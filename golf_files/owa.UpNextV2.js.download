self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.UpNextV2.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[493],{1002:function(e,t,n){"use strict";function r(e,t){return!e.some(function(e){return e&&t&&e.calculatedFolderId===t.calculatedFolderId})}function a(e,t){return e.indexOf(t)<0}function i(e,t){if(void 0===t&&(t=a),!e)return[];var n=[];return e&&e.forEach(function(e){t(n,e)&&n.push(e)}),n}var o=n(20);function c(e,t){if(void 0===t&&(t=a),!e)return e;var n=new o.ObservableMap;return e.forEach(function(e,r){n.set(r,i(e,t))}),n}function u(e,t){if(void 0===t&&(t=a),!e)return[];var n=[];return e.forEach(function(e){e&&e.forEach(function(e){t(n,e)&&n.push(e)})}),n}n.d(t,"a",function(){return r}),n.d(t,"b",function(){return i}),n.d(t,"c",function(){return c}),n.d(t,"d",function(){return u})},1005:function(e,t,n){"use strict";var r=n(7);t.a=function(e){return e.IsAllDayEvent||Object(r.u)(e.End,e.Start)>0}},1024:function(e,t,n){"use strict";n.d(t,"g",function(){return u}),n.d(t,"b",function(){return d}),n.d(t,"a",function(){return s}),n.d(t,"i",function(){return l}),n.d(t,"h",function(){return f}),n.d(t,"c",function(){return b}),n.d(t,"j",function(){return p}),n.d(t,"f",function(){return m}),n.d(t,"l",function(){return g}),n.d(t,"m",function(){return I}),n.d(t,"n",function(){return O}),n.d(t,"o",function(){return j}),n.d(t,"p",function(){return v}),n.d(t,"k",function(){return h}),n.d(t,"e",function(){return C}),n.d(t,"d",function(){return A});var r=n(0),a=n(2150),i=n(5),o=n(419),c=n.n(o),u="N/A",d="",s="CheckErrorDetails",l="React/Nps",f="UVNpsRating",b="UVFeedback",p="Search_{0}",m="NoUserMessage",g="https://outlook.uservoice.com/forums/{0}",I=601444,O=907141,j=4,v=15;function h(){return[{name:"NoResults",label:Object(i.a)(a.c)},{name:"SlowResults",label:Object(i.a)(a.f)},{name:"ResultsNotRelevant",label:Object(i.a)(a.e)},{name:"ItemNotFound",label:Object(i.a)(a.b)},{name:"SuggestionsNotUseful",label:Object(i.a)(a.g)},{name:"ClientUXHardToUse",label:Object(i.a)(a.a)},{name:"Other",label:Object(i.a)(a.d)}]}function C(e){return e?"1":"2"}function A(){return Object(r.__awaiter)(this,void 0,void 0,function(){var e;return Object(r.__generator)(this,function(t){switch(t.label){case 0:return[4,c()()];case 1:return[2,(e=t.sent()).ConsumerSubscriptions?e.ConsumerSubscriptions.join(","):d]}})})}},1073:function(e,t,n){"use strict";n.d(t,"c",function(){return r}),n.d(t,"a",function(){return a}),n.d(t,"e",function(){return i}),n.d(t,"g",function(){return o}),n.d(t,"f",function(){return c}),n.d(t,"b",function(){return u}),n.d(t,"d",function(){return d}),n.d(t,"h",function(){return s}),n.d(t,"i",function(){return l}),n.d(t,"j",function(){return f}),n.d(t,"k",function(){return b});var r=1,a=2,i=4,o=8,c=16,u=32,d=64,s=128,l=4294967296,f=8589934592,b=17179869184},1084:function(e,t,n){"use strict";var r=n(33),a=n(1300),i=n(1005),o=n(7),c=n(212);function u(e){var t=Object(c.w)();return e.ParentFolderId&&t&&e.ParentFolderId.Id===t.calculatedFolderId}function d(e){if(!e.ParentFolderId)return!1;var t=Object(c.k)(Object(c.w)()).ParentGroupId,n=Object(c.n)(e.ParentFolderId.Id);return n&&n.ParentGroupId===t}function s(e,t){var n=Object(i.a)(e);if(n!=Object(i.a)(t))return n?-1:1;var r=f(t)-f(e);if(0!=r)return r;if(0!=(r=Object(o.w)(e.Start,t.Start)))return r;if("Booking"!=e.__type||"Booking"!=t.__type){var c=u(e);if(c!=u(t))return c?-1:1;var s=d(e);if(s!=d(t))return s?-1:1}return 0!=(r=Object(a.a)(e,t))?r:0!=(r=Object(o.w)(t.End,e.End))?r:0!=(r=l(e.Subject,t.Subject))?r:0!=(r=l(e.CalendarItemType,t.CalendarItemType))?r:0!=(r=l(e.ParentFolderId.Id,t.ParentFolderId.Id))?r:l(e.ItemId.Id,t.ItemId.Id)}function l(e,t){return(e||"").localeCompare(t||"")}function f(e){var t=Object(o.w)(e.End,e.Start);return Math.max(Math.ceil(t/r.c),1)}n.d(t,"a",function(){return s})},1116:function(e,t,n){"use strict";function r(e){void 0===e&&(e={}),function(e){e.timeBetweenRetryInMS=e.timeBetweenRetryInMS||function(){return 6e4}}(e);var t=e.maximumAttempts,n=e.timeBetweenRetryInMS;return function(e){var r=0,a=!1,i=function(o,c){a?c(new Error("The function retry was cancelled")):(r++,e().then(function(e){return o(e)}).catch(function(e){t&&r>=t?c(e):setTimeout(function(){return i(o,c)},n(r))}))};return{retriableFunc:function(){return new Promise(function(e,t){return i(e,t)})},cancel:function(){return a=!0}}}}function a(e){return function(t){return Math.pow(2,t)*e}}n.d(t,"b",function(){return r}),n.d(t,"a",function(){return a})},11245:function(e,t,n){(t=e.exports=n(44)(!1)).push([e.i,'@-webkit-keyframes _3GYWRGGf7P_GI0nsmyJJEq{0%{-webkit-transform:translateY(0);transform:translateY(0)}33.33%,66.66%{-webkit-transform:translateY(-34px);transform:translateY(-34px)}to{-webkit-transform:translateY(-68px);transform:translateY(-68px)}}@-webkit-keyframes _2qguJkZ4YN-a4-jZornQTp{0%{-webkit-transform:translateY(0);transform:translateY(0)}33.33%,66.66%{-webkit-transform:translateY(-34px);transform:translateY(-34px)}to{-webkit-transform:translateY(-68px);transform:translateY(-68px)}}@keyframes _3GYWRGGf7P_GI0nsmyJJEq{0%{-webkit-transform:translateY(0);transform:translateY(0)}33.33%,66.66%{-webkit-transform:translateY(-34px);transform:translateY(-34px)}to{-webkit-transform:translateY(-68px);transform:translateY(-68px)}}@keyframes _2qguJkZ4YN-a4-jZornQTp{0%{-webkit-transform:translateY(0);transform:translateY(0)}33.33%,66.66%{-webkit-transform:translateY(-34px);transform:translateY(-34px)}to{-webkit-transform:translateY(-68px);transform:translateY(-68px)}}@-webkit-keyframes _1uBAfIo7O7RpspBEYft67J{to{-webkit-transform:translateY(0);transform:translateY(0)}}@-webkit-keyframes gqklPe3BnRAQGJ-1Nd_Xp{to{-webkit-transform:translateY(0);transform:translateY(0)}}@keyframes _1uBAfIo7O7RpspBEYft67J{to{-webkit-transform:translateY(0);transform:translateY(0)}}@keyframes gqklPe3BnRAQGJ-1Nd_Xp{to{-webkit-transform:translateY(0);transform:translateY(0)}}.bquTIlYhtqsZHlrJCQ0ci{font-size:12px;font-weight:400;color:"[theme:themeDark, default:#0D62AA]";cursor:pointer;height:34px;overflow:hidden}html[dir] .bquTIlYhtqsZHlrJCQ0ci{padding:0 8px}._1KWaEy1JwXTPcXePft1XyO,._1Lt2W5uQ7oe52kMFzniHCz,.HpJj1IBE9g7fhlrQQuBva{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-flow:column nowrap;flex-flow:column nowrap;-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto;overflow:hidden;-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start;-ms-flex-item-align:start;align-self:flex-start;height:34px}.HpJj1IBE9g7fhlrQQuBva{height:68px}html[dir] .HpJj1IBE9g7fhlrQQuBva{-webkit-transform:translateY(0);transform:translateY(0);-webkit-transition:-webkit-transform .3s cubic-bezier(.8,0,.2,1);transition:-webkit-transform .3s cubic-bezier(.8,0,.2,1);transition:transform .3s cubic-bezier(.8,0,.2,1);transition:transform .3s cubic-bezier(.8,0,.2,1),-webkit-transform .3s cubic-bezier(.8,0,.2,1)}._1Lt2W5uQ7oe52kMFzniHCz{height:102px;-webkit-animation-fill-mode:forwards;animation-fill-mode:forwards;-webkit-animation-play-state:running;animation-play-state:running;-webkit-animation-timing-function:cubic-bezier(.8,0,.2,1);animation-timing-function:cubic-bezier(.8,0,.2,1)}html[dir=ltr] ._1Lt2W5uQ7oe52kMFzniHCz{-webkit-animation-name:gqklPe3BnRAQGJ-1Nd_Xp;animation-name:gqklPe3BnRAQGJ-1Nd_Xp}html[dir=rtl] ._1Lt2W5uQ7oe52kMFzniHCz{-webkit-animation-name:_1uBAfIo7O7RpspBEYft67J;animation-name:_1uBAfIo7O7RpspBEYft67J}html[dir] .bquTIlYhtqsZHlrJCQ0ci:hover .HpJj1IBE9g7fhlrQQuBva{-webkit-transform:translateY(-34px);transform:translateY(-34px);-webkit-transition-delay:.1s;transition-delay:.1s}.bquTIlYhtqsZHlrJCQ0ci:hover ._1Lt2W5uQ7oe52kMFzniHCz{-webkit-animation-duration:3.6s;animation-duration:3.6s}html[dir=ltr] .bquTIlYhtqsZHlrJCQ0ci:hover ._1Lt2W5uQ7oe52kMFzniHCz{-webkit-animation-name:_2qguJkZ4YN-a4-jZornQTp;animation-name:_2qguJkZ4YN-a4-jZornQTp}html[dir=rtl] .bquTIlYhtqsZHlrJCQ0ci:hover ._1Lt2W5uQ7oe52kMFzniHCz{-webkit-animation-name:_3GYWRGGf7P_GI0nsmyJJEq;animation-name:_3GYWRGGf7P_GI0nsmyJJEq}._1hagGpG7AzPUNXP0Svq92n{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-flow:row nowrap;flex-flow:row nowrap;overflow:hidden;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-flex:1;-ms-flex:1 0 auto;flex:1 0 auto;-ms-flex-item-align:end;align-self:flex-end;height:34px}.Zxu7pq6NX4jIi550qVOsj{font-size:14px;font-weight:400;-webkit-box-flex:1;-ms-flex:1 0 auto;flex:1 0 auto;line-height:34px}html[dir=ltr] .Zxu7pq6NX4jIi550qVOsj{padding-right:6px}html[dir=rtl] .Zxu7pq6NX4jIi550qVOsj{padding-left:6px}._3PRzKbmV4xQJvn21aAkCeP{font-size:16px;-webkit-box-flex:1;-ms-flex:1 0 auto;flex:1 0 auto}html[dir=ltr] ._3PRzKbmV4xQJvn21aAkCeP{padding-right:8px}html[dir=rtl] ._3PRzKbmV4xQJvn21aAkCeP{padding-left:8px}._3wJAY7Lg8iqglCkKc_1xfx,._2KWQkcW6CcNYP-7HUovRXb,._5h5kaMsfWHnnSvF2gbHpv,._3xLd9sljnn8QP_g_E9drtK{overflow:hidden;word-break:break-all}html[dir] ._3wJAY7Lg8iqglCkKc_1xfx,html[dir] ._2KWQkcW6CcNYP-7HUovRXb,html[dir] ._5h5kaMsfWHnnSvF2gbHpv,html[dir] ._3xLd9sljnn8QP_g_E9drtK{text-align:start}.HI72OmTBCYbpLJFgasLYQ{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-flow:column nowrap;flex-flow:column nowrap;-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto;overflow:hidden;-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start;-ms-flex-item-align:start;align-self:flex-start}._5h5kaMsfWHnnSvF2gbHpv{font-weight:600;height:16px}._5h5kaMsfWHnnSvF2gbHpv,._1cph5Ohu1BNS65JDq4b3tl{-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto;max-width:162px}._1cph5Ohu1BNS65JDq4b3tl{display:-webkit-box;display:-ms-flexbox;display:flex}._3xLd9sljnn8QP_g_E9drtK{-webkit-box-flex:1;-ms-flex:1 0 auto;flex:1 0 auto;max-width:162px}html[dir=ltr] ._3xLd9sljnn8QP_g_E9drtK{margin-right:4px}html[dir=rtl] ._3xLd9sljnn8QP_g_E9drtK{margin-left:4px}._2KWQkcW6CcNYP-7HUovRXb{-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto}',""]),t.locals={upNextEventButtonContainer:"bquTIlYhtqsZHlrJCQ0ci",allEventsContainer:"_1KWaEy1JwXTPcXePft1XyO",allEventsContainerThreeOrMoreEvents:"_1Lt2W5uQ7oe52kMFzniHCz",allEventsContainerTwoEvents:"HpJj1IBE9g7fhlrQQuBva",reverseMotion:"gqklPe3BnRAQGJ-1Nd_Xp","reverseMotion-rtl":"_1uBAfIo7O7RpspBEYft67J",motionForThreeOrMore:"_2qguJkZ4YN-a4-jZornQTp","motionForThreeOrMore-rtl":"_3GYWRGGf7P_GI0nsmyJJEq",upNextEventContainer:"_1hagGpG7AzPUNXP0Svq92n",conflictingEventsCount:"Zxu7pq6NX4jIi550qVOsj",eventIconColumn:"_3PRzKbmV4xQJvn21aAkCeP",eventEntities:"_3wJAY7Lg8iqglCkKc_1xfx",eventLocation:"_2KWQkcW6CcNYP-7HUovRXb",eventName:"_5h5kaMsfWHnnSvF2gbHpv",eventTime:"_3xLd9sljnn8QP_g_E9drtK",eventDetailsColumn:"HI72OmTBCYbpLJFgasLYQ",eventTimeLocationRow:"_1cph5Ohu1BNS65JDq4b3tl"}},11246:function(e){e.exports={a:"dNb"}},1160:function(e,t,n){"use strict";var r=n(0),a=n(1),i=n(70),o=Object(i.action)("setDragState")(function(e,t){e.isBeingDragged=t}),c=n(1048),u=n(1192),d=n(25),s=n(63);n.d(t,"a",function(){return l});var l=function(){function e(e){var t=this;this.props=e,this.initialPageX=0,this.initialPageY=0,this.dragHelperElement=null,this.isPotentialDrag=!1,this.isDragging=!1,this.onDragStart=function(e){e.dataTransfer.clearData(),t.isDragAllowed()?(e.stopPropagation(),t.setDragStateAndData(e),e.dataTransfer.effectAllowed="copyMove",t.onDragStartInternal(e.pageX,e.pageY),t.overrideDefaultDragPreviewImage(e.dataTransfer)):t.props.showDefaultNoDragImage&&(t.overrideDefaultNoDragImage(e.dataTransfer),e.dataTransfer.setData("text","nodrop"),e.dataTransfer.effectAllowed="none")},this.onDragEnd=function(e){if(t.isDragging){t.isDragging=!1;var n=t.props.onDragEnd,r=e?e.dataTransfer.dropEffect:null;(Object(d.d)()||Object(d.f)())&&(r=Object(c.b)()),n&&n(t.props.getDragData(),r)}t.resetDragStateAndData(),t.removeDragHelperElement()},this.onMouseDown=function(e){!u.a&&0==e.button&&t.isDragAllowed()&&(t.initialPageX=e.pageX,t.initialPageY=e.pageY,t.isPotentialDrag=!0,document.body.addEventListener("mousemove",t.onMouseMove),document.body.addEventListener("mouseup",t.onMouseUp)),t.props.onMouseDown&&t.props.onMouseDown(e)},this.refCallback=function(e){t.div=e,t.div&&t.div.addEventListener("mousedown",t.onMouseDown)},this.onMouseMove=function(e){var n=e.pageX,r=e.pageY;(Math.abs(t.initialPageX-n)>=u.b||Math.abs(t.initialPageY-r)>=u.b)&&(t.removeMouseMoveAndUpEventListeners(),t.isPotentialDrag&&(t.isPotentialDrag=!1,(Object(d.d)()||Object(d.f)())&&window.getSelection().removeAllRanges(),t.isDragAllowed()&&(t.dragHelperElement=t.getDragHelperElement(),document.body.appendChild(t.dragHelperElement))),t.dragHelperElement&&(t.dragHelperElement.addEventListener("dragstart",function(e){t.onDragStartHelperElement(e)}),t.dragHelperElement.addEventListener("dragend",function(e){t.onDragEnd(e)}),t.dragHelperElement.dragDrop(),setTimeout(t.onDragEnd,0)))},this.onMouseUp=function(e){t.removeMouseMoveAndUpEventListeners()},this.onDragStartHelperElement=function(e){var n=e;n.stopPropagation(),n.dataTransfer.effectAllowed="copyMove",t.setDragStateAndData(n),t.onDragStartInternal(n.pageX,n.pageY)},this.removeMouseMoveAndUpEventListeners=function(){document.body.removeEventListener("mousemove",t.onMouseMove),document.body.removeEventListener("mouseup",t.onMouseUp)},this.removeDragHelperElement=function(){if(document.body)document.body.contains(t.dragHelperElement)&&(document.body.removeChild(t.dragHelperElement),t.dragHelperElement=null);else{var e=t.dragHelperElement?t.dragHelperElement.innerHTML:"null";s.d.error("removeDragHelperElement: "+e)}}}return e.prototype.onUnmount=function(){this.onDragEnd(null),u.a||this.removeMouseMoveAndUpEventListeners(),this.div.removeEventListener("mousedown",this.onMouseDown)},e.prototype.getDiv=function(){return this.div},e.prototype.onDragStartInternal=function(e,t){this.isDragging=!0;var n=this.props.onDragStart;n&&n(this.props.getDragData(),e,t)},e.prototype.setDragStateAndData=function(e){this.props.dragViewState&&o(this.props.dragViewState,!0);var t=this.props.getDragData();try{e.dataTransfer.setData(t.itemType,JSON.stringify(t))}catch(n){e.dataTransfer.setData("text",JSON.stringify(t))}Object(c.c)(t.itemType)},e.prototype.resetDragStateAndData=function(){this.props.dragViewState&&o(this.props.dragViewState,!1),Object(c.c)(null),Object(c.d)(null)},e.prototype.overrideDefaultDragPreviewImage=function(e){if(u.a){this.dragHelperElement=this.getDragHelperElement(),document.body.appendChild(this.dragHelperElement);var t=this.props.xOffset?this.props.xOffset:0,n=this.props.yOffset?this.props.yOffset:0;e.setDragImage(this.dragHelperElement,t,n)}},e.prototype.overrideDefaultNoDragImage=function(e){u.a&&(this.dragHelperElement=document.createElement("div"),this.dragHelperElement.style.display="none",document.body.appendChild(this.dragHelperElement),e.setDragImage(this.dragHelperElement,0,0))},e.prototype.getDragHelperElement=function(){var e=this.props.getDragPreview(this.props.getDragData());return e.style.top="0px",e.style.left="0px",e.style.zIndex="-1000",e.style.position="fixed",e},e.prototype.isDragAllowed=function(){return!this.props.canDrag||this.props.canDrag()},e}(),f=function(e){function t(t){var n=e.call(this,t)||this;return n.core=new l(t),n}return Object(r.__extends)(t,e),t.prototype.render=function(){return u.a?a.createElement("div",{draggable:!this.props.isDraggable||this.props.isDraggable(),className:this.props.classNames,ref:this.core.refCallback,onDragStart:this.core.onDragStart,onDragEnd:this.core.onDragEnd},this.props.children):a.createElement("div",{className:this.props.classNames,ref:this.core.refCallback},this.props.children)},t.prototype.componentWillUnmount=function(){this.core.onUnmount()},t.prototype.getDiv=function(){return this.core.getDiv()},t}(a.Component);t.b=f},1192:function(e,t,n){"use strict";n.d(t,"b",function(){return r}),n.d(t,"a",function(){return a});var r=5,a="undefined"!=typeof window&&window.hasOwnProperty("DataTransfer")&&DataTransfer.prototype.setDragImage},1218:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.action)("TOGGLE_CHARM",function(e){return{charm:e}})},1255:function(e,t,n){"use strict";n.d(t,"a",function(){return a}),n.d(t,"b",function(){return i}),n.d(t,"c",function(){return o});var r=n(4),a=Object(r.createStore)("UserVoiceNpsStore",{npsSurveyBody:"",npsSurveyRatings:"",isRatingSelected:!1,isSent:!1}),i=Object(r.createStore)("UserVoiceSuggestionStore",{message:"",isMessageEnabled:!1,isSent:!1,customFields:[]})(),o=Object(r.createStore)("userVoiceTrendingIdeasStore",{suggestions:[],pagination:{page:0,per_page:0,total_pages:0,total_records:0}})},1300:function(e,t,n){"use strict";var r=n(1301);t.a=function(e,t){return Object(r.a)(e.FreeBusyType)-Object(r.a)(t.FreeBusyType)}},1301:function(e,t,n){"use strict";t.a=function(e){switch(e){case"OOF":return 0;case"Busy":return 1;case"Tentative":return 2;case"WorkingElsewhere":return 3;case"Free":return 4;default:return 5}}},137:function(e,t,n){"use strict";var r=n(43),a={MillisecondsInOneDay:864e5,MillisecondsIn1Sec:1e3,MillisecondsIn1Min:6e4,MillisecondsIn30Mins:18e5,MillisecondsIn1Hour:36e5,MinutesInOneDay:1440,MinutesInOneHour:60,SecondsInOneMinute:60,DaysInOneWeek:7,AllDaysOfWeek:[r.b.Sunday,r.b.Monday,r.b.Tuesday,r.b.Wednesday,r.b.Thursday,r.b.Friday,r.b.Saturday]};t.a=a},1412:function(e,t,n){"use strict";var r=n(1084),a=n(1300),i=(n(1301),n(7));var o=function(e,t){return Object(i.xb)(e.Start)<Object(i.xb)(t.End)&&Object(i.xb)(e.End)>Object(i.xb)(t.Start)},c=function(e,t){return t.filter(function(t){return t!=e&&o(e,t)}).sort(r.a)};function u(e,t){var n,r,a,o,c;e.Start=t.Start,e.ItemId=t.ItemId,e.End=t.End,e.CalendarItemType="ThisAndFollowingInstancesMaster",e.Recurrence.RecurrenceRange.StartDate=(r=(n=t).StartTimeZoneId,a=n.Start,o=Object(i.Ob)(r,a),c=Object(i.Ub)(o),Object(i.sb)(c))}var d=n(1005);function s(e){e.Start=Object(i.Ob)(e.StartTimeZoneId,e.Start),e.End=Object(i.Ob)(e.EndTimeZoneId,e.End)}n.d(t,"a",function(){return r.a}),n.d(t,"b",function(){return a.a}),n.d(t,"c",function(){return c}),n.d(t,"d",function(){return u}),n.d(t,"e",function(){return o}),n.d(t,"f",function(){return d.a}),n.d(t,"g",function(){return s})},1436:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(51),a=new r.c(function(){return n.e(494).then(n.bind(null,3055))}),i=new r.a(a,function(e){return e.updateUserConfigurationService})},1468:function(e,t,n){"use strict";var r=n(4),a=Object(r.action)("UPDATE_SELECTED_CALENDARS_IN_STORE",function(e,t){return{calendarIds:e,primarySmtpAddress:t}}),i=Object(r.action)("ADD_SELECTED_CALENDAR_IN_STORE",function(e,t){return{calendarId:e,primarySmtpAddress:t}}),o={selectedCalendars:new(n(20).ObservableMap)},c=Object(r.createStore)("selectedCalendarsStore",o),u=n(1002);Object(r.mutator)(a,function(e){var t=e.calendarIds,n=e.primarySmtpAddress;c().selectedCalendars.set(n,Object(u.b)(t))});var d=n(0);function s(){return Object(u.c)(c().selectedCalendars)}function l(){return Object(u.d)(s())}function f(e){var t=s().get(e);return t||[]}Object(r.mutator)(i,function(e){var t=e.calendarId,n=e.primarySmtpAddress;c().selectedCalendars.set(n,Object(u.b)(Object(d.__spread)(f(n),[t])))});var b=Object(r.action)("UPDATE_SELECTED_CALENDARS",function(e,t){return{calendarIds:e,primarySmtpAddress:t}}),p=Object(r.action)("ADD_SELECTED_CALENDAR",function(e,t){return{calendarId:e,primarySmtpAddress:t}}),m=(Object(r.action)("INITIALIZE_SELECTED_CALENDARS",function(e,t){return{calendarIds:e,primarySmtpAddress:t}}),Object(r.action)("SELECTED_CALENDARS_UPDATED",function(e,t){return{calendarIds:e,primarySmtpAddress:t}})),g=n(133),I=n(63),O=n(1436),j="OWA.ViewStateConfiguration";function v(e,t){var n=Object(g.e)(t);e&&O.a.importAndExecute(j,{Type:"String",Value:["SelectedCalendarsDesktop"]},{Type:"StringArray",Value:Object(u.b)(e)},n).catch(function(e){I.d.warn("Could not save new selected calendars list to user configuration")})}Object(r.orchestrator)(b,function(e){var t=e.calendarIds,n=e.primarySmtpAddress;a(t,n),m(t,n),v(t,n)}),Object(r.orchestrator)(p,function(e){var t=e.calendarId,n=e.primarySmtpAddress;i(t,n);var r=f(n);m(r,n),v(r,n)});var h=n(79);function C(e){return e?function(e){var t=s().get(e);return t?t.length:0}(e):(t=s(),n=0,t.forEach(function(e,t){e&&(n+=e.length)}),n);var t,n}Object(r.orchestrator)(h.w,function(e){var t=e.userConfiguration,n=e.primarySmtpAddress,r=t.ViewStateConfiguration.SelectedCalendarsDesktop,i=n||Object(g.e)().primarySmtpAddress;a(r,i),m(r,i)}),n.d(t,"g",function(){return b}),n.d(t,"a",function(){return p}),n.d(t,"f",function(){return m}),n.d(t,"e",function(){return f}),n.d(t,"c",function(){return C}),n.d(t,"b",function(){return s}),n.d(t,"d",function(){return l})},1474:function(e,t,n){"use strict";n.d(t,"f",function(){return u}),n.d(t,"g",function(){return d}),n.d(t,"h",function(){return s}),n.d(t,"b",function(){return l});var r=n(51),a=n(1024);n.d(t,"a",function(){return a.l}),n.d(t,"c",function(){return a.m}),n.d(t,"e",function(){return a.n});var i=n(1255);n.d(t,"i",function(){return i.b});var o=n(1585);n.d(t,"d",function(){return o.a});var c=new r.c(function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(4),n.e(498)]).then(n.bind(null,3333))}),u=new r.a(c,function(e){return e.launchInAppFeedback}),d=new r.b(c,function(e){return e.postSuggestionAndSendLogDatapoint}),s=new r.b(c,function(e){return e.showUserVoiceSuggestionDialog}),l=Object(r.d)(c,function(e){return e.UserVoiceNps})},1538:function(e,t,n){"use strict";var r=n(0),a=n(212),i=n(133),o=n(41),c=n(346),u=n(63);function d(e,t,n){var d,s={},l={},f={},b={},p={},m=n?[n]:[Object(o.a)().SessionSettings.LogonEmailAddress],g=Object(i.e)(n);return e.forEach(function(e){p[e.ItemId.Id]=e.ItemId.ChangeKey;var n=Object(r.__assign)(Object(r.__assign)({},e),{id:{id:e.GroupId,mailboxInfo:g}}),i=Object(a.r)(g.primarySmtpAddress,e.GroupId);b[i]=n,e.Calendars.forEach(function(e){if(function(e,t){if(7==e.CalendarFolderType)return!1;if(Object(c.c)(e)){var n=e;if(n.IsOwnerEmailAddressInvalid)return u.d.info("[getCalendarsService] Ommitting shared calendar with IsOwnerEmailAddressInvalid flag on, OwnerEmailAddress: {1}: "+n.OwnerEmailAddress),!1;var r=n.IsGeneralScheduleCalendar?n.OwnerEmailAddress:n.SharedFolderId?n.SharedFolderId.Id:null;if(!r)return u.d.info("[getCalendarsService] Ommitting linked calendar with null SharedFolderId, Id: {1}: "+e.ItemId.Id),!1;if(t.includes(r))return u.d.info("[getCalendarsService] Ommitting duplicate shared calendar from Calendar folder list. DuplicateKey: {1}: "+r),!1;if(t.push(r),n.OwnerEmailAddress=n.OwnerEmailAddress.toLowerCase(),n.IsGroupMailboxCalendar)return!1}return!0}(e,m)){var n=e.ItemId.Id,i=Object(a.g)(e).Id,o=Object(r.__assign)(Object(r.__assign)({},e),{id:{id:n,mailboxInfo:g}});if(1==e.CalendarFolderType){var l=t&&t.filter(function(e){return e.FolderId.Id===i})[0];d={id:{id:n,mailboxInfo:g},calculatedFolderId:i,displayName:l?l.DisplayName:e.CalendarName,colorScheme:null},o.CalendarName=d.displayName}!s[n]&&(s[n]=o),!f[i]&&(f[i]={id:e.ItemId.Id,mailboxInfo:g}),!p[n]&&(p[n]=e.ItemId.ChangeKey)}})}),t.forEach(function(e){var t=f[e.FolderId.Id];t&&(l[t.id]=e)}),{defaultCalendar:d,calendarEntryMapping:s,calendarFolderMapping:l,folderIdMapping:f,calendarGroupMapping:b,calendarIdToChangeKeyMapping:p}}var s=n(2507),l=n.n(s),f=n(193),b=n(2347),p=n(79),m=n(247);function g(e){return Object(r.__awaiter)(this,void 0,void 0,function(){var t,n;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return t=null,e&&!Object(p.s)(e)||(t=Object(b.a)()),t?[3,3]:[4,Object(m.e)(Object(i.e)(e))];case 1:return n=r.sent(),[4,l()({Header:Object(f.getJsonRequestHeader)()},n)];case 2:t=r.sent(),r.label=3;case 3:return[2,t]}})})}var I=n(323),O=n.n(I),j=n(2273),v=n.n(j);function h(e,t){return Object(r.__awaiter)(this,void 0,void 0,function(){var n,i,o,c;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return n=new Headers,Object(m.g)(t,n),i={headers:n},o=Object(a.n)(e.Id),c=o&&(o.IsGeneralScheduleCalendar||o.IsGroupMailboxCalendar)?O()({Id:"calendar",Mailbox:{EmailAddress:t}}):5==o.CalendarFolderType?o.SharedFolderId:e,[4,v()({request:{FolderId:c}},i)];case 1:return[2,r.sent()]}})})}var C=n(746),A=n.n(C),w=n(153),x=n(4),D=Object(x.action)("calendarFolderIdUpdated"),S=Object(x.action)("setCalendarLoadState",function(e,t){return{calendarId:e,loadState:t}});function y(e){return Object(r.__awaiter)(this,void 0,void 0,function(){var t;return Object(r.__generator)(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),S(e,"Loading"),[4,E(e)];case 1:return n.sent(),[3,3];case 2:return(t=n.sent()).message&&(t.message.indexOf("ErrorApiQuarantined")>=0||t.message.indexOf("ErrorTooManyObjectsOpened")>=0)?S(e,"Throttled"):S(e,"Failed"),[3,3];case 3:return[2]}})})}function E(e){return Object(r.__awaiter)(this,void 0,void 0,function(){var t,n,c,u,d,s,l;return Object(r.__generator)(this,function(r){switch(r.label){case 0:if(!(t=Object(a.l)(e)))throw new Error("Unable to get calendar entry for calendar "+e);n=Object(a.x)(e),c=Object(a.h)(e),u=Object(a.t)(n),d=u?u.mailboxInfo:Object(i.e)(),s=5==t.CalendarFolderType&&Object(o.a)().SessionSettings.DefaultPublicFolderMailbox?Object(o.a)().SessionSettings.DefaultPublicFolderMailbox:function(e,t){return e||(t?t.primarySmtpAddress:null)}(t.OwnerEmailAddress,d),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,h(A()({Id:c}),s)];case 2:return l=r.sent(),[3,4];case 3:return r.sent(),Object(w.m)("getCalendarFolderConfigurationServiceFailed"),Object(a.H)(t),[2];case 4:if(!l)throw new Error("Unable to get folder for calendar "+e);return Object(a.H)(t),5==t.CalendarFolderType?function(e,t,n){var r=e.CalendarFolder;if(r){t.CalendarFolderId||(t.CalendarFolderId=e.CalendarFolder.FolderId);var o=r.ReplicaList[0];Object(a.b)(t,r,{type:0,deprecatedMailboxId:o,primarySmtpAddress:o,routingKey:Object(i.c)()+o,requestOptions:Object(m.a)(o,n),returnModernConversationItems:n.returnModernConversationItems})}}(l,t,d):function(e,t,n,r){var i=e.CalendarFolder;i&&i.EffectiveRights&&i.EffectiveRights.Read&&(e.MasterList&&(t.RemoteCategories=e.MasterList),(r==t.OwnerEmailAddress||t.ItemId&&r==t.ItemId.Id)&&(Object(a.e)(r,{id:{id:t.ItemId.Id,mailboxInfo:n},calculatedFolderId:i.FolderId.Id}),Object(a.J)(r),Object(a.b)(t,i,n)))}(l,t,d,e),D(),[2]}})})}function _(e){return Object(r.__awaiter)(this,void 0,void 0,function(){var t,n;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return[4,g(e)];case 1:return null!==(t=r.sent())&&t.WasSuccessful?(n=d(t.CalendarGroups,t.CalendarFolders,e),Object(a.B)(n.defaultCalendar,n.calendarEntryMapping,n.calendarFolderMapping,n.calendarGroupMapping,n.folderIdMapping,n.calendarIdToChangeKeyMapping)):u.d.error("[getCalendarFoldersFromServer] Failed to load calendars from server"),[2]}})})}var M=n(20),T=Object(x.createStore)("OwaCalendarsApiStore",{calendarIdsLoadState:new M.ObservableMap});function N(e){return T().calendarIdsLoadState.get(e)}Object(x.mutator)(S,function(e){var t=e.calendarId,n=e.loadState;T().calendarIdsLoadState.set(t,n)}),Object(x.mutator)(a.I,function(e){var t=e.calendar;T().calendarIdsLoadState.delete(t.id.id)}),n.d(t,"b",function(){return d}),n.d(t,"e",function(){return g}),n.d(t,"c",function(){return y}),n.d(t,"f",function(){return _}),n.d(t,"a",function(){return D}),n.d(t,"d",function(){return N})},156:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(7);function a(e,t,n){return Object(r.Ob)(e,Object(r.Ab)(t),Object(r.vb)(t),Object(r.kb)(t),Object(r.qb)(n),Object(r.ub)(n),Object(r.wb)(n),Object(r.tb)(n))}},1573:function(e,t,n){"use strict";var r=n(0),a=n(4),i=n(79),o=Object(a.action)("LOAD_WORKLOAD_SCENARIO_SETTINGS"),c=Object(a.action)("WORKLOAD_SCENARIO_SETTINGS_LOADED",function(e,t){return{settings:e,accountSmtpAddress:t}}),u=Object(a.action)("LOADING_WORKLOAD_SCENARIO_SETTINGS_FAILED",function(e){return{accountSmtpAddress:e}}),d=n(247),s=n(113);function l(e){switch(e){case 1:return"Mail";case 2:return"Calendar";case 64:return"FilesHub";case 4:return"People";default:throw new Error("getWorkloadScenarioType: The workload type is not supported")}}var f="ows/beta/ScenarioSettings";var b=71;function p(e){return 0!=(e&b)}var m=n(820);function g(e){return Object(r.__awaiter)(this,void 0,void 0,function(){var t,n,a,i,o=this;return Object(r.__generator)(this,function(c){return t=["Owa"],p(n=Object(m.b)())&&(a=l(n),t.push(a)),i=function(e){var t=e.join(",");return f+"/?Scenarios="+t}(t),[2,Object(d.b)(e).then(function(e){return Object(r.__awaiter)(o,void 0,void 0,function(){var t,n;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return[4,Object(s.b)(i,void 0,void 0,e,!0,void 0,"GET_WORKLOAD_SCENARIO_SETTINGS")];case 1:return t=r.sent(),n={timePanelSelectedView:null,timePanelCalendarIds:[],timePanelSelectedCalendarView:null,isTimePanelOpen:!1,isTimePanelDatePickerExpanded:!1},t.settings&&t.settings.forEach(function(e){var t;(t=e).calendarIds&&"TimePanelCalendarIds"===t.settingName?n.timePanelCalendarIds=e.calendarIds:!function(e){return!!e.selectedView&&"TimePanelSelectedView"===e.settingName}(e)?!function(e){return!!e.selectedView&&"SelectedCalendarListView"===e.settingName}(e)?!function(e){return void 0!==e.isOpen&&"IsTimePanelOpen"===e.settingName}(e)?function(e){return void 0!==e.isExpanded&&"IsTimePanelDatePickerExpanded"===e.settingName}(e)&&(n.isTimePanelDatePickerExpanded=e.isExpanded):n.isTimePanelOpen=e.isOpen:n.timePanelSelectedCalendarView=e.selectedView:n.timePanelSelectedView=e.selectedView}),[2,n]}})})})]})})}var I=n(1116),O=Object(I.b)({maximumAttempts:3,timeBetweenRetryInMS:Object(I.a)(1e4)}),j={};Object(a.orchestrator)(o,function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){return Object(i.e)().forEach(v),[2]})})});function v(e){return Object(r.__awaiter)(this,void 0,void 0,function(){var t;return Object(r.__generator)(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),j[e]?[2]:(j[e]=O(function(){return g(e)}),[4,j[e].retriableFunc()]);case 1:return t=n.sent(),c(t,e),[3,3];case 2:return n.sent(),u(e),[3,3];case 3:return[2]}})})}var h=n(1764);Object(a.orchestrator)(h.d,function(e){v(e.accountSmtpAddress)});function C(e,t){return f+"/"+e+"/"+t}function A(e){return Object(r.__awaiter)(this,void 0,void 0,function(){var t,n,a,i;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return p(t=Object(m.b)())?(n=l(t),a=C(n,"TimePanelSelectedView"),i={ViewType:e},[4,Object(s.c)(a,i,void 0,void 0,void 0,!0,void 0)]):[3,2];case 1:r.sent(),r.label=2;case 2:return[2]}})})}function w(e,t){return Object(r.__awaiter)(this,void 0,void 0,function(){var t,n;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return t=C("Owa","TimePanelCalendarIds"),n={CalendarIds:e},[4,Object(s.c)(t,n,void 0,void 0,void 0,!0,void 0)];case 1:return r.sent(),[2]}})})}function x(e){return Object(r.__awaiter)(this,void 0,void 0,function(){var t,n,a,i;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return p(t=Object(m.b)())?(n=l(t),a=C(n,"IsTimePanelOpen"),i={IsOpen:e},[4,Object(s.c)(a,i,void 0,void 0,void 0,!0,void 0)]):[3,2];case 1:r.sent(),r.label=2;case 2:return[2]}})})}function D(e){return Object(r.__awaiter)(this,void 0,void 0,function(){var t,n,a,i;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return p(t=Object(m.b)())?(n=l(t),a=C(n,"SelectedCalendarListView"),i={ViewType:e},[4,Object(s.c)(a,i,void 0,void 0,void 0,!0,void 0)]):[3,2];case 1:r.sent(),r.label=2;case 2:return[2]}})})}function S(e){return Object(r.__awaiter)(this,void 0,void 0,function(){var t,n;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return t=C("Owa","IsTimePanelDatePickerExpanded"),n={isExpanded:e},[4,Object(s.c)(t,n,void 0,void 0,void 0,!0,void 0)];case 1:return r.sent(),[2]}})})}n.d(t,"a",function(){return o}),n.d(t,"g",function(){return c}),n.d(t,"f",function(){return A}),n.d(t,"e",function(){return w}),n.d(t,"d",function(){return x}),n.d(t,"c",function(){return D}),n.d(t,"b",function(){return S})},1578:function(e,t,n){"use strict";function r(e){var t=0,n=[];function r(){t-=1,n.length>0&&n.shift()()}return{add:function(a){return new Promise(function(i,o){var c=function(){t+=1,a().then(function(e){r(),i(e)},function(e){r(),o(e)})};t===e?n.push(c):c()})},getRunningCount:function(){return t},getQueueLength:function(){return n.length}}}n.d(t,"a",function(){return r})},1585:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(4),a=Object(r.action)("DEACTIVATE_HELP_CHARM")},1622:function(e,t,n){"use strict";n.d(t,"a",function(){return a}),n.d(t,"b",function(){return i}),n.d(t,"c",function(){return o});var r=n(4),a=Object(r.action)("initializeOwaAccountsStore"),i=Object(r.action)("owaConnectedAccountAdded",function(e){return{accountSmtpAddress:e}}),o=Object(r.action)("removeAccount",function(e){return{primarySmtpAddress:e}})},1742:function(e,t,n){"use strict";var r=n(818);n.d(t,"b",function(){return r.a});var a=n(797);n.d(t,"d",function(){return a.a});var i=n(929);n.d(t,"c",function(){return i.b});var o=n(1160);n.d(t,"a",function(){return o.b})},1764:function(e,t,n){"use strict";n.d(t,"a",function(){return o}),n.d(t,"b",function(){return c}),n.d(t,"c",function(){return u});var r=n(1622);n.d(t,"d",function(){return r.b});var a=n(51),i=new a.c(function(){return n.e(536).then(n.bind(null,3589))}),o=new a.a(i,function(e){return e.initializeOwaAccountsStore}),c=new a.b(i,function(e){return e.initializeOwaConnectedAccount}),u=new a.a(i,function(e){return e.removeOWAConnectedAccount})},1786:function(e,t,n){"use strict";var r=n(0),a=n(4),i=n(50),o=Object(a.action)("toggleShowDeclinedEventsMode",function(e,t){return Object(i.b)({name:"ToggleShowDeclinedEventsMode",customData:{CurrentDateRangeType:t,ShowDeclinedEventsMode:e}},{isDeclinedEventsMode:e,dateRangeType:t})}),c=o,u=n(41),d=n(361),s=n(1436);Object(a.orchestrator)(o,function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var t,n;return Object(r.__generator)(this,function(a){return t=e.isDeclinedEventsMode,n=Object(u.a)(),Object(d.a)(Object(r.__assign)(Object(r.__assign)({},n),{ViewStateConfiguration:Object(r.__assign)(Object(r.__assign)({},n.ViewStateConfiguration),{CalendarViewShowDeclinedMeetings:t})})),s.a.importAndExecute("OWA.ViewStateConfiguration",{Type:"String",Value:["CalendarViewShowDeclinedMeetings"]},{Type:"Boolean",Value:[""+t]}),[2]})})});var l=n(79),f=n(67);function b(){return!!Object(f.f)("cal-surface-declinedMeetings")&&Object(l.f)().ViewStateConfiguration.CalendarViewShowDeclinedMeetings}n.d(t,"a",function(){return b}),n.d(t,"b",function(){return c})},1842:function(e,t,n){"use strict";var r=n(4),a=Object(r.action)("DEACTIVATE_CHARM",function(e){return{charm:e}}),i=Object(r.createStore)("headerViewState",{activeCharm:null});Object(r.mutator)(a,function(e){var t=e.charm,n=i();n.activeCharm===t&&(n.activeCharm=null)});var o=n(1218);Object(r.mutator)(o.a,function(e){var t=e.charm,n=i();n.activeCharm===t?n.activeCharm=null:n.activeCharm=t});var c=n(2352),u=(Object(r.orchestrator)(c.a,function(){Object(o.a)(4)}),Object(r.action)("HIDE_QUICK_OPTIONS",function(){return{}})),d=(Object(r.orchestrator)(u,function(){a(4)}),n(1474));Object(r.orchestrator)(d.d,function(){a(2)});function s(){return i().activeCharm}n.d(t,"a",function(){return a}),n.d(t,"b",function(){return s}),n.d(t,"c",function(){return o.a})},1849:function(e,t,n){"use strict";n.d(t,"a",function(){return h});var r=n(0),a=n(746),i=n.n(a),o=n(1850),c=n.n(o),u=n(1851),d=n.n(u),s=n(776),l=n.n(s),f=n(7),b=n(193),p=n(736),m=n(247),g=n(1578),I="X-OWA-ExplicitLogonUser",O="X-AnchorMailbox",j=6,v=null;function h(e,t,n,a,o,u){return void 0===n&&(n=Object(p.a)("calendar")),Object(r.__awaiter)(this,void 0,void 0,function(){var s,p;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return s=null,o?(s={headers:(p={},p[I]=o,p[O]=o,p)},[3,3]):[3,1];case 1:return a?[4,Object(m.e)(a.mailboxInfo)]:[3,3];case 2:s=r.sent(),r.label=3;case 3:return v||(v=Object(g.a)(j)),[2,v.add(function(){return c()({Header:Object(b.getJsonRequestHeader)(),Body:d()({CalendarId:l()({BaseFolderId:i()({Id:n})}),RangeStart:Object(f.pb)(e),RangeEnd:Object(f.pb)(t),IncludeDeclinedMeetings:u})},s).then(function(e){return e.Body})})]}})})}},1885:function(e,t,n){"use strict";n.d(t,"a",function(){return u}),n.d(t,"e",function(){return d});var r=n(51),a=n(2560);n.d(t,"b",function(){return a.a});var i=n(2443);n.d(t,"d",function(){return i.a});n(2508);var o=n(2509);n.d(t,"c",function(){return o.a});var c=new r.c(function(){return Promise.all([n.e(3),n.e(7),n.e(9),n.e(13),n.e(165)]).then(n.bind(null,4921))}),u=Object(r.d)(c,function(e){return e.NotesEditor}),d=new r.a(c,function(e){return e.openNotesEditor})},204:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(7),a=n(156);function i(e,t,n,i){var o=Object(a.a)(t,n,i);return Object(r.Cb)(e,o)&&(o=Object(r.Ob)(t,e)),{start:e,end:o}}},2080:function(e,t,n){"use strict";var r=n(4);var a=n(820),i=Object(r.createStore)("timePanelSettingStore",{panelViewStack:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return{stack:e||[]}}(2!==Object(a.b)()?"Calendar":"Tasks"),isDatePickerExpanded:!1});var o=Object(r.action)("pushTimePanelView",function(e){return{newView:e}}),c=Object(r.action)("updateTopTimePanelView",function(e){return{updatedView:e}}),u=Object(r.action)("updateIsDatePickerExpanded",function(e){return{isExpanded:e}}),d=Object(r.action)("popTimePanelView"),s=n(1573);function l(e){!function(e,t){if(0===t.length)return null;t[t.length-1]=e}(e,i().panelViewStack.stack)}function f(e){i().isDatePickerExpanded=e}Object(r.mutator)(o,function(e){var t;t=e.newView,i().panelViewStack.stack.push(t)}),Object(r.mutator)(c,function(e){return l(e.updatedView)}),Object(r.mutator)(d,function(){var e=i().panelViewStack;e.stack.pop()}),Object(r.mutator)(s.g,function(e){var t=e.settings;t.timePanelSelectedView&&l(t.timePanelSelectedView)}),Object(r.mutator)(u,function(e){return f(e.isExpanded)}),Object(r.mutator)(s.g,function(e){e.settings.isTimePanelDatePickerExpanded&&f(e.settings.isTimePanelDatePickerExpanded)});var b=n(0),p=n(1116),m=n(63),g=Object(p.b)({maximumAttempts:3,timeBetweenRetryInMS:Object(p.a)(1e3)}),I=null;Object(r.orchestrator)(c,function(e){return Object(b.__awaiter)(void 0,void 0,void 0,function(){var t,n;return Object(b.__generator)(this,function(r){switch(r.label){case 0:if(t=e.updatedView,"Tasks"!==(a=t)&&"Calendar"!==a)return[3,5];r.label=1;case 1:return r.trys.push([1,3,,4]),I&&I.cancel(),[4,(I=g(function(){return Object(s.f)(t)})).retriableFunc()];case 2:return r.sent(),[3,4];case 3:return n=r.sent(),m.d.warn("viewStackOrchestrator: updateTimePanelSelectedViewService with retry failed: "+n),[3,4];case 4:I=null,r.label=5;case 5:return[2]}var a})})});var O=Object(p.b)({maximumAttempts:3,timeBetweenRetryInMS:Object(p.a)(1e3)}),j=null;Object(r.orchestrator)(u,function(e){return Object(b.__awaiter)(void 0,void 0,void 0,function(){var t,n;return Object(b.__generator)(this,function(r){switch(r.label){case 0:t=e.isExpanded,r.label=1;case 1:return r.trys.push([1,3,,4]),j&&j.cancel(),[4,(j=O(function(){return Object(s.b)(t)})).retriableFunc()];case 2:return r.sent(),[3,4];case 3:return n=r.sent(),m.d.warn("updateIsDatePickerExpandedOrchestrator: updateIsTimePanelDatePickerExpandedService with retry failed: "+n),[3,4];case 4:return j=null,[2]}})})});var v={Conflicts:"Calendar",EventDetails:"Calendar",AttendeeTracking:"Calendar",Calendar:"Calendar",ComposeForm:"Calendar",Tasks:"Tasks"};function h(e){return e?v[e]:null}function C(){return h(A())}function A(){var e,t=i().panelViewStack;return 0===(e=t.stack).length?null:e[e.length-1]}function w(){return i().panelViewStack.stack.length}function x(){return-1!==i().panelViewStack.stack.indexOf("Conflicts")}function D(){return-1!==i().panelViewStack.stack.indexOf("AttendeeTracking")}function S(){var e=i().panelViewStack;return w()>=2?e.stack[w()-2]:null}function y(){return i().isDatePickerExpanded}n.d(t,"j",function(){return o}),n.d(t,"l",function(){return c}),n.d(t,"k",function(){return u}),n.d(t,"i",function(){return d}),n.d(t,"b",function(){return C}),n.d(t,"a",function(){return A}),n.d(t,"e",function(){return w}),n.d(t,"h",function(){return x}),n.d(t,"g",function(){return D}),n.d(t,"d",function(){return S}),n.d(t,"f",function(){return y}),n.d(t,"c",function(){return h})},2106:function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"b",function(){return o}),n.d(t,"e",function(){return c}),n.d(t,"f",function(){return u}),n.d(t,"g",function(){return d}),n.d(t,"d",function(){return s}),n.d(t,"c",function(){return l});var r=n(51),a=new r.c(function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(475)]).then(n.bind(null,3476))}),i=Object(r.d)(a,function(e){return e.TimePanel}),o=Object(r.d)(a,function(e){return e.TimePanelHeaderBar}),c=(new r.a(a,function(e){return e.preloadTimePanelData}),new r.a(a,function(e){return e.openEventDetailsView})),u=(new r.a(a,function(e){return e.openAttendeeTrackingView}),new r.a(a,function(e){return e.closeAttendeeTrackingView}),new r.a(a,function(e){return e.openTasksView})),d=new r.a(a,function(e){return e.openCalendarView}),s=new r.a(a,function(e){return e.openConflictsView}),l=new r.a(a,function(e){return e.closeConflictsView});new r.a(a,function(e){return e.openEventQuickComposeView})},212:function(e,t,n){"use strict";var r=n(4),a=n(20),i={calendarEntryMapping:new a.ObservableMap,calendarFolderMapping:new a.ObservableMap,calendarItemIdToChangeKey:new a.ObservableMap,folderIdToCalendarId:new a.ObservableMap,validEntryMapping:new a.ObservableMap,calendarGroupsMapping:new a.ObservableMap,defaultCalendars:new a.ObservableMap},o=Object(r.createStore)("calendarsCacheStore",i),c=n(0),u=Object(r.action)("initializeCalendarsCacheInStore",function(e,t,n,r,a,i){return{defaultCalendarEntry:e,calendarEntries:t,calendarFolders:n,calendarGroups:r,folderIdMapping:a,calendarIdToChangeKeyMapping:i}}),d=Object(r.action)("updateChangeKeyByCalendarItemId",function(e){return{itemId:e}}),s=Object(r.action)("addToCalendarsCache",function(e,t,n){return{calendarEntry:e,folder:t,mailboxInfo:n}}),l=Object(r.action)("addCalendarGroupToCalendarsCache",function(e){return{calendarGroup:e}}),f=Object(r.action)("updateCalendarEntry",function(e,t){return{itemId:e,calendarEntry:t}}),b=Object(r.action)("updateCalendarFolder",function(e,t){return{calendar:e,calendarFolder:t}}),p=Object(r.action)("removeCalendarFromCalendarsCache",function(e){return{calendar:e}}),m=Object(r.action)("markCalendarEntryAsValid",function(e){return{calendarEntry:e}}),g=Object(r.action)("calendarUpdated",function(e,t){return{calendarId:e,updates:t}}),I=Object(r.action)("groupAssociationChanged",function(e){return{payload:e}}),O=Object(r.action)("removeCalendarWithIDFromCalendarsCache",function(e){return{calendarId:e}});function j(e){if(void 0!==e.CalendarFolderId)return e.CalendarFolderId;var t=e;return t.IsGeneralScheduleCalendar?{Id:t.OwnerEmailAddress,ChangeKey:""}:t.SharedFolderId?{Id:t.SharedFolderId.Id,ChangeKey:null!=t.SharedFolderId.ChangeKey?t.SharedFolderId.ChangeKey:""}:null}Object(r.mutator)(d,function(e){var t=e.itemId,n=t.Id,r=t.ChangeKey;o().calendarItemIdToChangeKey.set(n,r)}),Object(r.mutator)(f,function(e){var t=e.itemId.Id,n=e.calendarEntry,r=o().calendarEntryMapping.get(t),a=(n.ItemId,Object(c.__rest)(n,["ItemId"]));r&&Object.keys(a).forEach(function(e){r[e]=a[e]})}),Object(r.mutator)(m,function(e){var t=e.calendarEntry;o().validEntryMapping.set(t.ItemId.Id,!0)});var v=n(133);function h(e){return e||(e=Object(v.e)().primarySmtpAddress),o().defaultCalendars.get(e)}function C(){var e=o().calendarEntryMapping;return Object(c.__spread)(e.values())}function A(){return C().map(function(e){return S(e.id.id)}).filter(function(e){return e})}function w(){var e=o().calendarGroupsMapping;return Object(c.__spread)(e.values())}function x(e){return o().folderIdToCalendarId.get(e)}function D(e){return o().calendarEntryMapping.get(e)}function S(e){var t=D(e);return t?{id:{id:e,mailboxInfo:Object(c.__assign)({},t.id.mailboxInfo)},calculatedFolderId:L(e),displayName:t.CalendarName,colorScheme:null}:null}function y(e){return o().calendarFolderMapping.get(e.id.id)}function E(e){return D(e.id.id)}function _(e){var t=x(e);return t?D(t.id):void 0}function M(e){var t=o().calendarFolderMapping,n=x(e);return n?t.get(n.id):void 0}function T(e){return o().calendarItemIdToChangeKey.get(e)}function N(e){return k(e.id.id)}function k(e){var t=o().calendarFolderMapping.get(e);return t&&(t.FolderId||t.DistinguishedFolderId)?t.FolderId?t.FolderId.Id:t.DistinguishedFolderId:L(e)}function L(e){var t=o().calendarEntryMapping.get(e);if(t){var n=j(t);return n?n.Id:null}return null}function P(e){return!!D(e)}function V(e){var t=o(),n=t.folderIdToCalendarId,r=t.calendarEntryMapping,a=n.get(e);if(a){var i=r.get(a.id);return!i.IsGroupMailboxCalendar&&null!=i.CalendarFolderId}return!1}function G(e){if(V(e)){var t=_(e);return t&&t.IsReadOnly}return!1}function H(e){var t=o().validEntryMapping;return e&&t.get(e.ItemId.Id)}function F(e){return!V(k(e))&&!H(D(e))}function R(e){var t,n=o(),r=n.folderIdToCalendarId,a=n.calendarEntryMapping,i=r.get(e);i?t=a.get(i.id):t=Object(c.__spread)(a.values()).filter(function(t){return t.OwnerEmailAddress&&t.OwnerEmailAddress.toLowerCase()==e.toLowerCase()})[0];return t}function z(e,t){return t+"_"+e}function W(e,t){Object.keys(t).forEach(function(n){return e.set(n,t[n])})}function Y(e,t){var n=o();n.calendarItemIdToChangeKey.delete(e),n.calendarEntryMapping.delete(e),n.calendarFolderMapping.delete(e),t&&n.folderIdToCalendarId.delete(t)}function Z(e){var t=x(e);return t?t.mailboxInfo:null}function B(e){var t=y(e),n=E(e);return t&&n&&!n.IsReadOnly&&t.EffectiveRights&&t.EffectiveRights.CreateContents}Object(r.mutator)(u,function(e){var t=e.defaultCalendarEntry;t&&o().defaultCalendars.set(t.id.mailboxInfo.primarySmtpAddress,t)}),Object(r.mutator)(u,function(e){var t=e.calendarEntries;W(o().calendarEntryMapping,t)}),Object(r.mutator)(u,function(e){var t=e.calendarFolders;W(o().calendarFolderMapping,t)}),Object(r.mutator)(u,function(e){var t=e.folderIdMapping;W(o().folderIdToCalendarId,t)}),Object(r.mutator)(u,function(e){var t=e.calendarIdToChangeKeyMapping;W(o().calendarItemIdToChangeKey,t)}),Object(r.mutator)(u,function(e){var t=e.calendarGroups;W(o().calendarGroupsMapping,t)}),Object(r.mutator)(s,function(e){var t=e.calendarEntry,n=e.folder,r=e.mailboxInfo,a=o();a.calendarItemIdToChangeKey.set(t.ItemId.Id,t.ItemId.ChangeKey);var i=Object(c.__assign)(Object(c.__assign)({},t),{id:{id:t.ItemId.Id,mailboxInfo:r}});a.calendarEntryMapping.set(t.ItemId.Id,i),a.calendarFolderMapping.set(t.ItemId.Id,n),n.FolderId?a.folderIdToCalendarId.set(n.FolderId.Id,{id:t.ItemId.Id,mailboxInfo:r}):n.DistinguishedFolderId&&a.folderIdToCalendarId.set(n.DistinguishedFolderId,{id:t.ItemId.Id,mailboxInfo:r})}),Object(r.mutator)(l,function(e){var t=e.calendarGroup,n=o(),r=z(t.id.mailboxInfo.primarySmtpAddress,t.GroupId);n.calendarGroupsMapping.set(r,t)}),Object(r.mutator)(p,function(e){var t=e.calendar;Y(t.id.id,t.calculatedFolderId?t.calculatedFolderId:null)}),Object(r.mutator)(O,function(e){var t=e.calendarId;Y(t,k(t))}),Object(r.mutator)(b,function(e){var t=e.calendar,n=e.calendarFolder,r=y(t);Object.keys(n).forEach(function(e){r[e]=n[e]})});var U=n(346),J=n(41);function Q(e,t){var n=E(e);if(Object(U.c)(n)){var r=n;return!r.IsOwnerEmailAddressInvalid&&r.OwnerEmailAddress==t}return e.id&&e.id.mailboxInfo?t.indexOf(e.id.mailboxInfo.primarySmtpAddress)>=0:Object(J.a)().SessionSettings.UserEmailAddress==t}function K(e){return e?e.map(S).filter(function(e){return!!e}):null}var q=n(329),X="Groups";function $(e){var t=Object(q.a)(w(),function(e){return e.ItemId.Id===X});return function(e){var t=E(e);return!!t&&t.IsGroupMailboxCalendar}(e)&&t?t.item.id.mailboxInfo.primarySmtpAddress:e.id.mailboxInfo.primarySmtpAddress}n.d(t,"B",function(){return u}),n.d(t,"M",function(){return d}),n.d(t,"b",function(){return s}),n.d(t,"a",function(){return l}),n.d(t,"K",function(){return f}),n.d(t,"L",function(){return b}),n.d(t,"I",function(){return p}),n.d(t,"H",function(){return m}),n.d(t,"e",function(){return g}),n.d(t,"A",function(){return I}),n.d(t,"J",function(){return O}),n.d(t,"w",function(){return h}),n.d(t,"j",function(){return C}),n.d(t,"f",function(){return A}),n.d(t,"s",function(){return w}),n.d(t,"t",function(){return x}),n.d(t,"l",function(){return D}),n.d(t,"i",function(){return S}),n.d(t,"o",function(){return y}),n.d(t,"k",function(){return E}),n.d(t,"n",function(){return _}),n.d(t,"p",function(){return M}),n.d(t,"v",function(){return T}),n.d(t,"q",function(){return N}),n.d(t,"x",function(){return k}),n.d(t,"h",function(){return L}),n.d(t,"d",function(){return P}),n.d(t,"D",function(){return V}),n.d(t,"E",function(){return G}),n.d(t,"F",function(){return H}),n.d(t,"c",function(){return F}),n.d(t,"m",function(){return R}),n.d(t,"g",function(){return j}),n.d(t,"y",function(){return Z}),n.d(t,"r",function(){return z}),n.d(t,"G",function(){return B}),n.d(t,"C",function(){return Q}),n.d(t,"z",function(){return K}),n.d(t,"u",function(){return $})},2120:function(e,t,n){"use strict";n.d(t,"a",function(){return o}),n.d(t,"c",function(){return c}),n.d(t,"b",function(){return u});var r=n(0),a=n(133),i=n(983),o={width:1095,height:640};function c(e,t,n,i){if(e){var o=Object(a.e)();u(Object(r.__assign)({ItemId:Object(r.__assign)({mailboxInfo:o},e)},t),n,i||0)}}function u(e,t,n,r){Object(i.c)("calendar","compose",{event:e,composeEntrySource:t,shouldDuplicate:r},o)}},2147:function(e){e.exports={c:"Cda",e:"Dda",f:"Eda",d:"Fda",b:"Gda",g:"Hda",a:"Ida",j:"Jda",h:"Kda",i:"Lda"}},2148:function(e){e.exports={a:"Tda",b:"Uda"}},2150:function(e){e.exports={c:"vhb",f:"whb",e:"xhb",b:"yhb",g:"zhb",a:"Ahb",d:"Bhb"}},2347:function(e,t,n){"use strict";var r;function a(e){var t=e.getCalendarFolders;return r=t,e}function i(){var e=r;return r=void 0,e}n.d(t,"b",function(){return a}),n.d(t,"a",function(){return i})},2352:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.action)("SHOW_QUICK_OPTIONS",function(){return{}})},2443:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(2561);function a(e){return Object(r.a)().meetingIdToNotesViewStateMap.get(e.Id)}},2480:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var r=n(0),a=n(983),i=n(2120);function o(e,t,n,o){var c="read/"+encodeURIComponent(e);Object(a.c)("calendar",c,Object(r.__assign)(Object(r.__assign)({},n),{entrySource:t}),i.a,!1,t)}},2495:function(e,t,n){"use strict";var r,a=n(4),i=Object(a.createStore)("cacheLoaderStore",{loadedCalendarAccounts:[]});!function(e){e[e.Outlook=0]="Outlook",e[e.OutlookGroup=1]="OutlookGroup"}(r||(r={}));var o=n(162),c=n(133);function u(e,t){switch(e){case r.Outlook:return(t||Object(c.e)().primarySmtpAddress)+e.toString();case r.OutlookGroup:return e.toString();default:return Object(o.a)(e)}}function d(e,t){var n=u(e,t);return i().loadedCalendarAccounts.some(function(e){return e===n})}var s=Object(a.action)("addToLoadedCalendarAccounts",function(e){return{calendarAccountData:e}});Object(a.mutator)(s,function(e){i().loadedCalendarAccounts.push(e.calendarAccountData)});var l=n(1764),f=n(0),b=n(63),p=n(1538),m=Object(a.action)("calendarCacheInitializedForAccount",function(e,t){return{calendarEndpointType:e,userId:t}}),g=n(2859),I={};function O(e,t){if(d(e,t))return Promise.resolve();var n=u(e,t),a=I[n];if(a)return a.requestPromise;var i=function(e,t){return Object(f.__awaiter)(this,void 0,void 0,function(){var n;return Object(f.__generator)(this,function(a){switch(a.label){case 0:switch(e){case r.Outlook:return[3,1];case r.OutlookGroup:return[3,5]}return[3,7];case 1:return a.trys.push([1,3,,4]),t=t||Object(c.e)().primarySmtpAddress,[4,Object(p.f)(t)];case 2:return a.sent(),[3,4];case 3:return n=a.sent(),b.d.error("initializeCalendarsCacheForAccount: failed to initialize calendar cache: "+n),[3,4];case 4:return[3,8];case 5:return[4,Object(g.b)()];case 6:return a.sent(),[3,8];case 7:Object(o.a)(e),a.label=8;case 8:return[2]}})})}(e,t);return I[n]={requestPromise:i},i.then(function(){s(n),m(e,t)})}Object(a.orchestrator)(l.d,function(e){O(r.Outlook,e.accountSmtpAddress)});var j=n(167);function v(){return Object(f.__awaiter)(this,void 0,void 0,function(){var e,t,n,a;return Object(f.__generator)(this,function(i){switch(i.label){case 0:return e=O(r.Outlook),t=Object(j.f)().map(function(e){return O(r.Outlook,e.primarySmtpAddress)}),n=O(r.OutlookGroup),a=Object(f.__spread)([e],t,[n]),[4,Promise.all(a)];case 1:return i.sent(),[2]}})})}n.d(t,"e",function(){return d}),n.d(t,"d",function(){return O}),n.d(t,"a",function(){return r}),n.d(t,"b",function(){return m}),n.d(t,"c",function(){return v})},2508:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.action)("onNotifyOrganizerToggled",function(e,t){return{id:e,sendResponse:t}})},2509:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(4),a=Object(r.action)("forwardEvent",function(e,t,n,r,a){return{calendarEventId:e,notes:t,eventScope:r,actionSource:n,forwardees:a}})},2560:function(e,t,n){"use strict";var r=n(2561),a=n(70);t.a=Object(a.action)("closeNotesEditor")(function(e){Object(r.a)().meetingIdToNotesViewStateMap.delete(e.Id)})},2561:function(e,t,n){"use strict";var r=n(20),a=n(4),i=Object(a.createStore)("calendarNotesEditorStore",{meetingIdToNotesViewStateMap:new r.ObservableMap});t.a=i},258:function(e,t,n){"use strict";n.d(t,"g",function(){return o}),n.d(t,"f",function(){return c}),n.d(t,"k",function(){return u}),n.d(t,"c",function(){return d}),n.d(t,"d",function(){return s}),n.d(t,"n",function(){return l}),n.d(t,"l",function(){return f}),n.d(t,"m",function(){return b}),n.d(t,"a",function(){return p}),n.d(t,"h",function(){return m}),n.d(t,"b",function(){return g}),n.d(t,"e",function(){return I}),n.d(t,"j",function(){return O}),n.d(t,"i",function(){return j}),n.d(t,"o",function(){return v});var r=n(137),a=n(43),i=n(7);function o(e,t){return void 0===t&&(t=Object(i.Nb)()),d(Object(i.Yb)(t,e),r.a.DaysInOneWeek)}function c(e,t){var n=u(e,t),r=Object(i.B)(e),a=Object(i.e)(Object(i.C)(r,t),1);return d(n,Math.abs(Object(i.s)(n,a)-1))}function u(e,t){var n=Object(i.Xb)(e);return Object(i.Yb)(n,t)}function d(e,t){return{start:e,end:Object(i.e)(e,t-1)}}function s(e,t,n,r,c){switch(void 0===c&&(c=1),e){case a.a.Day:return d(Object(i.Ub)(t),c);case a.a.Month:var u=Object(i.Xb)(t),s=Object(i.B)(t);return d(u,Math.abs(Object(i.s)(u,s)-1));case a.a.Week:return o(n,t);case a.a.WorkWeek:return function(e,t,n){void 0===n&&(n=Object(i.Nb)());for(var r,a,c=o(e,n),u=0;u<=O(c);u++){var d=Object(i.e)(c.start,u);if(!r&&t.includes(Object(i.mb)(d))&&(r=d),d=Object(i.e)(c.end,-u),!a&&t.includes(Object(i.mb)(d))&&(a=d),r&&a)break}return{start:r,end:a}}(n,r,t)}}function l(e,t){var n=c(e,t);return Object(i.t)(n.end,n.start,t)}function f(e,t){var n;return d(n=t==a.a.WorkWeek?Object(i.k)(e.start,1):Object(i.e)(e.end,1),t==a.a.Month?Object(i.nb)(n):Object(i.s)(e.end,e.start)+1)}function b(e,t){var n,r;if(t==a.a.WorkWeek)n=Object(i.k)(e.start,-1),r=Object(i.k)(e.end,-1);else{r=Object(i.e)(e.start,-1);var o=t==a.a.Month?-Object(i.nb)(r):Object(i.s)(e.start,e.end)-1;n=Object(i.e)(e.start,o)}return{start:n,end:r}}function p(e,t){return e&&t&&0==Object(i.p)(e.start,t.start)&&0==Object(i.p)(e.end,t.end)}function m(e,t,n){if(!e||!t)throw new Error("Date ranges cannot be null in call to areDateRangesOverlapping");return n?Object(i.p)(e.start,t.start)<=0?Object(i.p)(e.end,t.start)>=0?0:1:Object(i.p)(t.end,e.start)>=0?0:-1:Object(i.p)(e.start,t.start)<0?Object(i.p)(e.end,t.start)>0?0:1:Object(i.p)(t.end,e.start)>0?0:-1}function g(e,t,n){return!(!e||!t)&&(n?Object(i.p)(e.start,t.start)<=0&&Object(i.p)(e.end,t.end)>=0:Object(i.p)(e.start,t.start)<0&&Object(i.p)(e.end,t.end)>0)}function I(e,t){return e&&t?{start:Object(i.p)(e.start,t.start)<0?e.start:t.start,end:Object(i.p)(e.end,t.end)>0?e.end:t.end}:null}function O(e){return Object(i.s)(e.end,e.start)}function j(e){return Math.floor(Object(i.v)(e.end,e.start)/24)+(Object(i.v)(e.end,e.start)%24>0?1:0)}function v(e,t){return Object(i.s)(e.start,t)<=0&&Object(i.s)(e.end,t)>=0}},260:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(7),a=n(156);function i(e,t,n){if(e&&t&&n){var i=Object(r.x)(t,e),o=Object(a.a)(e.tz,n,e);return{start:o,end:Object(r.Ob)(t.tz,Object(r.h)(o,i))}}return null}},261:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(204);function a(e,t,n){return e&&t&&n?Object(r.a)(e,t.tz,n,t):null}},262:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(204);function a(e,t,n){return e&&t&&n?Object(r.a)(e,t.tz,t,n):null}},263:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(7),a=n(156);function i(e,t,n,i){if(e&&t&&n){var o=Object(a.a)(e.tz,e,n),c=t;if(!Object(r.Eb)(o,t)||i){var u=Object(r.x)(t,e);c=Object(r.Ob)(t.tz,Object(r.h)(o,u))}return{start:o,end:c}}return null}},264:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(258),a=n(7);function i(e,t){return e&&null!=t?Object(r.c)(Object(a.Ub)(e),t+1):null}},2687:function(e,t,n){"use strict";n.d(t,"d",function(){return u}),n.d(t,"b",function(){return d}),n.d(t,"a",function(){return s}),n.d(t,"f",function(){return l}),n.d(t,"e",function(){return f}),n.d(t,"c",function(){return b}),n.d(t,"j",function(){return p}),n.d(t,"g",function(){return m}),n.d(t,"i",function(){return g}),n.d(t,"h",function(){return I});var r=n(4055),a=n(3413),i=n(50),o=n(4),c=n(5066),u=Object(o.action)("openTimePanelInternal",function(e){return{source:e}}),d=Object(o.action)("initializeTelemetryData"),s=Object(o.action)("clearTelemetryData"),l=Object(o.action)("timePanelOpened",function(){return Object(i.b)({name:"timePanelActionOpen",options:c.b,customData:Object(c.a)({source_1:Object(a.b)()})})}),f=Object(o.action)("timePanelClosed",function(){var e=Object(r.b)(),t=Object(r.a)(e);return Object(i.b)({name:"timePanelActionClose",options:c.b,customData:Object(c.a)({sessionDuration:e,sessionDurationBucketLowerBoundMinutes_1:t.lowerBoundMinutes,sessionDurationBucketUpperBoundMinutes_2:t.upperBoundMinutes})})}),b=Object(o.action)("openDeeplink",function(e){return Object(i.b)({name:"timePanelActionDeeplink",options:c.b,customData:Object(c.a)({target_1:e})})}),p=Object(o.action)("updateSelectedCalendarEvent",function(e){return{selectedCalendarEventId:e}}),m=Object(o.action)("pushNewView",function(e){return{newView:e}}),g=Object(o.action)("updateCurrentView",function(e){return{updatedView:e}}),I=Object(o.action)("resetPanelViewOpenTimeStamp")},2833:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(41),a=n(7);function i(e){var t=Object(a.Nb)();if(Object(a.Gb)(t,e))return Object(a.f)(Object(a.Vb)(t),1);var n=Object(r.a)().UserOptions.WorkingHours;return Object(a.h)(Object(a.Ub)(e),n.WorkHoursStartTimeInMinutes)}},2859:function(e,t,n){"use strict";var r=n(0),a=n(70),i=n(2872),o=n(5),c=n(1517),u=n.n(c),d=n(1518),s=n.n(d),l=n(193),f="Groups",b=n(133),p=n(346);function m(){return Object(r.__awaiter)(this,void 0,void 0,function(){var e,t;return Object(r.__generator)(this,function(n){switch(n.label){case 0:return 4,(e=[]).push({FilterType:1,SortType:4,SortDirection:"Descending"}),e.push({FilterType:2,SortType:4,SortDirection:"Descending"}),(t=Object(l.getJsonRequestHeader)()).RequestServerVersion="V2018_01_08",[4,u()({Header:t,Body:s()({RequestedGroupsSets:e})})];case 1:return[2,n.sent()]}})})}var g=Object(a.action)("getGroupCalendarsService")(function(){return Object(r.__awaiter)(this,void 0,void 0,function(){var e;return Object(r.__generator)(this,function(t){switch(t.label){case 0:return[4,m()];case 1:return null!=(e=t.sent())&&e.Body.GroupsSets&&e.Body.GroupsSets.length>0?[2,I(e.Body.GroupsSets)]:[2,null]}})})});function I(e){var t=[],n=[];if(e.forEach(function(e){e.Groups.forEach(function(e){var r=e.SmtpAddress.toLowerCase(),a={type:b.a.GroupMailbox,deprecatedMailboxId:r,primarySmtpAddress:r,routingKey:Object(b.c)()+r,returnModernConversationItems:!1,requestOptions:null},i={__type:p.a,CalendarColor:-1,CalendarName:e.DisplayName,OwnerEmailAddress:r,OwnerName:e.DisplayName,IsGroupMailboxCalendar:!0,IsGeneralScheduleCalendar:!0,ItemId:{Id:r},ParentGroupId:f},o={DistinguishedFolderId:r,DisplayName:e.DisplayName};t.push({entry:i,folder:o,mailboxInfo:a});var c={id:{id:r,mailboxInfo:a},calculatedFolderId:r,displayName:e.DisplayName,colorScheme:null};n.push(c)})}),n.length>0){var r=Object(b.e)(),a={type:b.a.GroupMailbox,deprecatedMailboxId:r.deprecatedMailboxId,primarySmtpAddress:r.primarySmtpAddress,routingKey:Object(b.b)(),returnModernConversationItems:!1,requestOptions:null},c={id:{id:f,mailboxInfo:a},GroupId:f,ItemId:{Id:f},GroupName:Object(o.a)(i.a),GroupType:3};return{groupCalendars:t,calendarGroup:c,calendars:n}}return null}var O=n(212),j=Object(a.action)("getGroupCalendars")(function(){return Object(r.__awaiter)(this,void 0,void 0,function(){var e;return Object(r.__generator)(this,function(t){switch(t.label){case 0:return[4,g()];case 1:return null!=(e=t.sent())&&null!=e.groupCalendars?(e.groupCalendars.forEach(function(e){Object(O.b)(e.entry,e.folder,e.mailboxInfo)}),Object(O.a)(e.calendarGroup),[2,{group:e.calendarGroup,calendars:e.calendars}]):[2,null]}})})}),v=n(67),h=n(153),C=n(41),A=Object(a.action)("initializeGroupCalendars")(function(e){return Object(r.__awaiter)(this,void 0,void 0,function(){var t,n,a,i,o,c;return Object(r.__generator)(this,function(r){switch(r.label){case 0:t=new h.a("initializeGroupCalendars"),n=Object(C.a)().GroupsEnabled,a=Object(v.f)("cal-groupsCalendar"),i=!Object(O.s)().some(function(e){return e.GroupId===f}),o=n&&a&&(e||i),t.addCustomData({issueServiceCall:o,GroupsEnabled:n,featureEnabled:a,refresh:e,initialLoad:i}),r.label=1;case 1:return r.trys.push([1,4,,5]),o?[4,j()]:[3,3];case 2:r.sent(),r.label=3;case 3:return t.end(),[3,5];case 4:throw c=r.sent(),t.endWithError("ServerError",Error(c)),c;case 5:return[2]}})})}),w=n(4),x=n(63),D=n(359),S=null;Object(w.orchestrator)(O.A,function(e){var t=e.payload,n=t.id,r=t.EventType,a=t.Group.SmtpAddress;x.d.info(n+": "+r+", "+a),S||(S=Object(D.a)(A.bind(null,!0),2e3)),S()}),n.d(t,"b",function(){return A}),n.d(t,"a",function(){return f})},2872:function(e){e.exports={a:"yda"}},319:function(e,t,n){"use strict";var r=n(137);function a(e){for(var t=[],n=0;n<r.a.DaysInOneWeek;n++)e&1<<n&&t.push(n);return t}n(264),n(261),n(262),n(260),n(263);var i=n(258),o=n(7);function c(e,t,n){return Object(o.Kb)(e,t,n)}function u(e,t){return function(e){var t=e%r.a.SecondsInOneMinute;return e-t+r.a.SecondsInOneMinute}(Object(o.y)(e,t))}var d=15*r.a.SecondsInOneMinute;function s(e,t){return u(e,t)<=d}n.d(t,"h",function(){return i.g}),n.d(t,"g",function(){return i.f}),n.d(t,"m",function(){return i.k}),n.d(t,"d",function(){return i.c}),n.d(t,"e",function(){return i.d}),n.d(t,"q",function(){return i.n}),n.d(t,"n",function(){return i.l}),n.d(t,"o",function(){return i.m}),n.d(t,"b",function(){return i.a}),n.d(t,"j",function(){return i.h}),n.d(t,"c",function(){return i.b}),n.d(t,"f",function(){return i.e}),n.d(t,"l",function(){return i.j}),n.d(t,"k",function(){return i.i}),n.d(t,"r",function(){return i.o}),n.d(t,"s",function(){return c}),n.d(t,"t",function(){return s}),n.d(t,"p",function(){return u}),n.d(t,"i",function(){return a}),n.d(t,"a",function(){return r.a})},329:function(e,t,n){"use strict";function r(e,t){for(var n=0,r=e.length;n<r;n++){var a=e[n];if(t(a))return{item:a,index:n}}return null}n.d(t,"a",function(){return r})},3413:function(e,t,n){"use strict";n.d(t,"c",function(){return a}),n.d(t,"b",function(){return i}),n.d(t,"a",function(){return o});var r=n(4054);function a(){return Object(r.a)().isPanelOpen}function i(){return Object(r.a)().source}function o(){return Object(r.a)().selectedCalendarItemId}},346:function(e,t,n){"use strict";var r="LinkedCalendarEntry:#Exchange";function a(e){return e.__type==r}function i(e){return e.CanViewPrivateItems}n.d(t,"c",function(){return a}),n.d(t,"a",function(){return r}),n.d(t,"b",function(){return i})},3482:function(e,t,n){"use strict";var r=n(22),a=n(4174),i=n(1),o=Object(r.a)(function(e){var t=e.children,n=e.dropViewState,r=e.dropHintView,o=e.dragItemType,u=!e.hideDropHintCondition&&function(e,t){return c(Object(a.a)(),e)||c(t.draggableItemType,e)}(o,n);return i.createElement(i.Fragment,null,u&&r,!u&&t)});function c(e,t){return e===t}var u=n(5633),d=n(297),s=Object(r.a)(function(e){var t=e.dropHintLabel,n=e.dropHintIconBaseClass,r=e.dropHintIconActiveClass,a=e.dropViewState,o=e.customDropHintAreaContent,c=a.isDragOver;return i.createElement("div",{className:u.dropHintArea},i.createElement("span",{className:d(u.dropHintAreaInner,c&&u.isActive)},o,i.createElement("span",{className:d(u.dropHintIcon,c?r:n)}),i.createElement("span",{className:u.dropHintLabel},t)))}),l=n(0),f=n(5635),b=n(297),p=Object(r.a)(function(e){var t=e.referenceElementId,n=e.beakAdjustmentX,r=Object(l.__rest)(e,["referenceElementId","beakAdjustmentX"]),a=r.dropViewState.isDragOver,o=void 0;if(t){var c=document.getElementById(t);if(c)o={left:c.offsetLeft+c.offsetWidth/2+n+"px"}}return i.createElement(s,Object(l.__assign)({},r,{customDropHintAreaContent:o&&i.createElement("div",{className:b(f.dropHintBeak,a&&f.isActive),style:o})}))});n.d(t,"a",function(){return o}),n.d(t,"b",function(){return p})},4054:function(e,t,n){"use strict";var r=n(4),a=Object(r.createStore)("timePanelStore",{sessionId:"",panelOpenTimestamp:null,panelViewOpenTimestamp:null,source:null,isPanelOpen:!1,selectedCalendarItemId:null});t.a=a},4055:function(e,t,n){"use strict";n.d(t,"c",function(){return o}),n.d(t,"b",function(){return c}),n.d(t,"d",function(){return u}),n.d(t,"a",function(){return d});var r=n(4054),a=n(7),i=n(319);function o(){return Object(r.a)().sessionId}function c(){var e=Object(r.a)().panelOpenTimestamp;return e?Object(a.w)(Object(a.Nb)(),e):null}function u(){var e=Object(r.a)().panelViewOpenTimestamp;return e?Object(a.w)(Object(a.Nb)(),e):null}function d(e){return e<=i.a.MillisecondsIn1Min?{lowerBoundMinutes:0,upperBoundMinutes:1}:e<=5*i.a.MillisecondsIn1Min?{lowerBoundMinutes:1,upperBoundMinutes:5}:e<=30*i.a.MillisecondsIn1Min?{lowerBoundMinutes:5,upperBoundMinutes:30}:e<=i.a.MillisecondsIn1Hour?{lowerBoundMinutes:30,upperBoundMinutes:60}:e<=2*i.a.MillisecondsIn1Hour?{lowerBoundMinutes:60,upperBoundMinutes:120}:e<=4*i.a.MillisecondsIn1Hour?{lowerBoundMinutes:120,upperBoundMinutes:240}:e<=i.a.MillisecondsInOneDay?{lowerBoundMinutes:240,upperBoundMinutes:1440}:{lowerBoundMinutes:1440,upperBoundMinutes:null}}},4174:function(e,t,n){"use strict";var r=n(4),a=Object(r.createStore)("moduleDndStore",{draggedItemType:null}),i=Object(r.action)("OWA_MODULE_SET_DRAGGED_ITEM_TYPE",function(e){return{typeOfItemDragged:e}});Object(r.mutator)(i,function(e){a().draggedItemType=e.typeOfItemDragged});function o(){return a().draggedItemType}n.d(t,"b",function(){return i}),n.d(t,"a",function(){return o})},4646:function(e,t,n){"use strict";function r(){window.O365Shell.FlexPane.OpenFlexPaneForProvider("OwaTimePanel")}n.d(t,"a",function(){return r})},4920:function(e,t,n){"use strict";var r=n(4),a=Object(r.action)("UPDATE_SELECTED_TIME_PANEL_CALENDARIDS",function(e,t){return{calendarIds:e,primarySmtpAddress:t}}),i=Object(r.action)("ON_SELECTED_TIME_PANEL_CALENDARIDS_UPDATED",function(e,t){return{calendarIds:e,primarySmtpAddress:t}}),o=n(0),c=n(20),u=Object(r.createStore)("timePanelSelectedCalendarIdsStore",{calendarIdsMap:new c.ObservableMap});function d(){var e,t,n=u().calendarIdsMap,r=0;try{for(var a=Object(o.__values)(n.values()),i=a.next();!i.done;i=a.next()){var c=i.value;c&&(r+=c.length)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=a.return)&&t.call(a)}finally{if(e)throw e.error}}return r>0}var s=n(1468),l=(Object(r.orchestrator)(s.f,function(e){var t=e.calendarIds,n=e.primarySmtpAddress;d()||i(t,n)}),n(1116)),f=n(1573),b=n(1002),p=n(63),m=Object(l.b)({maximumAttempts:3,timeBetweenRetryInMS:Object(l.a)(1e3)}),g=null,I=(Object(r.orchestrator)(a,function(e){return Object(o.__awaiter)(void 0,void 0,void 0,function(){var t,n,r,a;return Object(o.__generator)(this,function(o){switch(o.label){case 0:t=e.calendarIds,n=e.primarySmtpAddress,r=Object(b.b)(t),o.label=1;case 1:return o.trys.push([1,3,,4]),g&&g.cancel(),[4,(g=m(function(){return Object(f.e)(r,n)})).retriableFunc()];case 2:return o.sent(),i(r,n),[3,4];case 3:return a=o.sent(),p.d.warn("updateSelectedCalendarIdsOrchestrator: updateTimePanelCalendarIdsService with retry failed: "+a),[3,4];case 4:return g=null,[2]}})})}),Object(r.action)("UPDATE_SELECTED_TIME_PANEL_CALENDARIDS_IN_STORE",function(e,t){return{calendarIds:e,primarySmtpAddress:t}}));Object(r.orchestrator)(f.g,function(e){var t=e.settings,n=e.accountSmtpAddress;t.timePanelCalendarIds&&t.timePanelCalendarIds.length>0&&(I(t.timePanelCalendarIds,n),i(t.timePanelCalendarIds,n))}),Object(r.mutator)(I,function(e){var t=e.calendarIds,n=e.primarySmtpAddress;u().calendarIdsMap.set(n,Object(b.b)(t))});function O(){return Object(b.d)(d()?Object(b.c)(u().calendarIdsMap):Object(s.b)())}n.d(t,"b",function(){return i}),n.d(t,"a",function(){return O})},5066:function(e,t,n){"use strict";n.d(t,"b",function(){return o}),n.d(t,"a",function(){return c});var r=n(0),a=n(4055),i=n(153),o={isCore:!0,tenantTokens:Object(i.e)()};function c(e){return Object(r.__assign)(Object(r.__assign)({},e),{sessionId:Object(a.c)()})}},5246:function(e,t,n){"use strict";var r=n(4),a=n(1742),i=Object(r.createStore)("timePanelDndStore",{isTimePanelDataInitialized:!1,timePanelDropViewState:Object(a.d)(),eventDropViewState:Object(a.d)(),taskDropViewState:Object(a.d)(),calendarTabDropViewState:Object(a.d)(),tasksTabDropViewState:Object(a.d)(),lastDragOverCalendarTab:null,lastDragOverTasksTab:null,upNextDropViewState:Object(a.d)(),lastDragOverUpNext:null,shouldShowHoverDayDrop:!1,dayViewDropTimeMinuteOffset:null}),o=n(50),c=n(153),u={isCore:!0,tenantTokens:Object(c.e)()};function d(e){return e}var s=Object(r.action)("initializeTimePanelData"),l=Object(r.action)("setLastEnterCalendarTab",function(e){return{lastTime:e}}),f=Object(r.action)("switchTabsOnHover",function(e,t){return Object(o.b)({name:"timePanelActionSwitchTabsOnHover",options:u,customData:d({previousView:e,nextView:t})},{nextView:t})}),b=Object(r.action)("setLastEnterTasksTab",function(e){return{lastTime:e}}),p=Object(r.action)("setShowDayDropHint",function(e){return{shouldShow:e}}),m=Object(r.action)("setDayViewDropTimeMinuteOffset",function(e){return{dayViewDropTimeMinuteOffset:e}}),g=Object(r.action)("setLastEnterUpNext",function(e){return{lastTime:e}}),I=Object(r.action)("resetCalendarUpNextState");Object(r.mutator)(s,function(){i().isTimePanelDataInitialized=!0}),Object(r.mutator)(l,function(e){i().lastDragOverCalendarTab=e.lastTime}),Object(r.mutator)(f,function(e){switch(e.nextView){case"Calendar":i().calendarTabDropViewState=Object(a.d)();break;case"Tasks":i().tasksTabDropViewState=Object(a.d)()}}),Object(r.mutator)(b,function(e){i().lastDragOverTasksTab=e.lastTime}),Object(r.mutator)(g,function(e){i().lastDragOverUpNext=e.lastTime}),Object(r.mutator)(I,function(){i().upNextDropViewState=Object(a.d)()}),Object(r.mutator)(p,function(e){i().shouldShowHoverDayDrop=e.shouldShow}),Object(r.mutator)(m,function(e){var t=e.dayViewDropTimeMinuteOffset;i().dayViewDropTimeMinuteOffset=t});var O=Object(r.action)("createEventFromMailItemDrop",function(e,t,n){return Object(o.b)({name:"timePanelActionCreateEventFromMailItemDrop",options:u,customData:d({dropTarget:t})},{dragData:e,dropTarget:t,preFillStartTime:n})}),j=Object(r.action)("createTaskFromMailItemDrop",function(e,t){return Object(o.b)({name:"timePanelActionCreateTaskFromMailItemDrop",options:u},{dragData:e,folderId:t})}),v=n(4174);function h(){return i().timePanelDropViewState}function C(){return i().eventDropViewState}function A(){return i().calendarTabDropViewState}function w(){return i().tasksTabDropViewState}function x(){return i().shouldShowHoverDayDrop}function D(){return h().draggableItemType===a.b.MailListRow}function S(){return i().upNextDropViewState}var y=n(22),E=n(2833),_=n(1),M=Object(y.a)(function(e){var t=e.dropViewState,n=e.dropTarget,r=e.classNames,i=e.selectedDate,o=e.generateStartTime,c=e.handleDrop,u=e.handleDragEnter,d=e.handleDragOver,s=e.handleDragLeave,l=e.children,f=_.useCallback(function(e){u&&u()},[u]),b=_.useCallback(function(e){d&&T(e)&&d()},[d]),p=_.useCallback(function(e,t,r,u){!function(e,t,n,r,i){switch(e.itemType){case a.b.MailListRow:var o=e;O(o,t,r?r(n):function(e){return e&&Object(E.a)(e)}(n)),i&&i()}}(e,n,i,o,c)},[n,i,o,c]);return _.createElement(a.c,{dropViewState:t,canDrop:T,onDragEnter:f,onDragOver:b,onDragLeave:s,onDrop:p,classNames:r,greedy:!0},l)});function T(e){return e.itemType===a.b.MailListRow}var N=n(0),k=n(5632),L=n(3482),P=n(5),V=n(7306),G=Object(y.a)(function(e){return _.createElement(L.b,Object(N.__assign)({dropHintLabel:Object(P.a)(k.a),dropHintIconBaseClass:V.eventDropHintIconBase,dropHintIconActiveClass:V.eventDropHintIconActive},e))}),H=n(7310),F=Object(y.a)(function(e){var t=e.selectedDate,n=h(),r=C();return _.createElement(L.a,{dragItemType:a.b.MailListRow,dropViewState:n,dropHintView:_.createElement(M,{classNames:H.timePanelAgendaDropHintView,dropViewState:r,dropTarget:"AgendaViewDropHint",selectedDate:t},_.createElement(G,{dropViewState:r}))})}),R=n(7),z=n(7312),W=n(297),Y=500,Z=Object(y.a)(function(e){var t=e.children,n=h();return _.createElement(L.a,{dragItemType:a.b.MailListRow,dropViewState:n,hideDropHintCondition:x(),dropHintView:_.createElement(B,Object(N.__assign)({},e))},_.createElement(U,Object(N.__assign)({},e),t))});function B(e){var t=e.selectedDate,n=e.containerClassName,r=C();return _.createElement(M,{dropViewState:r,dropTarget:"DayViewDropHint",selectedDate:t,classNames:W(n,z.timePanelDayDropHintView),handleDragEnter:Q,handleDragLeave:K,handleDrop:q},_.createElement(G,{dropViewState:r}))}function U(e){var t=e.selectedDate,n=e.containerClassName,r=e.children,a=C();return _.createElement(M,{dropViewState:a,dropTarget:"DayViewPreviewDropHint",selectedDate:t,generateStartTime:X,classNames:n,handleDragLeave:K,handleDrop:q},r)}var J=void 0;function Q(){x()||(J=window.setTimeout(function(){p(!0)},Y))}function K(){J&&window.clearTimeout(J),p(!1)}function q(){p(!1),m(null)}function X(e){return e&&Object(R.h)(e,i().dayViewDropTimeMinuteOffset)}var $=Object(y.a)(function(e){var t=e.containerClassName,n=Object(N.__rest)(e,["containerClassName"]),r=C();return _.createElement(M,{dropViewState:r,dropTarget:"TimePanelDropHint",classNames:t},_.createElement(G,Object(N.__assign)({dropViewState:r},n)))}),ee=n(7314),te=Object(y.a)(function(e){return _.createElement(L.b,Object(N.__assign)({dropHintLabel:Object(P.a)(k.b),dropHintIconBaseClass:ee.taskDropHintIconBase,dropHintIconActiveClass:ee.taskDropHintIconActive},e))}),ne=Object(y.a)(function(e){var t=e.dropViewState,n=e.classNames,r=e.children,i=e.canCreateTaskInFolder,o=e.folderId,c=_.useCallback(function(e){return function(e,t,n){var r=!n||t&&t(n);return e.itemType===a.b.MailListRow&&r||e.itemType===a.b.Todo}(e,i,o)},[i,o]),u=_.useCallback(function(e,t,n,r){!function(e,t,n,r,i){switch(e.itemType){case a.b.MailListRow:var o=e;j(o,i)}}(e,0,0,0,o)},[o]);return _.createElement(a.c,{dropViewState:t,canDrop:c,onDrop:u,classNames:n,greedy:!0},r)});var re=Object(y.a)(function(e){var t=e.containerClassName,n=Object(N.__rest)(e,["containerClassName"]),r=i().taskDropViewState;return _.createElement(ne,{dropViewState:r,classNames:t},_.createElement(te,Object(N.__assign)({dropViewState:r},n)))});function ae(e){return"time-panel-pivot-"+e}var ie=n(162),oe=n(67),ce=n(2080),ue=n(7318),de=Object(y.a)(function(e){var t=e.children;if(!Object(oe.f)("cal-time-panel-combinedDrop"))return _.createElement(_.Fragment,null,t);var n=Object(ce.b)(),r=null;switch(n){case"Calendar":r=_.createElement("div",{className:ue.dndContainer},_.createElement(re,{referenceElementId:ae("Tasks"),beakAdjustmentX:-12}),_.createElement($,{containerClassName:ue.primaryDropHintContainer}));break;case"Tasks":r=_.createElement("div",{className:ue.dndContainer},_.createElement($,{referenceElementId:ae("Calendar"),beakAdjustmentX:-12}),_.createElement(re,{containerClassName:ue.primaryDropHintContainer}));break;default:Object(ie.a)(n)}return _.createElement(L.a,{dragItemType:a.b.MailListRow,dropViewState:h(),dropHintView:r},t)}),se=n(4180);function le(e){var t=e.children,n=Object(N.__rest)(e,["children"]);return _.createElement(se.a,Object(N.__assign)({getTabId:ae},n),t)}function fe(e,t,n,r){}var be=n(7320),pe=Object(y.a)(function(e){var t=e.children;return _.createElement(a.c,{classNames:be.timePanelDropListener,dropViewState:h(),onDragEnter:me,onDrop:fe,canDrop:ge,greedy:!0},t)});function me(){i().isTimePanelDataInitialized||s()}function ge(e){return e.itemType===a.b.MailListRow||e.itemType===a.b.Todo}var Ie=n(1842),Oe=n(1322),je=n(7322),ve=n(297),he=1e3,Ce=Object(y.a)(function(e){var t,n=e.children,r=e.containerClassName,o=e.onLongHover,c=Object(oe.f)("cal-time-panel-dragEscalateMeeting")&&Object(Oe.a)()&&9!==Object(Ie.b)()&&i().upNextDropViewState&&(i().upNextDropViewState.draggableItemType===a.b.MailListRow||Object(v.a)()===a.b.MailListRow),u=_.useCallback(function(){!function(e){Object(R.p)(Object(R.g)(i().lastDragOverUpNext,he),Object(R.Nb)())<=0&&(I(),e())}(o)},[o]);return c?_.createElement(a.c,{dropViewState:S(),canDrop:Ae,onDragEnter:we,onDragOver:u,onDrop:fe,classNames:ve(r,ve(je.dropContainer,(t={},t[je.dropContainerActive]=S().isDragOver,t)))},n):_.createElement(_.Fragment,null,n)});function Ae(e){return e.itemType===a.b.MailListRow}function we(e){g(Object(R.Nb)())}var xe=n(7324),De=n(297),Se=500;function ye(){var e,t;return De(((e={})[xe.pivotItemDropContainer]=A().draggableItemType===a.b.MailListRow||Object(v.a)()===a.b.MailListRow||h().draggableItemType===a.b.MailListRow,e),((t={})[xe.pivotItemDropContainerActive]=A().isDragOver,t))}function Ee(){var e,t;return De(((e={})[xe.pivotItemDropContainer]=w().draggableItemType===a.b.MailListRow||Object(v.a)()===a.b.MailListRow||h().draggableItemType===a.b.MailListRow,e),((t={})[xe.pivotItemDropContainerActive]=w().isDragOver,t))}function _e(e,t){return _.createElement(a.c,{dropViewState:A(),onDrop:fe,onDragEnter:ke,onDragOver:Te},_.createElement("div",{className:ye()},t(e)))}function Me(e,t){return _.createElement(a.c,{dropViewState:w(),onDrop:fe,onDragEnter:Le,onDragOver:Ne},_.createElement("div",{className:Ee()},t(e)))}function Te(){Object(R.p)(Object(R.g)(i().lastDragOverCalendarTab,Se),Object(R.Nb)())<=0&&f(Object(ce.a)(),"Calendar")}function Ne(){Object(R.p)(Object(R.g)(i().lastDragOverTasksTab,Se),Object(R.Nb)())<=0&&f(Object(ce.a)(),"Tasks")}function ke(e){l(Object(R.Nb)())}function Le(e){b(Object(R.Nb)())}n.d(t,"l",function(){return s}),n.d(t,"o",function(){return m}),n.d(t,"p",function(){return f}),n.d(t,"g",function(){return O}),n.d(t,"h",function(){return j}),n.d(t,"i",function(){return D}),n.d(t,"a",function(){return F}),n.d(t,"b",function(){return Z}),n.d(t,"d",function(){return de}),n.d(t,"c",function(){return le}),n.d(t,"e",function(){return pe}),n.d(t,"f",function(){return Ce}),n.d(t,"j",function(){return ye}),n.d(t,"k",function(){return Ee}),n.d(t,"m",function(){return _e}),n.d(t,"n",function(){return Me})},5615:function(e,t,n){"use strict";var r=n(1322),a=n(3413),i=n(4),o=n(2687),c=n(4646),u=n(2080),d=n(1885);Object(i.orchestrator)(r.b,function(e){Object(r.a)()&&(Object(o.d)(e.source),Object(a.c)()||Object(c.a)())}),Object(i.orchestrator)(r.c,function(){"EventDetails"==Object(u.a)()&&Object(d.b)(Object(a.a)())})},5632:function(e){e.exports={b:"Xca",a:"Yca"}},5633:function(e,t,n){var r=n(5634),a=n(45);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)a.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},5634:function(e,t,n){(t=e.exports=n(44)(!1)).push([e.i,'.KEnWtoJmGSYBvw-qgEVfF .QjoPV2ilJoIa5f7uYBLDF{color:"[theme:neutralSecondary, default:#666666]"}html[dir] .KEnWtoJmGSYBvw-qgEVfF .QjoPV2ilJoIa5f7uYBLDF{background:"[theme:neutralLighterAlt, default:#f8f8f8]";border:1px dashed "[theme:neutralSecondary, default:#666666]"}.KEnWtoJmGSYBvw-qgEVfF .QjoPV2ilJoIa5f7uYBLDF._15sJj9boNHMEZtydNWUoaY{color:"[theme:themePrimary, default:#0078D4]"}html[dir] .KEnWtoJmGSYBvw-qgEVfF .QjoPV2ilJoIa5f7uYBLDF._15sJj9boNHMEZtydNWUoaY{background:"[theme:themeLighterAlt, default:#EFF6FC]";border:1px dashed "[theme:themePrimary, default:#0078D4]"}.KEnWtoJmGSYBvw-qgEVfF{-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto}.KEnWtoJmGSYBvw-qgEVfF,.KEnWtoJmGSYBvw-qgEVfF .QjoPV2ilJoIa5f7uYBLDF{display:-webkit-box;display:-ms-flexbox;display:flex;width:100%}.KEnWtoJmGSYBvw-qgEVfF .QjoPV2ilJoIa5f7uYBLDF{-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-sizing:border-box!important;box-sizing:border-box!important;position:relative}html[dir] .KEnWtoJmGSYBvw-qgEVfF .QjoPV2ilJoIa5f7uYBLDF{margin:8px;padding:20px 0;border-radius:2px}._101mP8iKOmq-AhtRbiSFVN{width:56px;height:56px}html[dir] ._101mP8iKOmq-AhtRbiSFVN{background-size:56px 56px}html[dir=ltr] ._101mP8iKOmq-AhtRbiSFVN{margin-right:24px}html[dir=rtl] ._101mP8iKOmq-AhtRbiSFVN{margin-left:24px}._2iOGpW5d409CQPY9PVn7lZ{font-size:14px;font-weight:400}',""]),t.locals={dropHintArea:"KEnWtoJmGSYBvw-qgEVfF",dropHintAreaInner:"QjoPV2ilJoIa5f7uYBLDF",isActive:"_15sJj9boNHMEZtydNWUoaY",dropHintIcon:"_101mP8iKOmq-AhtRbiSFVN",dropHintLabel:"_2iOGpW5d409CQPY9PVn7lZ"}},5635:function(e,t,n){var r=n(5636),a=n(45);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)a.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},5636:function(e,t,n){(t=e.exports=n(44)(!1)).push([e.i,'._3tj2Gc2V_eWAsCk-Z7SKAa{color:"[theme:neutralSecondary, default:#666666]"}html[dir] ._3tj2Gc2V_eWAsCk-Z7SKAa{background:"[theme:neutralLighterAlt, default:#f8f8f8]";border:1px dashed "[theme:neutralSecondary, default:#666666]"}._3tj2Gc2V_eWAsCk-Z7SKAa._357swfxgU2khDO-sF_Vpp9{color:"[theme:themePrimary, default:#0078D4]"}html[dir] ._3tj2Gc2V_eWAsCk-Z7SKAa._357swfxgU2khDO-sF_Vpp9{background:"[theme:themeLighterAlt, default:#EFF6FC]";border:1px dashed "[theme:themePrimary, default:#0078D4]"}html[dir=ltr] ._3tj2Gc2V_eWAsCk-Z7SKAa,html[dir=ltr] ._3tj2Gc2V_eWAsCk-Z7SKAa._357swfxgU2khDO-sF_Vpp9{border-width:1px 0 0 1px}html[dir=rtl] ._3tj2Gc2V_eWAsCk-Z7SKAa,html[dir=rtl] ._3tj2Gc2V_eWAsCk-Z7SKAa._357swfxgU2khDO-sF_Vpp9{border-width:1px 1px 0 0}._3tj2Gc2V_eWAsCk-Z7SKAa{height:16px;width:16px;content:"";position:absolute;top:-10.31371px;bottom:0}html[dir=ltr] ._3tj2Gc2V_eWAsCk-Z7SKAa{left:0;right:0;-webkit-transform:rotate(45deg);transform:rotate(45deg)}html[dir=rtl] ._3tj2Gc2V_eWAsCk-Z7SKAa{right:0;left:0;-webkit-transform:rotate(-45deg);transform:rotate(-45deg)}',""]),t.locals={dropHintBeak:"_3tj2Gc2V_eWAsCk-Z7SKAa",isActive:"_357swfxgU2khDO-sF_Vpp9"}},7306:function(e,t,n){var r=n(7307),a=n(45);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)a.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},7307:function(e,t,n){t=e.exports=n(44)(!1);var r=n(1564),a=r(n(7308)),i=r(n(7309));t.push([e.i,"html[dir] ._2Heq0sd5Q1vAbeKuw3JicS{background-image:url("+a+")}html[dir] .ep_o6WBdh8VXKCxMr7kEA{background-image:url("+i+")}",""]),t.locals={eventDropHintIconBase:"_2Heq0sd5Q1vAbeKuw3JicS",eventDropHintIconActive:"ep_o6WBdh8VXKCxMr7kEA"}},7308:function(e,t,n){e.exports=n.p+"../resources/images/calendar_drophint_bw-7efdf58ab7a6e8f994fb1da22e39230a.svg"},7309:function(e,t,n){e.exports=n.p+"../resources/images/calendar_drophint-c6713d8aa8f43d63794032c36016b87c.svg"},7310:function(e,t,n){var r=n(7311),a=n(45);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)a.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},7311:function(e,t,n){(t=e.exports=n(44)(!1)).push([e.i,"._3sQO2MydkxZVx2F5c_qMoM{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-flex:1;-ms-flex:1 0 auto;flex:1 0 auto;min-height:0}",""]),t.locals={timePanelAgendaDropHintView:"_3sQO2MydkxZVx2F5c_qMoM"}},7312:function(e,t,n){var r=n(7313),a=n(45);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)a.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},7313:function(e,t,n){(t=e.exports=n(44)(!1)).push([e.i,"._1eqgkOzdM0qs6MkswK8Sa5{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto;min-height:0;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-sizing:border-box;box-sizing:border-box}html[dir] ._1eqgkOzdM0qs6MkswK8Sa5{padding-bottom:4px}",""]),t.locals={timePanelDayDropHintView:"_1eqgkOzdM0qs6MkswK8Sa5"}},7314:function(e,t,n){var r=n(7315),a=n(45);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)a.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},7315:function(e,t,n){t=e.exports=n(44)(!1);var r=n(1564),a=r(n(7316)),i=r(n(7317));t.push([e.i,"html[dir] ._2gsKbAIxm1lntylxeBaNDa{background-image:url("+a+")}html[dir] ._32FOba1naf3ty8c2HnVqnR{background-image:url("+i+")}",""]),t.locals={taskDropHintIconBase:"_2gsKbAIxm1lntylxeBaNDa",taskDropHintIconActive:"_32FOba1naf3ty8c2HnVqnR"}},7316:function(e,t){e.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iNDUiIGhlaWdodD0iNDYiIHZpZXdCb3g9IjAgMCA0NSA0NiI+CiAgICA8ZGVmcz4KICAgICAgICA8cGF0aCBpZD0iYSIgZD0iTTAgMGgzOC4xNDl2MzguMTQ5SDB6Ii8+CiAgICA8L2RlZnM+CiAgICA8ZyBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwYXRoIGQ9Ik0tNi01aDU2djU2SC02eiIvPgogICAgICAgIDxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDQuNTIgNi4yMykiPgogICAgICAgICAgICA8bWFzayBpZD0iYiIgZmlsbD0iI2ZmZiI+CiAgICAgICAgICAgICAgICA8dXNlIHhsaW5rOmhyZWY9IiNhIi8+CiAgICAgICAgICAgIDwvbWFzaz4KICAgICAgICA8L2c+CiAgICAgICAgPGcgZmlsbD0iI0U1RTVFNSI+CiAgICAgICAgICAgIDxnIHRyYW5zZm9ybT0icm90YXRlKC0xMSAyMDYuNjg1IDE3LjUwNykiPgogICAgICAgICAgICAgICAgPHJlY3Qgd2lkdGg9IjEuNTkiIGhlaWdodD0iNi4wNCIgeD0iMi4yMjUiIHJ4PSIuNzk1IiBzdHlsZT0ibWl4LWJsZW5kLW1vZGU6bXVsdGlwbHkiLz4KICAgICAgICAgICAgICAgIDxwYXRoIGQ9Ik02LjA0IDMuMDJhLjc5NS43OTUgMCAwIDEtLjc5NS43OTVILjc5NWEuNzk1Ljc5NSAwIDAgMSAwLTEuNTloNC40NWMuNDQgMCAuNzk1LjM1Ni43OTUuNzk1eiIgc3R5bGU9Im1peC1ibGVuZC1tb2RlOm11bHRpcGx5Ii8+CiAgICAgICAgICAgIDwvZz4KICAgICAgICAgICAgPGcgdHJhbnNmb3JtPSJyb3RhdGUoLTExIDIxNy4yNjUgLTE2OC41NzIpIj4KICAgICAgICAgICAgICAgIDxyZWN0IHdpZHRoPSIxLjU5IiBoZWlnaHQ9IjYuMDQiIHg9IjIuMjI1IiByeD0iLjc5NSIgc3R5bGU9Im1peC1ibGVuZC1tb2RlOm11bHRpcGx5Ii8+CiAgICAgICAgICAgICAgICA8cGF0aCBkPSJNNi4wNCAzLjAyYS43OTUuNzk1IDAgMCAxLS43OTUuNzk1SC43OTVhLjc5NS43OTUgMCAwIDEgMC0xLjU5aDQuNDVjLjQ0IDAgLjc5NS4zNTYuNzk1Ljc5NXoiIHN0eWxlPSJtaXgtYmxlbmQtbW9kZTptdWx0aXBseSIvPgogICAgICAgICAgICA8L2c+CiAgICAgICAgICAgIDxnIHRyYW5zZm9ybT0icm90YXRlKC0xMSAzMy45MjQgLTE5Ni43MDcpIj4KICAgICAgICAgICAgICAgIDxyZWN0IHdpZHRoPSIxLjU5IiBoZWlnaHQ9IjYuMDQiIHg9IjIuMjI1IiByeD0iLjc5NSIgc3R5bGU9Im1peC1ibGVuZC1tb2RlOm11bHRpcGx5Ii8+CiAgICAgICAgICAgICAgICA8cGF0aCBkPSJNNi4wNCAzLjAyYS43OTUuNzk1IDAgMCAxLS43OTUuNzk1SC43OTVhLjc5NS43OTUgMCAwIDEgMC0xLjU5aDQuNDVjLjQ0IDAgLjc5NS4zNTYuNzk1Ljc5NXoiIHN0eWxlPSJtaXgtYmxlbmQtbW9kZTptdWx0aXBseSIvPgogICAgICAgICAgICA8L2c+CiAgICAgICAgICAgIDxnIHRyYW5zZm9ybT0icm90YXRlKDc0IDQuNjUyIDUuNCkiPgogICAgICAgICAgICAgICAgPHJlY3Qgd2lkdGg9IjEuNTkiIGhlaWdodD0iOS41OTIiIHg9IjQuMTMzIiByeD0iLjc5NSIgc3R5bGU9Im1peC1ibGVuZC1tb2RlOm11bHRpcGx5Ii8+CiAgICAgICAgICAgICAgICA8cGF0aCBkPSJNOS43MjQgNC43OTZhLjc5NS43OTUgMCAwIDEtLjc5NS43OTVILjkyNmEuNzk1Ljc5NSAwIDAgMSAwLTEuNTlIOC45M2MuNDM5IDAgLjc5NS4zNTYuNzk1Ljc5NXoiIHN0eWxlPSJtaXgtYmxlbmQtbW9kZTptdWx0aXBseSIvPgogICAgICAgICAgICA8L2c+CiAgICAgICAgICAgIDxwYXRoIGQ9Ik0xMS4yNDggMjkuMTE2TDMxLjA3NCA5LjI4OWw3LjI4MyA3LjI4NC0xOS44MjYgMTkuODI2eiIgc3R5bGU9Im1peC1ibGVuZC1tb2RlOm11bHRpcGx5Ii8+CiAgICAgICAgICAgIDxwYXRoIGQ9Ik01LjE3OCAyMy4wNDZsNy4yODMtNy4yODMgMTMuMzUzIDEzLjM1My03LjI4MyA3LjI4M3oiIHN0eWxlPSJtaXgtYmxlbmQtbW9kZTptdWx0aXBseSIvPgogICAgICAgIDwvZz4KICAgIDwvZz4KPC9zdmc+Cg=="},7317:function(e,t){e.exports="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iNDUiIGhlaWdodD0iNDYiIHZpZXdCb3g9IjAgMCA0NSA0NiI+CiAgICA8ZGVmcz4KICAgICAgICA8cGF0aCBpZD0iYSIgZD0iTTAgMGgzOC4xNDl2MzguMTQ5SDB6Ii8+CiAgICA8L2RlZnM+CiAgICA8ZyBmaWxsPSJub25lIiBmaWxsLXJ1bGU9ImV2ZW5vZGQiPgogICAgICAgIDxwYXRoIGQ9Ik0tNi01aDU2djU2SC02eiIvPgogICAgICAgIDxnIHRyYW5zZm9ybT0idHJhbnNsYXRlKDQuNTIgNi4yMykiPgogICAgICAgICAgICA8bWFzayBpZD0iYiIgZmlsbD0iI2ZmZiI+CiAgICAgICAgICAgICAgICA8dXNlIHhsaW5rOmhyZWY9IiNhIi8+CiAgICAgICAgICAgIDwvbWFzaz4KICAgICAgICA8L2c+CiAgICAgICAgPGcgZmlsbD0iI0ZGRTIyMSIgdHJhbnNmb3JtPSJyb3RhdGUoLTExIDIwNi42ODUgMTcuNTA3KSI+CiAgICAgICAgICAgIDxyZWN0IHdpZHRoPSIxLjU5IiBoZWlnaHQ9IjYuMDQiIHg9IjIuMjI1IiByeD0iLjc5NSIgc3R5bGU9Im1peC1ibGVuZC1tb2RlOm11bHRpcGx5Ii8+CiAgICAgICAgICAgIDxwYXRoIGQ9Ik02LjA0IDMuMDJhLjc5NS43OTUgMCAwIDEtLjc5NS43OTVILjc5NWEuNzk1Ljc5NSAwIDAgMSAwLTEuNTloNC40NWMuNDQgMCAuNzk1LjM1Ni43OTUuNzk1eiIgc3R5bGU9Im1peC1ibGVuZC1tb2RlOm11bHRpcGx5Ii8+CiAgICAgICAgPC9nPgogICAgICAgIDxnIGZpbGw9IiMwMzc4RDQiIHRyYW5zZm9ybT0icm90YXRlKC0xMSAyMTcuMjY1IC0xNjguNTcyKSI+CiAgICAgICAgICAgIDxyZWN0IHdpZHRoPSIxLjU5IiBoZWlnaHQ9IjYuMDQiIHg9IjIuMjI1IiByeD0iLjc5NSIgc3R5bGU9Im1peC1ibGVuZC1tb2RlOm11bHRpcGx5Ii8+CiAgICAgICAgICAgIDxwYXRoIGQ9Ik02LjA0IDMuMDJhLjc5NS43OTUgMCAwIDEtLjc5NS43OTVILjc5NWEuNzk1Ljc5NSAwIDAgMSAwLTEuNTloNC40NWMuNDQgMCAuNzk1LjM1Ni43OTUuNzk1eiIgc3R5bGU9Im1peC1ibGVuZC1tb2RlOm11bHRpcGx5Ii8+CiAgICAgICAgPC9nPgogICAgICAgIDxnIGZpbGw9IiNGRkUyMjEiIHRyYW5zZm9ybT0icm90YXRlKC0xMSAzMy45MjQgLTE5Ni43MDcpIj4KICAgICAgICAgICAgPHJlY3Qgd2lkdGg9IjEuNTkiIGhlaWdodD0iNi4wNCIgeD0iMi4yMjUiIHJ4PSIuNzk1IiBzdHlsZT0ibWl4LWJsZW5kLW1vZGU6bXVsdGlwbHkiLz4KICAgICAgICAgICAgPHBhdGggZD0iTTYuMDQgMy4wMmEuNzk1Ljc5NSAwIDAgMS0uNzk1Ljc5NUguNzk1YS43OTUuNzk1IDAgMCAxIDAtMS41OWg0LjQ1Yy40NCAwIC43OTUuMzU2Ljc5NS43OTV6IiBzdHlsZT0ibWl4LWJsZW5kLW1vZGU6bXVsdGlwbHkiLz4KICAgICAgICA8L2c+CiAgICAgICAgPGcgZmlsbD0iI0ZGOTBCQyIgdHJhbnNmb3JtPSJyb3RhdGUoNzQgNC42NTIgNS40KSI+CiAgICAgICAgICAgIDxyZWN0IHdpZHRoPSIxLjU5IiBoZWlnaHQ9IjkuNTkyIiB4PSI0LjEzMyIgcng9Ii43OTUiIHN0eWxlPSJtaXgtYmxlbmQtbW9kZTptdWx0aXBseSIvPgogICAgICAgICAgICA8cGF0aCBkPSJNOS43MjQgNC43OTZhLjc5NS43OTUgMCAwIDEtLjc5NS43OTVILjkyNmEuNzk1Ljc5NSAwIDAgMSAwLTEuNTlIOC45M2MuNDM5IDAgLjc5NS4zNTYuNzk1Ljc5NXoiIHN0eWxlPSJtaXgtYmxlbmQtbW9kZTptdWx0aXBseSIvPgogICAgICAgIDwvZz4KICAgICAgICA8ZyBmaWxsPSIjMDM3OEQ0Ij4KICAgICAgICAgICAgPHBhdGggZD0iTTExLjI0OCAyOS4xMTZMMzEuMDc0IDkuMjg5bDcuMjgzIDcuMjg0LTE5LjgyNiAxOS44MjZ6IiBzdHlsZT0ibWl4LWJsZW5kLW1vZGU6bXVsdGlwbHkiLz4KICAgICAgICAgICAgPHBhdGggZD0iTTUuMTc4IDIzLjA0Nmw3LjI4My03LjI4MyAxMy4zNTMgMTMuMzUzLTcuMjgzIDcuMjgzeiIgc3R5bGU9Im1peC1ibGVuZC1tb2RlOm11bHRpcGx5Ii8+CiAgICAgICAgPC9nPgogICAgPC9nPgo8L3N2Zz4K"},7318:function(e,t,n){var r=n(7319),a=n(45);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)a.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},7319:function(e,t,n){(t=e.exports=n(44)(!1)).push([e.i,"._3HA6ARGNxUB50S2NLQhyGo{height:100%;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto;min-height:0;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-sizing:border-box;box-sizing:border-box}html[dir] ._3HA6ARGNxUB50S2NLQhyGo{padding:4px 0 8px}.z_CuB_GLeHxYpQyA3KQIi{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-flex:1;-ms-flex:1 0 auto;flex:1 0 auto;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}",""]),t.locals={dndContainer:"_3HA6ARGNxUB50S2NLQhyGo",primaryDropHintContainer:"z_CuB_GLeHxYpQyA3KQIi"}},7320:function(e,t,n){var r=n(7321),a=n(45);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)a.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},7321:function(e,t,n){(t=e.exports=n(44)(!1)).push([e.i,"._3-Cjp9xGMD5XffOiTo9N5E{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column;-webkit-box-flex:1;-ms-flex:1 1 auto;flex:1 1 auto;min-height:0;width:100%;position:relative}",""]),t.locals={timePanelDropListener:"_3-Cjp9xGMD5XffOiTo9N5E"}},7322:function(e,t,n){var r=n(7323),a=n(45);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)a.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},7323:function(e,t,n){(t=e.exports=n(44)(!1)).push([e.i,'html[dir] ._2zAUCr-wD6AYeqZT1guyrQ{background-color:"[theme:neutralLighter, default:#f4f4f4]"}html[dir] ._2zAUCr-wD6AYeqZT1guyrQ.u7S_2_o3G8pbj-Nidq0E2{background-color:"[theme:themeLighterAlt, default:#EFF6FC]"}._2zAUCr-wD6AYeqZT1guyrQ:after{top:0;bottom:0;position:absolute;content:""}html[dir] ._2zAUCr-wD6AYeqZT1guyrQ:after{border:1px dashed "[theme:neutralSecondary, default:#666666]";border-radius:4px}html[dir=ltr] ._2zAUCr-wD6AYeqZT1guyrQ:after,html[dir=rtl] ._2zAUCr-wD6AYeqZT1guyrQ:after{left:0;right:0}html[dir] ._2zAUCr-wD6AYeqZT1guyrQ.u7S_2_o3G8pbj-Nidq0E2:after{border-color:"[theme:themePrimary, default:#0078D4]"}html[dir=ltr] ._2zAUCr-wD6AYeqZT1guyrQ,html[dir=rtl] ._2zAUCr-wD6AYeqZT1guyrQ{padding-left:6px;padding-right:6px;margin-left:-6px;margin-right:-6px}',""]),t.locals={dropContainer:"_2zAUCr-wD6AYeqZT1guyrQ",dropContainerActive:"u7S_2_o3G8pbj-Nidq0E2"}},7324:function(e,t,n){var r=n(7325),a=n(45);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)a.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},7325:function(e,t,n){(t=e.exports=n(44)(!1)).push([e.i,'html[dir] ._19MJfFFcLAdGumtM4JO-PK{background-color:"[theme:neutralLighter, default:#f4f4f4]"}html[dir] ._19MJfFFcLAdGumtM4JO-PK._2hUnbaTT9Vb-nyIDl8Fkbu{background-color:"[theme:themeLighterAlt, default:#EFF6FC]"}._19MJfFFcLAdGumtM4JO-PK:after{top:0;bottom:0;position:absolute;content:""}html[dir] ._19MJfFFcLAdGumtM4JO-PK:after{border:1px dashed "[theme:neutralSecondary, default:#666666]";border-radius:4px}html[dir=ltr] ._19MJfFFcLAdGumtM4JO-PK:after,html[dir=rtl] ._19MJfFFcLAdGumtM4JO-PK:after{left:0;right:0}html[dir] ._19MJfFFcLAdGumtM4JO-PK._2hUnbaTT9Vb-nyIDl8Fkbu:after{border-color:"[theme:themePrimary, default:#0078D4]"}html[dir=ltr] ._19MJfFFcLAdGumtM4JO-PK{margin-left:-5px;padding-left:5px;margin-right:-3px;padding-right:5px}html[dir=rtl] ._19MJfFFcLAdGumtM4JO-PK{margin-right:-5px;padding-right:5px;margin-left:-3px;padding-left:5px}html[dir=ltr] ._19MJfFFcLAdGumtM4JO-PK:after{margin-left:2px;margin-right:4px}html[dir=rtl] ._19MJfFFcLAdGumtM4JO-PK:after{margin-right:2px;margin-left:4px}',""]),t.locals={pivotItemDropContainer:"_19MJfFFcLAdGumtM4JO-PK",pivotItemDropContainerActive:"_2hUnbaTT9Vb-nyIDl8Fkbu"}},7461:function(e){e.exports={a:"cMb",d:"dMb",c:"eMb",g:"fMb",f:"gMb",b:"hMb",e:"iMb"}},886:function(e,t,n){"use strict";n.d(t,"c",function(){return d}),n.d(t,"b",function(){return s}),n.d(t,"a",function(){return l});var r=/^([a-zA-Z0-9!#$%&'*+/=?^_`{|}~-](?:[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]*[a-zA-Z0-9!#$%&'*+/=?^_`{|}~-])?)(?=@)/,a=/^("[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~\-(),:;<>@[\\\]" ]*")(?=@)/,i=/^[a-zA-Z0-9-]+(?:\.[a-zA-Z0-9-]+)*$/,o=/[^\\]"/,c=/^[A-Za-z0-9_-]+:.*$/,u=function(e){var t=e.match(r);if(t)return-1!==t[0].indexOf("..")?null:t[0];var n=e.match(a);if(n){var i=o.exec(n[0]);return i&&i.index!==n[0].length-2?null:n[0]}return null};function d(e){if(!e)return!1;var t=u(e);return!!t&&!!e.substring(t.length+1).match(i)}function s(e){return c.test(e)}function l(e){return d(e)||s(e)}},896:function(e,t,n){"use strict";var r=n(319),a=n(5),i=n(2147),o=n(7),c=n(899),u=n(2148),d=n(864);function s(e,t){var n=[];return e.IsDraft&&n.push(Object(a.a)(u.a)),e.Subject?n.push(e.Subject):t||n.push(Object(a.a)(u.b)),n.join(" ")}function l(e){return e.Location?Object(d.d)(e.Location.DisplayName,e.Location.PostalAddress):""}function f(e,t){var n=[];n.push(function(e,t){var n=s(e),u=Object(c.e)(e),d=m(e.Start,e.End,t,e.IsAllDayEvent,u,!0),l=Object(a.a)(i.b);e.IsAllDayEvent&&u&&Object(o.w)(e.End,e.Start)==r.a.MillisecondsInOneDay?l=Object(a.a)(i.g):e.IsAllDayEvent&&u&&(l=Object(a.a)(i.a));return Object(a.b)(l,d,n)}(e,t));var u=l(e);return u&&n.push(Object(a.b)(Object(a.a)(i.c),u)),e.Organizer&&e.IsMeeting&&n.push(Object(a.b)(Object(a.a)(i.d),e.Organizer.Mailbox.Name)),"Occurrence"===e.CalendarItemType&&n.push(Object(a.a)(i.f)),"Private"===e.Sensitivity&&n.push(Object(a.a)(i.e)),n.join(" ")}function b(e,t){var n=[],r=s(e);r&&n.push(r);var a=l(e);a&&n.push(a);var i=Object(c.e)(e),o=m(e.Start,e.End,t,e.IsAllDayEvent,i,!1);return n.push(o),n.join("\n")}function p(e,t){var n=l(e),r=b(e);return n?r+" "+n:r}function m(e,t,n,u,d,s){if(n&&(e=Object(o.Ob)(n,e),t=Object(o.Ob)(n,t)),Object(o.Gb)(e,t))return Object(a.b)(Object(a.a)(i.j),s?Object(o.eb)(e):"",Object(o.Y)(e),Object(o.Y)(t)).replace("  "," ");if(u&&d){if(Object(o.w)(t,e)==r.a.MillisecondsInOneDay)return Object(o.eb)(e);var l=Object(o.eb)(Object(c.a)({start:e,end:t}).end);return Object(a.b)(Object(a.a)(i.h),Object(o.eb)(e),l)}return Object(a.b)(Object(a.a)(i.i),Object(o.eb)(e),Object(o.Y)(e),Object(o.eb)(t),Object(o.Y)(t))}n.d(t,"a",function(){return f}),n.d(t,"d",function(){return b}),n.d(t,"e",function(){return p}),n.d(t,"b",function(){return l}),n.d(t,"c",function(){return s})},899:function(e,t,n){"use strict";var r=n(319),a=n(7);function i(e){return o({start:e.Start,end:e.End})}function o(e){var t=Object(a.Ub)(e.end),n={start:e.start,end:e.end},r=Object(a.Fb)(e.end,t),i=Object(a.Fb)(e.start,t);return r&&!i&&(n.end=Object(a.bc)(n.end,1)),n}function c(e){return function(t){var n=i(t);return 0===Object(r.j)(e,n,!0)}}var u=n(33);function d(e){var t=i(e),n=Object(a.w)(Object(a.Ub)(t.end),Object(a.Ub)(t.start));return Math.ceil(n/u.c)}var s=n(137);function l(e){return e.IsAllDayEvent||Object(a.w)(e.End,e.Start)>=s.a.MillisecondsInOneDay}function f(e){return Object(a.Db)(e.Start,e.End)?b(e):d(e)>=1}function b(e){return Math.abs(Object(a.s)(e.Start,e.End))>1}n.d(t,"d",function(){return c}),n.d(t,"c",function(){return d}),n.d(t,"a",function(){return o}),n.d(t,"b",function(){return i}),n.d(t,"e",function(){return l}),n.d(t,"g",function(){return f}),n.d(t,"f",function(){return b})},9118:function(e,t,n){var r=n(11245),a=n(45);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)a.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},9730:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n(4),i=n(4920),o=n(2856),c=Object(a.action)("INITIALIZE_UP_NEXT_V2"),u=(Object(a.orchestrator)(c,function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var e;return Object(r.__generator)(this,function(t){return e=Object(i.a)(),Object(o.d)(e,"TimePanelAgenda_UpNextCalendarCacheId"),[2]})})}),n(5615),Object(a.orchestrator)(i.b,function(e){var t=Object(i.a)();Object(o.i)(t,"TimePanelAgenda_UpNextCalendarCacheId")}),n(7461)),d=n(22),s=n(498),l=n(1),f=n(9118),b=Object(d.a)(function(e){return l.createElement("div",{className:f.upNextEventContainer},e.eventCountString&&l.createElement("div",{className:f.conflictingEventsCount},e.eventCountString),l.createElement(s.a,{className:f.eventIconColumn,iconName:"Event"}),l.createElement("div",{className:f.eventDetailsColumn},l.createElement("div",{className:f.eventName},e.eventName),l.createElement("div",{className:f.eventTimeLocationRow},l.createElement("div",{className:f.eventTime},e.timeUntilEvent),e.eventLocation&&l.createElement("div",{className:f.eventLocation},e.eventLocation))))}),p=n(11246),m=n(5),g=n(33),I=n(7),O=n(319),j=n(322),v=59*g.e;function h(e,t){var n=Object(j.h)();if(Object(O.s)(n,e.Start,e.End))return t?Object(m.a)(u.c)+",":Object(m.a)(u.c);var r=Object(I.ic)(e.Start),a=Math.abs(Object(I.xb)(n)-Object(I.xb)(r));if(a<=v){var i=Math.ceil(a/g.e);return Object(m.b)(Object(m.a)(p.a),i)}var o=Object(I.Gb)(n,r),c=Object(I.Y)(r);return o?c:Object(m.b)(Object(m.a)(u.f),c)}var C=n(896);var A=n(1603),w=n(153),x=n(2106),D=n(1322),S=n(794),y=n(2480),E=n(5246),_=n(9118),M="UpNext",T="DragEmailToUpNext";function N(e,t,n,r,a,i){e.push(l.createElement(b,{key:t,eventCountString:a,eventLocation:r,eventName:n,timeUntilEvent:i}))}var k=Object(d.a)(function(e){var t,n=e.upNextEvent,a=n.ItemId,i=e.conflictingEvents.length+1,o=i>1,c=Object(r.__spread)([n],e.conflictingEvents),d=!o&&a,s=l.useCallback(function(){var e;Object(D.a)()?(e=d,Object(w.m)("TnS_UpNextClicked"),e?x.e.importAndExecute(M,e):x.g.importAndExecute(M)):function(e){e?Object(y.a)(e.Id,"Mail_UpNext",null,6):window.open(Object(S.e)())}(d)},[d]),f=l.useCallback(function(){var e=c.length;t=setTimeout(function(){t&&Object(w.m)("TnS_UpNextHover",[e]),t=null},300)},[d]),b=l.useCallback(function(){t=null},[d]);l.useEffect(function(){Object(w.m)("TnS_UpNext",[c.length])},[d]);for(var p=[],g=i>3,I=g?2:c.length,O=0;O<I;O++){var j=c[O],v=j.Location&&j.Location.DisplayName,T=o&&Object(m.b)(Object(m.a)(u.a),O+1,i),k=h(j,!!v);N(p,j.ItemId.Id,j.Subject,v,T,k)}if(g){var P=i-I;N(p,"viewAll",Object(m.a)(u.g),null,Object(m.b)(Object(m.a)(u.d),P),h(n,!1))}var V=_.allEventsContainer;2==i?V=_.allEventsContainerTwoEvents:i>2&&(V=_.allEventsContainerThreeOrMoreEvents);var G=o?void 0:Object(C.e)(n),H=o?function(e,t,n){var r=[];r.push(Object(m.b)(Object(m.a)(u.b),t));for(var a=0;a<e.length;a++){var i=e[a];r.push(Object(m.b)(Object(m.a)(u.e),a+1,t)),r.push(Object(C.a)(i))}return n&&r.push(Object(m.a)(u.g)),r.join(" ")}(c.slice(0,I),c.length,g):Object(C.a)(n);return l.createElement(A.a,{ariaLabel:H,className:_.upNextEventButtonContainer,"data-is-focusable":!0,"data-automation-id":"UpNext",onClick:s,role:"button",title:G,styles:e.containerStyle},l.createElement(E.f,{containerClassName:_.allEventsContainer,onLongHover:L},l.createElement("div",{className:V,onMouseEnter:f,onMouseLeave:b},p)))});function L(){x.g.importAndExecute(T)}var P=n(1466),V="TimePanelAgenda_UpNextCalendarCacheId";var G=Object(d.a)(function(e){var t="DoesNotExist"!==Object(P.d)(V)?Object(o.c)(V):null;if(!t||!t.upNextEvent)return null;var n=t.conflictingEvents;return l.createElement(k,{upNextEvent:t.upNextEvent,conflictingEvents:n,containerStyle:e.containerStyle})});n.d(t,"initializeUpNextV2",function(){return c}),n.d(t,"UpNextV2",function(){return G})}},0,[0,1,2,3,475,7,8,148,167,258,9,13,165,604,368,536,538]]);
//# sourceMappingURL=owa.UpNextV2.js.map
self.scriptsLoaded['owa.UpNextV2.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.UpNextV2.js'] = (new Date()).getTime();