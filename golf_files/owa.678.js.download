self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.678.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[678],{1126:function(e,t,n){"use strict";var i,a=n(838),r=n(1486),o=n(4);t.a=Object(o.createStore)("owsOptionsStore",{options:(i={},i[a.a.SmartSuggestions]={feature:a.a.SmartSuggestions,smartSuggestionsEnabled:!1,browserLocationEnabled:!1},i[a.a.DiverseEmojis]={feature:a.a.DiverseEmojis,diverseEmojisSelectedSkinTone:""},i[a.a.SurfaceActions]={feature:a.a.SurfaceActions,readSurfaceActions:[],readSurfaceAddins:[],composeSurfaceActions:[],composeSurfaceAddins:[]},i[a.a.SkypeNotifications]={feature:a.a.SkypeNotifications,skypeMessageNotification:1,skypeCallingNotification:1},i[a.a.WebPushNotifications]={feature:a.a.WebPushNotifications,enabled:!1,applicationServerKey:null},i[a.a.Confetti]={feature:a.a.Confetti,confettiEnabled:!1},i[a.a.GdprAdsPrefs]={feature:a.a.GdprAdsPrefs,consentString:null,allowStorageAndAccess:!1,allowPersonalization:!1,allowAdSelectionDeliveryReporting:!1,allowContentSelectionDeliveryReporting:!1,allowMeasurement:!1},i[a.a.CalendarSurfaceAddins]={feature:a.a.CalendarSurfaceAddins,calendarSurfaceAddins:[]},i[a.a.ExternalImages]={feature:a.a.ExternalImages,externalImagesSelectedOption:null},i[a.a.EventCapture]={autoCollectionEnabled:!1},i[a.a.LinkedInBindingDismissed]={linkedInBindingDismissedInPeoplePicker:!1},i[a.a.Translation]={feature:a.a.Translation,translationMode:0,targetLanguage:"",excludedLanguages:[]},i[a.a.CalendarSurfaceOptions]={feature:a.a.CalendarSurfaceOptions,agendaPaneIsClosed:!0},i[a.a.MentionEventNotifications]={feature:a.a.MentionEventNotifications,enabled:!1},i[a.a.TxpEventNotifications]={feature:a.a.TxpEventNotifications,enabled:!1},i[a.a.ComposeAssistance]={feature:a.a.ComposeAssistance,composeAssistanceEnabled:!1},i[a.a.AmpDeveloper]={feature:a.a.AmpDeveloper,enabled:!0,allowedSender:[]},i[a.a.ActivityFeed]={feature:a.a.ActivityFeed,OWASurfaceOptions:{SupportedTypes:[],DisabledInFeedPanel:[]}},i[a.a.CalendarHelp]={feature:a.a.CalendarHelp,calendarHelpEnabled:!1},i[a.a.Bohemia]={feature:a.a.Bohemia,bohemiaEnabled:!1},i),loadState:r.a.OptionsNotLoaded})},1135:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var i=n(1126);function a(e){return Object(i.a)().options[e]}},1368:function(e,t,n){"use strict";n.d(t,"b",function(){return r}),n.d(t,"a",function(){return o}),n.d(t,"f",function(){return s}),n.d(t,"c",function(){return u}),n.d(t,"d",function(){return c}),n.d(t,"e",function(){return d});var i=n(153),a="WebPushSetup";function r(e){f("enabled",e)}function o(e,t){f("disabled",e),f("allClients",t)}function s(e){(window.webPushOptics.enabled||window.webPushOptics.disabled)&&(f("result",e),l())}function u(){f("lightning","ignored"),l()}function c(e){f("permission",e)}function d(e){f("roaming",e)}function l(){Object(i.m)(a,window.webPushOptics,{isCore:!0}),window.webPushOptics={}}function f(e,t){window.webPushOptics[e]=t}window.webPushOptics={}},1486:function(e,t,n){"use strict";var i;n.d(t,"a",function(){return i}),function(e){e[e.OptionsNotLoaded=0]="OptionsNotLoaded",e[e.OptionsLoading=1]="OptionsLoading",e[e.OptionsLoaded=2]="OptionsLoaded"}(i||(i={}))},1490:function(e,t,n){"use strict";n.d(t,"c",function(){return a}),n.d(t,"b",function(){return r}),n.d(t,"a",function(){return o});var i=n(4),a=Object(i.createStore)("webPushStore",{currentView:0,webPushPermission:window.Notification&&window.Notification.permission})(),r=Object(i.createStore)("localWebPushUserSettingStore",{userPreferenceIdentifier:null,lastSessionDate:null,uniqueDaysSessionCount:0,enabled:null,promptCount:0,lastPromptDate:null})();function o(){return r}},1514:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var i=n(4),a=n(988),r=Object(i.action)("APPLY_DEFAULT_OPTIONS_ON_LOAD_FAIL",function(e){return void 0===e&&(e=Object(a.a)()),{defaultOptions:e}})},1797:function(e,t,n){"use strict";n.d(t,"i",function(){return d}),n.d(t,"h",function(){return l}),n.d(t,"g",function(){return f}),n.d(t,"f",function(){return b}),n.d(t,"e",function(){return p}),n.d(t,"a",function(){return g});var i=n(2009);n.d(t,"d",function(){return i.a});var a=n(51),r=n(1949);n.d(t,"j",function(){return r.d});var o=n(1490);n.d(t,"b",function(){return o.a});var s=n(1925);n.d(t,"c",function(){return s.a});var u=n(1368);n.d(t,"l",function(){return u.b}),n.d(t,"k",function(){return u.a}),n.d(t,"m",function(){return u.f});var c=new a.c(function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(23),n.e(503)]).then(n.bind(null,3924))}),d=new a.a(c,function(e){return e.bootStrapWebPushService}),l=new a.b(c,function(e){return e.userInitiatedWebPushSetupWorkflow}),f=new a.b(c,function(e){return e.userInitiatedWebPushDisableWorkflow}),b=new a.b(c,function(e){return e.unsubscribe}),p=(new a.b(c,function(e){return e.shouldShowWebPushLightning}),new a.b(c,function(e){return e.loadWebPushOptions})),g=Object(a.d)(c,function(e){return e.WebPushDiscovery})},1925:function(e,t,n){"use strict";function i(e,t){return e+"_"+(null!=t.enabledTimeInUTCMs?t.enabledTimeInUTCMs:"")}n.d(t,"a",function(){return i})},1949:function(e,t,n){"use strict";var i=n(1490);function a(){return new Date}var r=n(70),o=n(11),s="WebPushUserSettings",u=5;function c(e,t){for(var n=d(e),i=-1,a=0;a<n.length;++a)if(n[a].userPreferenceIdentifier==t.userPreferenceIdentifier){i=a;break}if(i>=0)n[i]=t;else{if(i=n.length,n.length>=u){i=0;var r=new Date(n[0].lastSessionDate);for(a=1;a<n.length;++a){var o=new Date(n[a].lastSessionDate);o.getTime()<r.getTime()&&(r=o,i=a)}}n[i]=t}l(e,n)}function d(e){var t=Object(o.a)(e,s),n=new Array;try{var i=JSON.parse(t);null!=i&&(n=i)}catch(t){Object(o.c)(e,s)}return n}function l(e,t){if(t.length>0){var n=JSON.stringify(t);Object(o.d)(e,s,n)}else Object(o.c)(e,s)}n.d(t,"d",function(){return f}),n.d(t,"c",function(){return b}),n.d(t,"a",function(){return p}),n.d(t,"g",function(){return g}),n.d(t,"f",function(){return S}),n.d(t,"b",function(){return O}),n.d(t,"e",function(){return m});var f=Object(r.select)({store:function(){return i.b}})(Object(r.action)("loadLocalWebPushUserSetting")(function(e,t,n){var i=function(e,t){for(var n=d(e),i=null,a=0;a<n.length;++a)if(n[a].userPreferenceIdentifier==t){i=n[a];break}return i}(e,t);null!=i?Object.keys(i).forEach(function(e){n.store[e]=i[e]}):n.store.userPreferenceIdentifier=t})),b=Object(r.select)({store:function(){return i.b}})(Object(r.action)("incrementUniqueDaysSessionCount")(function(e,t){var n=a().toDateString();t.store.lastSessionDate!=n&&(t.store.lastSessionDate=n,t.store.uniqueDaysSessionCount<4&&t.store.uniqueDaysSessionCount++,c(e,t.store))})),p=Object(r.select)({store:function(){return i.b}})(Object(r.action)("cleanupLocalWebpushUserSetting")(function(e,t,n){!function(e,t){for(var n=d(e),i=-1,a=0;a<n.length;++a)if(n[a].userPreferenceIdentifier==t){i=a;break}-1!=i&&(n.splice(i,1),l(e,n))}(e,n.store.userPreferenceIdentifier),n.store.userPreferenceIdentifier=t})),g=Object(r.select)({store:function(){return i.b}})(Object(r.action)("updateLocalWebPushEnabledStatus")(function(e,t,n,i){i.store.enabled=t,i.store.userPreferenceIdentifier=n,c(e,i.store)})),S=Object(r.select)({store:function(){return i.b}})(function(e,t){return null!=t.store&&null==t.store.enabled&&t.store.uniqueDaysSessionCount>=4&&t.store.lastPromptDate!=a().toDateString()&&t.store.promptCount<=3}),O=Object(r.select)({store:function(){return i.b}})(Object(r.action)("incrementLocalWebPushPromptCount")(function(e,t){t.store.promptCount++,t.store.lastPromptDate=a().toDateString(),c(e,t.store)})),m=Object(r.select)({store:function(){return i.b}})(Object(r.action)("resetLocalWebPushPromptCount")(function(e,t){t.store.promptCount=0,t.store.lastPromptDate=null,c(e,t.store)}))},2009:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var i=n(67),a=n(34),r=n(41),o=n(820),s=function(e){return!(!Object(i.f)("fwk-webPushNotification")&&!Object(i.f)("fwk-webPushNotificationV2"))&&(!(!e.navigator||null==e.navigator.serviceWorker||null==e.PushManager)&&((Object(a.d)()||Object(a.g)()||Object(i.f)("fwk-webPushNotificationExtended")&&(Object(a.e)()||Object(a.i)()))&&!Object(r.a)().SessionSettings.IsUserCultureRightToLeft&&1==Object(o.b)()))}},3362:function(e,t,n){"use strict";n.d(t,"a",function(){return d});var i=n(0),a=n(41),r=n(70),o=n(67),s=n(1797),u=n(761),c=n(63),d=Object(r.action)("signout")(function(e){return Object(i.__awaiter)(this,void 0,void 0,function(){var t,n;return Object(i.__generator)(this,function(i){switch(i.label){case 0:if(!Object(o.f)("fwk-webPushNotification")||!Object(o.f)("fwk-webPushNotificationSignout"))return[3,6];i.label=1;case 1:return i.trys.push([1,5,,6]),null==(t=Object(u.c)(u.a.WebPushNotifications))||t.enabled?[4,s.f.import()]:[3,4];case 2:return[4,i.sent()(window)];case 3:i.sent(),i.label=4;case 4:return[3,6];case 5:return n=i.sent(),c.d.error("[WebPush] Failed to unsubscribe on signout, error: "+n),[3,6];case 6:return Object(a.a)().ApplicationSettings.CloseWindowOnLogout,"sessionStorage"in window&&window.sessionStorage&&window.sessionStorage.clear(),e.assign("/owa/logoff.owa"),[2]}})})})},6728:function(e,t,n){"use strict";n.r(t);n(13078);var i,a=n(41),r=n(401),o=n(46),s=n(734),u=n(3362),c=n(153),d=n(79);!function(e){e[e.Aad=1]="Aad",e[e.Msa=2]="Msa"}(i||(i={}));var l,f=n(2);function b(){switch(Object(f.m)()){case"WW":case"FirstRelease":case"Microsoft":case"Dogfood":default:return l.WorldWide}}!function(e){e[e.WorldWide=1]="WorldWide",e[e.Trailblazer=4]="Trailblazer",e[e.Pathfinder=5]="Pathfinder"}(l||(l={}));var p=n(67),g=n(794),S="abtSignOutEventForHost",O="abtInitializeResult",m="OWA",w=500,v=Object(s.a)(),P=0;function h(e){if(e.data&&""!==e.data&&e.origin===Object(g.m)()){var t=JSON.parse(e.data);t.eventId&&(t.eventId===S?(Object(c.m)("ActivityTimeout::Signout",{sessionId:v}),Object(u.a)(location)):t.eventId===O&&t.detail&&t.detail.initializeResult&&("false"===t.detail.initializeResult?Object(o.a)(w).then(function(){P<3&&(Object(c.m)("ActivityTimeout::RetryingIntialized",{attempt:P,sessionId:v,failureMessage:t.detail.initializeMessage}),A())}):Object(c.m)("ActivityTimeout::Initialized",{sessionId:v})))}}function A(){var e={market:Object(a.a)().SessionSettings.UserCulture,environment:b(),userId:Object(a.a)().SessionSettings.UserPuid,authType:Object(d.q)()?i.Aad:i.Msa,timeout:Object(a.a)().PolicySettings.SharedActivityBasedTimeout,trackEvents:!0,enableLogging:!0,workloadName:m,tenantId:Object(a.a)().SessionSettings.TenantGuid,sessionId:v,signinState:Object(a.a)().PolicySettings.SignInState};Object(c.m)("ActivityTimeout::Initializing",{authType:e.authType,timeout:e.timeout,sessionId:v}),P++,window.AbtInteraction.AbtInitialize(e)}function j(e){Promise.all([n.e(0),n.e(1),n.e(2),n.e(664)]).then(n.t.bind(null,14583,7)).then(function(t){e&&e()})}function I(){Object(r.a)()&&Object(p.f)("auth-sharedActivityBasedTimeout")&&Object(a.a)().PolicySettings.IsSharedActivityBasedTimeoutEnabled&&(window.LoadAbtPromptJs={Download:j},window.addEventListener("message",h,!1),A())}n.d(t,"registerAndInitializeSharedABT",function(){return I})},761:function(e,t,n){"use strict";var i=n(838),a=(function(){}(),n(51)),r=n(1514),o=n(1126),s=n(20),u=n(4),c=[i.a.SurfaceActions];Object(u.mutator)(r.a,function(e){var t=e.defaultOptions;c.forEach(function(e){t[e]&&Object(s.extendObservable)(Object(o.a)().options[e],t[e])})});var d=n(1135),l=n(988);n.d(t,"d",function(){return b}),n.d(t,"g",function(){return p}),n.d(t,"e",function(){return g}),n.d(t,"f",function(){return S}),n.d(t,"c",function(){return d.a}),n.d(t,"b",function(){return l.a}),n.d(t,"a",function(){return i.a});var f=new a.c(function(){return n.e(379).then(n.bind(null,14773))}),b=new a.a(f,function(e){return e.createOrUpdateOptionsForFeature}),p=new a.a(f,function(e){return e.updateAddinPinStatus}),g=new a.b(f,function(e){return e.getServerOptionsForFeature}),S=new a.a(f,function(e){return e.loadOptions})},838:function(e,t,n){"use strict";var i;n.d(t,"a",function(){return i}),function(e){e[e.TestFeature=1]="TestFeature",e[e.SmartSuggestions=2]="SmartSuggestions",e[e.DiverseEmojis=4]="DiverseEmojis",e[e.SurfaceActions=5]="SurfaceActions",e[e.SkypeNotifications=6]="SkypeNotifications",e[e.WebPushNotifications=7]="WebPushNotifications",e[e.Confetti=8]="Confetti",e[e.GdprAdsPrefs=9]="GdprAdsPrefs",e[e.CalendarSurfaceAddins=10]="CalendarSurfaceAddins",e[e.ExternalImages=11]="ExternalImages",e[e.EventCapture=12]="EventCapture",e[e.LinkedInBindingDismissed=13]="LinkedInBindingDismissed",e[e.Translation=14]="Translation",e[e.CalendarSurfaceOptions=15]="CalendarSurfaceOptions",e[e.TxpEventNotifications=16]="TxpEventNotifications",e[e.MentionEventNotifications=17]="MentionEventNotifications",e[e.ComposeAssistance=18]="ComposeAssistance",e[e.ActivityFeed=19]="ActivityFeed",e[e.AmpDeveloper=20]="AmpDeveloper",e[e.CalendarHelp=21]="CalendarHelp",e[e.LinkedInViewProfile=22]="LinkedInViewProfile",e[e.Bohemia=23]="Bohemia"}(i||(i={}))},988:function(e,t,n){"use strict";n.d(t,"a",function(){return o});var i=n(246),a=n(838),r=n(67);function o(){var e;return(e={})[a.a.SmartSuggestions]={smartSuggestionsEnabled:!0,browserLocationEnabled:!1},e[a.a.DiverseEmojis]={diverseEmojisSelectedSkinTone:""},e[a.a.SurfaceActions]={readSurfaceActions:["Reply","ReplyAll","Forward"].concat(Object(i.a)()?[]:["LikeUnlike"]),readSurfaceAddins:[],composeSurfaceActions:["AddAttachment","AddInlineImage","AddEmoji","ToggleDictation","ToggleRibbon"],composeSurfaceAddins:[]},e[a.a.SkypeNotifications]={skypeMessageNotification:1,skypeCallingNotification:1},e[a.a.Confetti]={confettiEnabled:!0},e[a.a.ComposeAssistance]={composeAssistanceEnabled:!0},e[a.a.GdprAdsPrefs]={feature:a.a.GdprAdsPrefs,consentString:null,allowStorageAndAccess:!1,allowPersonalization:!1,allowAdSelectionDeliveryReporting:!1,allowContentSelectionDeliveryReporting:!1,allowMeasurement:!1},e[a.a.CalendarSurfaceAddins]={calendarSurfaceAddins:[]},e[a.a.ExternalImages]={externalImagesSelectedOption:0},e[a.a.EventCapture]={autoCollectionEnabled:!1},e[a.a.LinkedInBindingDismissed]={linkedInBindingDismissedInPeoplePicker:!1},e[a.a.Translation]={translationMode:0,targetLanguage:"",excludedLanguages:[]},e[a.a.CalendarSurfaceOptions]={agendaPaneIsClosed:!1},e[a.a.AmpDeveloper]={enabled:Object(r.f)("rp-ampDefault"),allowedSender:[]},e[a.a.CalendarHelp]={calendarHelpEnabled:!1},e[a.a.LinkedInViewProfile]={dismissed:!1},e[a.a.Bohemia]={bohemiaEnabled:!1},e}}},0,[0,1,2,23,503]]);
//# sourceMappingURL=owa.678.js.map
self.scriptsLoaded['owa.678.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.678.js'] = (new Date()).getTime();