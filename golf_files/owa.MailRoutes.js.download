self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailRoutes.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[352],{1026:function(e,t,n){"use strict";n.d(t,"d",function(){return r}),n.d(t,"a",function(){return i}),n.d(t,"b",function(){return u}),n.d(t,"c",function(){return o}),n.d(t,"e",function(){return a}),n.d(t,"f",function(){return c});var r=600,i=600,u=650,o=1/2.89*100,a=420,c=420/1300*100},1092:function(e,t,n){"use strict";n.d(t,"t",function(){return d}),n.d(t,"g",function(){return f}),n.d(t,"h",function(){return l}),n.d(t,"i",function(){return b}),n.d(t,"j",function(){return p}),n.d(t,"k",function(){return w}),n.d(t,"l",function(){return v}),n.d(t,"m",function(){return h}),n.d(t,"n",function(){return m}),n.d(t,"o",function(){return g}),n.d(t,"p",function(){return I}),n.d(t,"q",function(){return O}),n.d(t,"r",function(){return j}),n.d(t,"s",function(){return _}),n.d(t,"u",function(){return y});var r=n(2167);n.d(t,"c",function(){return r.a});var i=n(1558);n.d(t,"d",function(){return i.a});var u=n(1520);n.d(t,"f",function(){return u.a});var o=n(51),a=n(1026);n.d(t,"b",function(){return a.a}),n.d(t,"e",function(){return a.d});var c=n(2168);n.d(t,"a",function(){return c.a});var s=new o.c(function(){return Promise.all([n.e(624),n.e(11),n.e(20),n.e(15),n.e(469)]).then(n.bind(null,4170))}),d=new o.b(s,function(e){return e}),f=new o.b(s,function(e){return e.resetPreviewPane}),l=(new o.b(s,function(e){return e.setAudioPreviewState}),new o.b(s,function(e){return e.setBlankPreviewState}),new o.b(s,function(e){return e.setCustomPreviewState}),new o.b(s,function(e){return e.setIframePreviewState})),b=(new o.b(s,function(e){return e.setImageGalleryItems}),new o.b(s,function(e){return e.setImagePreviewLoaded})),p=new o.b(s,function(e){return e.setImagePreviewState}),w=new o.b(s,function(e){return e.setImagePreviewStateFromImageGalleryItem}),v=(new o.b(s,function(e){return e.setNativePdfPreviewState}),new o.b(s,function(e){return e.setPanesSize})),h=(new o.b(s,function(e){return e.setPdfJsPreviewState}),new o.b(s,function(e){return e.setPdfJsPreviewStateByData}),new o.b(s,function(e){return e.setPreviewError})),m=new o.b(s,function(e){return e.setPreviewLoading}),g=new o.b(s,function(e){return e.setRightPaneDisplayAndUpdateSize}),I=new o.b(s,function(e){return e.setSaveStatusText}),O=new o.b(s,function(e){return e.setTextPreviewState}),j=(new o.b(s,function(e){return e.setVideoPreviewState}),new o.b(s,function(e){return e.setWacPreviewState})),_=new o.b(s,function(e){return e.setWacReadOnly}),y=new o.b(s,function(e){return e.updatePanesSize})},14674:function(e,t,n){"use strict";n.r(t);var r=n(0),i=n(1251);function u(e){return Object(r.__awaiter)(this,void 0,void 0,function(){return Object(r.__generator)(this,function(t){switch(t.label){case 0:return[4,Object(i.m)(e.categoryId)];case 1:return t.sent(),[2]}})})}var o=n(4507);function a(e){Object(o.a)(e.folderId)}var c=n(3369),s=n(4094),d=/^[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,3}$/i;function f(e){if(!e.groupAlias||!e.groupDomain)return null;var t,n=e.groupAlias+"@"+e.groupDomain;return t=n,d.test(t)?n:null}var l=n(153),b=n(3);function p(e,t){return Object(r.__awaiter)(this,void 0,void 0,function(){var n,u,o,a;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return(n=f(e))?(Object(l.m)("MailGroupFilesRouteHandlerEvent",{source:Object(b.c)()}),[4,c.a.import()]):[2];case 1:return u=r.sent(),[4,c.c.import()];case 2:return o=r.sent(),u(o.Files),[4,Object(i.q)(n,"groups")];case 3:return r.sent(),a=t&&t.length>2?t[2]:null,[4,s.f.import()];case 4:return r.sent()(n,a?"/"+a:""),[2]}})})}var w=n(7657),v=n(5169);function h(e){Object(v.a)(e.rowId)}function m(e){var t=e.folderId,n=e.rowId;Object(w.a)(t,n)}function g(e,t,n,r){return!!n&&n.some(function(e){return"search"==e})}var I=n(884);function O(e){return Object(r.__awaiter)(this,void 0,void 0,function(){return Object(r.__generator)(this,function(t){switch(t.label){case 0:return h(e),[4,I.v.import()];case 1:return t.sent()(e.attachmentId),[2]}})})}function j(e,t,n,i){return Object(r.__awaiter)(this,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return!!n&&n.some(function(e){return"sxs"==e})?[3,2]:[4,I.r.import()];case 1:e.sent()("browserNavigation"),e.label=2;case 2:return[2,!1]}})})}var _=n(51),y=new _.c(function(){return n.e(275).then(n.bind(null,14965))}),P=new _.b(y,function(e){return e.getSxSStoreViewState}),S=new _.a(y,function(e){return e.resetSxSViewStoreAction});function x(e,t,n,i){return Object(r.__awaiter)(this,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,S.importAndExecute("browserNavigation")];case 1:return e.sent(),[2,!1]}})})}function A(){return Object(r.__awaiter)(this,void 0,void 0,function(){return Object(r.__generator)(this,function(e){return[2,j()]})})}function D(e,t){return Object(r.__awaiter)(this,void 0,void 0,function(){return Object(r.__generator)(this,function(t){switch(t.label){case 0:return[4,p(e,void 0)];case 1:return t.sent(),[2]}})})}var R=n(5824),E=n(6908),F=new _.c(function(){return n.e(268).then(n.bind(null,14780))}),C=new _.b(F,function(e){return e.DeeplinkActionType}),G=new _.a(F,function(e){return e.initializeDeeplink}),V=new _.a(F,function(e){return e.onGroupDetailsLoaded}),k=new _.a(F,function(e){return e.onGroupDetailsLoadError});function N(e){return Object(r.__awaiter)(this,void 0,void 0,function(){var t,n,u,o,a,s,d,p,w,h,m=this;return Object(r.__generator)(this,function(g){switch(g.label){case 0:return(t=f(e))?(t=t.toLowerCase(),Object(l.m)("MailGroupRouteHandlerEvent",{source:Object(b.c)()}),n=null,u=null,e.actionId?[4,V.import()]:[3,2]):[2];case 1:g.sent(),o=new Promise(function(e,t){n=function(){V.importAndExecute(),e()},u=function(){k.importAndExecute(),e()}}),g.label=2;case 2:return[4,Object(i.q)(t,"groups",n,u)];case 3:return g.sent(),[4,c.a.import()];case 4:return a=g.sent(),[4,c.c.import()];case 5:return s=g.sent(),a(s.Email),e.actionId?[4,C.import()]:[3,7];case 6:d=g.sent(),null!=(p=d[e.actionId.toLowerCase()])&&(w=function(e){return Object(r.__awaiter)(m,void 0,void 0,function(){return Object(r.__generator)(this,function(t){switch(t.label){case 0:return[4,E.a.import()];case 1:return t.sent()(e),[2]}})})},h=function(e){return Object(r.__awaiter)(m,void 0,void 0,function(){return Object(r.__generator)(this,function(t){switch(t.label){case 0:return[4,R.a.import()];case 1:return t.sent()(e),[2]}})})},G.importAndExecute(t,p,w,h)),g.label=7;case 7:return e.rowId&&Object(v.a)(e.rowId),o?[4,o]:[3,9];case 8:g.sent(),g.label=9;case 9:return[2]}})})}var z=n(7571);function H(e){e.assetId?e.campaignId&&e.providerId?z.a.import().then(function(t){t(!1,e.assetId,e.campaignId,e.providerId)}):z.a.import().then(function(t){t(!1,e.assetId)}):z.a.import().then(function(e){e(!0)})}function q(e){return Object(r.__awaiter)(this,void 0,void 0,function(){return Object(r.__generator)(this,function(t){switch(t.label){case 0:return[4,i.f.importAndExecute(e.favoriteNodeId)];case 1:return t.sent(),[2]}})})}function B(e){return Object(r.__awaiter)(this,void 0,void 0,function(){return Object(r.__generator)(this,function(t){switch(t.label){case 0:return[4,i.h.importAndExecute(e.favoriteNodeId)];case 1:return t.sent(),[2]}})})}var K=n(67),L=n(3594),M=n(2549),T=n(3816),$=n(885),J=n(991),U=n(2704);function W(e){return Object(r.__awaiter)(this,void 0,void 0,function(){return Object(r.__generator)(this,function(t){switch(t.label){case 0:return Object(o.a)(e.folderId),e.draftId?[4,J.o.importAndExecute(e.draftId)]:[3,2];case 1:return t.sent(),[3,4];case 2:return[4,U.c.importAndExecute("Route")];case 3:t.sent(),t.label=4;case 4:return[2]}})})}function Q(){return!!$.a.primaryComposeId&&J.k.importAndExecute($.a.viewStates.get($.a.primaryComposeId)).then(function(){return!1},function(){return!0})}var X=n(6133);function Y(){Object(X.a)()}var Z=n(866),ee=n(801);function te(e){Object(ee.b)()&&(Object(l.m)("Search_ReadingPaneClosed",["BrowserBackButton"]),Object(Z.z)(!1),Object(Z.y)(!0)),e.rowId&&Object(v.a)(e.rowId)}function ne(e,t,n,r){return!!e&&e.some(function(e){return"sxs"==e})&&(j(0,0,n),Object(Z.z)(!1)),!1}function re(e){e("/help",Y),e("/compose",W,Q),e("/compose/:draftId",W,Q),e("/search/id/:rowId/sxs/:itemId/:attachmentId",O,ne),e("/search/id/:rowId/sxs/:attachmentId",O,ne),e("/search/id/:rowId",h,ne),e("/search",te,ne),e("/id/:rowId",m),function(e){Object(M.a)()&&(e("/group/:groupDomain/:groupAlias",N),e("/group/:groupDomain/:groupAlias/email",N),e("/group/:groupDomain/:groupAlias/email/id/:rowId",N),e("/group/:groupDomain/:groupAlias/action/:actionId",N),function(e){e("/group/:groupDomain/:groupAlias/files/sxs/sp/:spFileId/?((\\w|.)*)",D,x),e("/group/:groupDomain/:groupAlias/files/sxs/attachment/:attachmentId/?((\\w|.)*)",D,A),e("/group/:groupDomain/:groupAlias/files/?((\\w|.)*)",p)}(e))}(e),Object(T.b)(),Object(L.g)(),e("/persons/:favoriteNodeId",q),Object(K.f)("peo-favoritePdls")&&e("/contactlists/:favoriteNodeId",B),e("/category/:categoryId",u),e("/inclientstore",H),e("/inclientstore/assetid/:assetId",H),e("/inclientstore/assetid/:assetId/campaignid/:campaignId/providerid/:providerId",H),e("/:folderId/id/:rowId/sxs/:itemId/:attachmentId",O,j),e("/:folderId/id/:rowId/sxs/:attachmentId",O,j),e("/:folderId/compose/:draftId",W,Q),e("/:folderId/compose",W,Q),e("/:folderId/id/:rowId",m,g),e("/:folderId",a,g)}var ie=n(1092),ue=n(863),oe=n(1263),ae=n(1307),ce=n(758),se=n(79);function de(){var e,t,n=[],i=Object(T.a)();if(i.length)return i;if($.a.primaryComposeId){n.push("compose");var u=$.a.viewStates.get($.a.primaryComposeId);return u.itemId&&u.itemId.Id&&n.push(u.itemId.Id),n}var o=Object(ue.c)();if(1===o.type){if(o.id)return n.push("persons"),n.push(o.id),n}else if(5===o.type&&Object(K.f)("peo-favoritePdls")){if(o.id)return n.push("contactlists"),n.push(o.id),n}else if(4===o.type){if(o.id)return n.push("category"),n.push(o.id),n}else if(2===o.type){if(o.id){var a=o.id.split("@");if(2!=a.length)return n;n.push("group"),n.push(a[1]),n.push(a[0]);var d=c.b.tryImportForRender(),f=c.c.tryImportForRender();if(d&&f)switch(d.navigationButtonSelected){case f.Email:n.push("email");break;case f.Files:n.push("files");var l=P.tryImportForRender();if(l){var b=l();if(b&&b.previewPane&&b.previewPane.mode!=ie.d.Blank){n.push("sxs"),n.push("sp"),n.push(b.previewPane.id);break}}if(I.G.extendedViewState.attachmentId&&!Object(se.r)()){n.push("sxs"),n.push("attachment"),n.push(I.G.extendedViewState.attachmentId.Id);break}var p=s.b.tryImportForRender();if(p){var w=p(o.id);if(w&&w.length>0){"/"==w.charAt(0)&&(w=w.substring(1));var v=w.split("/");try{for(var h=Object(r.__values)(v),m=h.next();!m.done;m=h.next()){var g=m.value;n.push(g)}}catch(t){e={error:t}}finally{try{m&&!m.done&&(t=h.return)&&t.call(h)}finally{if(e)throw e.error}}}}return n}}}else if(3!==o.type&&o.id){if(0===o.type){var O=Object(ae.a)();if(O){var j=O.FolderId.Id;n.push(O.distinguishedFolderId?Object(ce.a)(j):j)}}}else n.push("search");return Object(Z.D)()&&(oe.q.conversationReadingPaneViewState?(n.push("id"),n.push(oe.q.conversationReadingPaneViewState.conversationId.Id)):oe.q.itemReadingPaneViewState&&(n.push("id"),n.push(oe.q.itemReadingPaneViewState.itemId))),I.G.extendedViewState.attachmentId&&(n.push("sxs"),n.push(I.G.extendedViewState.attachmentId.Id)),n}n.d(t,"initializeMailRoutes",function(){return re}),n.d(t,"getCurrentRoute",function(){return de})},2167:function(e,t,n){"use strict";var r;n.d(t,"a",function(){return r}),function(e){e[e.Default=0]="Default",e[e.NeedPassword=1]="NeedPassword",e[e.IncorrectPassword=2]="IncorrectPassword"}(r||(r={}))},2168:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r="autoHideEmail"},3816:function(e,t,n){"use strict";var r=n(1132),i=n(0),u=n(1843),o="options";function a(e){return Object(i.__awaiter)(this,void 0,void 0,function(){var t,n,u;return Object(i.__generator)(this,function(i){switch(i.label){case 0:return t=e.category,n=e.subcategory,u=e.option,[4,r.e.importAndExecute(t,n,u)];case 1:return i.sent(),[2]}})})}function c(e,t,n,u){return Object(i.__awaiter)(this,void 0,void 0,function(){var e,a,c=this;return Object(i.__generator)(this,function(s){return e=n[0]!==o,a=e||t.category!=u.category||t.subcategory!=u.subcategory,[2,new Promise(function(t){return Object(i.__awaiter)(c,void 0,void 0,function(){var n,u=this;return Object(i.__generator)(this,function(o){switch(o.label){case 0:return[4,r.c.import()];case 1:return n=o.sent(),a?n(function(){return Object(i.__awaiter)(u,void 0,void 0,function(){return Object(i.__generator)(this,function(n){switch(n.label){case 0:return t(!1),e?[4,r.d.import()]:[3,2];case 1:n.sent()(!1),n.label=2;case 2:return[2]}})})},function(){return t(!0)}):t(!1),[2]}})})})]})})}function s(){Object(u.b)("/"+o,a,c),Object(u.b)("/"+o+"/:category",a,c),Object(u.b)("/"+o+"/:category/:subcategory",a,c),Object(u.b)("/"+o+"/:category/:subcategory/:option",a,c)}function d(){var e=[],t=Object(r.b)();return t.isFullOptionsShown&&t.currentCategoryKey&&t.currentSubCategoryKey&&(e=[o,t.currentCategoryKey,t.currentSubCategoryKey],t.currentOptionKey&&e.push(t.currentOptionKey)),e}n.d(t,"a",function(){return d}),n.d(t,"b",function(){return s})},4094:function(e,t,n){"use strict";n.d(t,"d",function(){return u}),n.d(t,"e",function(){return o}),n.d(t,"f",function(){return a}),n.d(t,"b",function(){return c}),n.d(t,"c",function(){return s}),n.d(t,"a",function(){return d});var r=n(51),i=new r.c(function(){return Promise.all([n.e(11),n.e(46),n.e(273)]).then(n.bind(null,6710))}),u=new r.a(i,function(e){return e.onFilesNavigation}),o=new r.a(i,function(e){return e.onGetGroupDetailsSucceeded}),a=new r.b(i,function(e){return e.setSharePointItemsViewNavigationTargetPath}),c=new r.b(i,function(e){return e.getSharePointItemsViewCurrentPath}),s=new r.b(i,function(e){return e.loadAttachmentInformation}),d=new r.b(i,function(e){return e.clickAttachmentFile})},4507:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(1251);function i(e){e?Object(r.p)(e,"Route"):Object(r.l)("Route")}},5169:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(867),i=n(727),u=n(905),o=n(1078);function a(e){var t=Object(u.a)(),n=Object(i.A)([e],t)[0];t.rowKeys.includes(n)&&Object(r.r)(t,n,!0,o.a.RouteHandler)}},5824:function(e,t,n){"use strict";n.d(t,"a",function(){return u});var r=n(51),i=new r.c(function(){return Promise.all([n.e(3),n.e(4),n.e(5),n.e(6),n.e(269)]).then(n.bind(null,8596))}),u=new r.b(i,function(e){return e.editGroup})},6133:function(e,t,n){"use strict";var r=n(67);function i(){var e=Object(r.f)("help-o365ShellHeader-MaxPane")?"Help":"OwaHelp";window.O365Shell.FlexPane.OpenFlexPaneForProvider(e)}n.d(t,"a",function(){return i})},7571:function(e,t,n){"use strict";n.d(t,"b",function(){return u}),n.d(t,"a",function(){return o});var r=n(51),i=new r.c(function(){return Promise.all([n.e(4),n.e(76),n.e(507)]).then(n.bind(null,9775))}),u=new r.b(i,function(e){return e.storeLinkHandler}),o=new r.b(i,function(e){return e.launchStoreUrl})},7657:function(e,t,n){"use strict";n.d(t,"a",function(){return u});var r=n(4507),i=n(5169);function u(e,t){Object(r.a)(e),Object(i.a)(t)}}},0,[3,4,9,13,421,600,20,15,36,334,0,1,2,576,189,6,377,23,575,185,17,359,10,622,442,5,329,353,7,8,12,130,11,43,126,68,356,604,368,365,237,254,341,345,351,374,538,745]]);
//# sourceMappingURL=owa.MailRoutes.js.map
self.scriptsLoaded['owa.MailRoutes.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailRoutes.js'] = (new Date()).getTime();