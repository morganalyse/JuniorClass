self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailSmartPill.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[355],{1016:function(e,t,r){"use strict";r.d(t,"b",function(){return u}),r.d(t,"a",function(){return f});var n,a=r(1392),i=r(1140),o=r(768),c={};function u(e){return e in c?c[e]:(c[e]={extraSmall:Object(i.a)(e+"_16x16"),small:Object(i.a)(e+"_20x20"),medium:Object(i.a)(e+"_32x32"),large:Object(i.a)(e+"_64x64"),cdn:-1===m.indexOf(e)?Object(a.a)(e+"_16x16"):Object(a.a)("generic_16x16")},c[e])}var s="generic",l=Object.freeze({".3g2":"video",".3gp":"video",".aac":"audio",".accdb":"accdb",".accdc":"accdb",".accde":"accdb",".accdr":"accdb",".accdt":"accdb",".acs":"accdb",".ai":"vector",".aiff":"audio",".ape":"audio",".asf":"video",".aspx":"code",".asx":"video",".avi":"video",".bmp":"photo",".csv":"csv",".dib":"photo",".dgn":"vector",".doc":"docx",".docm":"docx",".docx":"docx",".dot":"dotx",".dotm":"docx",".dotx":"dotx",".email":"email",".emf":"vector",".eml":"email",".eps":"vector",".exe":"exe",".flac":"audio",".flv":"video",".gdraw":"vector",".gif":"photo",".htm":"code",".html":"code",".ical":"calendar",".icalendar":"calendar",".ico":"photo",".ics":"calendar",".indd":"vector",".indt":"vector",".jfif":"photo",".jpe":"photo",".jpeg":"photo",".jpg":"photo",".log":"txt",".lync":s,".m1v":"video",".m4a":"audio",".mdb":"accdb",".mht":"code",".mov":"video",".mp2":"audio",".mp3":"audio",".mp4":"video",".mpa":"audio",".mpe":"video",".mpeg":"video",".mpg":"video",".mpp":"project",".mpt":"mpt",".mpv2":"video",".msg":"email",".odp":"pptx",".ods":"xlsx",".odt":"docx",".ogg":"audio",".one":"one",".onepkg":"onetoc",".onetoc":"onetoc",".onetoc2":"onetoc",".oxps":"vector",".pd":"vector",".pdf":"pdf",".plt":"vector",".png":"photo",".pot":"pptx",".potm":"pptx",".potx":"potx",".ppa":"pptx",".ppam":"pptx",".pps":"pptx",".ppsm":"pptx",".ppsx":"ppsx",".ppt":"pptx",".pptm":"pptx",".pptx":"pptx",".pro":"vector",".ps":"vector",".psd":"photo",".pub":"pblsh",".rpmsg":"rpmsg",".rtf":"txt",".sketch":"vector",".srt":"video",".svg":"vector",".svgz":"vector",".swf":"video",".tif":"photo",".tiff":"photo",".txt":"txt",".url":"link",".vcs":"calendar",".vdx":"vsdx",".vob":"video",".vsd":"vsdx",".vsdx":"vsdx",".vsl":"vsdx",".vss":"vsdx",".vssx":"vssx",".vst":"vstx",".vstx":"vstx",".wav":"audio",".wm":"audio",".wma":"audio",".wmd":"video",".wmf":"vector",".wms":"video",".wmv":"video",".wmz":"video",".wps":"docx",".wri":"docx",".xcl":"xlsx",".xd":"vector",".xla":"xlsx",".xlam":"xlsx",".xls":"xlsx",".xlsb":"xlsx",".xlsm":"xlsx",".xlsx":"xlsx",".xlt":"xlsx",".xltm":"xlsx",".xltx":"xltx",".xml":"code",".xps":"vector",".xsn":"infopath",".zip":"zip"}),d=Object.freeze({"application/vnd.google-apps.document":"gdoc","application/vnd.google-apps.spreadsheet":"gsheet","application/vnd.google-apps.presentation":"gslide","application/vnd.google-apps.form":"gform","application/onenote":"one","application/pdf":"pdf"}),m=["gdoc","gform","gsheet","gslide"];function f(e,t,r){if(void 0===t&&(t=!1),t)return n=n||{extraSmall:null,small:Object(i.a)("folder_20x20"),medium:Object(i.a)("folder_32x32"),large:Object(i.a)("folder_64x64"),cdn:Object(a.a)("folder_16x16")};var c,m=Object(o.b)(e);return m&&(c=l[m.toLowerCase()]),!c&&r&&r in d&&(c=d[r]),u(c||s)}},1140:function(e,t,r){"use strict";r.d(t,"a",function(){return i});var n=r(2678),a="fileType-icon";function i(e){return n[function(e){return a+"-"+e}(e)]}},1322:function(e,t,r){"use strict";var n=r(67),a=r(79),i=r(794);function o(){return(!Object(i.t)()||!window.opener)&&(Object(n.f)("cal-time-panel")&&!Object(a.f)().SessionSettings.IsShadowMailbox)}var c=r(4),u=Object(c.action)("openTimePanel",function(e){return{source:e}}),s=Object(c.action)("popView");r.d(t,"a",function(){return o}),r.d(t,"b",function(){return u}),r.d(t,"c",function(){return s})},1332:function(e,t,r){"use strict";var n=r(4),a=r(20),i=r(1653),o={providers:new a.ObservableMap,loadState:i.a.NotLoaded,removalPending:new a.ObservableMap},c=Object(n.createStore)("fileProviderStoreV2",o);t.a=c},13422:function(e){e.exports={a:"n1b",b:"o1b"}},13423:function(e){e.exports={a:"l1b",b:"m1b"}},13424:function(e,t,r){(t=e.exports=r(44)(!1)).push([e.i,'._3Jtu3QV20_qLz8g_h0KpQb{position:relative;-webkit-font-smoothing:antialiased;font-size:14px;font-weight:400;color:inherit;width:100%;height:48px;line-height:32px;display:block;cursor:pointer;outline:transparent}html[dir] ._3Jtu3QV20_qLz8g_h0KpQb{background-color:transparent;padding-top:0;padding-bottom:0;border-width:initial;border-style:none;border-color:initial;-o-border-image:initial;border-image:initial}html[dir=ltr] ._3Jtu3QV20_qLz8g_h0KpQb{padding-right:12px;padding-left:12px;text-align:left}html[dir=rtl] ._3Jtu3QV20_qLz8g_h0KpQb{padding-left:12px;padding-right:12px;text-align:right}html[dir] ._3Jtu3QV20_qLz8g_h0KpQb:hover{background-color:"[theme:neutralLighter, default:#f4f4f4]"}html[dir] ._3Jtu3QV20_qLz8g_h0KpQb:active{background-color:"[theme:neutralLight, default:#eaeaea]"}._1v60Zw1heoE7AYHV2rZARo{white-space:nowrap;height:inherit;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;max-width:100%}.Nf0DroQfbZfcaaSjQ53MC{display:inline-block;color:"[theme:themePrimary, default:#0078D4]";height:32px;width:32px;vertical-align:middle;-ms-flex-negative:0;flex-shrink:0;overflow:hidden}html[dir=ltr] .Nf0DroQfbZfcaaSjQ53MC{margin-right:8px}html[dir=rtl] .Nf0DroQfbZfcaaSjQ53MC{margin-left:8px}._1V-pZ1TukzFi3FL2_U4Y5X{max-width:216px;width:100%;height:100%}._3TAbxFid2sTMSQ8v8sIeQH{font-size:14px;color:"[theme:neutralPrimary, default:#333333]";line-height:19px;max-width:100%}._3TAbxFid2sTMSQ8v8sIeQH,._1XRoVhbyaxndQhy7cIo11E{font-weight:400;display:block;text-overflow:ellipsis;white-space:nowrap;overflow:hidden}._1XRoVhbyaxndQhy7cIo11E{font-size:11px;color:"[theme:neutralSecondary, default:#666666]";line-height:15px;width:216px}html[dir] ._1XRoVhbyaxndQhy7cIo11E{padding-top:1px}._2PBoIqeXeRKbQpPjYUXOH_{width:280px}._3EISB-6HOl0a6XteBa9K8u{font-size:12px;font-weight:400;font-weight:600;color:"[theme:themePrimary, default:#0078D4]";max-width:280px}html[dir=ltr] ._3EISB-6HOl0a6XteBa9K8u{margin-left:1px}html[dir=rtl] ._3EISB-6HOl0a6XteBa9K8u{margin-right:1px}._1LIdXVeATDTlAL3Wafn6_V{position:absolute;top:20px}html[dir=ltr] ._1LIdXVeATDTlAL3Wafn6_V{left:24px}html[dir=rtl] ._1LIdXVeATDTlAL3Wafn6_V{right:24px}html[dir] ._16x5oaOekVnuCtNTMKxz1I{margin:0}',""]),t.locals={attachmentSuggestionButton:"_3Jtu3QV20_qLz8g_h0KpQb",attachmentSuggestionButtonContent:"_1v60Zw1heoE7AYHV2rZARo",attachmentSuggestionButtonImageContainer:"Nf0DroQfbZfcaaSjQ53MC",attachmentSuggestionButtonTextContainer:"_1V-pZ1TukzFi3FL2_U4Y5X",attachmentSuggestionPrimaryText:"_3TAbxFid2sTMSQ8v8sIeQH",attachmentSuggestionSecondaryText:"_1XRoVhbyaxndQhy7cIo11E",attachmentSuggestionButtonRoot:"_2PBoIqeXeRKbQpPjYUXOH_",replyWithHeaderForBottomBar:"_3EISB-6HOl0a6XteBa9K8u",fileIcon:"_1LIdXVeATDTlAL3Wafn6_V",cloudyIcon:"_16x5oaOekVnuCtNTMKxz1I"}},13425:function(e){e.exports={a:"r1b"}},13426:function(e){e.exports={l:"$0b",f:"a1b",a:"b1b",b:"c1b",c:"d1b",d:"e1b",e:"f1b",g:"g1b",h:"h1b",i:"i1b",j:"j1b",k:"k1b"}},13427:function(e,t,r){var n=r(13428),a=r(45);"string"==typeof n&&(n=[[e.i,n]]);for(var i=0;i<n.length;i++)a.loadStyles(n[i][1],!1);n.locals&&(e.exports=n.locals)},13428:function(e,t,r){(t=e.exports=r(44)(!1)).push([e.i,"html[dir] ._1BIi6rH1j5rnLh1OlF1NvI{padding-top:10px}html[dir=ltr] ._1BIi6rH1j5rnLh1OlF1NvI{margin-left:52px}html[dir=rtl] ._1BIi6rH1j5rnLh1OlF1NvI{margin-right:52px}",""]),t.locals={bar:"_1BIi6rH1j5rnLh1OlF1NvI"}},1361:function(e,t,r){"use strict";r.d(t,"b",function(){return i}),r.d(t,"a",function(){return a}),r.d(t,"c",function(){return o});var n=r(4),a=Object(n.action)("FILE_PROVIDER_ADDED",function(e){return{providerViewState:e}}),i=Object(n.action)("FILE_PROVIDER_REMOVED",function(e){return{providerType:e}}),o=Object(n.action)("PROVIDERS_LOADED",function(e){return{providers:e}})},1372:function(e,t,r){"use strict";r.d(t,"a",function(){return o});var n,a=r(1016),i=r(1392);function o(e,t,r,o,c){if(r)return n=n||{extraSmall:Object(a.b)("generic").extraSmall,small:Object(a.b)("generic").small,medium:Object(a.b)("blockedfile").medium,large:Object(a.b)("generic").large,cdn:Object(i.a)("generic_16x16")};switch(c){case"IPM.Note":case"IPM.Note.SMIME":case"IPM.Note.SMIME.MultipartSigned":return Object(a.b)("email");case"IPM.Schedule":case"IPM.Appointment":case"IPM.OLE.CLASS.{00061055-0000-0000-C000-000000000046}":return Object(a.b)("calendar")}return o?Object(a.b)("sharedfolder"):Object(a.a)(e,!1,t)||Object(a.b)("generic")}},1392:function(e,t,r){"use strict";r.d(t,"a",function(){return a});var n=1;function a(e){return"https://r"+(n++%4+1)+".res.outlook.com/owa/prem/images/"+e+".png"}},1429:function(e,t,r){"use strict";var n=r(0),a=r(2764),i=r.n(a),o=r(2068),c=r.n(o);function u(e){var t=c()({ProviderType:e});return i()(t)}var s=r(2765),l=r.n(s),d=r(2069),m=r.n(d);function f(e){var t=m()({ProviderType:e});return l()(t)}var p=r(2650),g=r(67);r.d(t,"a",function(){return P}),r.d(t,"b",function(){return T});var b="code",h="token",S=3e3,v=3;function y(e){return{state:e}}function O(e){return e.state}function x(e){return e.code}function P(e,t,r,a,i){var o={providerType:e,getAuthUrlInfo:null,getCSRFToken:O,getOAuthCode:x};return function e(t,r,a,i,o,c,s){return Object(n.__awaiter)(this,void 0,void 0,function(){var l,d;return Object(n.__generator)(this,function(n){switch(n.label){case 0:return n.trys.push([0,5,,6]),l=void 0,7!==t&&9!==t&&8!==t?[3,2]:[4,f(t)];case 1:return d=n.sent(),l=d.AttachmentDataProviderCreator.ProviderAppKey,a=d.AttachmentDataProviderCreator.AuthorizationUri,[3,4];case 2:return[4,u(t)];case 3:d=n.sent(),l=d.ProviderAppKey,n.label=4;case 4:return r.getAuthUrlInfo=Object(p.d)(t,a,i,l,o,c),[3,6];case 5:return n.sent(),s>0&&setTimeout(function(){return e(t,r,a,i,o,c,--s)},S),[3,6];case 6:return[2]}})})}(e,o,t,r,a,i,v),o}var j=null;function I(){if(!j){(j={})[3]=P(3,"https://app.box.com/api/oauth2/authorize",Object(p.c)(3),b,y),j[2]=P(2,"https://www.dropbox.com/oauth2/authorize",Object(p.b)(2),b,y);var e=P(6,"https://www.facebook.com/dialog/oauth",Object(p.b)(6),h,function(e){return{state:e,scope:"user_photos,email"}});e.getCSRFToken=O,e.getOAuthCode=function(e){return e.access_token},j[6]=e;var t=P(5,"https://accounts.google.com/o/oauth2/auth",p.a+"/ADPRedirect.aspx",b,function(e){var t={state:e,provider:5..toString(),url:Object(p.b)()};return{state:JSON.stringify(t),scope:"https://www.googleapis.com/auth/drive",access_type:"offline",prompt:"consent",include_granted_scopes:"true"}});t.getCSRFToken=function(e){return JSON.parse(e.state).state},j[5]=t,j[1]=P(1,"https://login.live.com/oauth20_authorize.srf",Object(p.c)(1),b,function(e){return{state:e,scope:"wl.basic onedrive.readwrite wl.offline_access"}}),Object(g.f)("doc-fileProvider-wopiClient")&&(j[7]=P(7,"",Object(p.c)(7),b,y),j[8]=P(8,"",Object(p.c)(8),b,y),j[9]=P(9,"",Object(p.c)(9),b,y))}return j}function T(e){var t=I();return e in t?t[e]:null}},1461:function(e,t,r){"use strict";r.d(t,"b",function(){return i}),r.d(t,"a",function(){return o});var n=r(0),a=r(1332),i=function(){return Object(n.__spread)(Object(a.a)().providers.values())},o=function(e){return Object(a.a)().providers.get(e)||null}},14617:function(e,t,r){"use strict";r.r(t);var n=r(0),a=r(4),i=Object(a.action)("setSmartPillBlockVisibility",function(e,t){return{viewState:e,smartPillBlockVisible:t}}),o=Object(a.action)("setSmartPillFeedbackSubmitted",function(e,t){return{item:e,smartPillFeedbackSubmitted:t}}),c=r(67),u=r(63),s=r(1322);function l(e){var t=e.featureName;if("SmartReply"===t)return Object(c.f)("mc-smartReply");if("SmartTime"===t)return Object(c.f)("mc-smartReplyWithCustomMeeting");if("SmartDoc"===t)return Object(c.f)("mc-smartReplyWithDoc");if("SmartTodo"===t||"SmartReminder"===t){var r=Object(s.a)();return r||u.d.info("[isPillTypeEnabled] Disable Smart Todo - Time Panel is unavailable."),Object(c.f)("mc-smartTask")&&r}return u.d.info("[isPillTypeEnabled] Unknown pill type: "+t),!1}function d(e){if(e){if("SmartDoc"===e.featureName)return!0;null==e.confidenceScore&&u.d.info("[isConfidenceScoreAcceptable] confidence score is null. Feature: "+e.featureName+" EntityId: "+e.logData.mainPayload.EID);var t=e.confidenceScore;if(t>0){if(Object(c.f)("mc-smartPillConfidenceLevel_LOW"))return!0;if(Object(c.f)("mc-smartPillConfidenceLevel_MID"))switch(e.featureName){case"SmartTime":case"SmartTask":return t>=70;default:return!0}else switch(e.featureName){case"SmartTime":case"SmartTask":return t>=90;default:return!0}}}return!1}var m=1,f=2,p=3;function g(){var e=Object(c.f)("mc-smartReplyWithTextPositionThird");return[{aggregation:{SmartReply:2,SmartTime:1},arrangement:e?["SmartTime","SmartReply"]:["SmartReply","SmartTime"]},{aggregation:{SmartTime:1},arrangement:["SmartTime"]},{aggregation:{SmartReply:2,SmartDoc:1},arrangement:e?["SmartDoc","SmartReply"]:["SmartReply","SmartDoc"]},{aggregation:{SmartDoc:1},arrangement:["SmartDoc"]},{aggregation:{SmartReply:1,SmartTodo:1,SmartReminder:1},arrangement:e?["SmartTodo","SmartReminder","SmartReply"]:["SmartReply","SmartTodo","SmartReminder"]},{aggregation:{SmartTodo:1,SmartReminder:1},arrangement:["SmartTodo","SmartReminder"]},{aggregation:{SmartReply:2,SmartTodo:1},arrangement:e?["SmartTodo","SmartReply"]:["SmartReply","SmartTodo"]},{aggregation:{SmartTodo:1},arrangement:["SmartTodo"]},{aggregation:{SmartReply:3},arrangement:["SmartReply"]}]}function b(e){if(e)for(var t=function(e){var t,r,a={};try{for(var i=Object(n.__values)(e),o=i.next();!o.done;o=i.next()){var c=o.value;a[c.featureName]=void 0===a[c.featureName]?1:a[c.featureName]+1}}catch(e){t={error:e}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(t)throw t.error}}return a}(e),r=g(),a=0;a<r.length;a++){for(var i=!0,o=r[a],c=0;c<o.arrangement.length;c++){if(o.aggregation[o.arrangement[c]]>(void 0===t[o.arrangement[c]]?0:t[o.arrangement[c]])){i=!1;break}}if(i)return o}return null}var h={selectPills:function(e){return function(e,t){var r=[];return t&&e.length>0&&t.arrangement.forEach(function(a){r.push.apply(r,Object(n.__spread)(function(e,t,r){return e.filter(function(e){return e.featureName===t}).slice(0,r)}(e,a,t.aggregation[a])))}),r}(e,b(e))}};function S(e,t,r,n){var a=[];return e.forEach(function(e){r(e)?a.push(e):(e.logData.mainPayload.renderStory|=n,t.push(e))}),a}var v={arbitratePills:function(e){var t=[],r=[];if(e){var a=S(e,r,l,1),i=S(a,r,d,4);if(i.length>0){if(Object(c.f)("mc-smartPillsRenderingStrategiesV2")){var o=h;t.push.apply(t,Object(n.__spread)(o.selectPills(i)))}else{var u=function(e){if(e){var t=e.some(function(e){return"SmartTime"===e.featureName}),r=e.some(function(e){return"SmartReply"===e.featureName}),n=e.some(function(e){return"SmartDoc"===e.featureName}),a=e.some(function(e){return"SmartTodo"===e.featureName}),i=e.some(function(e){return"SmartReminder"===e.featureName});if(t)return r?{smartReply:{numOfPills:f},smartTime:{numOfPills:m}}:{smartTime:{numOfPills:m}};if(n)return r?{smartReply:{numOfPills:f},smartDoc:{numOfPills:m}}:{smartDoc:{numOfPills:m}};if(a&&i)return r?{smartTodo:{numOfPills:m},smartReminder:{numOfPills:m},smartReply:{numOfPills:m}}:{smartTodo:{numOfPills:m},smartReminder:{numOfPills:m}};if(a)return r?{smartTodo:{numOfPills:m},smartReply:{numOfPills:f}}:{smartTodo:{numOfPills:m}};if(r)return{smartReply:{numOfPills:p}}}return null}(i);if(u)new Map([["SmartReply",u.smartReply],["SmartDoc",u.smartDoc],["SmartTime",u.smartTime],["SmartTodo",u.smartTodo],["SmartReminder",u.smartReminder]]).forEach(function(e,r){var a,o;e&&t.push.apply(t,Object(n.__spread)((a=r,o=e,i.filter(function(e){return e.featureName===a}).slice(0,o.numOfPills))))})}for(var s=function(e){var n=i[e];t.some(function(e){return e===n})||(n.logData.mainPayload.renderStory|=2,r.push(n))},g=0;g<i.length;g++)s(g)}}return{pillsToShow:t,pillsToHide:r,arbitratorId:"complexArbitrator"}}};var y="EntityExtraction/SendContentRequestV21.0",O=3;var x=r(13422),P=Object(a.action)("createMessageWithAttachmentAction",function(e,t){return{item:e,attachment:t}}),j=r(191),I=r(7),T=r(1563),_=r(5),w=r(860),D=r(3342),R=r(1),E=r(13423),k="...",N=30,A=r(9353);function C(e){var t,r,n,a=e.item,i=e.suggestion,o=e.smartPillLogData,c=e.onAttachmentClicked,s=e.dismissMenu,l=R.useCallback(function(){o.mainPayload.timeClicked=(new Date).toISOString(),Object(D.c)(o),Object(D.d)(o.mainPayload.EID,o.mainPayload.position,o.mainPayload.loggableText,"SmartDoc",o.mainPayload.language,o.mainPayload.locale,o.cosmosOnlyData),Object(w.k)(a.ItemId,!0),c(a,i),s()},[a,i,s]);try{t=function(e){var t=Object(I.Ob)("UTC",e.DateModified),r=Object(_.b)(Object(_.a)(E.b),Object(I.X)(t));return[e.FileName,F(e),r].join("\n")}(i),r=F(i),n=function(e){if(e.length<=N)return e;var t=N-k.length,r=Math.ceil(t/2),n=Math.floor(t/2),a=e.substr(0,r),i=e.substr(e.length-n);return""+a+k+i}(function(e){var t="."+e.FileExtension;return e.FileName.indexOf(t)>=0?e.FileName.replace(t,""):e.FileName}(i)+L(i))}catch(e){throw u.d.warn("[AttachmentSuggestionButton_render] Error: "+e.message),e.knownError=!0,e}return R.createElement("button",{className:A.attachmentSuggestionButton,title:t,name:i.FileName,"aria-label":Object(_.b)(Object(_.a)(E.a),i.FileName),"aria-posinset":1,"aria-setsize":7,"aria-disabled":"false",role:"menuitem",onClick:l,tabIndex:0},R.createElement("div",{className:A.attachmentSuggestionButtonContent},R.createElement("div",{className:A.attachmentSuggestionButtonImageContainer,role:"presentation","aria-hidden":"true"},function(e){var t=e.FileName+L(e);return R.createElement(T.a,{fileName:t,contentType:null,isBlocked:!1,isFolder:!1,embeddedItemClass:null,cloudyIconStyle:A.cloudyIcon,fileIconStyle:A.fileIcon})}(i)),R.createElement("div",null,R.createElement("div",{className:A.attachmentSuggestionButtonTextContainer},R.createElement("div",{className:A.attachmentSuggestionPrimaryText},n)),R.createElement("div",{className:A.attachmentSuggestionSecondaryText},r))))}function F(e){var t=null,r=document.createElement("a");r.href=e.Url,t=decodeURIComponent(r.hostname);for(var n=Object(j.a)(),a=decodeURIComponent(r.pathname).split("/"),i=1;i<a.length-1;i++)n?t=a[i]+" < "+t:t+=" > "+a[i];return t}function L(e){return"."+e.FileExtension}var M=Object(a.action)("cacheSmartDocDataAction",function(e,t,r){return{item:e,validPropertyExists:t,entityId:r}}),B="@EntityId";function V(e,t){var r=!1;if(e){if(t)try{r=function(e,t){var r=!1,n=t[B];if(!n){u.d.info("[extractAndCacheSmartDocDataFromProperty] Cannot parse entity ID. Aborting...");var a=new Error("NoEntityIdOnProperty");throw a}M(e,r=!0,n);return r}(e,JSON.parse(t.Value)[0])}catch(e){throw u.d.warn("[parseSmartDocProperty] Malformed property, cannot parse. Error: "+e.message),e.knownError=!0,e}else u.d.info("[parseSmartDocProperty] No property found.");r||M(e,r)}else u.d.info("[parseSmartDocProperty] No item.")}function U(e){return e.Source.LastModifiedBy?e.Source.LastModifiedBy.DisplayName:e.Source.LastShared.SharedBy.DisplayName}var z=r(1145),H=r(463),Q="application/json;charset=utf-8",q="/search/api/v1/recommendations",G="suggestedattachments";function X(e){return Object(n.__awaiter)(this,void 0,void 0,function(){var t,r,a,i,o,c,s,l;return Object(n.__generator)(this,function(n){switch(n.label){case 0:t=null,r="",n.label=1;case 1:return n.trys.push([1,7,8,9]),[4,J()];case 2:return a=n.sent(),i=function(e,t){var r={};r.headers=new Headers,r.headers.set("Authorization","Bearer "+e),r.headers.set("Content-Type",Q),r.method="POST";var n=Object(z.c)();n&&r.headers.append("X-AnchorMailbox",n);r.headers.set("X-Client-LocalTime",(new Date).toISOString());var a=[];t&&a.push(G);a.length&&r.headers.set("X-Client-Flights",a.join(","));var i={EntityRequests:[t?{Context:{EntityId:t}}:{}],Scenario:{Name:"AttachFile"}};return r.body=JSON.stringify(i),r}(a,e),[4,fetch(q,i)];case 3:return(o=n.sent())&&200==o.status?[4,o.text()]:[3,5];case 4:return c=n.sent(),s=JSON.parse(c),t=function(e,t){try{var r=e.EntitySets[0].ResultSets[0].Results;return r.map(function(e){return function(e,t){try{var r=!!e.Source.LastShared&&!e.Source.WebUrl,n=e.Source.Author?e.Source.Author.DisplayName:"";return{Author:n,CreatedBy:n,DateAccessed:e.Source.LastAccessDateTime||e.Source.UserRelationship&&e.Source.UserRelationship.LastAccessDateTime,DateCreated:null,DateModified:e.Source.LastModifiedDateTime,Endpoint:t?3:r?2:1,FileExtension:e.Source.FileExtension,FileName:e.Source.FileName,FileSize:e.Source.FileSize,FileSourceType:e.ContentSource||e.Provenance,Id:r?e.Source.LastShared.AttachmentId:e.Id,ModifiedBy:U(e),ReferenceId:e.ReferenceId,SourceTitle:e.Source.SiteTitle||e.Source.LastShared.SharingSubject,Text:e.Source.Title,Title:e.Source.Title,Url:e.Source.Url}}catch(e){return u.d.info("[convertMRUAttachmentToReplyWithAttachmentSuggestion] Error accessing MRUAttachment properties: "+e.message),null}}(e,t)})}catch(e){return u.d.info("[fetchMRUSuggestions_getAttachmentsFromResponse] Error: "+e.message),[]}}(s,!!e),[3,6];case 5:r=o?o.status+"-"+o.statusText:"No response",n.label=6;case 6:return[3,9];case 7:return l=n.sent(),r=l.message,[3,9];case 8:return r&&u.d.info("getMRUSuggestions: Error "+r),[2,t];case 9:return[2]}})})}function J(){return Object(n.__awaiter)(this,void 0,void 0,function(){var e,t,r;return Object(n.__generator)(this,function(a){switch(a.label){case 0:return e=Object(n.__read)(Object(H.getAccessTokenforResourceAsLazy)(window.location.origin),2),t=e[0],r=e[1],t?[3,2]:[4,r];case 1:t=a.sent(),a.label=2;case 2:return[2,t]}})})}var W=r(3316),K=r(3485),Z=r(130),Y=r(9353);function $(e){return Object(n.__awaiter)(this,void 0,void 0,function(){var t,r,a;return Object(n.__generator)(this,function(n){switch(n.label){case 0:return e.SmartDocData&&!e.SmartDocData.EntityId?[2,[]]:e.SmartDocData?[3,3]:[4,W.c.import()];case 1:return[4,n.sent()(e.ItemId.Id,K.a.SmartDoc)];case 2:(t=n.sent())&&(r=function(e,t){var r=e.ExtendedProperty;if(r)for(var n=r.length,a=0;a<n;a++){var i=r[a];if(i.ExtendedFieldURI.PropertyName===t)return i}return null}(t,y),V(t,r)),n.label=3;case 3:return e.SmartDocData&&e.SmartDocData.EntityId?[4,X(e.ItemId.Id)]:[3,5];case 4:return(a=n.sent())&&a.length>0?[2,[ee(function(e,t){void 0===t&&(t=O);var r=[],n=null;if(e)for(var a=0;a<e.length&&r.length<t;a++)(n=e[a])?r.push(n):u.d.info("[extractAttachmentSuggestions] mru suggestion is null");return r}(a),e)]]:[2,[]];case 5:return[2,[]];case 6:return[2]}})})}function ee(e,t){var r=Object(D.b)("SmartDoc","suggestions");r.mainPayload.suggestionsInMenu=e.length,r.mainPayload.EID=t.SmartDocData.EntityId;var n={items:[{key:"replyWithHeader",name:Object(_.a)(x.b),title:Object(_.a)(x.b),itemType:Z.a.Header,iconProps:{iconName:null,styles:{root:{margin:"0px",width:"0px"}}},className:Y.replyWithHeaderForBottomBar}].concat(e.map(function(e,n){return function(e,t,r,n){return{key:"suggestion"+t,className:Y.attachmentSuggestionButtonRoot,onRender:function(t,a){return R.createElement(C,{item:r,suggestion:e,smartPillLogData:n,onAttachmentClicked:P,dismissMenu:a})}}}(e,n,t,r)}))};return{ariaLabel:Object(_.a)(x.a),featureName:"SmartDoc",icon:{iconName:"Attach"},logData:r,onClick:null,index:0,text:Object(_.a)(x.a),menuProps:n}}var te=r(937),re=r(1579);function ne(e,t){return Object(n.__awaiter)(this,void 0,void 0,function(){var r;return Object(n.__generator)(this,function(n){switch(n.label){case 0:return r=null,Object(re.i)()!==re.c.NotLoaded?[3,2]:[4,re.k.import()];case 1:return n.sent()(function(n){r=ae(Object(re.g)(),e),t(r)}),[3,3];case 2:r=ae(Object(re.g)(),e),t(r),n.label=3;case 3:return[2]}})})}function ae(e,t){var r=function(e){for(var t=0;t<e.length;t++)if(0===e[t].type)return e[t].model.Id;return u.d.warn("createCloudFileFromAttachmentData: Could not get OneDrive Pro provider ID. Attachment will not upload."),""}(e);return{fileType:te.a.CloudSuggestion,name:t.FileName,size:null,providerId:r,providerType:0,location:t.Url,providerEndpointUrl:null,isFolder:!1,fileId:t.Id,fileParentId:null,thumbnailUrl:null,previewUrl:null,type:null}}var ie=r(991);Object(a.orchestrator)(P,function(e){return Object(n.__awaiter)(this,void 0,void 0,function(){var t,r,a,i=this;return Object(n.__generator)(this,function(o){switch(o.label){case 0:t=e.item,r=e.attachment,o.label=1;case 1:return o.trys.push([1,3,,4]),[4,ne(r,function(e){return Object(n.__awaiter)(i,void 0,void 0,function(){return Object(n.__generator)(this,function(r){return function(e,t){Object(n.__awaiter)(this,void 0,void 0,function(){var r,a,i;return Object(n.__generator)(this,function(n){switch(n.label){case 0:return t?[4,ie.v.import()]:[3,5];case 1:return r=n.sent(),[4,ie.i.import()];case 2:return a=n.sent(),(i=Object(ie.c)(e.ConversationId.Id))?[3,4]:[4,r({referenceItemOrId:e,isReplyAll:!0,useFullCompose:!1,actionSource:null,instrumentationContexts:null,conversationId:e.ConversationId.Id,body:null})];case 3:i=n.sent(),n.label=4;case 4:a([t],i,{isInline:!1,isHiddenInline:!1,shouldShare:!0},null,null,null,null),n.label=5;case 5:return[2]}})})}(t,e),[2]})})})];case 2:return o.sent(),[3,4];case 3:return a=o.sent(),u.d.error("[createMessageWithAttachmentOrchestrator] Error when creating cloud file: "+a.message),[3,4];case 4:return[2]}})})});Object(a.mutator)(M,function(e){var t={EntityId:void 0},r=e.item,n=e.validPropertyExists,a=e.entityId;n&&(t.EntityId=a),r.SmartDocData=t});var oe="EntityExtraction/SmartReplyForEmail",ce=r(13425),ue=Object(a.action)("updateSIGSDataOnClickAction",function(e,t,r){return{composeViewState:e,timeClicked:t,clickIndex:r}}),se=r(2704);var le=Object(a.action)("cacheSmartReplyDataAction",function(e,t,r,n,a){return{item:e,validPropertyExists:t,smartReplies:r,loggableSmartReplies:n,smartReplyExtractionID:a}}),de="2018-06-20T00:00:00.0000000Z",me="@extractionTimeUtc",fe="@EntityId",pe=3;function ge(e,t){var r=!1;if(e){if(t)try{var n=JSON.parse(t.Value)[0],a=n[me];if(!a){u.d.warn("[getSmartRepliesForItem_parseSmartReplyProperty] Time stamp not found on property, aborting smart reply parsing.");var i=new Error("NoTimeStamp");throw i.knownError=!0,i}Date.parse(a)>=Date.parse(de)&&(r=function(e,t){for(var r=t[fe],n=[],a=[],i=!1,o=t.entities.length,c=0;c<o;c++)n.push(t.entities[c].value),a.push(t.entities[c].valueRaw||t.entities[c].value);if(!r||n.length!=pe){u.d.info("[getSmartRepliesForItem_extractAndCacheSmartRepliesFromProperty] Unexpected number of smart replies on item. Expected "+pe+" but found "+n.length);var s=new Error("NumberOfSmartRepliesIs"+n.length);throw s.knownError=!0,s}le(e,i=!0,n,a,r);return i}(e,n))}catch(e){throw u.d.warn("[getSmartRepliesForItem_parseSmartReplyProperty] Malformed property, cannot parse. Error: "+e.message),e.knownError=!0,e}else u.d.info("[getSmartRepliesForItem_parseSmartReplyProperty] No property found.");r||le(e,r)}else u.d.info("[getSmartRepliesForItem_parseSmartReplyProperty] No item.")}function be(e){return Object(n.__awaiter)(this,void 0,void 0,function(){var t,r;return Object(n.__generator)(this,function(a){switch(a.label){case 0:return e?e.SmartReplyData?[3,3]:[4,W.c.import()]:[3,4];case 1:return[4,a.sent()(e.ItemId.Id,K.a.SmartReply)];case 2:(t=a.sent())&&(r=function(e,t){var r=e.ExtendedProperty;if(r)for(var n=r.length,a=0;a<n;a++){var i=r[a];if(i.ExtendedFieldURI.PropertyName===t)return i}return null}(t,oe),ge(t,r)),a.label=3;case 3:return e.SmartReplyData&&e.SmartReplyData.ExtractionID?[2,e.SmartReplyData.SmartReplies.map(function(t,r){return function(e,t,r,a,i){var o=this,c=Object(D.b)("SmartReply",r);return c.mainPayload.EID=a,c.mainPayload.confidenceScore=i+1,{ariaLabel:Object(_.b)(Object(_.a)(ce.a),t),featureName:"SmartReply",onClick:function(r){return Object(n.__awaiter)(o,void 0,void 0,function(){var a;return Object(n.__generator)(this,function(n){switch(n.label){case 0:return[4,se.j.importAndExecute(e.ItemId.Id,e.ConversationId.Id,t,1)];case 1:return a=n.sent(),ue(a,r.logData.mainPayload.timeClicked,r.logData.mainPayload.position),Object(w.k)(e.ItemId,!0),[2]}})})},logData:c,index:i,text:t,toolTip:t,confidenceScore:c.mainPayload.confidenceScore}}(e,t,e.SmartReplyData.LoggableSmartReplies[r],e.SmartReplyData.ExtractionID,r)})]:[3,5];case 4:u.d.info("[getSmartRepliesForItem] No item, cannot produce smart replies."),a.label=5;case 5:return[2,[]]}})})}var he=r(20),Se=(Object(a.mutator)(le,function(e){var t={SmartReplies:null,LoggableSmartReplies:null,ExtractionID:null,SuggestionAppropriatenessMap:null,FeedbackSubmitted:!1},r=e.item,n=e.validPropertyExists,a=e.smartReplies,i=e.loggableSmartReplies,o=e.smartReplyExtractionID;if(n){t={SmartReplies:a,LoggableSmartReplies:i,ExtractionID:o,SuggestionAppropriatenessMap:new he.ObservableMap,FeedbackSubmitted:!1};for(var c=0;c<a.length;c++){var u=String(c);t.SuggestionAppropriatenessMap.set(u,"")}}r.SmartReplyData=t}),Object(a.mutator)(ue,function(e){var t=e.composeViewState,r=e.timeClicked,n=e.clickIndex;t&&(t.smartReplyComposeSIGSData={isSmartSuggestionsClicked:!0,suggestionsClickedTime:r,clickIndex:n})}),r(9354));var ve="EntityExtraction/Events1.0";var ye=r(322),Oe=r(79);var xe=Object(a.action)("cacheSmartTimeExtendedPropertyAction",function(e,t,r){return{item:e,validPropertyExists:t,smartTimesExtendedProp:r}}),Pe="@EntityId",je="confidence";var Ie=r(1263),Te=r(7345),_e=r(873),we=r(761);function De(){var e=Object(c.f)("mc-smartReplyWithMeeting-Cortana"),t=Object(we.c)(we.a.CalendarHelp).calendarHelpEnabled;return e&&t}function Re(e){return Object(n.__awaiter)(this,void 0,void 0,function(){var t,r,a,i,o,s,l,d,m,f,p,g;return Object(n.__generator)(this,function(b){switch(b.label){case 0:return t=[],e?e.SmartTimeExtendedProperty?[3,3]:[4,W.c.import()]:[3,7];case 1:return[4,b.sent()(e.ItemId.Id,K.a.SmartTime)];case 2:(r=b.sent())&&(a=function(e){var t=null;if(e){var r=e.ExtendedProperty;r&&r.some(function(e){return e.ExtendedFieldURI.PropertyName==ve&&(t=e,!0)})}return t}(r),function(e,t){var r,a;if(t){var i=null,o=!1;try{var c=JSON.parse(t.Value);if(c&&c.length>0){var s=c[0][Pe],l=c[0][je];try{for(var d=Object(n.__values)(c),m=d.next();!m.done;m=d.next()){var f=m.value;if(f.times&&f.times.length>0){var p=f.times[0];i={beginingOfTimeRange:p.beginingOfTimeRange,endOfTimeRange:p.endOfTimeRange,duration:p.duration,entityId:s,hasIntent:!0,confidenceScore:l},o=!0}}}catch(e){r={error:e}}finally{try{m&&!m.done&&(a=d.return)&&a.call(d)}finally{if(r)throw r.error}}}}catch(e){throw u.d.warn("[getSmartTimeForItem_parseSmartTimeProperty] Malformed property, cannot parse. Error: "+e.message),e.knownError=!0,e}finally{xe(e,o,i)}}else u.d.info("[getSmartTimeForItem_parseSmartTimeProperty] No smart time extended property found.")}(r,a)),b.label=3;case 3:return(i=e.SmartTimeExtendedProperty)?(o=i.entityId,s=100*i.confidenceScore,l=null,d=null,Object(c.f)("mc-smartReplyWithMeeting-SuggestedTimeToCAS")&&(l=function(e){var t=null;if(e&&e.SmartTimeExtendedProperty)try{var r=Object(I.ic)(e.SmartTimeExtendedProperty.beginingOfTimeRange);if(Object(ye.d)(r)){var n=e.SmartTimeExtendedProperty.duration,a=Number(n);a<=0&&(a=Object(Oe.b)()),t={startTime:r,endTime:Object(I.h)(r,a)}}}catch(e){throw u.d.warn("[getSmartTimeSuggestion] Unable to parse suggested time. Error: "+e.message),e.knownError=!0,e}return t}(e))?[4,Object(Te.a)(e,l)]:[3,5]):[3,6];case 4:b.sent(),d=Object(_e.b)().conversationReadingPaneViewState.calendarInlineComposeViewState,b.label=5;case 5:m=e,f=De(),p=function(e,t,r,n,a){var i=Object(D.b)("SmartTime",Object(_.a)(Se.d)),o=null!=n,c=r.ToRecipients?r.ToRecipients.length:0,u=r.CcRecipients?r.CcRecipients.length:0;i.mainPayload.EID=e,i.mainPayload.confidenceScore=t,i.mainPayload.hasSuggestedTime=o,i.mainPayload.NumToRecipient=c,i.mainPayload.NumCCRecipient=u,i.mainPayload.isCalendarHelpEnabled=a,o&&(i.mainPayload.suggestedStartTime=n.startTime,i.mainPayload.suggestedEndTime=n.endTime);return i}(o,s,m,l,f),g=null,f&&(g={items:Ne(e,d,o,m,p)}),t.push(function(e,t,r,n,a,i,o){return{ariaLabel:Object(_.a)(Se.d),featureName:"SmartTime",onClick:r,index:e,logData:n,text:t,toolTip:t,icon:i,confidenceScore:a,menuProps:o}}(t.length,Object(_.a)(Se.d),function(){return Ee(e,d,o,m)},p,s,{iconName:"DateTime2"},g)),b.label=6;case 6:return[3,8];case 7:u.d.info("[getSmartTimesForItem] No item, cannot produce smart times."),b.label=8;case 8:return[2,t]}})})}function Ee(e,t,r,n){Ie.m.importAndExecute(e.ItemId.Id,t,!1,null,r,n.InternetMessageId)}function ke(e,t,r,n){var a={data:[e.mainPayload]};a.data[0].subtype=t,a.data[0].timeClicked=n,Object(D.g)("SmartPillClicked",[JSON.stringify(a)],r)}function Ne(e,t,r,n,a){var i=[];return i.push({key:"OutlookMeeting",text:Object(_.a)(Se.c),onClick:function(){ke(a,"OutlookMeeting",n.InternetMessageId,(new Date).toISOString()),Ee(e,t,r,n)}}),i.push({key:"CortanaMeeting",text:Object(_.a)(Se.a),onClick:function(){ke(a,"CortanaMeeting",n.InternetMessageId,(new Date).toISOString()),function(e){se.j.importAndExecute(e.ItemId.Id,e.ConversationId.Id,Object(_.a)(Se.b),2)}(e)}}),i}Object(a.mutator)(xe,function(e){var t={beginingOfTimeRange:null,endOfTimeRange:null,duration:null,entityId:null,hasIntent:!1,confidenceScore:0},r=e.item,n=e.validPropertyExists,a=e.smartTimesExtendedProp;n&&a&&(t={beginingOfTimeRange:a.beginingOfTimeRange,endOfTimeRange:a.endOfTimeRange,duration:a.duration,entityId:a.entityId,hasIntent:!0,confidenceScore:a.confidenceScore}),r.SmartTimeExtendedProperty=t});var Ae=r(8037),Ce=r(2106),Fe=r(4302);function Le(e,t,r,n){var a=Object(D.b)("SmartTodo",r);return a.mainPayload.confidenceScore=e.confidenceScore,a.mainPayload.EID=e.entityId,{ariaLabel:Object(_.a)(Ae.a),featureName:"SmartTodo",icon:{iconName:"ToDoLogoOutline"},onClick:function(){!function(e,t,r){if(Object(s.a)())Ce.f.importAndExecute("SmartTask"),e&&t&&Fe.b.importAndExecute(e,t,r)}(e.description,t,e.entityId)},logData:a,index:n,text:r,toolTip:r,confidenceScore:e.confidenceScore}}var Me=Object(a.action)("cacheSmartTaskData",function(e,t,r){return{item:e,validPropertyExists:t,smartTasks:r}}),Be="@EntityId",Ve="@sourceConfidenceScore";function Ue(e,t){var r=!1;if(e){if(t)try{r=function(e,t){var r=JSON.parse(t.Value),n=!1;if(!t)return u.d.info("[getSmartTaskForItem_parseSmartTaskProperty] No smart task extended property found."),n;var a=[];if(r&&r.length>0)for(var i=r.length,o=0;o<i;o++){var c=r[o];a.push({entityId:c[Be],description:c.description,confidenceScore:100*Number(c[Ve])})}a.length>0?Me(e,n=!0,a):u.d.info("[getSmartTasksForItem_extractAndCacheSmartTaskFromProperty] There are zero smart tasks for this item");return n}(e,t)}catch(e){throw u.d.warn("[getSmartTasksForItem_parseSmartTaskProperty] Malformed property, cannot parse. Error: "+e.message),e.knownError=!0,e}else u.d.info("[getSmartTasksForItem_parseSmartTaskProperty] No property found.");r||Me(e,!1)}else u.d.info("[getSmartTasksForItem_parseSmartTaskProperty] No item found.")}var ze,He="EntityExtraction/RequestForAction1.0";function Qe(e,t){return Object(n.__awaiter)(this,void 0,void 0,function(){var r,a;return Object(n.__generator)(this,function(n){switch(n.label){case 0:return e?e.SmartTaskData?[3,3]:[4,W.c.import()]:[3,4];case 1:return[4,n.sent()(e.ItemId.Id,K.a.SmartTask)];case 2:(r=n.sent())&&(a=function(e){var t=null;if(e){var r=e.ExtendedProperty;r&&r.some(function(e){return e.ExtendedFieldURI.PropertyName==He&&(t=e,!0)})}return t}(r),Ue(r,a)),n.label=3;case 3:return e.SmartTaskData&&e.SmartTaskData.SmartTasks?[2,e.SmartTaskData.SmartTasks.map(function(r,n){return t==ze.Todo&&e.ItemId?Le(r,e.ItemId.Id,Object(_.a)(Ae.a),n):function(e,t,r,n,a){var i=Object(D.b)("SmartReminder",n);return i.mainPayload.confidenceScore=e.confidenceScore,i.mainPayload.EID=e.entityId,{ariaLabel:Object(_.a)(Ae.b),featureName:"SmartReminder",icon:{iconName:"AddEvent"},onClick:function(){Ie.m.importAndExecute(t,null,!1,null,e.entityId,r,!0)},logData:i,index:a,text:n,toolTip:n,confidenceScore:e.confidenceScore}}(r,e.ItemId.Id,e.InternetMessageId,Object(_.a)(Ae.b),n)})]:[3,5];case 4:u.d.info("[getSmartTodosOrRemindersForItem] No item, cannot produce smart tasks."),n.label=5;case 5:return[2,[]]}})})}!function(e){e[e.Todo=0]="Todo",e[e.Reminder=1]="Reminder"}(ze||(ze={}));Object(a.mutator)(Me,function(e){var t={SmartTasks:null},r=e.item;if(e.validPropertyExists){var n=e.smartTasks;t.SmartTasks=n}r.SmartTaskData=t});function qe(e){var t=[];return t.push(function(e){var t=this;return{buildPills:function(){return Object(n.__awaiter)(t,void 0,void 0,function(){return Object(n.__generator)(this,function(t){return[2,Re(e)]})})},getName:function(){return"SmartTime"}}}(e)),t.push(function(e){var t=this;return{buildPills:function(){return Object(n.__awaiter)(t,void 0,void 0,function(){return Object(n.__generator)(this,function(t){return[2,$(e)]})})},getName:function(){return"SmartDoc"}}}(e)),t.push(function(e){var t=this;return{buildPills:function(){return Object(n.__awaiter)(t,void 0,void 0,function(){return Object(n.__generator)(this,function(t){return[2,be(e)]})})},getName:function(){return"SmartReply"}}}(e)),t.push(function(e){var t=this;return{buildPills:function(){return Object(n.__awaiter)(t,void 0,void 0,function(){return Object(n.__generator)(this,function(t){return[2,Qe(e,ze.Todo)]})})},getName:function(){return"SmartTodo"}}}(e)),Object(c.f)("mc-smartTaskWithReminder")&&t.push(function(e){var t=this;return{buildPills:function(){return Object(n.__awaiter)(t,void 0,void 0,function(){return Object(n.__generator)(this,function(t){return[2,Qe(e,ze.Reminder)]})})},getName:function(){return"SmartReminder"}}}(e)),t}function Ge(e){var t=this;return{updateLogData:function(r){return Object(n.__awaiter)(t,void 0,void 0,function(){var t,a,i;return Object(n.__generator)(this,function(n){return e&&(t=e.stampedLanguage&&e.stampedLanguage.language,a=e.stampedLanguage&&e.stampedLanguage.locale,i=e.InternetMessageId,r.forEach(function(e){e.logData.mainPayload.language=t,e.logData.mainPayload.locale=a,e.logData.cosmosOnlyData=i})),[2]})})},getName:function(){return"ItemLevelDataUpdater"}}}var Xe=Object(a.action)("updateItemLanguageAction",function(e){return{item:e}});function Je(e){var t=this;return{preRun:function(){return Object(n.__awaiter)(t,void 0,void 0,function(){var t;return Object(n.__generator)(this,function(r){switch(r.label){case 0:return[4,W.c.import()];case 1:return[4,r.sent()(e.ItemId.Id,K.a.LanguageAndLocale)];case 2:return(t=r.sent())&&!t.stampedLanguage&&Xe(t),[2]}})})},getName:function(){return"LanguagePreRunner"}}}var We=r(13426);function Ke(e,t){var r;t.UniqueBody?r=t.UniqueBody.Value:t.NormalizedBody&&(r=t.NormalizedBody.Value);var n={subtitle:void 0,dSATOptions:void 0,donationJson:{messageBody:r}},a=e.some(function(e){return"SmartTime"===e.featureName});return e.some(function(e){return"SmartReply"===e.featureName})?(n.subtitle=Object(_.a)(We.f),n.dSATOptions=a?[{logString:"They aren't relevant",uiString:Object(_.a)(We.a)},{logString:"They don't sound like me",uiString:Object(_.a)(We.c)},{logString:"They're offensive or rude",uiString:Object(_.a)(We.d)},{logString:"I'm not the person who should schedule the meeting",uiString:Object(_.a)(We.i)},{logString:"I don't want help scheduling a meeting",uiString:Object(_.a)(We.k)},{logString:"Other",uiString:Object(_.a)(We.e)}]:[{logString:"They aren't relevant",uiString:Object(_.a)(We.a)},{logString:"The meaning isn't clear",uiString:Object(_.a)(We.b)},{logString:"They don't sound like me",uiString:Object(_.a)(We.c)},{logString:"They're offensive or rude",uiString:Object(_.a)(We.d)},{logString:"Other",uiString:Object(_.a)(We.e)}]):a?(n.subtitle=Object(_.a)(We.l),n.dSATOptions=[{logString:"The meeting is already on my calendar",uiString:Object(_.a)(We.g)},{logString:"A meeting suggestion isn't relevant",uiString:Object(_.a)(We.h)},{logString:"I'm not the person who should schedule the meeting",uiString:Object(_.a)(We.i)},{logString:"I want to schedule the meeting later",uiString:Object(_.a)(We.j)},{logString:"I don't want help scheduling a meeting",uiString:Object(_.a)(We.k)},{logString:"Other",uiString:Object(_.a)(We.e)}]):n.subtitle=Object(_.a)(We.f),n}var Ze=r(5125);var Ye=r(6562),$e=r(105),et=r(8013),tt=r(13427),rt=function(e){function t(t){var r=e.call(this,t)||this,n=r.props.item;return r.smartPillBuilders=qe(n),r.smartPillArbitrator=v,r.smartPillLogDataUpdaters=function(e){return[Ge(e)]}(n),r.smartPillPreRunners=function(e){return[Je(e)]}(n),r.loggedToSIGS=!1,r}return Object(n.__extends)(t,e),t.prototype.componentDidMount=function(){this.runSmartPillBuilders()},t.prototype.componentDidUpdate=function(){this.loggedToSIGS||(Object(Ye.b)(this.props.item),this.loggedToSIGS=!0)},t.prototype.componentWillUnmount=function(){this.smartPillBuilders=null,this.smartPillArbitrator=null,this.smartPillData=null,this.smartPillPreRunners=null,i(this.props.viewState,!1)},t.prototype.render=function(){var e=this.props,t=e.item,r=e.viewState.smartPillBlockVisible;if(!!t.RightsManagementLicenseData||!r||!this.smartPillData||0==this.smartPillData.pillsToShow.length&&0==this.smartPillData.pillsToHide.length)return null;var n=this.smartPillData.pillsToShow.length>0;return R.createElement("div",{className:n?tt.bar:void 0},R.createElement(et.a,{arbitratedPills:this.smartPillData,enableFeedbackForm:!t.smartPillFeedbackSubmitted,feedbackData:Ke(this.smartPillData.pillsToShow,t)}))},t.prototype.runSmartPillBuilders=function(){return Object(n.__awaiter)(this,void 0,void 0,function(){var e;return Object(n.__generator)(this,function(t){switch(t.label){case 0:return u.d.info("[MailSmartPillBlock] Running smart pill builders"),e=this,[4,Object(D.a)(this.smartPillBuilders,this.smartPillArbitrator,this.smartPillPreRunners,this.smartPillLogDataUpdaters,3e3)];case 1:return e.smartPillData=t.sent(),r=this.props.item,n=this.smartPillData,a=n?n.pillsToShow.filter(function(e){return"SmartReply"===e.featureName}):[],o=a.length>0?a[0].logData.mainPayload.EID:"",c=n&&n.pillsToShow.length>0?"True":"False",s="True"===c?n.pillsToShow.map(function(e){return e.featureName}).toString():"",l="True"===c?n.pillsToShow.map(function(e){return e.text}).join("$"):"",Object(Ze.a)(r.ItemId.Id,c,s,l,o),this.smartPillData&&this.smartPillData.pillsToShow.length>0&&i(this.props.viewState,!0),[2]}var r,n,a,o,c,s,l})})},t=Object(n.__decorate)([$e.observer],t)}(R.Component),nt=(Object(a.mutator)(i,function(e){e.viewState.smartPillBlockVisible=e.smartPillBlockVisible}),Object(a.mutator)(o,function(e){e.item.smartPillFeedbackSubmitted=e.smartPillFeedbackSubmitted}),r(4876));function at(e){var t=function(e){var t=e.ExtendedProperty;if(t){var r=t.filter(function(e){return e.ExtendedFieldURI.PropertyName===nt.a});if(r.length>0)return r[0]}return null}(e),r=void 0,n=void 0,a=0,i=void 0;try{if(t){var o=JSON.parse(t.Value)[0],c=o[nt.c],s=o[nt.d];i=o[nt.b],n=Object.keys(s)[0],r=c&&c[nt.e]&&c[nt.e].toLowerCase(),a=parseInt(Object.values(s)[0])}}catch(e){u.d.info("[getStampedLanguage] Failed to parse property, error: "+e.message)}return{locale:r,language:n,confidenceScore:a,entityId:i}}Object(a.mutator)(Xe,function(e){var t=e.item;t.stampedLanguage=at(t)});r.d(t,"MailSmartPillBlock",function(){return rt})},1529:function(e,t,r){"use strict";r.d(t,"b",function(){return n}),r.d(t,"a",function(){return i}),r.d(t,"c",function(){return o});var n,a=r(0);!function(e){e[e.Groups=1e4]="Groups"}(n||(n={}));var i=Object.freeze([1,3,2,6,5,7,8,9]),o=Object.freeze(Object(a.__spread)(i,[0,4,10]))},1563:function(e,t,r){"use strict";r.d(t,"a",function(){return u});var n=r(1140);r.d(t,"c",function(){return n.a});var a=r(1372);r.d(t,"d",function(){return a.a});var i=r(1016);r.d(t,"e",function(){return i.a}),r.d(t,"b",function(){return i.b});var o=r(51),c=new o.c(function(){return r.e(239).then(r.bind(null,2980))}),u=Object(o.d)(c,function(e){return e.CloudIconWithOverlay})},1579:function(e,t,r){"use strict";var n=r(51),a=r(1994),i=r(1862),o=(r(1332),r(1361)),c=r(1529),u=(r(2606),r(2533),r(1461));var s=r(1835),l=r(1653),d=r(1429);r.d(t,"k",function(){return f}),r.d(t,"m",function(){return p}),r.d(t,"j",function(){return g}),r.d(t,"l",function(){return b}),r.d(t,"b",function(){return a.a}),r.d(t,"h",function(){return i.a}),r.d(t,"d",function(){return o.a}),r.d(t,"e",function(){return o.b}),r.d(t,"n",function(){return o.c}),r.d(t,"a",function(){return c.b}),r.d(t,"g",function(){return u.b}),r.d(t,"i",function(){return s.a}),r.d(t,"c",function(){return l.a}),r.d(t,"f",function(){return d.b});var m=new n.c(function(){return Promise.all([r.e(7),r.e(8),r.e(12),r.e(27),r.e(242)]).then(r.bind(null,14715))}),f=new n.b(m,function(e){return e.loadProviders}),p=new n.b(m,function(e){return e.removeFileProvider}),g=new n.b(m,function(e){return e.addFileProvider}),b=new n.b(m,function(e){return e.removeAndAddFileProvider})},1653:function(e,t,r){"use strict";var n;r.d(t,"a",function(){return n}),function(e){e[e.Loaded=0]="Loaded",e[e.Loading=1]="Loading",e[e.NotLoaded=2]="NotLoaded"}(n||(n={}))},1835:function(e,t,r){"use strict";r.d(t,"a",function(){return a});var n=r(1332);function a(){return Object(n.a)().loadState}},1862:function(e,t,r){"use strict";r.d(t,"a",function(){return u});var n=r(2763),a=r(2532),i=r(2686),o=r(5),c=r(162);function u(e,t){if(void 0===t&&(t=!1),t)return"";switch(e){case 0:return Object(o.a)(i.b);case 1:return Object(o.a)(i.a);case 2:case 9:return Object(o.a)(n.b);case 3:case 7:return Object(o.a)(n.a);case 5:return Object(o.a)(n.e);case 6:return Object(o.a)(n.d);case 4:return Object(o.a)(n.f);case 10:return Object(o.a)(a.b);case 8:return Object(o.a)(n.c);default:return Object(c.a)(e)}}},1994:function(e,t,r){"use strict";var n;!function(e){e[e.None=0]="None",e[e.Images=1]="Images"}(n||(n={})),t.a=n},2068:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0);t.default=function(e){return n.__assign({__type:"GetNewAttachmentDataProviderCreationInfoRequest:#Exchange"},e)}},2069:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0);t.default=function(e){return n.__assign({__type:"GetAttachmentDataProviderCreatorRequest:#Exchange"},e)}},2106:function(e,t,r){"use strict";r.d(t,"a",function(){return i}),r.d(t,"b",function(){return o}),r.d(t,"e",function(){return c}),r.d(t,"f",function(){return u}),r.d(t,"g",function(){return s}),r.d(t,"d",function(){return l}),r.d(t,"c",function(){return d});var n=r(51),a=new n.c(function(){return Promise.all([r.e(0),r.e(1),r.e(2),r.e(3),r.e(475)]).then(r.bind(null,3476))}),i=Object(n.d)(a,function(e){return e.TimePanel}),o=Object(n.d)(a,function(e){return e.TimePanelHeaderBar}),c=(new n.a(a,function(e){return e.preloadTimePanelData}),new n.a(a,function(e){return e.openEventDetailsView})),u=(new n.a(a,function(e){return e.openAttendeeTrackingView}),new n.a(a,function(e){return e.closeAttendeeTrackingView}),new n.a(a,function(e){return e.openTasksView})),s=new n.a(a,function(e){return e.openCalendarView}),l=new n.a(a,function(e){return e.openConflictsView}),d=new n.a(a,function(e){return e.closeConflictsView});new n.a(a,function(e){return e.openEventQuickComposeView})},2532:function(e){e.exports={a:"kHa",b:"lHa"}},2533:function(e,t,r){"use strict";r.d(t,"a",function(){return c});var n=r(41),a=r(246),i=r(162),o=r(67);function c(e){var t=Object(n.a)();switch(e){case 5:return t.AttachmentPolicy.GoogleDriveAttachmentsEnabled&&t.AttachmentPolicy.ThirdPartyAttachmentsEnabled&&Object(o.f)("doc-fileProvider-gdrive");case 4:case 0:return!0;case 3:return t.AttachmentPolicy.BoxAttachmentsEnabled&&t.AttachmentPolicy.ThirdPartyAttachmentsEnabled&&Object(o.f)("doc-fileProvider-box");case 2:return t.AttachmentPolicy.DropboxAttachmentsEnabled&&t.AttachmentPolicy.ThirdPartyAttachmentsEnabled&&Object(o.f)("doc-fileProvider-dropbox");case 6:return t.AttachmentPolicy.ThirdPartyAttachmentsEnabled&&Object(o.f)("doc-fileProvider-facebook");case 1:return!!Object(a.a)()||Object(o.f)("doc-filePicker-oneDriveConsumerForO365")&&t.AttachmentPolicy.OnedriveAttachmentsEnabled&&t.AttachmentPolicy.ThirdPartyAttachmentsEnabled;case 10:return Object(o.f)("doc-filePicker-mailMessageAttachment");case 7:case 8:case 9:return t.AttachmentPolicy.ThirdPartyAttachmentsEnabled&&Object(o.f)("doc-fileProvider-wopiClient");default:return Object(i.a)(e)}}},2606:function(e,t,r){"use strict";r.d(t,"a",function(){return a}),r.d(t,"b",function(){return i});var n=r(1529),a="file provider is not addable";function i(e){return n.a.indexOf(e)>-1}},2650:function(e,t,r){"use strict";var n=r(794),a=r(2);function i(e,t,r){if(!e||!t||!r)throw new Error("Key and Value parameters should not be null");return e.indexOf("?")>0?e+"&"+t+"="+r:e+"?"+t+"="+r}r.d(t,"a",function(){return o}),r.d(t,"b",function(){return c}),r.d(t,"c",function(){return u}),r.d(t,"d",function(){return s});var o=Object(a.w)()?"https://exchangelabs.live-int.com/owa":"https://outlook.office.com/owa";function c(e){var t=e?encodeURIComponent("?provider="+e):"",r=e&&6===e?"AddFacebookFileProvider.html":"AddFileProvider.html";return Object(n.m)()+"/mail/"+r+t}function u(e){var t=Object(n.m)()+"/mail/AddFileProvider.html",r=encodeURIComponent("provider="+e+"&url="+t);return o+"/ADPRedirect.aspx?"+r}function s(e,t,r,n,a,o){return function(){var e=function(){for(var e="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789".split(""),t=e.length-1,r=[],n=0;n<16;n++)r.push(e[Math.round(Math.random()*t)]);return"owa_csrf_token_"+r.join("")}(),c=i(t,"client_id",n);if(c=i(c,"redirect_uri",r),c=i(c,"response_type",a),o){var u=o(e);c=Object.keys(u).reduce(function(e,t){return i(e,t,u[t])},c)}return{authUrl:c,redirectUrl:r,csrfToken:e}}}},2686:function(e){e.exports={b:"iHa",a:"jHa"}},2763:function(e){e.exports={b:"cHa",a:"dHa",e:"eHa",d:"fHa",f:"gHa",c:"hHa"}},2764:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(131),a=r(2068);t.default=function(e,t){return void 0===e||e.__type||(e=a.default(e)),n.makeServiceRequest("GetNewAttachmentDataProviderCreationInfo",e,t)}},2765:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(131),a=r(2069);t.default=function(e,t){return void 0===e||e.__type||(e=a.default(e)),n.makeServiceRequest("GetAttachmentDataProviderCreator",e,t)}},3342:function(e,t,r){"use strict";var n=r(0),a=2500,i=r(144),o=r(386);function c(e,t,r){var n=new o.a(e,t,{isCore:!0,isCosmosDatapoint:!0});r&&n.addCosmosOnlyData(r),i.e.importAndExecute(n)}function u(e,t,r,i,o){return Object(n.__awaiter)(this,void 0,void 0,function(){var u,s,l,d,m,f,p,g,b,h,S;return Object(n.__generator)(this,function(n){switch(n.label){case 0:return u={},s=o||a,r?[4,Promise.all(r.map(function(e){return e.preRun().catch(function(t){u[e.getName()]=new Error(t)})}))]:[3,2];case 1:n.sent(),n.label=2;case 2:return d=Date.now(),[4,Promise.all(e.map(function(e){return Promise.race([e.buildPills(),(t=s,new Promise(function(e,r){setTimeout(function(){var e=new Error("timeout");e.knownError=!0,r(e)},t)}))]).catch(function(t){return u[e.getName()]=new Error(t),[]});var t})).then(function(e){return l=Date.now(),e})];case 3:return m=n.sent(),f=[].concat.apply([],m),p=f.length,i?[4,Promise.all(i.map(function(e){return e.updateLogData(f).catch(function(t){u[e.getName()]=new Error(t)})}))]:[3,5];case 4:n.sent(),n.label=5;case 5:g={pillsToShow:[],pillsToHide:[],arbitratorId:""};try{g=t.arbitratePills(f)}catch(e){u.arbitrator=new Error(e)}finally{return b=Object.keys(u),h=[],S=[],b.length>0&&b.forEach(function(e){var t=u[e];t.hasOwnProperty("knownError")?h.push(e+"_"+t.message):S.push(e+"_"+t.message)}),c("SmartPillError",[h.toString(),S.toString(),p,l-d,s]),[2,g]}return[2]}})})}function s(e,t,r){return{mainPayload:{renderStory:0,loggableText:t,type:e,timeClicked:null,position:-1},cosmosOnlyData:r}}function l(e,t,r){var n=void 0;e.concat(t).forEach(function(e){!n&&e.logData.cosmosOnlyData&&(n=e.logData.cosmosOnlyData)});var a={data:e.map(function(e){return e.logData.mainPayload})},i={data:t.map(function(e){return e.logData.mainPayload})};c("SmartPillsRendered",[e.length,t.length,JSON.stringify(a),JSON.stringify(i),r],n)}function d(e,t,r,n,a,i,o){c("SmartReply_Rendered",[e,!1,t.join("$"),!1,r.toString(),n.toString(),a,i],o)}function m(e){var t={data:[e.mainPayload]};c("SmartPillClicked",[JSON.stringify(t)],e.cosmosOnlyData)}function f(e,t,r,n,a,i,o){c("SmartReply_Clicked",[e,t,r,!1,n,a,i],o)}r(153);r.d(t,"a",function(){return u}),r.d(t,"b",function(){return s}),r.d(t,"e",function(){return l}),r.d(t,"f",function(){return d}),r.d(t,"c",function(){return m}),r.d(t,"d",function(){return f}),r.d(t,"g",function(){return c})},3485:function(e,t,r){"use strict";var n,a=r(51),i=r(5125),o=r(4),c=r(735);Object(o.mutator)(i.a,function(e){var t=e.itemId,r=e.isSmartSuggestionsRendered,n=e.suggestionTypesRendered,a=e.suggestionsRendered,i=e.extractionId,o=Object(c.s)().items.get(t);o&&o.SIGSData&&(o.SIGSData.SmartPillData={IsSmartSuggestionsRendered:r,SuggestionTypesRendered:n,SuggestionsRendered:a,ExtractionId:i})});!function(e){e.LanguageAndLocale="SmartPill_LanguageAndLocale",e.SmartDoc="SmartPill_SmartDoc",e.SmartReply="SmartPill_SmartReply",e.SmartTask="SmartPill_SmartTask",e.SmartTime="SmartPill_SmartTime"}(n||(n={})),r.d(t,"b",function(){return s}),r.d(t,"a",function(){return n});var u=new a.c(function(){return r.e(460).then(r.bind(null,14556))}),s=new a.a(u,function(e){return e.logToSIGSOnMessageSent})},4302:function(e,t,r){"use strict";r.d(t,"a",function(){return i}),r.d(t,"c",function(){return o}),r.d(t,"b",function(){return c}),r.d(t,"d",function(){return u});var n=r(51),a=new n.c(function(){return Promise.all([r.e(6),r.e(24),r.e(35),r.e(628),r.e(483)]).then(r.bind(null,6677))}),i=Object(n.d)(a,function(e){return e.TaskListView}),o=new n.a(a,function(e){return e.preloadTaskPanelData}),c=new n.a(a,function(e){return e.initializeQuickAdd}),u=new n.a(a,function(e){return e.switchFolderAndCreateTasks})},4876:function(e,t,r){"use strict";r.d(t,"c",function(){return i}),r.d(t,"e",function(){return o}),r.d(t,"d",function(){return c}),r.d(t,"b",function(){return u}),r.d(t,"a",function(){return s}),r.d(t,"f",function(){return l}),r.d(t,"h",function(){return d}),r.d(t,"i",function(){return m}),r.d(t,"j",function(){return f}),r.d(t,"g",function(){return p});var n=r(464),a=r.n(n),i="Language",o="Locale",c="LanguageScores",u="@EntityId",s="EntityExtraction/ExtractLanguage1.0",l=a()({PropertyName:s,DistinguishedPropertySetId:"Common",PropertyType:"String"}),d=a()({PropertyName:"EntityExtraction/SmartReplyForEmail",DistinguishedPropertySetId:"Common",PropertyType:"String"}),m=a()({PropertyName:"EntityExtraction/Events1.0",DistinguishedPropertySetId:"Common",PropertyType:"String"}),f=a()({PropertyName:"EntityExtraction/RequestForAction1.0",DistinguishedPropertySetId:"Common",PropertyType:"String"}),p=a()({PropertyName:"EntityExtraction/SendContentRequestV21.0",DistinguishedPropertySetId:"Common",PropertyType:"String"})},5125:function(e,t,r){"use strict";var n=r(4);t.a=Object(n.action)("initializeSIGSDataAction",function(e,t,r,n,a){return{itemId:e,isSmartSuggestionsRendered:t,suggestionTypesRendered:r,suggestionsRendered:n,extractionId:a}})},6562:function(e,t,r){"use strict";r.d(t,"b",function(){return u}),r.d(t,"a",function(){return s});var n=r(0),a=r(153),i=r(735),o=r(63),c=4e3;function u(e){if(e.SIGSData&&e.SIGSData.SmartPillData){var t=e.SIGSData.SmartPillData,r=t.IsSmartSuggestionsRendered,n=t.SuggestionTypesRendered,i=t.SuggestionsRendered,u=t.ExtractionId,s=e.InternetMessageId,l=e.UniqueBody&&e.UniqueBody.Value||e.NormalizedBody&&e.NormalizedBody.Value;if(l&&(l=l.substring(0,c)),"True"===r){var d={InternetMessageId:s,MessageBody:l,SuggestionTypesRendered:n,SuggestionsRendered:i,ExtractionId:u};a.j.importAndExecute("SmartSuggestionsRendered",{compliance:"CustomerContent",customProperties:d})}}else o.d.warn("SIGSData object not initialized on item.")}function s(e,t,r){try{if(e){var u=Object(i.s)().items.get(e);if(u&&u.SIGSData&&u.SIGSData.SmartPillData){var s=u.InternetMessageId,l=u.NormalizedBody&&u.NormalizedBody.Value||u.UniqueBody&&u.UniqueBody.Value;l&&(l=l.substring(0,c));var d=t.substring(0,c);a.j.importAndExecute("SmartSuggestionsClicked",{compliance:"CustomerContent",customProperties:Object(n.__assign)(Object(n.__assign)({InternetMessageId:s,MessageBody:l},u.SIGSData.SmartPillData),{IsSmartSuggestionsClicked:r&&r.isSmartSuggestionsClicked?"True":"False",SuggestionsClickedTime:r&&r.suggestionsClickedTime,ClickIndex:r&&r.clickIndex.toString(),ReplyBody:d})})}}}catch(e){o.d.error("[logToSIGSOnMessageSent] Error: "+e.message)}}},8013:function(e,t,r){"use strict";r.d(t,"a",function(){return i});var n=r(51),a=new n.c(function(){return r.e(461).then(r.bind(null,9750))}),i=(Object(n.d)(a,function(e){return e.SmartPill}),Object(n.d)(a,function(e){return e.SmartPillBlock}))},8037:function(e){e.exports={a:"p1b",b:"q1b"}},9353:function(e,t,r){var n=r(13424),a=r(45);"string"==typeof n&&(n=[[e.i,n]]);for(var i=0;i<n.length;i++)a.loadStyles(n[i][1],!1);n.locals&&(e.exports=n.locals)},9354:function(e){e.exports={d:"s1b",c:"t1b",a:"u1b",b:"v1b"}}},0,[0,1,2,576,189,3,475,6,377,23,575,185,4,5,329,24,35,628,483,7,8,12,27,242,563,109,239,260,341,345,374,461]]);
//# sourceMappingURL=owa.MailSmartPill.js.map
self.scriptsLoaded['owa.MailSmartPill.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailSmartPill.js'] = (new Date()).getTime();