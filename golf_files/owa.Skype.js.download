self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.Skype.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[456],{10638:function(t,e,n){var r=n(10639),i=n(45);"string"==typeof r&&(r=[[t.i,r]]);for(var a=0;a<r.length;a++)i.loadStyles(r[a][1],!1);r.locals&&(t.exports=r.locals)},10639:function(t,e,n){(e=t.exports=n(44)(!1)).push([t.i,'._2pS8bOl0ieaAzwdy9cg-RS{width:235px}html[dir] ._2pS8bOl0ieaAzwdy9cg-RS{padding:25px 20px 12px 20px}._3pvswtalYV4ocp_1VIkJf_{font-size:21px;font-weight:100;font-weight:600;color:"[theme:neutralPrimary, default:#333333]"}html[dir] ._3pvswtalYV4ocp_1VIkJf_{padding-bottom:12px}._3X7BCE3fToVD-QESwyP6QO{font-size:14px;font-weight:400;font-weight:300;color:"[theme:neutralPrimary, default:#333333]"}._2MPHJUqJOlnhTp6IV8zYmR{font-weight:400}html[dir] ._2MPHJUqJOlnhTp6IV8zYmR{padding-top:8px}._3z1qBgV0wtr6fLZexRdIIk{color:"[theme:themePrimary, default:#0078D4]"}',""]),e.locals={notificationContent:"_2pS8bOl0ieaAzwdy9cg-RS",notificationTitle:"_3pvswtalYV4ocp_1VIkJf_",notificationSubtext:"_3X7BCE3fToVD-QESwyP6QO",goToTeams:"_2MPHJUqJOlnhTp6IV8zYmR",teamsLink:"_3z1qBgV0wtr6fLZexRdIIk"}},10640:function(t,e,n){var r=n(10641),i=n(45);"string"==typeof r&&(r=[[t.i,r]]);for(var a=0;a<r.length;a++)i.loadStyles(r[a][1],!1);r.locals&&(t.exports=r.locals)},10641:function(t,e,n){(e=t.exports=n(44)(!1)).push([t.i,".xpcE12DTdKx2lSq2Rp9cN{--themeDarker:var(--fallback-themeDarker);--themeDark:var(--fallback-themeDark);--themeDarkAlt:var(--fallback-themeDarkAlt);--themePrimary:var(--fallback-themePrimary);--themeSecondary:var(--fallback-themeSecondary);--themeTertiary:var(--fallback-themeTertiary);--themeLight:var(--fallback-themeLight);--themeLighter:var(--fallback-themeLighter);--themeLighterAlt:var(--fallback-themeLighterAlt);--headerBrandText:var(--fallback-headerBrandText);--headerTextIcons:var(--fallback-headerTextIcons);--headerSearchBoxIcon:var(--fallback-headerSearchBoxIcon);--headerSearchPlaceholderText:var(--fallback-headerSearchPlaceholderText);--headerSearchButtonIcon:var(--fallback-headerSearchButtonIcon);--headerSearchFilters:var(--fallback-headerSearchFilters);--headerSearchFiltersHover:var(--fallback-headerSearchFiltersHover);--headerBadgeText:var(--fallback-headerBadgeText);--headerSearchIcon:var(--fallback-headerSearchIcon);--black:var(--fallback-black);--blackTranslucent40:var(--fallback-blackTranslucent40);--white:var(--fallback-white);--whiteTranslucent40:var(--fallback-whiteTranslucent40);--whiteTranslucent90:var(--fallback-whiteTranslucent90);--neutralDark:var(--fallback-neutralDark);--neutralPrimary:var(--fallback-neutralPrimary);--neutralPrimaryAlt:var(--fallback-neutralPrimaryAlt);--neutralSecondary:var(--fallback-neutralSecondary);--neutralTertiary:var(--fallback-neutralTertiary);--neutralTertiaryAlt:var(--fallback-neutralTertiaryAlt);--neutralQuaternary:var(--fallback-neutralQuaternary);--neutralQuaternaryAlt:var(--fallback-neutralQuaternaryAlt);--neutralLight:var(--fallback-neutralLight);--neutralLighter:var(--fallback-neutralLighter);--neutralLighterAlt:var(--fallback-neutralLighterAlt);--redDark:var(--fallback-redDark);--flaggedMessage:var(--fallback-flaggedMessage);color:var(--neutralPrimary);bottom:0;position:absolute;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:end;-ms-flex-align:end;align-items:flex-end;max-width:calc(100% - 300px)}html[dir] .xpcE12DTdKx2lSq2Rp9cN{--headerBackground:var(--fallback-headerBackground);--headerBackgroundSearch:var(--fallback-headerBackgroundSearch);--headerSearchBoxBackground:var(--fallback-headerSearchBoxBackground);--headerSearchButtonBackground:var(--fallback-headerSearchButtonBackground);--headerSearchButtonBackgroundHover:var(--fallback-headerSearchButtonBackgroundHover);--headerButtonsBackground:var(--fallback-headerButtonsBackground);--headerButtonsBackgroundHover:var(--fallback-headerButtonsBackgroundHover);--headerButtonsBackgroundSearch:var(--fallback-headerButtonsBackgroundSearch);--headerButtonsBackgroundSearchHover:var(--fallback-headerButtonsBackgroundSearchHover);--headerBadgeBackground:var(--fallback-headerBadgeBackground);--searchBoxBackground:var(--fallback-searchBoxBackground);--richUserContentBackground:var(--fallback-richUserContentBackground);background:var(--white)}html[dir=ltr] .xpcE12DTdKx2lSq2Rp9cN{right:0}html[dir=rtl] .xpcE12DTdKx2lSq2Rp9cN{left:0}.xpcE12DTdKx2lSq2Rp9cN .conversation{display:initial}",""]),e.locals={chatWrapper:"xpcE12DTdKx2lSq2Rp9cN"}},1068:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(0);e.default=function(t){return r.__assign({__type:"SetMailboxMessageConfigurationRequest:#Exchange"},t)}},126:function(t,e,n){"use strict";n.d(e,"a",function(){return i});var r=n(332);function i(t,e){return void 0===e&&(e=!0),t&&(e&&Object(r.a)(t)||t.parentNode&&t.parentNode)}},134:function(t,e,n){"use strict";n.d(e,"a",function(){return i});var r=n(126);function i(t,e,n){void 0===n&&(n=!0);var i=!1;if(t&&e)if(n)for(i=!1;e;){var a=Object(r.a)(e);if(a===t){i=!0;break}e=a}else t.contains&&(i=t.contains(e));return i}},1387:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(0);e.default=function(t){return r.__assign({__type:"MailboxMessageConfigurationOptions:#Exchange"},t)}},1388:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(131),i=n(1068);e.default=function(t,e){return void 0===t||t.__type||(t=i.default(t)),r.makeServiceRequest("SetMailboxMessageConfiguration",t,e)}},1389:function(t,e,n){"use strict";var r=n(4);e.a=Object(r.createStore)("headerToastNotificationViewState",{notificationViewStates:[]})()},1390:function(t,e,n){"use strict";n.d(e,"a",function(){return r}),n.d(e,"b",function(){return i}),n.d(e,"c",function(){return a});var r="Calling",i="UnreadMessage",a="Summary"},14675:function(t,e,n){"use strict";n.r(e);var r=n(4),i=n(3378),a=n(7258);function o(t){window.swc&&"function"==typeof window.swc.setTheme&&window.swc.setTheme(t)}Object(r.orchestrator)(i.a,function(t){o("dark")}),Object(r.orchestrator)(a.a,function(t){o(t.themeId)});var c=n(0),u=n(1886),s=n(70),l=Object(s.action)("updateIsRecentsInitialized ")(function(t){u.a.isRecentsInitialized=t});function f(t){u.a.isSwcInitialized?d(t):window.addEventListener("swc:core:ready",function(){!function t(e){window.removeEventListener("swc:core:ready",function(){t(e)});d(e)}(t)})}function d(t){window.swc&&(window.swc.API.registerEvent("recentsReady",h),window.swc.create("recents",{},t))}function h(){l(!0)}var v=n(105),p=n(690),b=n(66),g=n(1),k=n(10638),w=n(297),m=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return Object(c.__extends)(e,t),e.prototype.populateRecentsContent=function(t){t&&(u.a.isRecentsInitialized?function(t){window.swc&&window.swc.SDK.Recents.refreshDOM(t)}(t):f(t))},e.prototype.render=function(){return g.createElement(p.a,{onDismiss:this.props.onDismiss,target:this.props.target,isBeakVisible:!1,beakWidth:15,gapSpace:0,directionalHint:b.a.bottomCenter,calloutWidth:320,setInitialFocus:!0},this.renderSkypeRecents())},e.prototype.renderSkypeRecents=function(){return g.createElement("div",{"data-style":"outlook",className:w("skype-recents",k.recentsWrapper),ref:this.populateRecentsContent})},e=Object(c.__decorate)([v.observer],e)}(g.Component),O=n(153),y=Object(s.action)("updateIsGlimpseOpen ")(function(t){u.a.isGlimpseOpen=t,window.swc&&(t?window.swc.API.triggerEvent("recentsShown"):window.swc.API.triggerEvent("recentsHidden")),Object(O.m)("Skype_Recents",[t])});var _=n(1325),T=n(2350),j=n(1389);function S(t){j.a.notificationViewStates.forEach(function(e){e.actionType!=T.c.SkypeNotification||e.actionContext.id!=t||Object(T.j)(e)})}var A=n(6104),x=0,E=1;function N(t){var e=t.type,n=t.title,r=t.description,i=t.actions,a=t.avatarUrl,o=A.c.tryImportForRender();if(o&&function(t,e){switch(e){case T.b:case T.e:return!u.a.isGlimpseOpen&&t.skypeMessageNotification!==A.b.None;case T.a:return t.skypeCallingNotification!==A.b.None;default:return null}}(o(),e)){Object(T.g)(T.c.SkypeNotification,C);var c={actionType:T.c.SkypeNotification,title:n,description:r,actionLink:i.length>x?i[x].title:null,cancelLink:i.length>E?i[E].title:null,image:a,actionContext:t,ignore:!1,playSound:I(o(),e),type:t.type};Object(T.f)(c)}}function C(t){var e=t.actionContext,n=e.actions,r=e.type,i=t.ignore,a=t.timedOut;i&&n.length>E?n[E].action():!i&&!a&&n.length>x&&(n[x].action(),r===T.e&&y(!0)),Object(O.m)("Skype_Notification",[r,a?null:i,a])}function I(t,e){switch(e){case T.b:case T.e:return t.skypeMessageNotification!==A.b.ToastOnly;case T.a:return t.skypeCallingNotification!==A.b.ToastOnly;default:return!1}}var R=n(2151),B=Object(s.action)("updateIsSwcInitialized ")(function(t){u.a.isSwcInitialized=t}),D=Object(s.action)("updateUnreadConversationCount")(function(t){u.a.unreadConversationCount=t}),P=n(101),F=n(41),L=n(246),M=n(96),z=n(463),U="dark",V={IsVirtual:!0,ParallelView:!Object(R.a)(),Style:"outlook",CanCollapse:!0};function H(t){var e,n=this,r=Object(P.c)()?U:Object(M.c)();window.swc&&window.swc.init(null,(e={toLoadUnreadConversationsCount:!0,locale:Object(F.a)().SessionSettings.UserLanguage},Object(L.a)()?e:Object(c.__assign)({tokenProvider:q,tokenType:"aad"},e))).then(function(){return Object(c.__awaiter)(n,void 0,void 0,function(){return Object(c.__generator)(this,function(e){return B(!0),window.swc.API.registerEvent("receivedNotification",N),window.swc.API.registerEvent("unreadConversationsUpdate",J),window.swc.API.registerEvent("hideNotification",S),window.swc.API.registerEvent("onRecentItemSelected",G),window.swc.create("chat",V,t),Object(R.a)()&&window.swc.getRecents().then(function(t){return t.setOptions({PreventOpenChat:!0})}),window.swc.setTheme(r),[2]})})})}function q(t){return Object(c.__awaiter)(this,void 0,void 0,function(){return Object(c.__generator)(this,function(e){switch(e.label){case 0:return[4,Object(z.getAccessTokenforResource)(t)];case 1:return[2,e.sent()]}})})}function G(t){y(!1),Object(R.a)()&&Object(r.dispatch)(Object(_.a)(t))}function J(t){D(t)}function Q(t){window.addEventListener("swc:core:ready",function(){!function t(e){window.removeEventListener("swc:core:ready",function(){t(e)});H(e)}(t)})}var W=n(10640),K=n(297),Y="chat-wrapper";var $=function(){var t=document.createElement("div");return t.className=K(Y,W.chatWrapper),document.body.appendChild(t),t};function X(){var t;Q($()),(t=document.createElement("script")).type="text/javascript",t.setAttribute("data-style","outlook"),t.setAttribute("data-manual-boot","true"),t.src="https://swc.cdn.skype.com/sdk/v1/sdk.min.js",document.head.appendChild(t)}function Z(){var t=A.c.tryImportForRender();return t&&t().skypeMessageNotification!==A.b.None}var tt="swc:ready";function et(){window.addEventListener(tt,function(){!function t(){window.removeEventListener(tt,function(){t()});A.d.importAndExecute()}()})}n.d(e,"SkypeGlimpse",function(){return m}),n.d(e,"updateIsGlimpseOpen",function(){return y}),n.d(e,"beginSkypeInitialization",function(){return X}),n.d(e,"shouldShowUnreadConversationCount",function(){return Z}),n.d(e,"onNotificationReceived",function(){return N}),n.d(e,"onHideNotificationReceived",function(){return S}),n.d(e,"createOnSwcReadyEvent",function(){return et})},154:function(t,e,n){"use strict";var r=n(0),i=n(163),a=n(138),o=n(180),c=n(298),u=n.n(c),s=n(46),l=n(334),f=n.n(l),d=n(50),h=500,v="OWA_GetAccessTokenForResource";function p(t){return Object(r.__awaiter)(this,void 0,void 0,function(){var e;return Object(r.__generator)(this,function(n){return e={isUserActivity:!1},[2,f()(u()({Resource:t}),e)]})})}function b(t,e,n){return Object(r.__awaiter)(this,void 0,void 0,function(){return Object(r.__generator)(this,function(r){return e<1?(Object(d.g)(v,[t,e,n.toString()]),[2,Promise.reject()]):[2,p(t).catch(function(n){return Object(s.a)(h).then(function(){return b(t,e-1,n)})})]})})}var g,k=n(67),w=n(249),m=3,O=500;function y(t){var e=this,n=null,i=null,a=new Promise(function(t,a){return Object(r.__awaiter)(e,void 0,void 0,function(){return Object(r.__generator)(this,function(e){return n=t,i=a,[2]})})}),o={onFulfilled:n,onRejected:i,resource:t};return(null==g&&(g=new w.a(m,_,O)),g).add(o),a}function _(t){return Object(r.__awaiter)(this,void 0,void 0,function(){return Object(r.__generator)(this,function(e){return I(t.resource).then(function(e){t.onFulfilled(e)}).catch(function(e){t.onRejected(e)}),[2]})})}var T=n(166);n.d(e,"e",function(){return E}),n.d(e,"b",function(){return N}),n.d(e,"c",function(){return C}),n.d(e,"a",function(){return I}),n.d(e,"d",function(){return R});var j=1,S=12e4,A=3,x=null;function E(t){x=t}function N(t){return Object(r.__awaiter)(this,void 0,void 0,function(){var e;return Object(r.__generator)(this,function(n){switch(n.label){case 0:return null!=(e=R(B(),t))?[3,2]:[4,I(t)];case 1:e=n.sent(),n.label=2;case 2:return[2,null!=e?e.AccessToken:void 0]}})})}function C(t){var e=R(B(),t);if(e)return[e.AccessToken,void 0];if(Object(k.f)("auth-getAccessTokenQueueEnabled")){var n=Object(T.a)(t),r=void 0;return n?r=n:(r=y(t),Object(T.b)(t,r)),[void 0,r.then(function(e){return Object(T.c)(t),e.AccessToken})]}return[void 0,I(t).then(function(t){return t.AccessToken})]}function I(t){return Object(r.__awaiter)(this,void 0,void 0,function(){var e,n,i;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return Object(k.f)("auth-getAccessTokenQueueEnabled")?[4,b(t,A)]:[3,2];case 1:return n=r.sent(),[3,4];case 2:return[4,p(t)];case 3:n=r.sent(),r.label=4;case 4:return null!=(e=n)&&0==e.TokenResultCode&&null!=e.AccessTokenExpiry&&(e.ExpiresIn&&e.ExpiresIn>0&&(e.AccessTokenExpiry=Object(o.a)(Date.now(),e.ExpiresIn).toISOString()),(i=new Date(e.AccessTokenExpiry).getTime()-Date.now()-S)>0&&B().put(t,e,i,function(t,e){I(t).catch(function(){})})),[2,e]}})})}function R(t,e){var n=t.get(e),r=void 0;n&&n.AccessTokenExpiry&&(Object(a.a)(new Date(n.AccessTokenExpiry),-j)>new Date(Date.now())&&(r=n));return r}function B(){return null==x&&(x=new i.Cache),x}},1623:function(t,e,n){"use strict";var r=n(70),i=n(1389);e.a=Object(r.action)("removeNotification")(function(t){var e=i.a.notificationViewStates.indexOf(t);e>=0&&i.a.notificationViewStates.splice(e,1)})},163:function(t,e,n){"use strict";function r(){var t=Object.create(null),e=0,n=0,r=0,i=!1;function a(e){r--,delete t[e]}this.put=function(e,n,i,o){if(void 0!==i&&("number"!=typeof i||isNaN(i)||i<=0))throw new Error("Cache timeout must be a positive number");if(void 0!==o&&"function"!=typeof o)throw new Error("Cache timeout callback must be a function");var c=t[e];c?clearTimeout(c.timeout):r++;var u={value:n,expire:i+Date.now()};return isNaN(u.expire)||(u.timeout=setTimeout(function(){a(e),o&&o(e,n)}.bind(this),i)),t[e]=u,n},this.del=function(e){var n=!0,r=t[e];return r?(clearTimeout(r.timeout),!isNaN(r.expire)&&r.expire<Date.now()&&(n=!1)):n=!1,n&&a(e),n},this.clear=function(){for(var a in t)clearTimeout(t[a].timeout);r=0,t=Object.create(null),i&&(e=0,n=0)},this.get=function(a){var o=t[a];if(void 0!==o){if(isNaN(o.expire)||o.expire>=Date.now())return i&&e++,o.value;i&&n++,r--,delete t[a]}else i&&n++;return null},this.size=function(){return r},this.memsize=function(){var e,n=0;for(e in t)n++;return n},this.debug=function(t){i=t},this.hits=function(){return e},this.misses=function(){return n},this.keys=function(){return Object.keys(t)},this.exportJson=function(){var e={};for(var n in t){var r=t[n];e[n]={value:r.value,expire:r.expire||"NaN"}}return JSON.stringify(e)},this.importJson=function(e,n){var r=JSON.parse(e),i=Date.now(),a=n&&n.skipDuplicates;for(var o in r)if(r.hasOwnProperty(o)){if(a)if(t[o])continue;var c=r[o],u=c.expire-i;if(u<=0){this.del(o);continue}u=u>0?u:void 0,this.put(o,c.value,u)}return this.size()}}t.exports=new r,t.exports.Cache=r},1644:function(t,e,n){"use strict";var r;n.d(e,"a",function(){return r}),function(t){t[t.AsyncSendFailed=0]="AsyncSendFailed",t[t.AddFavoritePersonaFailedNotification=1]="AddFavoritePersonaFailedNotification",t[t.RemoveFavoritePersonaFailedNotification=2]="RemoveFavoritePersonaFailedNotification",t[t.PeopleHubNotification=3]="PeopleHubNotification",t[t.SkypeNotification=4]="SkypeNotification",t[t.SkypeForBusinessNotification=5]="SkypeForBusinessNotification"}(r||(r={}))},166:function(t,e,n){"use strict";n.d(e,"a",function(){return o}),n.d(e,"c",function(){return c}),n.d(e,"b",function(){return u});var r=n(163),i=null;function a(){return null==i&&(i=new r.Cache),i}function o(t){return a().get(t)}function c(t){return a().del(t)}function u(t,e){a().put(t,e)}},1971:function(t,e,n){"use strict";var r=n(0),i=n(70),a=n(1389),o=0;e.a=Object(i.action)("addNotification")(function(t){var e=Object(r.__assign)({id:o++},t);a.a.notificationViewStates.push(e)})},1972:function(t,e,n){"use strict";n.d(e,"a",function(){return o}),n.d(e,"b",function(){return c});var r=n(1644),i=n(1623),a={};function o(t,e){var n=r.a[t];a[n]||(a[n]=e)}function c(t){var e=a[r.a[t.actionType]];e&&e(t),Object(i.a)(t)}},2350:function(t,e,n){"use strict";n.d(e,"d",function(){return f}),n.d(e,"i",function(){return d});var r=n(51),i=n(1971);n.d(e,"f",function(){return i.a});var a=n(1623);n.d(e,"j",function(){return a.a});var o=n(1389);n.d(e,"h",function(){return o.a});var c=n(1390);n.d(e,"a",function(){return c.a}),n.d(e,"b",function(){return c.b}),n.d(e,"e",function(){return c.c});var u=n(1972);n.d(e,"g",function(){return u.a});var s=n(1644);n.d(e,"c",function(){return s.a});var l=new r.c(function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(3),n.e(372)]).then(n.bind(null,3930))}),f=Object(r.d)(l,function(t){return t.NotificationToast}),d=new r.a(l,function(t){return t.addNotification})},249:function(t,e,n){"use strict";var r=function(){function t(t,e,n){this.maxParallelTasks=t,this.taskCallback=e,this.taskDelay=n,this.taskList=[],this.numberOfTasksRunning=0}return t.prototype.add=function(t){this.taskList.unshift(t),this.scheduleTask()},t.prototype.clear=function(){this.taskList.splice(0,this.taskList.length)},t.prototype.canRunMoreTasks=function(){return this.numberOfTasksRunning<this.maxParallelTasks&&this.taskList.length>0},t.prototype.scheduleTask=function(){var t=this;this.canRunMoreTasks()&&setTimeout(function(){t.tryRunTask()},this.taskDelay)},t.prototype.tryRunTask=function(){this.canRunMoreTasks()&&this.runTask()},t.prototype.onTaskComplete=function(){this.numberOfTasksRunning--,this.scheduleTask()},t.prototype.runTask=function(){var t=this,e=this.taskList.pop();this.numberOfTasksRunning++,this.taskCallback(e).then(function(){t.onTaskComplete()}).catch(function(){t.onTaskComplete()}),this.scheduleTask()},t}();n.d(e,"a",function(){return r})},254:function(t,e,n){"use strict";n.d(e,"a",function(){return i});var r=n(126);function i(t,e){return t&&t!==document.body?e(t)?t:i(Object(r.a)(t),e):null}},298:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(0);e.default=function(t){return r.__assign({__type:"TokenRequest:#Exchange"},t)}},300:function(t,e,n){"use strict";n.d(e,"a",function(){return r}),n.d(e,"b",function(){return i});var r="data-portal-element";function i(t){t.setAttribute(r,"true")}},331:function(t,e,n){"use strict";function r(t){return t&&!!t._virtual}n.d(e,"a",function(){return r})},332:function(t,e,n){"use strict";n.d(e,"a",function(){return i});var r=n(331);function i(t){var e;return t&&Object(r.a)(t)&&(e=t._virtual.parent),e}},333:function(t,e,n){"use strict";n.d(e,"a",function(){return i});var r=n(254);function i(t,e){var n=Object(r.a)(t,function(t){return t.hasAttribute(e)});return n&&n.getAttribute(e)}},334:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=n(131),i=n(298);e.default=function(t,e){return void 0===t||t.__type||(t=i.default(t)),r.makeServiceRequest("GetAccessTokenforResource",t,e)}},3378:function(t,e,n){"use strict";var r=n(4);e.a=Object(r.action)("TOGGLE_DARK_MODE_THEME",function(t){return{isDarkModeEnabled:t}})},4053:function(t,e,n){"use strict";n.d(e,"a",function(){return i}),n.d(e,"c",function(){return o}),n.d(e,"b",function(){return c});var r,i,a=n(4286);function o(t){switch(t){case r.Off:return a.a.None;case r.Notification:return a.a.ToastOnly;case r.All:default:return a.a.ToastAndSound}}function c(t){switch(t){case a.a.None:return r.Off;case a.a.ToastOnly:return r.Notification;case a.a.ToastAndSound:default:return r.All}}!function(t){t.All="ALL",t.Notification="NOTIFICATION",t.Off="OFF"}(r||(r={})),function(t){t.IncomingCall="swc.notification.incoming-call",t.NewMessage="swc.notification.new-message"}(i||(i={}))},4286:function(t,e,n){"use strict";var r;!function(t){t[t.None=0]="None",t[t.ToastAndSound=1]="ToastAndSound",t[t.ToastOnly=2]="ToastOnly",t[t.Migrated=3]="Migrated"}(r||(r={})),e.a=r},4287:function(t,e,n){"use strict";var r=n(761),i=n(4);e.a=Object(i.createStore)("swcOptions",{skypeMessageNotification:null,skypeCallingNotification:null,feature:r.a.SkypeNotifications})},463:function(t,e,n){"use strict";n.r(e);var r=n(163),i=n(154);function a(t){Object(i.e)(new r.Cache),Object(i.b)(t.location.origin)}var o=n(0),c=n(40),u=n(183),s=n.n(u),l=n(180),f=n(50),d="OWA_GetDelegationAccessToken",h={};function v(t){return Object(o.__awaiter)(this,void 0,void 0,function(){var e,n,r,i;return Object(o.__generator)(this,function(a){switch(a.label){case 0:e=t.client_id+t.scope,n=encodeURIComponent(e),r={},a.label=1;case 1:return a.trys.push([1,3,4,5]),[4,p(t,window)];case 2:return r=a.sent(),[3,5];case 3:return i=a.sent(),r.TokenResultCode=2,Object(f.g)(d+" Token fetch failure ",[i.toString(),t]),[3,5];case 4:return function(t,e){var n=e.document.getElementById(t);null!=n&&(n.removeEventListener("load",h[t]),e.document.body.removeChild(n),delete h[t])}(n,window),[7];case 5:return[2,r]}})})}function p(t,e){return Object(o.__awaiter)(this,void 0,void 0,function(){var n,r,i;return Object(o.__generator)(this,function(a){return n=encodeURIComponent(t.client_id+t.scope),r=function(t){var e={response_type:"token",prompt:"none",redirect_uri:t.redirect_uri,scope:t.scope,client_id:t.client_id};return t.authorization_uri+"?"+c.stringify(e)}(t),e.document.getElementById(n)?[2,{TokenResultCode:2}]:((i=e.document.createElement("iframe")).src=r.toString(),i.style.display="none",i.id=n,e.document.body.appendChild(i),[2,new Promise(function(r,a){h[n]=function(n){var o={};try{i.contentWindow&&i.contentWindow.location.host==e.location.host&&(o=function(t){var e=c.parse(t),n={};e.access_token?(n.AccessToken=e.access_token,n.AccessTokenExpiry=Object(l.a)(Date.now(),parseInt(e.expires_in)).toISOString(),n.TokenResultCode=0):"login_required"==e.error||"interaction_required"==e.error||"consent_required"==e.error?(n.TokenResultCode=3,Object(f.g)(d+" MSA Failure ",[e.error,t])):(n.TokenResultCode=2,Object(f.g)(d+" MSA Failure ",[e.error,t]));return n}(i.contentWindow.location.hash.substring(1)))}catch(e){Object(f.g)(d+" Hash param parsing failure ",[e.toString(),t]),o.TokenResultCode=2,a(o)}r(o)},i.addEventListener("load",h[n],!1)})])})})}var b,g=n(67),k=n(166),w=n(249),m=3,O=500;function y(t){var e=this,n=null,r=null,i=new Promise(function(t,i){return Object(o.__awaiter)(e,void 0,void 0,function(){return Object(o.__generator)(this,function(e){return n=t,r=i,[2]})})}),a={onFulfilled:n,onRejected:r,options:t};return(null==b&&(b=new w.a(m,_,O)),b).add(a),i}function _(t){return Object(o.__awaiter)(this,void 0,void 0,function(){return Object(o.__generator)(this,function(e){return v(t.options).then(function(e){t.onFulfilled(e)}).catch(function(e){t.onRejected(e)}),[2]})})}var T=null,j="OWA_GetDelegationAccessToken";function S(t){return Object(o.__awaiter)(this,void 0,void 0,function(){var e,n,r,i,a;return Object(o.__generator)(this,function(o){switch(o.label){case 0:e={scope:t,client_id:"",authorization_uri:"",redirect_uri:""},n=void 0,o.label=1;case 1:return o.trys.push([1,5,,6]),[4,s()()];case 2:return 0!=(r=o.sent()).ResultCode||null==r.ImplicitGrantAuthorizationUrl||""==r.ImplicitGrantAuthorizationUrl?(Object(f.g)(j+" ImplicitGrantAuthorizationUrl is empty or null "),[2,n]):(i=c.parse(r.ImplicitGrantAuthorizationUrl.split("?")[1]||"")).client_id&&i.redirect_uri?(e.client_id=i.client_id,e.authorization_uri=r.ImplicitGrantAuthorizationUrl.split("?")[0],e.redirect_uri=i.redirect_uri,[4,A(e)]):[3,4];case 3:n=o.sent(),o.label=4;case 4:return[2,n];case 5:return a=o.sent(),Object(f.g)(j+" GetAuthenticationUrl Operation failed ",[a.toString()]),[2,n];case 6:return[2]}})})}function A(t){return Object(o.__awaiter)(this,void 0,void 0,function(){var e,n,r,a;return Object(o.__generator)(this,function(o){switch(o.label){case 0:return e=t.client_id+t.scope,(n=Object(i.d)(E(),e))&&n.AccessToken?[2,n.AccessToken]:[3,1];case 1:return Object(g.f)("auth-getDelegationTokenQueueEnabled")?(r=Object(k.a)(e),a=void 0,r?a=r:(a=y(t),Object(k.b)(e,a)),[2,a.then(function(t){return x(e,t),Object(k.c)(e),t.AccessToken})]):[3,2];case 2:return[4,v(t)];case 3:return n=o.sent(),x(e,n),[2,0==n.TokenResultCode?n.AccessToken:void 0]}})})}function x(t,e){if(e&&0==e.TokenResultCode&&e.AccessTokenExpiry){var n=new Date(e.AccessTokenExpiry).getTime()-Date.now();n>0&&E().put(t,e,n)}}function E(){return null==T&&(T=new r.Cache),T}var N=n(121),C=n(340);var I=!1;function R(t){I||(!function(t){var e=Object(C.a)("/owa",t);Object(N.initializeServiceRequest)({baseUrl:e})}(t),I=!0)}function B(t,e,n,r){n?t.acquireTokenPopup(e,null,n,r):t.acquireToken(e,r)}var D=n(51),P=new D.c(function(){return Promise.all([n.e(563),n.e(109)]).then(n.bind(null,14939))}),F=new D.a(P,function(t){return t.createAdalAuthenticationContext});var L=function(t,e,n,r){return function(i,a){i||!a?r(i,null):(t.getCachedUser(),B(t,e,n,r))}},M="adalIdTokenFrame";function z(t,e,n,r){t.config.displayCall=function(i){!function(t){if(-1==t.indexOf("?"))throw new Error("Invalid Url in Adal Auth Context Display Call")}(i),window.detectUserCachedCallback=L(t,e,n,r),function(t,e){t._addAdalFrame(M).src="about:blank",t._loadFrame(e+"&prompt=none",M)}(t,i)},t.login()}function U(t,e,n,r,i){return Object(o.__awaiter)(this,void 0,void 0,function(){var a;return Object(o.__generator)(this,function(o){switch(o.label){case 0:return"https://login.microsoftonline.com/",[4,F.importAndExecute("https://login.microsoftonline.com/",t,e)];case 1:return a=o.sent(),a.getCachedUser()?B(a,n,r,i):z(a,n,r,i),[2]}})})}n.d(e,"registerTokenProvider",function(){return a}),n.d(e,"getAccessTokenforResource",function(){return i.b}),n.d(e,"getAccessTokenforResourceAsLazy",function(){return i.c}),n.d(e,"getDelegationToken",function(){return A}),n.d(e,"getDelegationTokenForOwa",function(){return S}),n.d(e,"bootstrap",function(){return R}),n.d(e,"getAccessTokenOnBehalfOfResource",function(){return U})},6104:function(t,e,n){"use strict";var r=n(51),i=n(7259),a=n(6285),o=n(745),c=n(6286),u=n(67);var s=new r.c(function(){return Promise.all([n.e(719),n.e(768)]).then(n.bind(null,14781))}),l=Object(o.b)({key:"skypeNotifications",titleStringKey:Object(c.a)()?i.b:i.a,searchTermsStringKey:a.a,isHidden:function(){return!(!Object(u.f)("fwk-partner-code-off")&&(Object(u.f)("fwk-skypeConsumer")||Object(u.f)("fwk-skypeBusinessV2")))}},s,function(t){return t.default}),f=n(4286);n(4053),n(4287);n.d(e,"d",function(){return h}),n.d(e,"c",function(){return v}),n.d(e,"a",function(){return l}),n.d(e,"b",function(){return f.a});var d=new r.c(function(){return n.e(458).then(n.bind(null,14906))}),h=new r.a(d,function(t){return t.initializeNotificationSettings}),v=new r.b(d,function(t){return t.getUserSkypeOptions})},6285:function(t){t.exports={a:"S9a"}},6286:function(t,e,n){"use strict";n.d(e,"a",function(){return i});var r=n(67);function i(){return Object(r.f)("fwk-skypeConsumer")||Object(r.f)("fwk-skypeBusinessCalling")}},7258:function(t,e,n){"use strict";var r=n(4);e.a=Object(r.action)("ON_COMMIT_THEME_CHANGE",function(t){return{themeId:t}})},7259:function(t){t.exports={b:"e$a",a:"f$a"}},74:function(t,e,n){"use strict";n.d(e,"e",function(){return d}),n.d(e,"h",function(){return h}),n.d(e,"f",function(){return v}),n.d(e,"i",function(){return p}),n.d(e,"c",function(){return b}),n.d(e,"k",function(){return g}),n.d(e,"j",function(){return k}),n.d(e,"o",function(){return w}),n.d(e,"n",function(){return m}),n.d(e,"m",function(){return O}),n.d(e,"l",function(){return y}),n.d(e,"a",function(){return _}),n.d(e,"p",function(){return T}),n.d(e,"b",function(){return S}),n.d(e,"g",function(){return A}),n.d(e,"d",function(){return x});var r=n(333),i=n(134),a=n(126),o=n(80),c=n(117),u="data-is-focusable",s="data-is-visible",l="data-focuszone-id",f="data-is-sub-focuszone";function d(t,e,n){return k(t,e,!0,!1,!1,n)}function h(t,e,n){return g(t,e,!0,!1,!0,n)}function v(t,e,n,r){return void 0===r&&(r=!0),k(t,e,r,!1,!1,n,!1,!0)}function p(t,e,n,r){return void 0===r&&(r=!0),g(t,e,r,!1,!0,n,!1,!0)}function b(t){var e=k(t,t,!0,!1,!1,!0);return!!e&&(S(e),!0)}function g(t,e,n,r,i,a,o,c){if(!e||!o&&e===t)return null;var u=w(e);if(i&&u&&(a||!O(e)&&!y(e))){var s=g(t,e.lastElementChild,!0,!0,!0,a,o,c);if(s){if(c&&m(s,!0)||!c)return s;var l=g(t,s.previousElementSibling,!0,!0,!0,a,o,c);if(l)return l;for(var f=s.parentElement;f&&f!==e;){var d=g(t,f.previousElementSibling,!0,!0,!0,a,o,c);if(d)return d;f=f.parentElement}}}if(n&&u&&m(e,c))return e;var h=g(t,e.previousElementSibling,!0,!0,!0,a,o,c);return h||(r?null:g(t,e.parentElement,!0,!1,!1,a,o,c))}function k(t,e,n,r,i,a,o,c){if(!e||e===t&&i&&!o)return null;var u=w(e);if(n&&u&&m(e,c))return e;if(!i&&u&&(a||!O(e)&&!y(e))){var s=k(t,e.firstElementChild,!0,!0,!1,a,o,c);if(s)return s}if(e===t)return null;var l=k(t,e.nextElementSibling,!0,!0,!1,a,o,c);return l||(r?null:k(t,e.parentElement,!1,!1,!0,a,o,c))}function w(t){if(!t||!t.getAttribute)return!1;var e=t.getAttribute(s);return null!=e?"true"===e:0!==t.offsetHeight||null!==t.offsetParent||!0===t.isVisible}function m(t,e){if(!t||t.disabled)return!1;var n=0,r=null;t&&t.getAttribute&&(r=t.getAttribute("tabIndex"))&&(n=parseInt(r,10));var i=t.getAttribute?t.getAttribute(u):null,a=null!==r&&n>=0,o=!!t&&"false"!==i&&("A"===t.tagName||"BUTTON"===t.tagName||"INPUT"===t.tagName||"TEXTAREA"===t.tagName||"true"===i||a);return e?-1!==n&&o:o}function O(t){return!!(t&&t.getAttribute&&t.getAttribute(l))}function y(t){return!(!t||!t.getAttribute||"true"!==t.getAttribute(f))}function _(t){var e=Object(c.a)(t),n=e&&e.activeElement;return!(!n||!Object(i.a)(t,n))}function T(t,e){return"true"!==Object(r.a)(t,e)}var j=void 0;function S(t){if(t){if(j)return void(j=t);j=t;var e=Object(o.a)(t);e&&e.requestAnimationFrame(function(){j&&j.focus(),j=void 0})}}function A(t,e){for(var n=t,r=0,i=e;r<i.length;r++){var a=i[r],o=n.children[Math.min(a,n.children.length-1)];if(!o)break;n=o}return n=m(n)&&w(n)?n:k(t,n,!0)||g(t,n)}function x(t,e){for(var n=[];e&&t&&e!==t;){var r=Object(a.a)(e,!0);if(null===r)return[];n.unshift(Array.prototype.indexOf.call(r.children,e)),e=r}return n}},745:function(t,e,n){"use strict";var r=n(51),i=n(330),a=n.n(i),o=n(299),c=n.n(o),u=n(336);function s(t,e){return void 0===e&&(e="OWA.UserOptions"),Object(u.a)(e,t.map(function(t){return a()({DictionaryKey:c()({Type:"String",Value:[t.propertyName]}),DictionaryValue:c()({Type:t.propertyType,Value:Array.isArray(t.propertyValue)?t.propertyValue:[t.propertyValue]})})}))}var l=n(1387),f=n.n(l),d=n(1068),h=n.n(d),v=n(1388),p=n.n(v),b=n(193);function g(t){return p()(h()({Header:Object(b.getJsonRequestHeader)(),Options:f()(t)}))}function k(t,e){return null===t?e:t}var w=n(4),m=n(79),O=n(194),y=Object(w.mutatorAction)("updateSessionSettings",function(t){O(Object(m.f)().SessionSettings,t)}),_=n(194),T=Object(w.mutatorAction)("updateUserOptions",function(t){_(Object(m.f)().UserOptions,t)});function j(t){var e=N(t);return!!e&&e.reduce(function(t,e){return t||e.fullOptionFormSettings.isDirty()},!1)}function S(t){var e=N(t);return e&&e.reduce(function(t,e){return t&&!!e.fullOptionFormSettings.hideSaveDiscard&&e.fullOptionFormSettings.hideSaveDiscard()},!0)}function A(t){var e=N(t);return!e||e.filter(function(t){return t.fullOptionFormSettings.isDirty()}).reduce(function(t,e){return t&&!!e.fullOptionFormSettings.disableSave&&e.fullOptionFormSettings.disableSave()},!0)}var x=n(0);function E(t,e,n,i,a){var o=new r.b(e,n),c=i&&a?new r.b(i,a):null;return Object(x.__assign)(Object(x.__assign)({},t),{tryImportFullOptionFormSettingsSync:function(){return o.tryImportForRender()},tryImportQuickOptionSettingsSync:c?function(){return c.tryImportForRender()}:void 0})}function N(t){var e=t.options.map(function(t){return function(t){return"fullOptionFormSettings"in t}(t)?t:Object(x.__assign)(Object(x.__assign)({},t),{fullOptionFormSettings:t.tryImportFullOptionFormSettingsSync()})});return e.some(function(t){return!t.fullOptionFormSettings})?null:e}var C=Object(w.action)("HIDE_FULL_OPTION",function(t,e){return{showQuickOptions:t,subcategory:e}});n.d(e,"g",function(){return R}),n.d(e,"a",function(){return B}),n.d(e,"l",function(){return s}),n.d(e,"h",function(){return g}),n.d(e,"c",function(){return k}),n.d(e,"k",function(){return y}),n.d(e,"m",function(){return T}),n.d(e,"f",function(){return j}),n.d(e,"e",function(){return S}),n.d(e,"i",function(){return A}),n.d(e,"b",function(){return E}),n.d(e,"j",function(){return N}),n.d(e,"d",function(){return C});var I=new r.c(function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(6),n.e(377)]).then(n.bind(null,14898))}),R=new r.a(I,function(t){return t.confirmOptionNavigation}),B=Object(r.d)(I,function(t){return t.OptionsEditor})}},0,[0,1,2,6,377,563,109,458]]);
//# sourceMappingURL=owa.Skype.js.map
self.scriptsLoaded['owa.Skype.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.Skype.js'] = (new Date()).getTime();