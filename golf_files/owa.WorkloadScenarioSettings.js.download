self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.WorkloadScenarioSettings.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[505],{1116:function(e,t,n){"use strict";function r(e){void 0===e&&(e={}),function(e){e.timeBetweenRetryInMS=e.timeBetweenRetryInMS||function(){return 6e4}}(e);var t=e.maximumAttempts,n=e.timeBetweenRetryInMS;return function(e){var r=0,a=!1,c=function(i,u){a?u(new Error("The function retry was cancelled")):(r++,e().then(function(e){return i(e)}).catch(function(e){t&&r>=t?u(e):setTimeout(function(){return c(i,u)},n(r))}))};return{retriableFunc:function(){return new Promise(function(e,t){return c(e,t)})},cancel:function(){return a=!0}}}}function a(e){return function(t){return Math.pow(2,t)*e}}n.d(t,"b",function(){return r}),n.d(t,"a",function(){return a})},113:function(e,t,n){"use strict";n.d(t,"d",function(){return c}),n.d(t,"c",function(){return i}),n.d(t,"e",function(){return u}),n.d(t,"b",function(){return o}),n.d(t,"a",function(){return d});var r=n(51),a=(n(251),new r.c(function(){return n.e(391).then(n.bind(null,671))})),c=(new r.a(a,function(e){return e.makeOwsPrimeRequest}).importAndExecute,new r.a(a,function(e){return e.makePostRequest}).importAndExecute),i=new r.a(a,function(e){return e.makePatchRequest}).importAndExecute,u=new r.a(a,function(e){return e.makePutRequest}).importAndExecute,o=new r.a(a,function(e){return e.makeGetRequest}).importAndExecute,d=new r.a(a,function(e){return e.makeDeleteRequest}).importAndExecute},1322:function(e,t,n){"use strict";var r=n(67),a=n(79),c=n(794);function i(){return(!Object(c.t)()||!window.opener)&&(Object(r.f)("cal-time-panel")&&!Object(a.f)().SessionSettings.IsShadowMailbox)}var u=n(4),o=Object(u.action)("openTimePanel",function(e){return{source:e}}),d=Object(u.action)("popView");n.d(t,"a",function(){return i}),n.d(t,"b",function(){return o}),n.d(t,"c",function(){return d})},1519:function(e,t,n){"use strict";function r(){return window.O365Shell}n.d(t,"a",function(){return r})},1573:function(e,t,n){"use strict";var r=n(0),a=n(4),c=n(79),i=Object(a.action)("LOAD_WORKLOAD_SCENARIO_SETTINGS"),u=Object(a.action)("WORKLOAD_SCENARIO_SETTINGS_LOADED",function(e,t){return{settings:e,accountSmtpAddress:t}}),o=Object(a.action)("LOADING_WORKLOAD_SCENARIO_SETTINGS_FAILED",function(e){return{accountSmtpAddress:e}}),d=n(247),s=n(113);function l(e){switch(e){case 1:return"Mail";case 2:return"Calendar";case 64:return"FilesHub";case 4:return"People";default:throw new Error("getWorkloadScenarioType: The workload type is not supported")}}var f="ows/beta/ScenarioSettings";var b=71;function O(e){return 0!=(e&b)}var p=n(820);function v(e){return Object(r.__awaiter)(this,void 0,void 0,function(){var t,n,a,c,i=this;return Object(r.__generator)(this,function(u){return t=["Owa"],O(n=Object(p.b)())&&(a=l(n),t.push(a)),c=function(e){var t=e.join(",");return f+"/?Scenarios="+t}(t),[2,Object(d.b)(e).then(function(e){return Object(r.__awaiter)(i,void 0,void 0,function(){var t,n;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return[4,Object(s.b)(c,void 0,void 0,e,!0,void 0,"GET_WORKLOAD_SCENARIO_SETTINGS")];case 1:return t=r.sent(),n={timePanelSelectedView:null,timePanelCalendarIds:[],timePanelSelectedCalendarView:null,isTimePanelOpen:!1,isTimePanelDatePickerExpanded:!1},t.settings&&t.settings.forEach(function(e){var t;(t=e).calendarIds&&"TimePanelCalendarIds"===t.settingName?n.timePanelCalendarIds=e.calendarIds:!function(e){return!!e.selectedView&&"TimePanelSelectedView"===e.settingName}(e)?!function(e){return!!e.selectedView&&"SelectedCalendarListView"===e.settingName}(e)?!function(e){return void 0!==e.isOpen&&"IsTimePanelOpen"===e.settingName}(e)?function(e){return void 0!==e.isExpanded&&"IsTimePanelDatePickerExpanded"===e.settingName}(e)&&(n.isTimePanelDatePickerExpanded=e.isExpanded):n.isTimePanelOpen=e.isOpen:n.timePanelSelectedCalendarView=e.selectedView:n.timePanelSelectedView=e.selectedView}),[2,n]}})})})]})})}var w=n(1116),m=Object(w.b)({maximumAttempts:3,timeBetweenRetryInMS:Object(w.a)(1e4)}),j={};Object(a.orchestrator)(i,function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(e){return Object(c.e)().forEach(S),[2]})})});function S(e){return Object(r.__awaiter)(this,void 0,void 0,function(){var t;return Object(r.__generator)(this,function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),j[e]?[2]:(j[e]=m(function(){return v(e)}),[4,j[e].retriableFunc()]);case 1:return t=n.sent(),u(t,e),[3,3];case 2:return n.sent(),o(e),[3,3];case 3:return[2]}})})}var h=n(1764);Object(a.orchestrator)(h.d,function(e){S(e.accountSmtpAddress)});function P(e,t){return f+"/"+e+"/"+t}function _(e){return Object(r.__awaiter)(this,void 0,void 0,function(){var t,n,a,c;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return O(t=Object(p.b)())?(n=l(t),a=P(n,"TimePanelSelectedView"),c={ViewType:e},[4,Object(s.c)(a,c,void 0,void 0,void 0,!0,void 0)]):[3,2];case 1:r.sent(),r.label=2;case 2:return[2]}})})}function A(e,t){return Object(r.__awaiter)(this,void 0,void 0,function(){var t,n;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return t=P("Owa","TimePanelCalendarIds"),n={CalendarIds:e},[4,Object(s.c)(t,n,void 0,void 0,void 0,!0,void 0)];case 1:return r.sent(),[2]}})})}function I(e){return Object(r.__awaiter)(this,void 0,void 0,function(){var t,n,a,c;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return O(t=Object(p.b)())?(n=l(t),a=P(n,"IsTimePanelOpen"),c={IsOpen:e},[4,Object(s.c)(a,c,void 0,void 0,void 0,!0,void 0)]):[3,2];case 1:r.sent(),r.label=2;case 2:return[2]}})})}function E(e){return Object(r.__awaiter)(this,void 0,void 0,function(){var t,n,a,c;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return O(t=Object(p.b)())?(n=l(t),a=P(n,"SelectedCalendarListView"),c={ViewType:e},[4,Object(s.c)(a,c,void 0,void 0,void 0,!0,void 0)]):[3,2];case 1:r.sent(),r.label=2;case 2:return[2]}})})}function T(e){return Object(r.__awaiter)(this,void 0,void 0,function(){var t,n;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return t=P("Owa","IsTimePanelDatePickerExpanded"),n={isExpanded:e},[4,Object(s.c)(t,n,void 0,void 0,void 0,!0,void 0)];case 1:return r.sent(),[2]}})})}n.d(t,"a",function(){return i}),n.d(t,"g",function(){return u}),n.d(t,"f",function(){return _}),n.d(t,"e",function(){return A}),n.d(t,"d",function(){return I}),n.d(t,"c",function(){return E}),n.d(t,"b",function(){return T})},1622:function(e,t,n){"use strict";n.d(t,"a",function(){return a}),n.d(t,"b",function(){return c}),n.d(t,"c",function(){return i});var r=n(4),a=Object(r.action)("initializeOwaAccountsStore"),c=Object(r.action)("owaConnectedAccountAdded",function(e){return{accountSmtpAddress:e}}),i=Object(r.action)("removeAccount",function(e){return{primarySmtpAddress:e}})},1764:function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"b",function(){return u}),n.d(t,"c",function(){return o});var r=n(1622);n.d(t,"d",function(){return r.b});var a=n(51),c=new a.c(function(){return n.e(536).then(n.bind(null,3589))}),i=new a.a(c,function(e){return e.initializeOwaAccountsStore}),u=new a.b(c,function(e){return e.initializeOwaConnectedAccount}),o=new a.a(c,function(e){return e.removeOWAConnectedAccount})},1924:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(1519);function a(e){var t=Object(r.a)();t&&t.FlexPane.CloseFlexPaneForProvider(e)}},2080:function(e,t,n){"use strict";var r=n(4);var a=n(820),c=Object(r.createStore)("timePanelSettingStore",{panelViewStack:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return{stack:e||[]}}(2!==Object(a.b)()?"Calendar":"Tasks"),isDatePickerExpanded:!1});var i=Object(r.action)("pushTimePanelView",function(e){return{newView:e}}),u=Object(r.action)("updateTopTimePanelView",function(e){return{updatedView:e}}),o=Object(r.action)("updateIsDatePickerExpanded",function(e){return{isExpanded:e}}),d=Object(r.action)("popTimePanelView"),s=n(1573);function l(e){!function(e,t){if(0===t.length)return null;t[t.length-1]=e}(e,c().panelViewStack.stack)}function f(e){c().isDatePickerExpanded=e}Object(r.mutator)(i,function(e){var t;t=e.newView,c().panelViewStack.stack.push(t)}),Object(r.mutator)(u,function(e){return l(e.updatedView)}),Object(r.mutator)(d,function(){var e=c().panelViewStack;e.stack.pop()}),Object(r.mutator)(s.g,function(e){var t=e.settings;t.timePanelSelectedView&&l(t.timePanelSelectedView)}),Object(r.mutator)(o,function(e){return f(e.isExpanded)}),Object(r.mutator)(s.g,function(e){e.settings.isTimePanelDatePickerExpanded&&f(e.settings.isTimePanelDatePickerExpanded)});var b=n(0),O=n(1116),p=n(63),v=Object(O.b)({maximumAttempts:3,timeBetweenRetryInMS:Object(O.a)(1e3)}),w=null;Object(r.orchestrator)(u,function(e){return Object(b.__awaiter)(void 0,void 0,void 0,function(){var t,n;return Object(b.__generator)(this,function(r){switch(r.label){case 0:if(t=e.updatedView,"Tasks"!==(a=t)&&"Calendar"!==a)return[3,5];r.label=1;case 1:return r.trys.push([1,3,,4]),w&&w.cancel(),[4,(w=v(function(){return Object(s.f)(t)})).retriableFunc()];case 2:return r.sent(),[3,4];case 3:return n=r.sent(),p.d.warn("viewStackOrchestrator: updateTimePanelSelectedViewService with retry failed: "+n),[3,4];case 4:w=null,r.label=5;case 5:return[2]}var a})})});var m=Object(O.b)({maximumAttempts:3,timeBetweenRetryInMS:Object(O.a)(1e3)}),j=null;Object(r.orchestrator)(o,function(e){return Object(b.__awaiter)(void 0,void 0,void 0,function(){var t,n;return Object(b.__generator)(this,function(r){switch(r.label){case 0:t=e.isExpanded,r.label=1;case 1:return r.trys.push([1,3,,4]),j&&j.cancel(),[4,(j=m(function(){return Object(s.b)(t)})).retriableFunc()];case 2:return r.sent(),[3,4];case 3:return n=r.sent(),p.d.warn("updateIsDatePickerExpandedOrchestrator: updateIsTimePanelDatePickerExpandedService with retry failed: "+n),[3,4];case 4:return j=null,[2]}})})});var S={Conflicts:"Calendar",EventDetails:"Calendar",AttendeeTracking:"Calendar",Calendar:"Calendar",ComposeForm:"Calendar",Tasks:"Tasks"};function h(e){return e?S[e]:null}function P(){return h(_())}function _(){var e,t=c().panelViewStack;return 0===(e=t.stack).length?null:e[e.length-1]}function A(){return c().panelViewStack.stack.length}function I(){return-1!==c().panelViewStack.stack.indexOf("Conflicts")}function E(){return-1!==c().panelViewStack.stack.indexOf("AttendeeTracking")}function T(){var e=c().panelViewStack;return A()>=2?e.stack[A()-2]:null}function g(){return c().isDatePickerExpanded}n.d(t,"j",function(){return i}),n.d(t,"l",function(){return u}),n.d(t,"k",function(){return o}),n.d(t,"i",function(){return d}),n.d(t,"b",function(){return P}),n.d(t,"a",function(){return _}),n.d(t,"e",function(){return A}),n.d(t,"h",function(){return I}),n.d(t,"g",function(){return E}),n.d(t,"d",function(){return T}),n.d(t,"f",function(){return g}),n.d(t,"c",function(){return h})},251:function(e,t,n){"use strict";n.d(t,"b",function(){return r}),n.d(t,"a",function(){return a});var r="owsserver",a="owsapi"},2548:function(e,t,n){"use strict";n(1924);var r=n(1519);function a(e){var t=Object(r.a)();t&&t.FlexPane.OpenFlexPaneForProvider(e)}function c(e){var t=Object(r.a)();t&&t.Theme.SetSearchActive(e)}function i(e,t){Object(r.a)().Extensibility.SetCustomHeaderButtonBadgeValue(e,t)}n.d(t,"a",function(){return a}),n.d(t,"b",function(){return c}),n.d(t,"c",function(){return i})},3480:function(e,t,n){"use strict";var r=n(4),a=Object(r.action)("updateIsSuiteHeaderRendered",function(e){return{isRendered:e}}),c=Object(r.createStore)("suiteHeaderStore",{isRendered:!1});Object(r.mutator)(a,function(){c().isRendered=!0});function i(){return c().isRendered}n.d(t,"b",function(){return a}),n.d(t,"a",function(){return i})},4920:function(e,t,n){"use strict";var r=n(4),a=Object(r.action)("UPDATE_SELECTED_TIME_PANEL_CALENDARIDS",function(e,t){return{calendarIds:e,primarySmtpAddress:t}}),c=Object(r.action)("ON_SELECTED_TIME_PANEL_CALENDARIDS_UPDATED",function(e,t){return{calendarIds:e,primarySmtpAddress:t}}),i=n(0),u=n(20),o=Object(r.createStore)("timePanelSelectedCalendarIdsStore",{calendarIdsMap:new u.ObservableMap});function d(){var e,t,n=o().calendarIdsMap,r=0;try{for(var a=Object(i.__values)(n.values()),c=a.next();!c.done;c=a.next()){var u=c.value;u&&(r+=u.length)}}catch(t){e={error:t}}finally{try{c&&!c.done&&(t=a.return)&&t.call(a)}finally{if(e)throw e.error}}return r>0}var s=n(1468),l=(Object(r.orchestrator)(s.f,function(e){var t=e.calendarIds,n=e.primarySmtpAddress;d()||c(t,n)}),n(1116)),f=n(1573),b=n(1002),O=n(63),p=Object(l.b)({maximumAttempts:3,timeBetweenRetryInMS:Object(l.a)(1e3)}),v=null,w=(Object(r.orchestrator)(a,function(e){return Object(i.__awaiter)(void 0,void 0,void 0,function(){var t,n,r,a;return Object(i.__generator)(this,function(i){switch(i.label){case 0:t=e.calendarIds,n=e.primarySmtpAddress,r=Object(b.b)(t),i.label=1;case 1:return i.trys.push([1,3,,4]),v&&v.cancel(),[4,(v=p(function(){return Object(f.e)(r,n)})).retriableFunc()];case 2:return i.sent(),c(r,n),[3,4];case 3:return a=i.sent(),O.d.warn("updateSelectedCalendarIdsOrchestrator: updateTimePanelCalendarIdsService with retry failed: "+a),[3,4];case 4:return v=null,[2]}})})}),Object(r.action)("UPDATE_SELECTED_TIME_PANEL_CALENDARIDS_IN_STORE",function(e,t){return{calendarIds:e,primarySmtpAddress:t}}));Object(r.orchestrator)(f.g,function(e){var t=e.settings,n=e.accountSmtpAddress;t.timePanelCalendarIds&&t.timePanelCalendarIds.length>0&&(w(t.timePanelCalendarIds,n),c(t.timePanelCalendarIds,n))}),Object(r.mutator)(w,function(e){var t=e.calendarIds,n=e.primarySmtpAddress;o().calendarIdsMap.set(n,Object(b.b)(t))});function m(){return Object(b.d)(d()?Object(b.c)(o().calendarIdsMap):Object(s.b)())}n.d(t,"b",function(){return c}),n.d(t,"a",function(){return m})},4925:function(e,t,n){"use strict";var r=n(4),a=Object(r.action)("updateSelectedCalendarView",function(e){return{updatedView:e}}),c=Object(r.createStore)("calendarListSettingsStore",{selectedView:"Agenda"});function i(){return c().selectedView}var u=Object(r.action)("updateSelectedCalendarViewInStore",function(e){return{updatedView:e}}),o=(Object(r.mutator)(u,function(e){var t=e.updatedView;c().selectedView=t}),n(0)),d=n(1573),s=n(1116),l=n(63),f=Object(s.b)({maximumAttempts:3,timeBetweenRetryInMS:Object(s.a)(1e3)}),b=null;Object(r.orchestrator)(a,function(e){return Object(o.__awaiter)(void 0,void 0,void 0,function(){var t,n;return Object(o.__generator)(this,function(r){switch(r.label){case 0:t=e.updatedView,u(t),r.label=1;case 1:return r.trys.push([1,3,,4]),b&&b.cancel(),[4,(b=f(function(){return Object(d.c)(t)})).retriableFunc()];case 2:return r.sent(),[3,4];case 3:return n=r.sent(),l.d.warn("updateSelectedCalendarViewOrchestrator: updateSelectedCalendarView with retry failed: "+n),[3,4];case 4:return b=null,[2]}})})});Object(r.orchestrator)(d.g,function(e){var t=e.settings;t.timePanelSelectedCalendarView&&u(t.timePanelSelectedCalendarView)});n.d(t,"b",function(){return a}),n.d(t,"a",function(){return i})},4942:function(e,t,n){"use strict";n.r(t);var r=n(1573),a=(n(4920),n(2080),n(4925),n(4)),c=n(3480),i=n(67),u=n(1322),o=n(8570),d=null;Object(a.orchestrator)(r.g,function(e){var t=e.settings;d=t.isTimePanelOpen,Object(c.a)()&&(d&&Object(u.a)()&&Object(i.f)("cal-time-panel-softPin")?Object(o.a)("OwaTimePanel",!0):Object(o.a)("OwaTimePanel",!1))}),Object(a.orchestrator)(c.b,function(e){null!==d&&(e.isRendered&&d&&Object(u.a)()&&Object(i.f)("cal-time-panel-softPin")?Object(o.a)("OwaTimePanel",!0):Object(o.a)("OwaTimePanel",!1))}),n.d(t,"loadWorkloadScenarioSettings",function(){return r.a})},8570:function(e,t,n){"use strict";var r=n(0),a=n(4),c=n(50),i=Object(a.action)("updateShouldAutoOpen",function(e,t){return{autoOpenPaneId:e,shouldAutoOpen:t}}),u=Object(a.action)("flexPaneAutoOpened",function(e){return Object(c.b)({name:"flexPaneAutoOpened",customData:{autoOpenPaneId:e}},{autoOpenPaneId:e})}),o=Object(a.action)("updateShouldAutoOpenInStore",function(e,t){return{autoOpenPaneId:e,shouldAutoOpen:t}}),d=n(20),s=Object(a.createStore)("suiteHeaderAutoOpenStore",{shouldAutoOpenMap:new d.ObservableMap});var l=["whatsNewPane","OwaTimePanel"],f=n(2548),b=!1;Object(a.orchestrator)(i,function(e){var t=e.autoOpenPaneId,n=e.shouldAutoOpen;o(t,n),b||function(){var e,t,n=s().shouldAutoOpenMap;try{for(var a=Object(r.__values)(l),c=a.next();!c.done;c=a.next()){var i=c.value;if(!n.has(i))break;if(n.get(i)){Object(f.a)(i),u(i),b=!0;break}}}catch(t){e={error:t}}finally{try{c&&!c.done&&(t=a.return)&&t.call(a)}finally{if(e)throw e.error}}}()});Object(a.mutator)(o,function(e){s().shouldAutoOpenMap.set(e.autoOpenPaneId,e.shouldAutoOpen)});n.d(t,"a",function(){return i})}},0,[536,538]]);
//# sourceMappingURL=owa.WorkloadScenarioSettings.js.map
self.scriptsLoaded['owa.WorkloadScenarioSettings.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.WorkloadScenarioSettings.js'] = (new Date()).getTime();