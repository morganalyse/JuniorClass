self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.OutlookServiceOptions.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[379],{113:function(e,t,n){"use strict";n.d(t,"d",function(){return a}),n.d(t,"c",function(){return i}),n.d(t,"e",function(){return c}),n.d(t,"b",function(){return u}),n.d(t,"a",function(){return s});var o=n(51),r=(n(251),new o.c(function(){return n.e(391).then(n.bind(null,671))})),a=(new o.a(r,function(e){return e.makeOwsPrimeRequest}).importAndExecute,new o.a(r,function(e){return e.makePostRequest}).importAndExecute),i=new o.a(r,function(e){return e.makePatchRequest}).importAndExecute,c=new o.a(r,function(e){return e.makePutRequest}).importAndExecute,u=new o.a(r,function(e){return e.makeGetRequest}).importAndExecute,s=new o.a(r,function(e){return e.makeDeleteRequest}).importAndExecute},14773:function(e,t,n){"use strict";n.r(t);var o=n(0),r=n(106),a=n(70),i=Object(a.action)("setFeatureSettings")(function(e,t,n){e.options[t]=n}),c=n(838),u=n(1486),s=n(1126),d=n(734),f=n(113),p=n(67),O=n(63),l="ows/v1.0/OutlookOptions/{0}";function b(e,t){var n=Object(r.a)(l,c.a[e]);if(Object(s.a)().loadState===u.a.OptionsLoaded){if(Object(s.a)().options[e]&&Object(s.a)().options[e].lastModifiedDateTime){if(t&&0!==Object.keys(t).length){var a=t;a["feature@is.Queryable"],a["feature@odata.type"],a.createdDateTime,a.lastModifiedDateTime;return j(1,n,Object(o.__rest)(a,["feature@is.Queryable","feature@odata.type","createdDateTime","lastModifiedDateTime"]))}return O.d.info("createOrUpdateOptionsForFeature called with no changes to options"),Promise.resolve()}return j(0,n,t)}return Promise.reject("Options are not loaded. Cannot update options.")}function j(e,t,n){var o={correlationId:Object(d.a)(),options:n};return(1==e?f.c:f.d)(t,o,o.correlationId,void 0,{PreferOption:Object(p.f)("fwk-option-useRestCore")&&"Ows.UseRestCore"}).then(function(e){if(!function(e){if(e&&e.options&&1==e.options.length){var t=e.options[0];return i(Object(s.a)(),t.feature,t),!0}return!1}(e))throw new Error("Error processing options response")})}var m=n(988),S=n(194),w=Object(a.action)("applyDefaultOptions")(function(e){void 0===e&&(e=Object(m.a)()),Object.keys(Object(s.a)().options).forEach(function(t){Object(s.a)().options[t].lastModifiedDateTime||e[t]&&S(Object(s.a)().options[t],e[t])})}),A=n(1514),v=null,h=Object(a.action)("loadOptions")(function(){switch(Object(s.a)().loadState){case u.a.OptionsLoading:return v;case u.a.OptionsLoaded:return Promise.resolve();case u.a.OptionsNotLoaded:default:return Object(s.a)().loadState=u.a.OptionsLoading,v=Object(f.b)("ows/v1.0/OutlookOptions",void 0,void 0,{PreferOption:Object(p.f)("fwk-option-useRestCore")&&"Ows.UseRestCore"}).then(function(e){!function(e){e?(e.options&&e.options.forEach(function(e){null!=e&&(e.feature==c.a.SurfaceActions&&(e=function(e){return e.readSurfaceActions=e.readSurfaceActions?e.readSurfaceActions:[],e.readSurfaceAddins=e.readSurfaceAddins?e.readSurfaceAddins:[],e.composeSurfaceActions=e.composeSurfaceActions?e.composeSurfaceActions:[],e.composeSurfaceAddins=e.composeSurfaceAddins?e.composeSurfaceAddins:[],e}(e)),i(Object(s.a)(),e.feature,e))}),w(),Object(s.a)().loadState=u.a.OptionsLoaded):(O.d.info("Error loading options"),Object(A.a)(),Object(s.a)().loadState=u.a.OptionsNotLoaded)}(e),v=null})}});var k=n(1135);function E(e){return Object(o.__awaiter)(this,void 0,void 0,function(){return Object(o.__generator)(this,function(t){switch(t.label){case 0:return[4,h()];case 1:return t.sent(),[2,Object(k.a)(e)]}})})}var P=Object(a.action)("updateAddinPinStatus")(function(e,t,n){var o=Object(k.a)(c.a.SurfaceActions),r=Object(k.a)(c.a.CalendarSurfaceAddins),a=!!n.readMode&&g(o.readSurfaceAddins,e,t);a=n.composeMode&&g(o.composeSurfaceAddins,e,t)||a;var i=!!n.calendarMode&&g(r.calendarSurfaceAddins,e,t);a&&b(c.a.SurfaceActions,o),i&&b(c.a.CalendarSurfaceAddins,r)}),g=function(e,t,n){var o=!1;return n?-1===e.indexOf(t)&&(e.push(t),o=!0):-1!==e.indexOf(t)&&(e.splice(e.indexOf(t),1),o=!0),o};n.d(t,"createOrUpdateOptionsForFeature",function(){return b}),n.d(t,"loadOptions",function(){return h}),n.d(t,"getServerOptionsForFeature",function(){return E}),n.d(t,"updateAddinPinStatus",function(){return P})},251:function(e,t,n){"use strict";n.d(t,"b",function(){return o}),n.d(t,"a",function(){return r});var o="owsserver",r="owsapi"}}]);
//# sourceMappingURL=owa.OutlookServiceOptions.js.map
self.scriptsLoaded['owa.OutlookServiceOptions.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.OutlookServiceOptions.js'] = (new Date()).getTime();