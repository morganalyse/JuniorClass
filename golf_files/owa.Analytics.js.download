self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.Analytics.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[120],{1022:function(t,e,n){"use strict";var r=n(301),i=1/0,a=1.7976931348623157e308;e.a=function(t){return t?(t=Object(r.a)(t))===i||t===-i?(t<0?-1:1)*a:t==t?t:0:0===t?t:0}},1054:function(t,e,n){"use strict";e.a=function(t,e,n){return t==t&&(void 0!==n&&(t=t<=n?t:n),void 0!==e&&(t=t>=e?t:e)),t}},1072:function(t,e,n){"use strict";var r=n(1054),i=n(875),a=n(819),o=n(840);e.a=function(t,e,n){t=Object(o.a)(t),e=Object(i.a)(e);var s=t.length,c=n=void 0===n?s:Object(r.a)(Object(a.a)(n),0,s);return(n-=e.length)>=0&&t.slice(n,c)==e}},113:function(t,e,n){"use strict";n.d(e,"d",function(){return a}),n.d(e,"c",function(){return o}),n.d(e,"e",function(){return s}),n.d(e,"b",function(){return c}),n.d(e,"a",function(){return u});var r=n(51),i=(n(251),new r.c(function(){return n.e(391).then(n.bind(null,671))})),a=(new r.a(i,function(t){return t.makeOwsPrimeRequest}).importAndExecute,new r.a(i,function(t){return t.makePostRequest}).importAndExecute),o=new r.a(i,function(t){return t.makePatchRequest}).importAndExecute,s=new r.a(i,function(t){return t.makePutRequest}).importAndExecute,c=new r.a(i,function(t){return t.makeGetRequest}).importAndExecute,u=new r.a(i,function(t){return t.makeDeleteRequest}).importAndExecute},196:function(t,e,n){"use strict";var r=n(250).a.Symbol;e.a=r},213:function(t,e,n){"use strict";e.a=function(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}},250:function(t,e,n){"use strict";var r=n(339),i="object"==typeof self&&self&&self.Object===Object&&self,a=r.a||i||Function("return this")();e.a=a},251:function(t,e,n){"use strict";n.d(e,"b",function(){return r}),n.d(e,"a",function(){return i});var r="owsserver",i="owsapi"},301:function(t,e,n){"use strict";var r=n(213),i=n(328),a=NaN,o=/^\s+|\s+$/g,s=/^[-+]0x[0-9a-f]+$/i,c=/^0b[01]+$/i,u=/^0o[0-7]+$/i,d=parseInt;e.a=function(t){if("number"==typeof t)return t;if(Object(i.a)(t))return a;if(Object(r.a)(t)){var e="function"==typeof t.valueOf?t.valueOf():t;t=Object(r.a)(e)?e+"":e}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(o,"");var n=c.test(t);return n||u.test(t)?d(t.slice(2),n?2:8):s.test(t)?a:+t}},324:function(t,e,n){"use strict";e.a=function(t){return null!=t&&"object"==typeof t}},326:function(t,e,n){"use strict";var r=n(196),i=Object.prototype,a=i.hasOwnProperty,o=i.toString,s=r.a?r.a.toStringTag:void 0;var c=function(t){var e=a.call(t,s),n=t[s];try{t[s]=void 0;var r=!0}catch(t){}var i=o.call(t);return r&&(e?t[s]=n:delete t[s]),i},u=Object.prototype.toString;var d=function(t){return u.call(t)},f="[object Null]",p="[object Undefined]",l=r.a?r.a.toStringTag:void 0;e.a=function(t){return null==t?void 0===t?p:f:l&&l in Object(t)?c(t):d(t)}},328:function(t,e,n){"use strict";var r=n(326),i=n(324),a="[object Symbol]";e.a=function(t){return"symbol"==typeof t||Object(i.a)(t)&&Object(r.a)(t)==a}},339:function(t,e,n){"use strict";(function(t){var n="object"==typeof t&&t&&t.Object===Object&&t;e.a=n}).call(this,n(32))},5383:function(t,e){var n=function(){function t(){this._state=new Int32Array(4),this._buffer=new ArrayBuffer(68),this._buffer8=new Uint8Array(this._buffer,0,68),this._buffer32=new Uint32Array(this._buffer,0,17),this.start()}return t.hashStr=function(t,e){return void 0===e&&(e=!1),this.onePassHasher.start().appendStr(t).end(e)},t.hashAsciiStr=function(t,e){return void 0===e&&(e=!1),this.onePassHasher.start().appendAsciiStr(t).end(e)},t.prototype.start=function(){return this._dataLength=0,this._bufferLength=0,this._state.set(t.stateIdentity),this},t.prototype.appendStr=function(e){var n,r,i=this._buffer8,a=this._buffer32,o=this._bufferLength;for(r=0;r<e.length;r+=1){if((n=e.charCodeAt(r))<128)i[o++]=n;else if(n<2048)i[o++]=192+(n>>>6),i[o++]=63&n|128;else if(n<55296||n>56319)i[o++]=224+(n>>>12),i[o++]=n>>>6&63|128,i[o++]=63&n|128;else{if((n=1024*(n-55296)+(e.charCodeAt(++r)-56320)+65536)>1114111)throw"Unicode standard supports code points up to U+10FFFF";i[o++]=240+(n>>>18),i[o++]=n>>>12&63|128,i[o++]=n>>>6&63|128,i[o++]=63&n|128}o>=64&&(this._dataLength+=64,t._md5cycle(this._state,a),o-=64,a[0]=a[16])}return this._bufferLength=o,this},t.prototype.appendAsciiStr=function(e){for(var n,r=this._buffer8,i=this._buffer32,a=this._bufferLength,o=0;;){for(n=Math.min(e.length-o,64-a);n--;)r[a++]=e.charCodeAt(o++);if(a<64)break;this._dataLength+=64,t._md5cycle(this._state,i),a=0}return this._bufferLength=a,this},t.prototype.appendByteArray=function(e){for(var n,r=this._buffer8,i=this._buffer32,a=this._bufferLength,o=0;;){for(n=Math.min(e.length-o,64-a);n--;)r[a++]=e[o++];if(a<64)break;this._dataLength+=64,t._md5cycle(this._state,i),a=0}return this._bufferLength=a,this},t.prototype.getState=function(){var t=this._state;return{buffer:String.fromCharCode.apply(null,this._buffer8),buflen:this._bufferLength,length:this._dataLength,state:[t[0],t[1],t[2],t[3]]}},t.prototype.setState=function(t){var e,n=t.buffer,r=t.state,i=this._state;for(this._dataLength=t.length,this._bufferLength=t.buflen,i[0]=r[0],i[1]=r[1],i[2]=r[2],i[3]=r[3],e=0;e<n.length;e+=1)this._buffer8[e]=n.charCodeAt(e)},t.prototype.end=function(e){void 0===e&&(e=!1);var n,r=this._bufferLength,i=this._buffer8,a=this._buffer32,o=1+(r>>2);if(this._dataLength+=r,i[r]=128,i[r+1]=i[r+2]=i[r+3]=0,a.set(t.buffer32Identity.subarray(o),o),r>55&&(t._md5cycle(this._state,a),a.set(t.buffer32Identity)),(n=8*this._dataLength)<=4294967295)a[14]=n;else{var s=n.toString(16).match(/(.*?)(.{0,8})$/),c=parseInt(s[2],16),u=parseInt(s[1],16)||0;a[14]=c,a[15]=u}return t._md5cycle(this._state,a),e?this._state:t._hex(this._state)},t._hex=function(e){var n,r,i,a,o=t.hexChars,s=t.hexOut;for(a=0;a<4;a+=1)for(r=8*a,n=e[a],i=0;i<8;i+=2)s[r+1+i]=o.charAt(15&n),n>>>=4,s[r+0+i]=o.charAt(15&n),n>>>=4;return s.join("")},t._md5cycle=function(t,e){var n=t[0],r=t[1],i=t[2],a=t[3];r=((r+=((i=((i+=((a=((a+=((n=((n+=(r&i|~r&a)+e[0]-680876936|0)<<7|n>>>25)+r|0)&r|~n&i)+e[1]-389564586|0)<<12|a>>>20)+n|0)&n|~a&r)+e[2]+606105819|0)<<17|i>>>15)+a|0)&a|~i&n)+e[3]-1044525330|0)<<22|r>>>10)+i|0,r=((r+=((i=((i+=((a=((a+=((n=((n+=(r&i|~r&a)+e[4]-176418897|0)<<7|n>>>25)+r|0)&r|~n&i)+e[5]+1200080426|0)<<12|a>>>20)+n|0)&n|~a&r)+e[6]-1473231341|0)<<17|i>>>15)+a|0)&a|~i&n)+e[7]-45705983|0)<<22|r>>>10)+i|0,r=((r+=((i=((i+=((a=((a+=((n=((n+=(r&i|~r&a)+e[8]+1770035416|0)<<7|n>>>25)+r|0)&r|~n&i)+e[9]-1958414417|0)<<12|a>>>20)+n|0)&n|~a&r)+e[10]-42063|0)<<17|i>>>15)+a|0)&a|~i&n)+e[11]-1990404162|0)<<22|r>>>10)+i|0,r=((r+=((i=((i+=((a=((a+=((n=((n+=(r&i|~r&a)+e[12]+1804603682|0)<<7|n>>>25)+r|0)&r|~n&i)+e[13]-40341101|0)<<12|a>>>20)+n|0)&n|~a&r)+e[14]-1502002290|0)<<17|i>>>15)+a|0)&a|~i&n)+e[15]+1236535329|0)<<22|r>>>10)+i|0,r=((r+=((i=((i+=((a=((a+=((n=((n+=(r&a|i&~a)+e[1]-165796510|0)<<5|n>>>27)+r|0)&i|r&~i)+e[6]-1069501632|0)<<9|a>>>23)+n|0)&r|n&~r)+e[11]+643717713|0)<<14|i>>>18)+a|0)&n|a&~n)+e[0]-373897302|0)<<20|r>>>12)+i|0,r=((r+=((i=((i+=((a=((a+=((n=((n+=(r&a|i&~a)+e[5]-701558691|0)<<5|n>>>27)+r|0)&i|r&~i)+e[10]+38016083|0)<<9|a>>>23)+n|0)&r|n&~r)+e[15]-660478335|0)<<14|i>>>18)+a|0)&n|a&~n)+e[4]-405537848|0)<<20|r>>>12)+i|0,r=((r+=((i=((i+=((a=((a+=((n=((n+=(r&a|i&~a)+e[9]+568446438|0)<<5|n>>>27)+r|0)&i|r&~i)+e[14]-1019803690|0)<<9|a>>>23)+n|0)&r|n&~r)+e[3]-187363961|0)<<14|i>>>18)+a|0)&n|a&~n)+e[8]+1163531501|0)<<20|r>>>12)+i|0,r=((r+=((i=((i+=((a=((a+=((n=((n+=(r&a|i&~a)+e[13]-1444681467|0)<<5|n>>>27)+r|0)&i|r&~i)+e[2]-51403784|0)<<9|a>>>23)+n|0)&r|n&~r)+e[7]+1735328473|0)<<14|i>>>18)+a|0)&n|a&~n)+e[12]-1926607734|0)<<20|r>>>12)+i|0,r=((r+=((i=((i+=((a=((a+=((n=((n+=(r^i^a)+e[5]-378558|0)<<4|n>>>28)+r|0)^r^i)+e[8]-2022574463|0)<<11|a>>>21)+n|0)^n^r)+e[11]+1839030562|0)<<16|i>>>16)+a|0)^a^n)+e[14]-35309556|0)<<23|r>>>9)+i|0,r=((r+=((i=((i+=((a=((a+=((n=((n+=(r^i^a)+e[1]-1530992060|0)<<4|n>>>28)+r|0)^r^i)+e[4]+1272893353|0)<<11|a>>>21)+n|0)^n^r)+e[7]-155497632|0)<<16|i>>>16)+a|0)^a^n)+e[10]-1094730640|0)<<23|r>>>9)+i|0,r=((r+=((i=((i+=((a=((a+=((n=((n+=(r^i^a)+e[13]+681279174|0)<<4|n>>>28)+r|0)^r^i)+e[0]-358537222|0)<<11|a>>>21)+n|0)^n^r)+e[3]-722521979|0)<<16|i>>>16)+a|0)^a^n)+e[6]+76029189|0)<<23|r>>>9)+i|0,r=((r+=((i=((i+=((a=((a+=((n=((n+=(r^i^a)+e[9]-640364487|0)<<4|n>>>28)+r|0)^r^i)+e[12]-421815835|0)<<11|a>>>21)+n|0)^n^r)+e[15]+530742520|0)<<16|i>>>16)+a|0)^a^n)+e[2]-995338651|0)<<23|r>>>9)+i|0,r=((r+=((a=((a+=(r^((n=((n+=(i^(r|~a))+e[0]-198630844|0)<<6|n>>>26)+r|0)|~i))+e[7]+1126891415|0)<<10|a>>>22)+n|0)^((i=((i+=(n^(a|~r))+e[14]-1416354905|0)<<15|i>>>17)+a|0)|~n))+e[5]-57434055|0)<<21|r>>>11)+i|0,r=((r+=((a=((a+=(r^((n=((n+=(i^(r|~a))+e[12]+1700485571|0)<<6|n>>>26)+r|0)|~i))+e[3]-1894986606|0)<<10|a>>>22)+n|0)^((i=((i+=(n^(a|~r))+e[10]-1051523|0)<<15|i>>>17)+a|0)|~n))+e[1]-2054922799|0)<<21|r>>>11)+i|0,r=((r+=((a=((a+=(r^((n=((n+=(i^(r|~a))+e[8]+1873313359|0)<<6|n>>>26)+r|0)|~i))+e[15]-30611744|0)<<10|a>>>22)+n|0)^((i=((i+=(n^(a|~r))+e[6]-1560198380|0)<<15|i>>>17)+a|0)|~n))+e[13]+1309151649|0)<<21|r>>>11)+i|0,r=((r+=((a=((a+=(r^((n=((n+=(i^(r|~a))+e[4]-145523070|0)<<6|n>>>26)+r|0)|~i))+e[11]-1120210379|0)<<10|a>>>22)+n|0)^((i=((i+=(n^(a|~r))+e[2]+718787259|0)<<15|i>>>17)+a|0)|~n))+e[9]-343485551|0)<<21|r>>>11)+i|0,t[0]=n+t[0]|0,t[1]=r+t[1]|0,t[2]=i+t[2]|0,t[3]=a+t[3]|0},t.stateIdentity=new Int32Array([1732584193,-271733879,-1732584194,271733878]),t.buffer32Identity=new Int32Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),t.hexChars="0123456789abcdef",t.hexOut=[],t.onePassHasher=new t,t}();e.Md5=n,n.hashStr("hello")},692:function(t,e,n){"use strict";n.r(e);var r=n(0),i=n(185),a=n(79),o=n(65),s=n(2),c=n(8),u=function(t){function e(e){var n=t.call(this,null,null,{isCore:!0})||this;n.addData(o.b.bootType,e),n.addData("FEServer",Object(s.j)()),n.addData("RefUrl",Object(s.q)());var r=Object(c.f)();r&&n.addData("pltnav",r.time);var i=Object(a.f)();return i&&i.UserOptions&&(i.UserOptions.ReactOptinSettings&&i.UserOptions.ReactOptinSettings.MailGraduatedFromBeta&&n.addCustomProperty("graduated","1"),n.addCustomProperty("optin",""+i.UserOptions.ClientTypeOptInState)),n}return Object(r.__extends)(e,t),e.prototype.getEventType=function(){return"Owa_PageLoadTime"},e}(i.a);function d(t,e){return t&&t>0&&e&&e>0?Math.floor(t-e):-1}var f=function(t){function e(e,n,r){var i=t.call(this,e,null)||this;return n&&(n.headers&&i.addData(o.b.correlationVectors,n.headers.get("ms-cv")),n.datapoint&&n.datapoint.customData&&i.addCustomData(n.datapoint.customData)),"number"==typeof r&&i.addData(o.b.attemptCount,r,!0),i.addData(o.b.throughAFD,Object(s.v)()),i}return Object(r.__extends)(e,t),e.prototype.getEventType=function(){return"client_network_request"},e.prototype.addResponseDiagnostics=function(t){t&&(t.headers&&(this.addData(o.b.requestIds,t.headers.get("request-id")),this.addData(o.b.afdId,t.headers.get("x-msedge-ref")),this.addData(o.b.contentEncoding,t.headers.get("content-encoding")),this.addData(o.b.responseContentLength,t.headers.get("content-length"),!0),this.logTimeDifferenceForHeaders(t.headers,"x-frontend-begin","x-frontend-end",o.c.FETimeElapsed),this.logTimeDifferenceForHeaders(t.headers,"x-backend-begin","x-backend-end",o.c.BETimeElapsed)),this.addData(o.b.status,t.status)),window.performance&&window.performance.now&&(this.parsingTime=window.performance.now())},e.prototype.addErrorDiagnostics=function(t){this.options=this.options||{},this.options.isCore=!0;var e=typeof t;"object"==e?(this.addData(o.a.errorMsg,t.message),this.addData(o.a.errorDetails,t.stack)):"string"==e&&this.addData(o.a.errorMsg,t)},e.prototype.addResourceTimings=function(t,e){this.addData(o.d.Type,t),this.parsingTime&&this.addTiming(o.b.responseRecieved,d(this.parsingTime,e.ST)),this.addTiming(o.d.WorkerStart,e.WS),this.addTiming(o.d.RedirectStart,e.RdS),this.addTiming(o.d.RedirectEnd,e.RdE),this.addTiming(o.d.FetchStart,e.FS),this.addTiming(o.d.DomainLookupStart,e.DS),this.addTiming(o.d.DomainLookupEnd,e.DE),this.addTiming(o.d.ConnectStart,e.CS),this.addTiming(o.d.SecureConnectionStart,e.SCS),this.addTiming(o.d.ConnectEnd,e.CE),this.addTiming(o.d.RequestStart,e.RqS),this.addTiming(o.d.ResponseStart,e.RpS),this.addTiming(o.d.ResponseEnd,e.RpE),this.addData(o.d.NextHopProtocol,e.P)},e.prototype.addTiming=function(t,e){this.addData(t,e,!0)},e.prototype.logTimeDifferenceForHeaders=function(t,e,n,r){var i=t.get(e),a=t.get(n),o=i?new Date(i):void 0,s=a?new Date(a):void 0;if(o&&s){var c=Math.abs(s.getTime()-o.getTime());this.addCustomProperty(r,c)}},e}(i.a),p=n(50),l=n(67),h=n(1072);function g(t){Object(l.f)("an-log-assets")&&t.forEach(function(t){if(t&&(Object(h.a)(t.name,".js")||Object(h.a)(t.name,".json"))){var e=t.name.split("/"),n=e[e.length-1],r=new f(n);r.addResourceTimings("Asset",t),mt(r)}})}function b(t,e){if(t){var n=t.fetchStart||t.startTime;return{name:e||t.name,ST:n,WS:d(t.workerStart,n),RdS:d(t.redirectStart,n),RdE:d(t.redirectEnd,n),FS:d(t.fetchStart,n),DS:d(t.domainLookupStart,n),DE:d(t.domainLookupEnd,n),CS:d(t.connectStart,n),SCS:d(t.secureConnectionStart,n),CE:d(t.connectEnd,n),RqS:d(t.requestStart,n),RpS:d(t.responseStart,n),RpE:d(t.responseEnd,n),P:t.nextHopProtocol}}}var m,v={},O={};function w(t){return new Promise(function(e){var n=T(t);if(!Object(p.f)()||-1==n)return e(void 0);v[n]=function(t,e){if(t)return function(n){t(n),e(n)};return e}(v[n],e),y(),clearTimeout(m),m=setTimeout(function(){var t,e;y();try{for(var n=Object(r.__values)(Object.keys(v)),i=n.next();!i.done;i=n.next()){S(i.value)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}O={}},2e3)})}function y(){var t,e,n;n=window.performance.getEntriesByType("resource"),O=n.reduce(function(t,e){var n=T(e.name);return n>-1&&(t[n]=e),t},O||{}),g(n.map(function(t){return b(t)})),window.performance.clearResourceTimings?window.performance.clearResourceTimings():window.performance.webkitClearResourceTimings&&window.performance.webkitClearResourceTimings();try{for(var i=Object(r.__values)(Object.keys(v)),a=i.next();!a.done;a=i.next()){var o=a.value,s=O[o];s&&S(o,s)}}catch(e){t={error:e}}finally{try{a&&!a.done&&(e=i.return)&&e.call(i)}finally{if(t)throw t.error}}}function S(t,e){v[t](b(e)),delete v[t],delete O[t]}var j=/n=([\d]+)/;function T(t){var e=j.exec(t);return e&&parseInt(e[1])||-1}function E(t,e,n,r,i){var a=new f(e,i,r);return t.then(function(t){return a.addResponseDiagnostics(t),i&&i.datapoint&&(i.datapoint.headersCustomData&&t&&a.addCustomData(i.datapoint.headersCustomData(t.headers)),i.datapoint.jsonCustomData)?t.clone().json().then(function(t){a.addCustomData(i.datapoint.jsonCustomData(t))}):Promise.resolve()}).catch(function(t){a.addErrorDiagnostics(t)}).then(function(){return w(n)}).then(function(t){t&&a.addResourceTimings("ServiceAction",t),mt(a)})}var _=n(3),D=n(429),A=n(286),C=function(t){var e=t.eventName;if(e&&Object(_.d)("dp")&&(!Object(_.a)("dp")||e.toLowerCase().indexOf(Object(_.a)("dp").toLowerCase())>-1)||Object(D.a)().traceDatapoints)Object(A.a)(t.properties),Object(A.b)(t)},L=function(){var t=navigator,e=t.connection||t.mozConnection||t.webkitConnection;return e?{type:e.type,effectiveType:e.effectiveType,downlink:e.downlink,rtt:e.rtt,saveData:e.saveData}:null},I=null,x=!1;"undefined"!=typeof location&&(x=location.hostname&&location.hostname.indexOf("live.com")>-1);var R=function(){if(!I){var t=Object(a.f)();t&&(I=t.IsConsumerChild?"c_child":t.SessionSettings.IsPremiumConsumerMailbox?"c_premium":t.SessionSettings.IsShadowMailbox?"c_shadow":x?"c_standard":"business")}return I},k=n(179);function P(t){return k.AWTLogManager.getLogger(t)}function M(t){return{name:t,properties:{}}}function F(t,e,n,r){var i={Features:JSON.stringify(Object(l.b)()),ServiceVersion:Object(s.t)(),Dag:Object(s.h)(),BootType:r,UserAgent:window.navigator.userAgent};if(e){var a=e.UserOptions,o=e.ViewStateConfiguration,c={WindowWidth:window.innerWidth,WindowHeight:window.innerHeight};window.screen&&(c.ScreenWidth=window.screen.availWidth,c.ScreenHeight=window.screen.availHeight),i.Settings=JSON.stringify({ReadingPanePosition:a.GlobalReadingPanePositionReact,ListViewType:a.GlobalListViewTypeReact,FocusedEnabled:a.IsFocusedInboxEnabled,FocusedInboxBits:o.FocusedInboxBitFlags,ListViewBits:o.ListViewBitFlags,FolderViewBits:o.GlobalFolderViewState,PreviewText:a.ShowPreviewTextInListView,SenderOnTop:a.ShowSenderOnTopInListView,InlinePreviews:a.ShowInlinePreviews,HoverActions:o.MailTriageOnHoverActions,Ponts:a.NewEnabledPonts,Theme:(a.ThemeStorageId||"")+"|"+a.IsDarkModeTheme,MasterCategories:(e.MasterCategoryList.MasterList||[]).length,IsEdu:n&&n.IsEdu,NetworkInfo:L(),Dimensions:c,AdMarket:e.AdMarket,DisplayDensity:a.DisplayDensityMode,ConsumerAdsExperiment:a.ConsumerAdsExperimentMode,Domain:e.SessionSettings.TenantDomain}),i.Dates=JSON.stringify({OwaLogon:a.FirstOWALogon,MailLogon:a.FirstOWAReactMailLogon,PeopleLogon:a.FirstOWAReactPeopleLogon,CalendarLogon:a.FirstOWAReactCalendarLogon,MiniLogon:a.FirstOWAReactMiniLogon,MailboxCreate:e.MailboxCreateDate})}var u=function(t){var e={name:"session",type:"session",properties:t};return e.priority=k.AWTEventPriority.High,e}(i);N(u),P(t).logEvent(u)}function N(t){var e=Object(a.f)().SessionSettings;t.properties.BEServer=Object(s.d)(),t.properties.MBXGuid=e.MailboxGuid,t.properties.Forest=Object(s.i)(),t.properties.Puid=e.UserPuid,t.properties.ClientId=Object(s.f)(),t.properties.Ring=Object(s.m)(),t.properties.UserType=R(),t.properties.App=Object(s.c)(),t.properties.Layout="Desktop",t.properties.TenantGuid=e.ExternalDirectoryTenantGuid,t.properties["Session.Id"]=Object(s.u)(),t.properties.PhysicalRing=Object(s.p)(),t.properties.Host=Object(s.k)(),t.properties.HostedScenario=Object(s.l)()}var W=n(5383),U=n(279),H=["https://swc.cdn.skype.com","https://acdn.adnxs.com/","https://s.aolcdn.com"];var B,q="client_error",V="diagnostics",G=function(t){function e(e){var n,r,i=this,a=e.stack||e.message,o=a?W.Md5.hashStr(a):-1;(i=t.call(this,o)||this).isExternal=(n=e.message,r=e.stack,H.some(function(t){return n&&n.indexOf(t)>-1||r&&r.indexOf(t)>-1}));try{i.addData("message",e.message),i.addData("background",Object(U.b)()),i.addIfNotNull("name",e.name),i.addIfNotNull("stack",e.stack||new Error(e.message).stack),i.addIfNotNull("file",e.filename),i.addIfNotNull("line",e.lineno,!0),i.addIfNotNull("col",e.colno,!0),i.addIfNotNull("httpstatus",e.httpStatus,!0),i.addIfNotNull(V,e.diagnosticInfo),window&&window.navigator&&"boolean"==typeof window.navigator.onLine&&i.addData("online",window.navigator.onLine)}catch(t){i.addData(V,t.message)}return i}return Object(r.__extends)(e,t),e.prototype.getEventType=function(){return this.isExternal?"client_error_external":q},e.prototype.addIfNotNull=function(t,e,n){e&&this.addData(t,e,n)},e}(i.a);function $(t){return void 0===B&&(B=Math.floor(1e4*Math.random())),B<100*t}var z=n(357),J=n(63),K=n(113),X=n(246),Z="EUII";function Y(t,e){if(Object(l.f)("fwk-sigs")){var n=Object(a.f)(),r=n&&n.SessionSettings,i=e&&e.customProperties?e.customProperties:{},o={SignalType:t,Locale:r&&r.UserCulture,Compliance:e&&e.compliance||Z,StartTime:(e&&e.start||new Date).toISOString(),EndTime:(new Date).toISOString(),Application:{AadAppId:"00000002-0000-0ff1-ce00-000000000000",AppName:"OWA",AppVer:Object(s.g)(),Workload:"EXO"},Actor:{AadTenantId:r&&r.ExternalDirectoryTenantGuid,ActorIdType:Object(X.a)()?"MSA":"AAD",ActorId:r&&Q(r),ActorType:"User"},Device:{},CustomProperties:i};e&&e.itemId&&(o.Item={ItemType:"Message",ItemId:e.itemId}),Object(K.d)("/api/v2.0/me/signals",o,null,!1,{Prefer:'exchange.behavior="SignalAccessV2,OpenComplexTypeExtensions,EhamJitProvisioning",outlook.data-source="Substrate"'},!1,!0,!0,"SigsUpload",{customData:{Type:t}})}}function Q(t){return(Object(X.a)()?"":"PUID:")+t.UserPuid}var tt=n(386),et=window.owaBackfilledErrors;var nt,rt=n(129),it=n(403),at=n(388),ot=n(127);n.d(e,"getInitializeAnalyticsPromse",function(){return ct}),n.d(e,"defaultAnalyticsOptions",function(){return ut}),n.d(e,"initializeAnalytics",function(){return dt}),n.d(e,"getOTelAddinsLogger",function(){return ft}),n.d(e,"flush",function(){return pt}),n.d(e,"shouldLogDatapoint",function(){return bt}),n.d(e,"logDatapoint",function(){return mt}),n.d(e,"logCLPAriaDataPoint",function(){return wt}),n.d(e,"getResourceTimingForUrl",function(){return w}),n.d(e,"logSigsDatapoint",function(){return Y});var st=new Promise(function(t){nt=t});function ct(){return st}var ut={ariaTenantTokens:[],isTesting:!1,maxErrorsPerSession:100,flightControls:null,verboseWhiteListEvents:[]};function dt(t){return Object(r.__awaiter)(this,void 0,void 0,function(){var e,n,i,o,d,f;return Object(r.__generator)(this,function(h){switch(h.label){case 0:if(!(t&&t.ariaTenantTokens&&t.ariaTenantTokens.length>0))return[3,6];if(t=Object(r.__assign)(Object(r.__assign)({},ut),t),(Object(l.f)("ring-dogfood")||Object(l.f)("an-no-sample-ppe"))&&delete t.flightControls,m=t.ariaTenantTokens[0],k.AWTLogManager.setTransmitProfile(k.AWT_NEAR_REAL_TIME),k.AWTLogManager.initialize(m),e=k.AWTLogManager.getSemanticContext(),n=Object(a.f)(),e&&(e.setAppVersion(Object(s.g)()),n&&(e.setUserTimeZone(n.UserOptions.TimeZone),e.setUserLanguage(n.SessionSettings.UserCulture))),nt(t),lt(t))return[3,5];h.label=1;case 1:return h.trys.push([1,,4,5]),[4,Object(at.a)()];case 2:return i=h.sent(),[4,Object(s.e)()];case 3:return o=h.sent(),[3,5];case 4:return t.ariaTenantTokens.forEach(function(t){F(t,n,i,o)}),mt(new u(o)),[7];case 5:!function(t){for(var e=0;e<et.length;e++)t.apply(null,et[e]);window.owaErrorHandler=t,et=[]}(J.b),window.performance&&window.performance.timing&&g([b(window.performance.timing,"indexPage")]),(d=Object(p.e)()).errors.forEach(Ot),d.network.forEach(function(t){return E.apply(null,t)}),Object(J.c)(function(t,e,n){e==J.a.Error&&Ot(n)}),Object(rt.registerCreateServiceResponseCallback)(E),Object(it.b)(E),(f=Object(c.f)())&&new ot.a("PageLoadTime",{isCore:!0,isCosmosDatapoint:!0}).end(f.time,function(t,e){if("ok"==t)return"Success";if("fail"==t)return e?"ServerError":"ClientError";return"UserError"}(f.status,f.isServer)),h.label=6;case 6:return[2]}var m})})}function ft(t){return P(t)}function pt(){k.AWTLogManager.flush(function(){})}function lt(t){return Object(_.e)()||t&&t.isTesting||Object(s.w)()}function ht(t,e){return!e||!e.flightControls||t.options&&t.options.isCore?null:e.flightControls[t.getEventType()]}var gt=0;function bt(t,e){var n=t.getEventType();if(Object(i.d)(n))return!0;if(n==i.b&&(!e.verboseWhiteListEvents||-1==e.verboseWhiteListEvents.indexOf(t.eventName)))return!1;if(n==q&&++gt>e.maxErrorsPerSession)return!1;var r=ht(t,e);return!(r&&!Object(l.c)(r.flight))&&((!t.options||!t.options.logEvery||(t.sessionOccurence-1)%t.options.logEvery==0)&&((!t.options||!t.options.ring||t.options.ring==Object(s.m)())&&(function(t){return!t.options||!t.options.sessionSampleRate||$(t.options.sessionSampleRate)}(t)&&function(t){switch(t.options&&t.options.variant){case 0:return!1;case 2:return 1==t.sessionOccurence;case 3:return t.sessionOccurence>1;default:return!0}}(t))))}function mt(t){st.then(function(e){var n=Object(l.f)("an-full-logging"),r=ht(t,e);if((bt(t,e)||n)&&(C(t),!lt(e)))for(var a=function(t,e){return e&&e.tenantTokens?e.tenantTokens:t.ariaTenantTokens}(e,t.options),o=t.getEventType(),s=0;s<a.length;s++){var c=M(n?i.b:o);n&&(c.properties.OriginalEvent=o);for(var u=Object.keys(t.properties),d=0;d<u.length;d++){var f=t.properties[u[d]];c.properties[u[d]]=f.value}N(c),c.properties.Sampled=r&&r.rate?r.rate:100,t.propertyBag&&(c.properties.MiscData=Object(A.b)(t)),t.piiBag&&(c.properties.PiiData={value:Object(A.a)(t.piiBag),pii:k.AWTPiiKind.GenericData}),P(a[s]).logEvent(c)}})}var vt=["out of memory","not enough storage is available"];function Ot(t){try{var e=t.networkError?"NETWORK_ERROR":function(t){if(t)for(var e=0;e<vt.length;e++)if(t.toLowerCase().indexOf(vt[e])>-1)return!0;return!1}(t.message)&&"MEMORY_ERROR";mt(e?new tt.a(e,{message:t.message,diagnosticInfo:t.diagnosticInfo}):new G(t))}catch(t){}}function wt(t){var e=M("CLPLabel");Object.keys(t).map(function(n){e.properties[n]=t[n]}),P(Object(z.b)()).logEvent(e)}},774:function(t,e,n){"use strict";var r=Array.isArray;e.a=r},819:function(t,e,n){"use strict";var r=n(1022);e.a=function(t){var e=Object(r.a)(t),n=e%1;return e==e?n?e-n:e:0}},840:function(t,e,n){"use strict";var r=n(875);e.a=function(t){return null==t?"":Object(r.a)(t)}},874:function(t,e,n){"use strict";e.a=function(t,e){for(var n=-1,r=null==t?0:t.length,i=Array(r);++n<r;)i[n]=e(t[n],n,t);return i}},875:function(t,e,n){"use strict";var r=n(196),i=n(874),a=n(774),o=n(328),s=1/0,c=r.a?r.a.prototype:void 0,u=c?c.toString:void 0;e.a=function t(e){if("string"==typeof e)return e;if(Object(a.a)(e))return Object(i.a)(e,t)+"";if(Object(o.a)(e))return u?u.call(e):"";var n=e+"";return"0"==n&&1/e==-s?"-0":n}}}]);
//# sourceMappingURL=owa.Analytics.js.map
self.scriptsLoaded['owa.Analytics.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.Analytics.js'] = (new Date()).getTime();