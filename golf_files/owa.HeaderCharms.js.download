self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.HeaderCharms.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[287],{10649:function(e){e.exports={b:"P7b",a:"Q7b"}},1325:function(e,t,a){"use strict";var r=a(4),n=Object(r.actionCreator)("ADD_CHAT_TAB",function(e){return{chatConversationId:e}});t.a=n},1886:function(e,t,a){"use strict";var r=a(4),n=Object(r.createStore)("SkypeStore",{unreadConversationCount:0,isRecentsInitialized:!1,isSwcInitialized:!1,isGlimpseOpen:!1})();t.a=n},2151:function(e,t,a){"use strict";a.d(t,"a",function(){return i});var r=a(67),n=a(820);function i(){return Object(r.f)("rp-skypeInTabs")&&1==Object(n.b)()}},2152:function(e,t,a){var r=a(3127),n=a(45);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)n.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},2277:function(e,t,a){"use strict";var r=a(0),n=a(5),i=a(105),o=a(498),c=a(765),s=a(1842),u=a(1),l=a(297),d=a(2152),b=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.onCharmClicked=function(e){Object(s.c)(t.props.behavior.charm)},t.onDismiss=function(){Object(s.a)(t.props.behavior.charm)},t}return Object(r.__extends)(t,e),t.prototype.render=function(){var e=this.CharmBehavior,t=this.props,a=t.getBadgeCount,i=t.className,o=t.title,s=t.ariaLabel,b=t.activeClassName,m=t.ariaLabelWithBadgeCount,h=a?a():0,p=l(i,d.charm,e.isActive&&b,e.isActive&&d.charmActive),f={role:c.a.menuitem,expanded:e.isActive,hasPopup:!0,label:h>0&&m?Object(n.b)(m,h):s};return u.createElement("button",Object(r.__assign)({className:p,onClick:e.charmOnClick,title:o,"data-is-focusable":"true"},Object(c.b)(f)),this.renderGlyph(),e.hostedContent,h>0&&u.createElement("div",{className:d.badgeCounter},h))},Object.defineProperty(t.prototype,"CharmBehavior",{get:function(){var e=this.props.behavior;if(!e)return{isActive:!1,charmOnClick:null,hostedContent:null};var t=e,a=e,r=void 0!==t.isActive?t.isActive:a.charm===Object(s.b)();return{isActive:r,charmOnClick:t.onClick||this.onCharmClicked,hostedContent:t.content||r&&a.paneComponent&&u.createElement(a.paneComponent,{onDismiss:this.onDismiss})}},enumerable:!0,configurable:!0}),t.prototype.renderGlyph=function(){var e=this.props.icons;return e.iconName?[u.createElement(o.a,{className:d.suiteCharmIcon,iconName:e.iconName,key:"base"}),u.createElement(o.a,{className:d.suiteHoverCharmIcon,iconName:e.hoverIconName||e.iconName,key:"hover"})]:this.props.icons.charmContent},t=Object(r.__decorate)([i.observer],t)}(u.Component);t.a=b},2707:function(e,t,a){"use strict";var r=a(1886),n=a(51),i=a(1325),o=a(67),c=function(){return!Object(o.f)("fwk-partner-code-off")&&!Object(o.f)("fwk-skypeSuite")&&Object(o.f)("fwk-skypeConsumer")},s=a(2151);a.d(t,"a",function(){return l}),a.d(t,"i",function(){return d}),a.d(t,"h",function(){return b}),a.d(t,"d",function(){return m}),a.d(t,"e",function(){return h}),a.d(t,"g",function(){return p}),a.d(t,"f",function(){return f}),a.d(t,"k",function(){return r.a}),a.d(t,"b",function(){return i.a}),a.d(t,"c",function(){return s.a}),a.d(t,"j",function(){return c});var u=new n.c(function(){return Promise.all([a.e(2),a.e(456)]).then(a.bind(null,14675))}),l=Object(n.d)(u,function(e){return e.SkypeGlimpse}),d=new n.a(u,function(e){return e.updateIsGlimpseOpen}),b=new n.b(u,function(e){return e.shouldShowUnreadConversationCount}),m=new n.a(u,function(e){return e.beginSkypeInitialization}),h=new n.a(u,function(e){return e.createOnSwcReadyEvent}),p=new n.a(u,function(e){return e.onNotificationReceived}),f=new n.a(u,function(e){return e.onHideNotificationReceived})},3127:function(e,t,a){(t=e.exports=a(44)(!1)).push([e.i,'._3ioEp2RGR5vb0gqRDsaFPa{width:48px;height:48px;-webkit-box-flex:0;-ms-flex:0 0 auto;flex:0 0 auto;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;cursor:pointer;color:"[theme:headerTextIcons, default:#FFFFFF]";position:relative}html[dir] ._3ioEp2RGR5vb0gqRDsaFPa{background:"[theme:headerButtonsBackground, default:#0078D4]";border-radius:0}._3ioEp2RGR5vb0gqRDsaFPa ._8ZbC_RYWrRjKXGOOsvA0d,._3ioEp2RGR5vb0gqRDsaFPa ._2yz8OiT5Kpykvmi_5RGORW{font-size:20px}._3ioEp2RGR5vb0gqRDsaFPa ._1euZDO_V1bY8yM5-2Mq_8G,._3ioEp2RGR5vb0gqRDsaFPa ._2Am2jvTaBz17UJ8XnfxFOy{font-size:16px}._3ioEp2RGR5vb0gqRDsaFPa ._2yz8OiT5Kpykvmi_5RGORW,._3ioEp2RGR5vb0gqRDsaFPa ._2Am2jvTaBz17UJ8XnfxFOy{display:none}html[dir] ._3ioEp2RGR5vb0gqRDsaFPa:focus,html[dir] ._3ioEp2RGR5vb0gqRDsaFPa:hover{background:"[theme:headerButtonsBackgroundHover, default:#005A9E]"}._3ioEp2RGR5vb0gqRDsaFPa:focus{outline:1px solid;outline-offset:-1px}._3ioEp2RGR5vb0gqRDsaFPa ._1euZDO_V1bY8yM5-2Mq_8G,._3ioEp2RGR5vb0gqRDsaFPa:hover ._8ZbC_RYWrRjKXGOOsvA0d{display:none}._3ioEp2RGR5vb0gqRDsaFPa ._2Am2jvTaBz17UJ8XnfxFOy,._3ioEp2RGR5vb0gqRDsaFPa:hover ._2yz8OiT5Kpykvmi_5RGORW{display:inline-block}._2TZmd9B7xpvpgKwm5-SCMt ._3ioEp2RGR5vb0gqRDsaFPa{color:#fff}html[dir] ._2TZmd9B7xpvpgKwm5-SCMt ._3ioEp2RGR5vb0gqRDsaFPa{background:"[theme:headerButtonsBackgroundSearch, default:#005A9E]"}html[dir] ._2TZmd9B7xpvpgKwm5-SCMt ._3ioEp2RGR5vb0gqRDsaFPa:hover{background:"[theme:headerButtonsBackgroundSearchHover, default:#004578]"}.TMe4jJ7-qMLF9DKksr8tK,.TMe4jJ7-qMLF9DKksr8tK:hover,._2TZmd9B7xpvpgKwm5-SCMt .TMe4jJ7-qMLF9DKksr8tK,._2TZmd9B7xpvpgKwm5-SCMt .TMe4jJ7-qMLF9DKksr8tK:hover{color:"[theme:themeDark, default:#0D62AA]"}html[dir] .TMe4jJ7-qMLF9DKksr8tK,html[dir] .TMe4jJ7-qMLF9DKksr8tK:hover,html[dir] ._2TZmd9B7xpvpgKwm5-SCMt .TMe4jJ7-qMLF9DKksr8tK,html[dir] ._2TZmd9B7xpvpgKwm5-SCMt .TMe4jJ7-qMLF9DKksr8tK:hover{background:"[theme:white, default:#ffffff]"}html[dir] ._1bH6B2zYS95bLsUm2lWCoD{border:transparent;-webkit-box-shadow:none;box-shadow:none}._2q34ENdgmNtl6jikB850Hn,._1ciiC6HCLa0f-UISNw1idm{position:absolute}._2q34ENdgmNtl6jikB850Hn{width:18px;height:18px;line-height:14px!important;font-size:12px;font-weight:400;top:-17px;color:"[theme:headerBadgeText, default:#FFFFFF]"}html[dir] ._2q34ENdgmNtl6jikB850Hn{border-radius:.8em;background:"[theme:headerBadgeBackground, default:#004578]";text-align:center}html[dir=ltr] ._2q34ENdgmNtl6jikB850Hn{left:-1px}html[dir=rtl] ._2q34ENdgmNtl6jikB850Hn{right:-1px}._1vrqe4bdWVTV-LL1iHA5aW{font-size:10px;color:"[theme:white, default:#ffffff]";min-width:16px;height:16px;line-height:16px;top:8px;position:absolute}html[dir] ._1vrqe4bdWVTV-LL1iHA5aW{border-radius:16px;background-color:"[theme:themeDarker, default:#004578]";text-align:center}html[dir=ltr] ._1vrqe4bdWVTV-LL1iHA5aW{right:7px}html[dir=rtl] ._1vrqe4bdWVTV-LL1iHA5aW{left:7px}html[dir] .eKX1Dg5Zxt3n0ijWtDO5K:hover i{-webkit-transform:translateY(3%) scale(1.25);transform:translateY(3%) scale(1.25);-webkit-transition:all .25s;transition:all .25s}',""]),t.locals={charm:"_3ioEp2RGR5vb0gqRDsaFPa",charmIcon:"_8ZbC_RYWrRjKXGOOsvA0d",hoverCharmIcon:"_2yz8OiT5Kpykvmi_5RGORW",suiteCharmIcon:"_1euZDO_V1bY8yM5-2Mq_8G",suiteHoverCharmIcon:"_2Am2jvTaBz17UJ8XnfxFOy",inSearch:"_2TZmd9B7xpvpgKwm5-SCMt",charmActive:"TMe4jJ7-qMLF9DKksr8tK",notificationCallout:"_1bH6B2zYS95bLsUm2lWCoD",unseenBadge:"_2q34ENdgmNtl6jikB850Hn",unseenContainer:"_1ciiC6HCLa0f-UISNw1idm",badgeCounter:"_1vrqe4bdWVTV-LL1iHA5aW",launchManagePremium:"eKX1Dg5Zxt3n0ijWtDO5K"}},3302:function(e,t,a){"use strict";a.d(t,"a",function(){return n});var r=a(4),n=Object(r.createStore)("chatStore",{isChatCalloutShown:!1,chatProvider:0});n()},3363:function(e){e.exports={a:"N7b"}},3876:function(e,t,a){"use strict";a.d(t,"a",function(){return i});var r=a(4),n={chats:[],isMoreChatMenuShown:!1,participantCache:new(a(20).ObservableMap)},i=Object(r.createStore)("ucmaStore",n);i()},4288:function(e,t,a){"use strict";a.d(t,"e",function(){return n}),a.d(t,"b",function(){return i}),a.d(t,"c",function(){return o}),a.d(t,"d",function(){return c}),a.d(t,"a",function(){return s});var r=a(3876);function n(){return Object(r.a)().chats.filter(function(e){return 1==e.state||2==e.state})}function i(){return Object(r.a)().chats.filter(function(e){return 0==e.state})}function o(){return Object(r.a)().chats.filter(function(e){return 0==e.state||c(e)>0}).length}function c(e){return e.lastMessageSequence-e.lastReadMessageSequence}function s(){return Object(r.a)().chats.filter(function(e){return 4==e.state})}},4936:function(e,t,a){"use strict";a.r(t);var r=a(0),n=a(3259),i=a(10649),o=a(3363),c=a(5),s=a(2277),u=a(105),l=a(67),d=a(1447),b=a(3302),m=a(4288),h=a(7261);function p(){switch(Object(b.a)().chatProvider){case 3:return Object(m.c)();case 4:return Object(h.a)().unreadCount;default:return 0}}var f=a(1207),v=a(1),k=a(143),g=a(2707),C=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.setCharmDiv=function(e){t.charmDiv=k.findDOMNode(e)},t}return Object(r.__extends)(t,e),t.prototype.onDismiss=function(){g.i.importAndExecute(!1)},t.prototype.onUcmaDismiss=function(){d.d.importAndExecute(!1)},t.prototype.render=function(){if(!Object(l.f)("fwk-skypeBusinessV2"))return g.k.isSwcInitialized&&this.renderCharm(g.k.isGlimpseOpen,"SkypeLogo",Object(c.a)(n.a),Object(c.a)(i.a),g.k.isGlimpseOpen&&this.renderCharmContent(),this.onClickNonUcmaCharm,this.getBadgeCount);var e=Object(b.a)();switch(e.chatProvider){case 3:return!Object(l.f)("fwk-skypeSuite")&&3==f.a.signInState&&this.renderCharm(e.isChatCalloutShown,"SkypeForBusinessLogo",Object(c.a)(o.a),Object(c.a)(i.b),e.isChatCalloutShown&&v.createElement(d.a,{onDismiss:this.onUcmaDismiss,target:this.charmDiv}),this.onClickUcmaOrUcwaCharm,p);case 4:return!Object(l.f)("fwk-skypeSuite")&&this.renderCharm(e.isChatCalloutShown,"SkypeForBusinessLogo",Object(c.a)(o.a),Object(c.a)(i.b),null,this.onClickUcmaOrUcwaCharm,p);case 5:return!Object(l.f)("fwk-skypeSuite")&&this.renderCharm(!1,"OfficeChat",Object(c.a)(o.a),Object(c.a)(i.b),void 0,this.onClickTeams,this.getBadgeCount);default:return null}},t.prototype.renderCharm=function(e,t,a,r,n,i,o){return v.createElement(s.a,{ref:this.setCharmDiv,key:"skype",icons:{iconName:t,hoverIconName:t},title:a,ariaLabel:a,ariaLabelWithBadgeCount:r,behavior:{isActive:e,content:n,onClick:i,charm:10},getBadgeCount:o})},t.prototype.renderCharmContent=function(){return v.createElement(g.a,{onDismiss:this.onDismiss,target:this.charmDiv})},t.prototype.getBadgeCount=function(){return g.h.tryImportForRender()?g.k.unreadConversationCount:null},t.prototype.onClickUcmaOrUcwaCharm=function(){d.d.import().then(function(e){return e(!Object(b.a)().isChatCalloutShown)})},t.prototype.onClickNonUcmaCharm=function(){var e=g.k.isGlimpseOpen;g.i.importAndExecute(!e)},t.prototype.onClickTeams=function(){window.open("https://teams.microsoft.com")},t=Object(r.__decorate)([u.observer],t)}(v.Component);a.d(t,"SkypeCharm",function(){return C})},7261:function(e,t,a){"use strict";a.d(t,"a",function(){return n});var r=a(4),n=Object(r.createStore)("ucwaStore",{unreadCount:0});n()},765:function(e,t,a){"use strict";var r={alert:"alert",alertdialog:"alertdialog",application:"application",article:"article",banner:"banner",button:"button",cell:"cell",checkbox:"checkbox",columnheader:"columnheader",combobox:"combobox",complementary:"complementary",contentinfo:"contentinfo",definition:"definition",dialog:"dialog",directory:"directory",document:"document",feed:"feed",figure:"figure",form:"form",grid:"grid",gridcell:"gridcell",group:"group",heading:"heading",img:"img",link:"link",list:"list",listbox:"listbox",listitem:"listitem",log:"log",main:"main",marquee:"marquee",math:"math",menu:"menu",menubar:"menubar",menuitem:"menuitem",menuitemcheckbox:"menuitemcheckbox",menuitemradio:"menuitemradio",navigation:"navigation",note:"note",option:"option",presentation:"presentation",progressbar:"progressbar",radio:"radio",radiogroup:"radiogroup",region:"region",row:"row",rowgroup:"rowgroup",rowheader:"rowheader",scrollbar:"scrollbar",search:"search",searchbox:"searchbox",separator:"separator",slider:"slider",spinbutton:"spinbutton",status:"status",switch:"switch",tab:"tab",table:"table",tablist:"tablist",tabpanel:"tabpanel",term:"term",textbox:"textbox",timer:"timer",toolbar:"toolbar",tooltip:"tooltip",tree:"tree",treegrid:"treegrid",treeitem:"treeitem"},n=0;function i(e){return void 0===e&&(e="id"),""+e+n++}function o(e){return Array.isArray(e)?e.join(" "):e}function c(e){if(!e)return null;for(var t={},a=Object.keys(e),r=0;r<a.length;r++){switch(a[r]){case"role":t.role=e.role;break;case"id":t.id=e.id;break;case"activeDescendant":t["aria-activedescendant"]=e.activeDescendant;break;case"atomic":t["aria-atomic"]=e.atomic;break;case"autocomplete":t["aria-autocomplete"]=e.autocomplete;break;case"busy":t["aria-busy"]=e.busy;break;case"checked":t["aria-checked"]=e.checked;break;case"controls":t["aria-controls"]=o(e.controls);break;case"describedBy":t["aria-describedby"]=o(e.describedBy);break;case"disabled":t["aria-disabled"]=e.disabled;break;case"dropEffect":t["aria-dropeffect"]=o(e.dropEffect);break;case"expanded":t["aria-expanded"]=e.expanded;break;case"flowTo":t["aria-flowto"]=o(e.flowTo);break;case"grabbed":t["aria-grabbed"]=e.grabbed;break;case"hasPopup":t["aria-haspopup"]=e.hasPopup;break;case"hidden":t["aria-hidden"]=e.hidden;break;case"invalid":t["aria-invalid"]=e.invalid;break;case"label":t["aria-label"]=e.label;break;case"labelledBy":t["aria-labelledby"]=o(e.labelledBy);break;case"level":t["aria-level"]=e.level;break;case"live":t["aria-live"]=e.live;break;case"multiline":t["aria-multiline"]=e.multiline;break;case"multiselectable":t["aria-multiselectable"]=e.multiselectable;break;case"orientation":t["aria-orientation"]=e.orientation;break;case"owns":t["aria-owns"]=o(e.owns);break;case"positionInSet":t["aria-posinset"]=e.positionInSet;break;case"pressed":t["aria-pressed"]=e.pressed;break;case"readonly":t["aria-readonly"]=e.readonly;break;case"relevant":t["aria-relevant"]=o(e.relevant);break;case"required":t["aria-required"]=e.required;break;case"selected":t["aria-selected"]=e.selected;break;case"setSize":t["aria-setsize"]=e.setSize;break;case"sort":t["aria-sort"]=e.sort;break;case"valueMax":t["aria-valuemax"]=e.valueMax;break;case"valueMin":t["aria-valuemin"]=e.valueMin;break;case"valueNow":t["aria-valuenow"]=e.valueNow;break;case"valueText":t["aria-valuetext"]=e.valueText}}return t}a.d(t,"a",function(){return r}),a.d(t,"c",function(){return i}),a.d(t,"b",function(){return c})}},0,[0,1,2,3,457,456]]);
//# sourceMappingURL=owa.HeaderCharms.js.map
self.scriptsLoaded['owa.HeaderCharms.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.HeaderCharms.js'] = (new Date()).getTime();