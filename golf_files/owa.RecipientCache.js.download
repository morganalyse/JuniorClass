self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.RecipientCache.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[423],{1122:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(803);function i(e){var t,n="";e&&(Object(r.a)()?(t=e).Groups&&t.Instrumentation&&(n=t.Instrumentation.TraceId):"Success"==(t=e).ResponseClass&&t.ResultSet&&(n=t.TransactionId));return n}},1330:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(131),i=n(1378);t.default=function(e,t){return void 0===e||e.__type||(e=i.default(e)),r.makeServiceRequest("AddEntityFeedback",e,t)}},1331:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"AddEntityFeedbackRequest:#Exchange"},e)}},1378:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"AddEntityFeedbackJsonRequest:#Exchange"},e)}},1569:function(e,t,n){"use strict";n.d(t,"b",function(){return a}),n.d(t,"a",function(){return c});var r=n(51),i=new r.c(function(){return Promise.all([n.e(30),n.e(55),n.e(561),n.e(100)]).then(n.bind(null,2546))}),a=new r.b(i,function(e){return e.searchCacheTrie}),c=new r.a(i,function(e){return e.initializeSuggestionTrie})},1701:function(e,t,n){"use strict";var r=n(5),i=n(1223);function a(e,t,n){var a=e.EmailAddresses,u=e.DisplayName,d=e.Text,l=e.PDLItemId,b=e.ADObjectId,f=e.PersonaId,p=e.FeatureData,y=e.Id,I=e.ReferenceId,m=e.ImAddress,O=e.JobTitle,v=e.PeopleSubtype,h=a?a[0]:null;if(!n&&function(e){return Object(i.b)().sessionMaskedRecipients[e]}(h))return null;var j={EmailAddress:h,Name:Object(r.g)(u)?d:u,MailboxType:o(v),RoutingType:c(v),ItemId:l?{Id:l,__type:"ItemId:#Exchange"}:null};return{DisplayName:u,ADObjectId:b,FeatureData:p,Id:y,ImAddress:m,EmailAddress:j,EmailAddresses:[j],PersonaTypeString:s(v),PersonaId:{Id:f},Title:O,ReferenceId:I,TransactionId:t}}function c(e){return"PersonalDistributionList"==e?"MAPIPDL":"SMTP"}function s(e){switch(e){case"PublicDistributionList":case"PersonalDistributionList":return"DistributionList";case"UnifiedGroup":return"ModernGroup";case"OrganizationUser":case"PersonalContact":case"ImplicitContact":case"OrganizationContact":return"Person";case"LinkedIn":return"LinkedIn";case"ImplicitGroup":return"ImplicitGroup";default:return"Unknown"}}function o(e){switch(e){case"PublicDistributionList":return"PublicDL";case"PersonalDistributionList":return"PrivateDL";case"UnifiedGroup":return"GroupMailbox";case"ImplicitGroup":return"RecommendedGroup";case"OrganizationUser":return"InternalMailbox";case"LinkedIn":return"LinkedIn";case"PersonalContact":case"OrganizationContact":case"ImplicitContact":case"Guest":case"Unknown":return"ExternalMailbox";default:return e}}n.d(t,"a",function(){return a})},1770:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"ContextProperty:#Exchange"},e)}},1825:function(e,t,n){"use strict";function r(e){return e?e.EmailAddress&&e.EmailAddress.EmailAddress||e.PersonaId&&e.PersonaId.Id:null}n.d(t,"a",function(){return r})},1826:function(e,t,n){"use strict";var r=n(5),i=n(889),a=n(966),c=n(7),s=n(106),o=n(63),u=n(70);t.a=Object(u.action)("transactionFailed")(function(e,t,n,u,d,l){if(void 0===l&&(l=null),e&&e.hasSessionStarted){var b={TransactionRequestTime:Object(c.pb)(u),TransactionRequestDuration:Object(c.w)(Object(c.Nb)(),u),QueryString:Object(r.g)(t)?"":t,QueryStringLength:Object(s.b)(t)?0:t.length,ImpressionId:n};l&&Object.keys(l).forEach(function(e){b[e]=l[e]}),d&&(b.Context=d);var f=JSON.stringify(b),p=Object(a.a)(e,n,"TransactionFailed",null,0,f);Object(i.a)(e,p,!1),o.d.info(Object(r.b)("{0} TransactionComplete. Session id: {1}",e.entityScenarioName,e.clientSessionId))}})},4031:function(e,t,n){"use strict";n.d(t,"a",function(){return r});var r=["Id","ADObjectId","DisplayName","EmailAddresses","PeopleSubtype","PeopleType","PDLItemId","PersonaId","ImAddress","JobTitle"]},4639:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(734);function i(){return{maxActionBatchSize:10,entityType:1,entityScenarioName:"FindPeople_react",hasSessionStarted:!1,isSessionPaused:!1,entityFeedbackEntries:[],clientSessionId:"",clientVersion:"1.0",clientId:1,entrySequenceNumber:0,conversationId:Object(r.a)()}}},889:function(e,t,n){"use strict";var r=n(5),i=n(70),a=n(1330),c=n.n(a),s=n(1331),o=n.n(s),u=n(193),d=n(63);function l(e){var t=o()({EntityFeedbackEntries:e});return c()({Header:Object(u.getJsonRequestHeader)(),Body:t}).then(function(e){!function(e){if(e&&e.Body){var t=e.Body;d.d.info(Object(r.b)("addEntityFeedback Error count: {0}",t.ErrorCount)),d.d.info(Object(r.b)("addEntityFeedback error details: {0}",t.ErrorDetails))}}(e)})}t.a=Object(i.action)("attemptToSubmitAddEntityFeedback")(function(e,t,n){e&&t&&(e.entityFeedbackEntries.push(t),(n||e.entityFeedbackEntries.length>=e.maxActionBatchSize)&&(l(e.entityFeedbackEntries),d.d.info(Object(r.b)("{0} Submitted {1} entities.",e.entityScenarioName,e.entityFeedbackEntries.length)),e.entityFeedbackEntries=[]))})},947:function(e,t,n){"use strict";var r=n(4),i=Object(r.createStore)("recipientcache",{recipientCache:null,allKeys:{},usedFindPeopleFallback:!1})();t.a=i},966:function(e,t,n){"use strict";var r=n(5),i=n(70),a=Object(i.action)("increaseEntrySequenceNumber")(function(e){e&&e.entrySequenceNumber++}),c=n(106),s=n(63),o=n(7);function u(e,t,n,i,u,d,l,b){if(void 0===b&&(b=Object(o.Nb)()),!e)return s.d.warn("Attempting to create entity feedback entry with invalid feedbackManager"),null;if(Object(c.b)(e.clientSessionId))return s.d.warn(Object(r.b)("{0} - Attempting to create entity feedback entry with empty client session id",e.entityScenarioName)),null;var f={ClientEventTimeUtc:Object(o.rb)(b),ClientEventTimeLocal:Object(o.pb)(b),ClientSessionId:e.clientSessionId,ClientVersion:e.clientVersion,ClientId:e.clientId,EntityType:e.entityType,EntrySequenceNumber:e.entrySequenceNumber,TransactionId:t,EventType:n,TargetEntityList:i,EntityAddSource:u,JsonPropertyBag:d,ScenarioName:l||e.entityScenarioName};return a(e),f}n.d(t,"a",function(){return u})},9733:function(e,t,n){"use strict";n.r(t);var r=n(0),i=n(1825),a=n(1770),c=n.n(a),s=n(1272),o=n.n(s),u=n(1497),d=n.n(u),l=n(815),b=n.n(l),f=n(1478),p=n.n(f),y=n(741),I=n.n(y),m=n(1498),O=n.n(m),v=n(193),h=500,j="owa.react.compose";function S(){var e,t=d()({IndexedPageItemView:b()({BasePoint:"Beginning",Offset:0,MaxEntriesReturned:h}),PersonaShape:(e=p()({BaseShape:"IdOnly",AdditionalProperties:[I()({FieldURI:"PersonaEmailAddress"}),I()({FieldURI:"EmailAddresses"}),I()({FieldURI:"PersonaDisplayName"}),I()({FieldURI:"PersonaDisplayNames"}),I()({FieldURI:"PersonaId"}),I()({FieldURI:"PersonaType"}),I()({FieldURI:"PersonaImAddress"}),I()({FieldURI:"PersonaTitle"})]}),e),QuerySources:["Mailbox"],QueryString:"",SearchPeopleSuggestionIndex:!0,ShouldResolveOneOffEmailAddress:!1,Context:[c()({Key:"AppName",Value:"OWA"}),c()({Key:"AppScenario",Value:j})]});return O()(o()({Header:Object(v.getJsonRequestHeader)(),Body:t})).then(function(e){return e.Body})}var g=n(734),P=n(113),E=n(4031),_="/search/api/v1/suggestions?",A="owa.react.recipientcache",T=500;function w(){return Object(r.__awaiter)(this,void 0,void 0,function(){var e,t;return Object(r.__generator)(this,function(n){switch(n.label){case 0:return[4,F()];case 1:return e=n.sent(),t=function(e){return{AppName:"OWA",Scenario:{Name:A},Cvid:Object(g.a)(),EntityRequests:[e]}}(e),[2,Object(P.d)(_,t,null,!1,null,!0,void 0,!1).then(function(e){return e},function(e){throw new Error(e.message)})]}})})}function F(){return Object(r.__awaiter)(this,void 0,void 0,function(){return Object(r.__generator)(this,function(e){return[2,{Query:{QueryString:""},EntityType:"People",Provenances:["Mailbox"],Size:T,Fields:E.a}]})})}var k=n(50),C=n(4639),R=n(1826),D=n(7),N=n(4),x=n(1651),L=Object(N.mutatorAction)("setFallbackToFindPeople",function(e){x.a.fallbackToFindPeople=e}),M=n(1701),U=n(1122),q=n(63),z=n(67),G=n(1569),B={Action:"Type Down"},J=Object(k.c)("tryInitializeCacheWithSource",{name:"RecipientCacheInitialization",custonData:function(e,t){return[e,t]}})(function(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,function(){var a,c,s,o,u,d;return Object(r.__generator)(this,function(l){switch(l.label){case 0:a=Object(D.Nb)(),c="",l.label=1;case 1:switch(l.trys.push([1,7,,8]),s=void 0,e){case 0:return[3,2];case 1:return[3,4]}return[3,6];case 2:return[4,w()];case 3:return o=l.sent(),s=function(e){var t,n,i=[];if(e&&e.Groups){var a=e.Instrumentation&&e.Instrumentation.TraceId;try{for(var c=Object(r.__values)(e.Groups),s=c.next();!s.done;s=c.next()){var o=s.value;if("People"===o.Type){i=o.Suggestions.map(function(e){return Object(M.a)(e,a)});break}}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=c.return)&&n.call(c)}finally{if(t)throw t.error}}}else q.d.warn("Response groups should not be null");return i}(o),c=Object(U.a)(o),[3,6];case 4:return[4,S()];case 5:return u=l.sent(),s=u.ResultSet,c=Object(U.a)(u),[3,6];case 6:return t&&L(!0),function(e,t){e&&e.length>0&&(e.forEach(function(e){var n=Object(i.a)(e);n&&(t.store.allKeys[n]=!0)}),t.store.recipientCache=e,Object(z.f)("rp-peopleSuggestionsTrie")&&G.a.importAndExecute(e,i.a))}(s,n),[3,8];case 7:return d=l.sent(),q.d.warn(d.message),function(e,t){Object(R.a)(Object(C.a)(),"",t,e,B)}(a,c),[3,8];case 8:return[2]}})})});var Q=n(947),V=n(803),H=n(70),K=Object(H.action)("initializeCache")(Object(H.select)({store:function(){return Q.a}})(function(e){return Object(r.__awaiter)(this,void 0,void 0,function(){var t;return Object(r.__generator)(this,function(n){switch(n.label){case 0:return t=Object(V.a)(),[4,J(t?0:1,!1,e)];case 1:return n.sent(),!t||e.store.recipientCache?[3,3]:[4,J(1,!0,e)];case 2:n.sent(),n.label=3;case 3:return e.store.recipientCache||(e.store.recipientCache=[]),[2]}})})}));n.d(t,"initializeCache",function(){return K})}}]);
//# sourceMappingURL=owa.RecipientCache.js.map
self.scriptsLoaded['owa.RecipientCache.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.RecipientCache.js'] = (new Date()).getTime();