self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.CLP.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[147],{11827:function(e,t,n){var r=n(11828),a=n(45);"string"==typeof r&&(r=[[e.i,r]]);for(var i=0;i<r.length;i++)a.loadStyles(r[i][1],!1);r.locals&&(e.exports=r.locals)},11828:function(e,t,n){(t=e.exports=n(44)(!1)).push([e.i,'._31IkFpp5b72Rv6tTM5wjsx{color:"[theme:neutralSecondary, default:#666666]"}html[dir=ltr] ._31IkFpp5b72Rv6tTM5wjsx{padding-left:12px;padding-right:8px}html[dir=rtl] ._31IkFpp5b72Rv6tTM5wjsx{padding-right:12px;padding-left:8px}._35yiavnkrHXl4okJM1d7bN{font-size:12px}html[dir=ltr] ._2dJK6zp7Pb1DJHdwx-4zHt{margin-right:4px}html[dir=rtl] ._2dJK6zp7Pb1DJHdwx-4zHt{margin-left:4px}',""]),t.locals={subjectLabel:"_31IkFpp5b72Rv6tTM5wjsx",subjectLabelText:"_35yiavnkrHXl4okJM1d7bN",labelIcon:"_2dJK6zp7Pb1DJHdwx-4zHt"}},11829:function(e){e.exports={g:"$nb",f:"aob",e:"bob",c:"cob",d:"dob",b:"eob",a:"fob"}},1259:function(e,t,n){"use strict";var r=n(0),a=n(1986),i=n(4);var o=Object(i.mutatorAction)("removeInfoBarMessages",function(e,t){(Array.isArray(t)?t:t?[t]:e.infoBarIds?Object(r.__spread)(e.infoBarIds):[]).forEach(function(t){return function(e,t){var n=e.infoBarIds&&e.infoBarIds.indexOf(t);n>=0&&e.infoBarIds.splice(n,1);var r=e.infoBarHostKey;a.b[r]&&(delete a.b[r][t],0===Object.keys(a.b[r]).length&&delete a.b[r])}(e,t)})});t.a=o},1345:function(e,t,n){"use strict";var r=n(0),a=n(1986),i=n(70),o=Object(i.action)("addInfoBarMessage")(function(e,t,n){-1==e.infoBarIds.indexOf(t)?e.infoBarIds.push(t):e.infoBarIds=Object(r.__spread)(e.infoBarIds);var i=e.infoBarHostKey;n&&(a.b[i]||(a.b[i]={}),a.b[i][t]=n)});t.a=o},1765:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var r=n(1),a=n(143),i=n(1659),o=0;function c(e){var t=document.createElement("div");t.id="owa-modal-"+o++,document.body.appendChild(t);var n,c=!1,u=function(){c||(c=!0,a.unmountComponentAtNode(t),document.body.removeChild(t))};return[new Promise(function(o,c){n=c,a.render(r.createElement(i.a,{child:r.createElement(e,{onDismiss:function(e){u(),o(e)}}),type:i.b.None,onError:function(){u(),c()}}),t)}),function(){u(),n()}]}},1986:function(e,t,n){"use strict";n.d(t,"b",function(){return r}),n.d(t,"a",function(){return a});var r={};function a(e,t){var n=e.infoBarHostKey;return r[n]&&r[n][t]}},2339:function(e,t,n){"use strict";function r(e){if(!e)return e;var t=e.replace(/\+/g,"_");return t=t.replace(/\//g,"-")}function a(e){if(!e)return e;var t=e.replace(/_/g,"+");return t=t.replace(/-/g,"/")}n.d(t,"a",function(){return r}),n.d(t,"b",function(){return a})},2368:function(e,t,n){"use strict";n.d(t,"b",function(){return a});var r=n(4),a=Object(r.createStore)("CLPUserLabels",{userLabels:[],learnMoreUrl:""});t.a=a()},2677:function(e,t,n){"use strict";function r(e,t,n,r){var i=a(e,t,n,r);return i?i.Value:null}function a(e,t,n,r){if(!e||!e.ExtendedProperty)return null;for(var a=0;a<e.ExtendedProperty.length;a++){var i=e.ExtendedProperty[a],o=null,c=null,u=null;if(i&&i.ExtendedFieldURI&&(o=i.ExtendedFieldURI.PropertyTag,c=i.ExtendedFieldURI.PropertyName,u=i.ExtendedFieldURI.PropertyId),t&&o==t)return i;if(n&&c==n)return i;if(r&&u==r)return i}return null}n.d(t,"a",function(){return r}),n.d(t,"b",function(){return a})},3321:function(e,t,n){"use strict";n.d(t,"e",function(){return c}),n.d(t,"f",function(){return u}),n.d(t,"d",function(){return l}),n.d(t,"b",function(){return s}),n.d(t,"c",function(){return d}),n.d(t,"a",function(){return b}),n.d(t,"g",function(){return f}),n.d(t,"h",function(){return L});var r=n(0),a=n(153),i=n(7),o=n(41);function c(e,t){var n=g(e.selectedCLPLabel,"Change"),i=e.originalCLPLabel,o=e.selectedCLPLabel,c=Object(r.__assign)(Object(r.__assign)({},n),{IsLabelChanged:!0,LabelIdBefore:i?i.id:null,IsProtectionChanged:!(!i||!o)&&i.isEncryptingLabel!=o.isEncryptingLabel,ProtectedBefore:i&&i.isEncryptingLabel,UserJustification:t});a.i.importAndExecute(c)}function u(e){var t=g(e,"Discover");a.i.importAndExecute(t)}function l(e){e&&e.value&&e.value.length>0&&Object(a.m)("LoadCLPLabelOnBoot",{labelCount:e.value.length})}function s(e){e&&Object(a.m)("LoadCLPLabelComposeUsage",{isDefaultLabel:e.isDefault,isEncryptingLabel:e.isEncryptingLabel})}function d(e,t){t&&e?Object(a.m)("LoadCLPLabelChange",{isDowngrade:e.settingOrder>t.settingOrder,isOriginalLabelDefault:e.isDefault}):e&&Object(a.m)("LoadCLPLabelUnselect",{isOriginalLabelDefault:e.isDefault,isOriginalLabelEncrypting:e.isEncryptingLabel})}function b(e){401!=e.status&&Object(a.m)("CLPAutoLabelEnabled")}function f(){Object(a.m)("CLPAutoLabelRecommendedApplied")}function L(){Object(a.m)("CLPAutoLabelRecommendedDismissed")}function g(e,t){var n=Object(o.a)().SessionSettings,r=n.ExternalDirectoryTenantGuid,a=n.UserEmailAddress;return{CreationTime:Object(i.rb)(Object(i.Nb)()),Version:"1.1",Operation:t,OrganizationId:r,UserId:a,ApplicationId:"00000002-0000-0ff1-ce00-000000000000",ApplicationName:"Outlook Web",DataState:"Use",LabelId:e?e.id:null,Protected:e?e.isEncryptingLabel:null}}},3440:function(e,t,n){"use strict";var r;n.d(t,"a",function(){return r}),function(e){e.Manual="manual",e.Automatic="automatic",e.Default="default"}(r||(r={}))},3889:function(e,t,n){"use strict";n.d(t,"c",function(){return r}),n.d(t,"b",function(){return a}),n.d(t,"a",function(){return i}),n.d(t,"e",function(){return o}),n.d(t,"d",function(){return c});var r="msip_labels",a="X-MS-Exchange-Organization-ModifySensitivityLabel",i="00000000-0000-0000-0000-000000000000",o="Standard",c="Privileged"},4103:function(e,t,n){"use strict";n.d(t,"b",function(){return c});var r=n(2368),a=n(4326),i=n(106),o=/[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}/g;function c(e){return Object(i.b)(e)?null:function e(t,n){if(!n)return null;for(var r=0;r<n.length;r++){var a=n[r];if(a.id==t)return a;var i=e(t,a.children);if(i)return i}return null}(e,Object(r.b)().userLabels)}t.a=function(e){var t=Object(a.a)();if(!e)return t;for(var n=e.split(";"),r={},i=0;i<n.length;i++){var u=n[i];if(u){var l=u.match(o);if(l&&0!=l.length){var s=l[0];r[s]?r[s].push(u):r[s]=[u]}}}var d=Object.keys(r);for(i=0;i<d.length;i++){var b=c(d[i]);if(b){t.selectedLabel=b,delete r[d[i]];break}}return Object.values(r).forEach(function(e){t.nonTenantLabelString+=e.join(";")+";"}),t}},4326:function(e,t,n){"use strict";function r(){return{nonTenantLabelString:"",selectedLabel:null}}n.d(t,"a",function(){return r})},4410:function(e,t,n){"use strict";n.r(t);var r=n(5278),a=n(4),i=Object(a.action)("setJustificationSent",function(e,t){return{clpViewState:e,justificationSent:t}});Object(a.mutator)(i,function(e){var t=e.clpViewState,n=e.justificationSent;t.justificationSent=n});var o=Object(a.action)("setSelectedCLPLabel",function(e,t,n){return{labelToSet:e,infoBarViewState:t,clpViewState:n}}),c=n(6484),u=n(1345),l=n(1259),s=n(3440);Object(a.orchestrator)(o,function(e){var t=e.infoBarViewState,n=e.clpViewState,r=e.labelToSet,a=t.infoBarIds;n.selectedCLPLabel&&r.id==n.selectedCLPLabel.id?(Object(c.a)(n,null,s.a.Default),a.indexOf("CLPLabel")>=0&&Object(l.a)(t,"CLPLabel")):r.isDefault?(Object(c.a)(n,r,s.a.Default),a.indexOf("CLPLabel")>=0&&Object(l.a)(t,"CLPLabel")):(Object(c.a)(n,r,s.a.Manual),a.indexOf("CLPLabel")<0&&Object(u.a)(t,"CLPLabel"))});var d=n(1),b=n(498),f=n(22),L=n(668),g=n(11827),p=Object(f.a)(function(e){var t=e.subjectHeaderLabel;return t?d.createElement(L.a,{content:t.tooltip,hostClassName:g.subjectLabel},d.createElement(b.a,{iconName:t.isEncryptingLabel?"Lock":"MarkAsProtected",className:g.labelIcon}),d.createElement("span",{className:g.subjectLabelText},t.infobarDisplayText)):null}),m=n(4694),v=n(0),O=n(464),j=n.n(O),P=n(1101),h=n(836),C=n.n(h),y=n(2677),I=n(753),S=n(4103),_=Object(a.mutatorAction)("updateItemCLPInfoInMailStore",function(e,t){e&&(e.itemCLPInfo=t,t&&t.selectedLabel&&(e.MSIPLabelGuid=t.selectedLabel.id))}),x=n(5695),E=n(67);function A(e,t){Object(E.f)("cmp-clp")&&(r.a?r.a.then(function(){w(e,t)}):w(e,t))}function w(e,t){if(e&&!e.itemCLPInfo){var n="";n=t?t.Value:Object(x.a)(e),_(e,Object(S.a)(n))}}var D=n(3889),R=n(4326);function M(e){return Object(v.__awaiter)(this,void 0,void 0,function(){var t;return Object(v.__generator)(this,function(n){return(t=I.a.items.get(e))?t.itemCLPInfo?[2,Promise.resolve(t.itemCLPInfo)]:[2,T(e).then(function(e){return A(t,e),t.itemCLPInfo})]:[2,Promise.resolve(Object(R.a)())]})})}function T(e){return Object(v.__awaiter)(this,void 0,void 0,function(){return Object(v.__generator)(this,function(t){return[2,Object(P.a)([e],C()({BaseShape:"IdOnly",AdditionalProperties:[j()({PropertyName:D.c,DistinguishedPropertySetId:"InternetHeaders",PropertyType:"String"})]}),null).then(function(e){return e&&e[0]&&e[0].Items&&e[0].Items[0]?Object(y.b)(e[0].Items[0],null,D.c):null})]})})}var k=n(3321),B=n(11829),J=n(5),U=n(105),N=n(672),H=n(181),V=n(348),F=n(356),z=n(255),q=n(1575),K=n(693),G=function(e){function t(t){var n=e.call(this,t)||this;return n.confirmDialog=function(){n.props.onDismiss({success:!0,downgradeJustification:n.state.downgradeJustification})},n.closeDialog=function(){n.props.onDismiss({success:!1,downgradeJustification:null})},n.onChoiceChange=function(e,t){if("OTHERS"!=t.key)return n.setState({downgradeJustification:t.value||""}),void(n.isPresetJustification=!0);n.isPresetJustification=!1},n.onTextFieldChange=function(e,t){n.isPresetJustification||n.setState({downgradeJustification:t||""})},n.isPresetJustification=!0,n.state={downgradeJustification:""},n}return Object(v.__extends)(t,e),t.prototype.render=function(){var e=this,t=[{key:"LABEL_NOT_APPLY",text:Object(J.a)(B.g),value:"Previous label no longer applies"},{key:"LABEL_NOT_CORRECT",text:Object(J.a)(B.f),value:"Previous label was incorrect"},{key:"OTHERS",text:Object(J.a)(B.e),onRenderField:function(t,n){return d.createElement("div",null,n(t),t.checked&&d.createElement(K.a,{multiline:!0,rows:3,onChange:e.onTextFieldChange}))},styles:{choiceFieldWrapper:{width:"100%"},field:{marginBottom:"10px"}}}],n=!this.state.downgradeJustification;return d.createElement(N.a,{hidden:!1,onDismiss:this.closeDialog,dialogContentProps:{type:H.a.normal,title:Object(J.a)(B.c),subText:Object(J.a)(B.d)}},d.createElement(q.a,{options:t,onChange:this.onChoiceChange}),d.createElement(V.a,null,d.createElement(F.a,{onClick:this.confirmDialog,disabled:n,text:Object(J.a)(B.b)}),d.createElement(z.a,{onClick:this.closeDialog,text:Object(J.a)(B.a)})))},t=Object(v.__decorate)([U.observer],t)}(d.Component),X=n(1765);function $(e,t,n,r){var a=n.originalCLPLabel;return r&&a&&e.settingOrder<=a.settingOrder&&!n.justificationSent?Object(v.__read)(Object(X.a)(G),1)[0].then(function(r){var a=r.success,c=r.downgradeJustification;return a&&c?(i(n,!0),o(e,t,n),Object(k.e)(n,c),Object(k.c)(n.selectedCLPLabel,e),Promise.resolve(!0)):Promise.resolve(!1)}):(o(e,t,n),Object(k.c)(n.selectedCLPLabel,e),Promise.resolve(!0))}var W=n(113),Y=n(41),Q=n(734),Z=n(2339),ee=n(122),te="/ows/beta/CLPAutoLabeling";var ne=n(63),re=Object(a.mutatorAction)("updateAutoLabelViewState",function(e,t,n){e[t]=n});var ae=n(2368);var ie=["automatic","recommended"];function oe(e,t,n,r){if(a=function(e,t){var n=!1;return t.children&&t.children.length>0&&(n=t.children.reduce(a,!1)),e||t.isAutoLabelingOn||n},ae.a.userLabels.reduce(a,!1)){var a,i=t.autoLabelViewState;if(!i.shouldKeepGettingAutoLabel)return re(i,"inProgressAutoLabelRequest",null),void re(i,"pendingAutoLabelRequest",null);var o=i.contentOfExistingAutoLabel;if(i.inProgressAutoLabelRequest)re(i,"pendingAutoLabelRequest",{itemId:n,content:r});else{if(!r||""==r)return;r!=o&&(re(i,"inProgressAutoLabelRequest",{itemId:n,content:r}),function(e){return Object(v.__awaiter)(this,void 0,void 0,function(){var t,n,r,a,i,o,c,u,l;return Object(v.__generator)(this,function(s){switch(s.label){case 0:return t=Object(Z.a)(e.Id),n=Object(Y.a)().SessionSettings,(r=n?n.ExternalDirectoryUserGuid:null)&&t?(a=Object(Q.a)(),[4,Object(W.b)(te+"/"+r+"/"+t,a,!0,null,!1,!0)]):[3,6];case 1:return i=s.sent(),o={status:i.status},Object(ee.a)(i.status)?[4,i.json()]:[3,3];case 2:return c=s.sent(),(u=c.result)&&(o.automatic=u.automatic,o.recommended=u.recommended),[3,5];case 3:return l=o,[4,i.text()];case 4:l.errorMessage=s.sent(),s.label=5;case 5:return[2,Promise.resolve(o)];case 6:return[2,Promise.resolve(null)]}})})}(n).then(function(n){!function(e,t,n){var r=t.autoLabelViewState;if(Object(k.a)(n),n)switch(n.status){case 200:!function(e,t,n){var r=t.autoLabelViewState,a=r.inProgressAutoLabelRequest;ie.forEach(function(e){var t=null;n[e]&&n[e].sensitivityLabel&&(t=Object(S.b)(n[e].sensitivityLabel.id)),re(r,e,t)});var i=r.automatic,o=r.recommended;(function(e,t){if(e.labelApplyMethod==s.a.Manual||!t)return!1;var n=e.selectedCLPLabel&&e.selectedCLPLabel.settingOrder<t.settingOrder;return!e.selectedCLPLabel||n})(t,i)&&(!function(e){var t=e.autoLabelViewState.automatic;Object(c.a)(e,t,s.a.Automatic)}(t),Object(u.a)(e,"CLPAutoLabelAutomatic"));(function(e,t){return!e.selectedCLPLabel||t&&e.selectedCLPLabel.settingOrder<t.settingOrder})(t,o)&&function(e,t){var n=t.automatic,r=t.recommended;n&&r&&n.id==r.id?Object(l.a)(e,"CLPAutoLabelRecommended"):r?Object(u.a)(e,"CLPAutoLabelRecommended"):Object(l.a)(e,"CLPAutoLabelRecommended")}(e,r);a&&re(r,"contentOfExistingAutoLabel",a.content)}(e,t,n);break;case 400:case 401:case 404:case 429:case 500:!function(e,t){t&&ne.d.warn(Object(J.b)("GetAutoLabelRequest failed with code of: {0}; Error Message: {1}",t.status,t.errorMessage));re(e,"shouldKeepGettingAutoLabel",!1)}(r,n);break;default:return}re(r,"inProgressAutoLabelRequest",null);var a=r.pendingAutoLabelRequest;if(a){var i=a.itemId,o=a.content;oe(e,t,i,o)}}(e,t,n)}))}}}var ce=oe;n.d(t,"CLPSubjectHeaderLabel",function(){return p}),n.d(t,"loadCLPUserLabels",function(){return m.a}),n.d(t,"loadItemCLPInfo",function(){return M}),n.d(t,"logReadCLPLabel",function(){return k.f}),n.d(t,"showJustificationModal",function(){return $}),n.d(t,"updateItemCLPInfo",function(){return A}),n.d(t,"triggerCLPAutoLabeling",function(){return ce})},4694:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.action)("loadCLPUserLabels")},5120:function(e,t,n){"use strict";var r=n(4),a=n(2368);t.a=Object(r.mutatorAction)("initializeCLPStore",function(e){var t=Object(a.b)();t.userLabels=e.userLabels,t.learnMoreUrl=e.learnMoreUrl})},5278:function(e,t,n){"use strict";var r=n(4),a=n(4694),i=n(5120),o=n(113),c=n(41),u=function(e){if(!e||!e.value)return{userLabels:[],learnMoreUrl:""};var t=e.value,n=Object(c.a)().SessionSettings.UserLanguage,r={},a="";return t.forEach(function(e){"true"==e.Setting_enabled&&(!a&&e.PolicySetting_customurl&&(a=e.PolicySetting_customurl),r[e.Id]=function(e,t){var n=e["DisplayName_"+t]||e.DisplayName_Fallback;return{id:e.Id,parentId:e.ParentId,displayName:n,infobarDisplayText:n,tooltip:e.Setting_tooltip,settingOrder:parseInt(e.Setting_order),isDefault:"true"==e.PolicySetting_default,isEncryptingLabel:!!e.RightsProtectMessage_Disabled&&"false"==e.RightsProtectMessage_Disabled,isAutoLabelingOn:e.AutoLabeling_SensitiveTypeIds&&e.AutoLabeling_SensitiveTypeIds.length>0,children:[]}}(e,n))}),Object.keys(r).forEach(function(e){var t=r[e];if(t.parentId){var n=r[t.parentId];n&&(t.infobarDisplayText=n.displayName+"\\"+t.displayName,n.children.push(t)),delete r[e]}}),{userLabels:l(Object.values(r)),learnMoreUrl:a}};function l(e){return e?(e.sort(s),e.forEach(function(e){e.children&&e.children.sort(s)}),e):null}function s(e,t){return e.settingOrder-t.settingOrder}var d=n(67),b=n(3321),f=n(246);n.d(t,"a",function(){return L});var L=null;Object(r.orchestrator)(a.a,function(){Object(d.f)("cmp-clp")&&!Object(f.a)()&&(L=Object(o.b)("/compliancepolicy/api/v1.0/user/label").then(function(e){Object(i.a)(u(e)),Object(b.d)(e),L=null}))})},5695:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(2677),a="msip_labels";function i(e){return e&&e.ExtendedProperty?Object(r.a)(e,null,a):null}},6484:function(e,t,n){"use strict";var r=n(4);t.a=Object(r.mutatorAction)("internalSetSelectedCLPLabel",function(e,t,n){e.selectedCLPLabel=t,e.labelApplyMethod=n})}}]);
//# sourceMappingURL=owa.CLP.js.map
self.scriptsLoaded['owa.CLP.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.CLP.js'] = (new Date()).getTime();