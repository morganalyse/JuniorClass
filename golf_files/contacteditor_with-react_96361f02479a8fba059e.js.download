/*! Version: 1.0.0; Third Party Notices: https://lpcres.delve.office.com/lpc/versionless/tpn-01d67aa9caf83cdfa3f747b1c21d0432ea8abdfcb0d9912f6791cb2edd1bd0abdd1da77c3af22b0de89e03a99a1d9790fea8374ed01710ba3c8d72168e7fd3a6.txt */
(window.webpackJsonpLpc=window.webpackJsonpLpc||[]).push([[17],{1074:function(e,t){},1168:function(e,t,n){"use strict";var r=n(4),a=n(148),o=n(24),i=n(105),c=n(202),s=n(787),l=n(856),d=n(90),u=n(630),p=n(958);var m=/(.*?)<<<(.*?)>>>/g,h=function(e,t){if(void 0===t)return e;try{return Object(u.getPluralizedString)(e,t)}catch(t){return e}},f=Object(d.memoizeFunction)(function(e,t){for(var n=arguments.length,o=new Array(n>2?n-2:0),c=2;c<n;c++)o[c-2]=arguments[c];var d=s.a.apply(void 0,[function(e){return"<<<".concat(e,">>>")}].concat(o)),u=h(e(d),t),f=Object(l.a)(u,m);if(!f.length)return function(){return[u].filter(Boolean)};var g=f[f.length-1],b=u.substr(g.index+g[0].length),y=Object(p.a)(f.map(function(e,t){var n=Object(a.a)(e,3),o=(n[0],n[1]),i=n[2];return[function(){return o||null},function(e){var n=e[i];return n?"string"==typeof n?n:r.cloneElement(n,{key:t}):null}]})).concat(function(){return b||null});return function(e){return Object(i.filterOutNull)(y.map(function(t){return t(e)}))}});function g(e){var t,n,a,i=(t=e.text,n=e.placeholders,a=e.count,f.apply(void 0,[t,a].concat(Object(o.a)(Object(c.keys)(n).sort())))(n));return r.createElement(r.Fragment,null,i)}n.d(t,"a",function(){return g})},1616:function(e,t,n){"use strict";n.r(t);n(1290),n(1292),n(1293),n(1294);var r=n(817),a=n(1),o=n.n(a),i=n(483),c=n(17),s=n(18),l=n(70),d=n(71),u=n(72),p=n(3),m=n(5),h=n(431),f=n(7),g=n(90),b=n(428),y=n(300),S=n(807),x=n(332),v=n(1161),P=n(1267),E=n(1018),C=n(1191),A=n(1265),O=n(605),N=n(14),w=n(650),k=n(4),j=n(249),V=n(2),D="ContactEditor";function L(e,t,n){return Object(V.a)("".concat(D,".").concat(e),{featureName:D,getLogProperties:function(){return t?{}:null},exportOptions:n})}var U=L("StartEditingContact",!0),T=L("StartCreateContact",!0),B=L("LoadCompleted",!0),M=L("LoadFailed",!0),R=L("AddedChangeSetFromPersona",!0),W=L("NameAdded",!0),I=L("NameUpdated",!1),F=L("PhoneAdded",!0),H=L("PhoneUpdated",!0),Y=L("AddressEditStarted",!0),G=L("AddressAdded",!0),z=L("AddressUpdated",!0),X=L("OtherContactPropAdded",!0),K=L("OtherContactPropUpdated",!0),q=L("OtherContactDatePropRemoved",!0),J=L("ImAdded",!0),_=L("ImUpdated",!0),Z=L("EmailAdded",!0),$=L("EmailBlurred",!0),Q=L("EmailUpdated",!0),ee=L("PersonalNotesAdded",!0),te=L("PersonalNotesUpdated",!0),ne=L("WorkDetailAdded",!0),re=L("WorkDetailUpdated",!0),ae=L("SaveButtonClicked",!0,{exportType:"UserInteraction",exportName:"EditedContact"}),oe=L("SaveButtonClickedWithErrors",!0),ie=L("CancelButtonClicked",!0),ce=L("NotSaveButtonInDialogClicked",!0),se=L("RetryButtonInDialogClicked",!0),le=L("CancelButtonInDialogClicked",!0),de=(L("ScrolledToTop",!0),L("SaveConfirmationTriggered",!0)),ue=L("ExternalCancelTriggered",!0),pe=L("SaveCompleted",!0),me=L("CancelCompleted",!0),he=L("SaveFailed",!0),fe=L("FavoriteStarClicked",!0),ge=L("ProfilePhotoUpdated",!0),be=L("ResetErrorState",!0),ye=n(485),Se=n(24),xe=n(20),ve=n(89),Pe=n.n(ve),Ee=n(105),Ce=n(202),Ae=n(1316),Oe=n(618),Ne=n(620),we=n(425),ke=n(1610),je=n(777),Ve=n(0),De=((Ve.declareString)("contactEditorStrings.attributionForGAL")),Le=((Ve.declareStringWithPlaceholders)("contactEditorStrings.attributionForContactFolder"));function Ue(e,t){return e&&t?Object(Oe.a)(Object(Ee.filterOutNull)(e.map(function(e){var n=Object(we.default)(t,function(t){return t.Id===e});return!n||n.IsHidden?null:"GAL"===n.DisplayName?De():"Outlook"===n.DisplayName&&n.FolderName?Le({folder:n.FolderName}):n.FolderName?"".concat(n.DisplayName," - ").concat(n.FolderName):n.DisplayName}))):[]}var Te={AddNameSubmenu:((Ve.declareString)("contactEditorStrings.labelAddNameSubmenu")),AddPhoneSubmenu:((Ve.declareString)("contactEditorStrings.labelAddPhoneSubmenu")),AddPhoneOtherSubmenu:((Ve.declareString)("contactEditorStrings.labelAddPhoneOtherSubmenu")),AddAddressSubmenu:((Ve.declareString)("contactEditorStrings.labelAddAddressSubmenu")),AddWorkSubmenu:((Ve.declareString)("contactEditorStrings.labelAddWorkSubmenu")),AddOtherSubmenu:((Ve.declareString)("contactEditorStrings.labelAddOtherSubmenu")),GivenName:((Ve.declareString)("contactEditorStrings.labelGivenName")),MiddleName:((Ve.declareString)("contactEditorStrings.labelMiddleName")),Surname:((Ve.declareString)("contactEditorStrings.labelSurname")),DisplayNamePrefix:((Ve.declareString)("contactEditorStrings.labelDisplayNamePrefix")),Generation:((Ve.declareString)("contactEditorStrings.labelGeneration")),Nickname:((Ve.declareString)("contactEditorStrings.labelNickname")),YomiName:((Ve.declareString)("contactEditorStrings.labelYomiName")),YomiFirstName:((Ve.declareString)("contactEditorStrings.labelYomiFirstName")),YomiLastName:((Ve.declareString)("contactEditorStrings.labelYomiLastName")),PersonaBodies:((Ve.declareString)("contactEditorStrings.labelPersonaBodies")),PersonaCompanyNames:((Ve.declareString)("contactEditorStrings.labelCompanyName")),PersonaDepartments:((Ve.declareString)("contactEditorStrings.labelDepartment")),PersonaOfficeLocations:((Ve.declareString)("contactEditorStrings.labelLocation")),PersonaTitles:((Ve.declareString)("contactEditorStrings.labelTitle")),PersonaYomiCompanyNames:((Ve.declareString)("contactEditorStrings.labelYomiCompanyName")),Email:((Ve.declareString)("contactEditorStrings.labelEmail")),PersonaAssistantPhoneNumbers:((Ve.declareString)("contactEditorStrings.labelAssistant")),BusinessPhone:((Ve.declareString)("contactEditorStrings.labelBusiness")),AddBusiness:((Ve.declareString)("contactEditorStrings.labelAddBusiness")),PersonaWorkFaxes:((Ve.declareString)("contactEditorStrings.labelBusinessFax")),PersonaCallbackPhones:((Ve.declareString)("contactEditorStrings.labelCallback")),HomePhone:((Ve.declareString)("contactEditorStrings.labelHome")),AddHome:((Ve.declareString)("contactEditorStrings.labelAddHome")),PersonaHomeFaxes:((Ve.declareString)("contactEditorStrings.labelHomeFax")),Mobile:((Ve.declareString)("contactEditorStrings.labelMobile")),AddMobile:((Ve.declareString)("contactEditorStrings.labelAddMobile")),PersonaOrganizationMainPhones:((Ve.declareString)("contactEditorStrings.labelOrganizationMain")),Other:((Ve.declareString)("contactEditorStrings.labelOther")),IM:((Ve.declareString)("contactEditorStrings.labelIM")),PersonaOtherFaxes:((Ve.declareString)("contactEditorStrings.labelOtherFax")),PersonaPagers:((Ve.declareString)("contactEditorStrings.labelPager")),PersonaPhoneNumber:((Ve.declareString)("contactEditorStrings.labelPrimary")),PersonaRadioPhones:((Ve.declareString)("contactEditorStrings.labelRadio")),PersonaTelexNumbers:((Ve.declareString)("contactEditorStrings.labelTelex")),PersonaTTYTDDPhoneNumbers:((Ve.declareString)("contactEditorStrings.labelTTYTDD")),PersonaManagers:((Ve.declareString)("contactEditorStrings.labelPersonaManagers")),PersonaBusinessHomePages:((Ve.declareString)("contactEditorStrings.labelPersonaBusinessHomePages")),PersonaAssistantNames:((Ve.declareString)("contactEditorStrings.labelPersonaAssistantNames")),PersonaLocations:((Ve.declareString)("contactEditorStrings.labelPersonaLocations")),PersonaHobbies:((Ve.declareString)("contactEditorStrings.labelPersonaHobbies")),PersonaSchools:((Ve.declareString)("contactEditorStrings.labelPersonaSchools")),PersonaHomeAddresses:((Ve.declareString)("contactEditorStrings.labelPersonaHomeAddresses")),AddPersonaHomeAddresses:((Ve.declareString)("contactEditorStrings.labelAddPersonaHomeAddresses")),PersonaBusinessAddresses:((Ve.declareString)("contactEditorStrings.labelPersonaBusinessAddresses")),AddPersonaBusinessAddresses:((Ve.declareString)("contactEditorStrings.labelAddPersonaBusinessAddresses")),PersonaOtherAddresses:((Ve.declareString)("contactEditorStrings.labelPersonaOtherAddresses")),AddPersonaOtherAddresses:((Ve.declareString)("contactEditorStrings.labelAddPersonaOtherAddresses")),Street:((Ve.declareString)("contactEditorStrings.labelStreet")),City:((Ve.declareString)("contactEditorStrings.labelCity")),State:((Ve.declareString)("contactEditorStrings.labelStateProvince")),PostalCode:((Ve.declareString)("contactEditorStrings.labelZipPostalCode")),Country:((Ve.declareString)("contactEditorStrings.labelCountryRegion")),PersonaPersonalHomePages:((Ve.declareString)("contactEditorStrings.labelPersonaPersonalHomePages")),PersonaSpouseNames:((Ve.declareString)("contactEditorStrings.labelPersonaSpouseNames")),PersonaWeddingAnniversaries:((Ve.declareString)("contactEditorStrings.labelPersonaWeddingAnniversaries")),PersonaBirthdays:((Ve.declareString)("contactEditorStrings.labelPersonaBirthdays")),GoToToday:((Ve.declareString)("contactEditorStrings.labelGoToToday")),GoToPreviousMonth:((Ve.declareString)("contactEditorStrings.labelGoToPreviousMonth")),GoToNextMonth:((Ve.declareString)("contactEditorStrings.labelGoToNextMonth")),GoToPrevYear:((Ve.declareString)("contactEditorStrings.labelGoToPrevYear")),GoToNextYear:((Ve.declareString)("contactEditorStrings.labelGoToNextYear")),SelectDay:((Ve.declareString)("contactEditorStrings.labelSelectDay")),Day:((Ve.declareString)("contactEditorStrings.labelDay")),Month:((Ve.declareString)("contactEditorStrings.labelMonth")),Year:((Ve.declareString)("contactEditorStrings.labelYear"))},Be=Object(m.a)({},Te,{PersonaWeddingAnniversariesLocal:Te.PersonaWeddingAnniversaries,PersonaBirthdaysLocal:Te.PersonaBirthdays});function Me(e){return Be[e]()}function Re(e){switch(e){case"PersonaHomePhones":case"PersonaHomePhones2":return Me("HomePhone");case"PersonaBusinessPhoneNumbers":case"PersonaBusinessPhoneNumbers2":return Me("BusinessPhone");case"PersonaMobilePhones":case"PersonaCarPhones":return Me("Mobile");case"PersonaOtherTelephones":case"PersonaOtherPhones2":return Me("Other");default:return Me(e)}}function We(e){switch(e){case"PersonaHomePhones":case"PersonaHomePhones2":return Me("AddHome");case"PersonaBusinessPhoneNumbers":case"PersonaBusinessPhoneNumbers2":return Me("AddBusiness");case"PersonaMobilePhones":case"PersonaCarPhones":return Me("AddMobile");case"PersonaOtherTelephones":case"PersonaOtherPhones2":return Me("Other");default:return Me(e)}}function Ie(e){switch(e){case"PersonaHomeAddresses":return Me("AddPersonaHomeAddresses");case"PersonaBusinessAddresses":return Me("AddPersonaBusinessAddresses");case"PersonaOtherAddresses":return Me("AddPersonaOtherAddresses");default:return Object(f.g)(e)}}var Fe=255,He={updatedNames:{},updatedPhones:[],updatedWorkDetails:[],updatedIms:[],updatedPostalAddresses:[],updatedEmails:[],updatedOtherContactProps:[],updatedPersonalNotes:[],updatedProfilePhoto:null,validationErrors:!1},Ye={index:0,oldValue:null,newValue:"",attributions:[],isWritable:!0},Ge=Object(m.a)({},Ye,{propertyUri:"PersonaCompanyNames"}),ze={updatedNames:{PersonaGivenNames:{oldValue:null,newValue:""},PersonaSurnames:{oldValue:null,newValue:""}},updatedPhones:[Object(m.a)({},Ye,{propertyUri:"PersonaMobilePhones"})],updatedWorkDetails:[Ge],updatedIms:[],updatedPostalAddresses:[],updatedEmails:[Object(m.a)({},Ye,{propertyUri:"PersonaEmails1",oldDisplayNameValue:null,oldOriginalDisplayNameValue:null})],updatedOtherContactProps:[],updatedPersonalNotes:[],updatedProfilePhoto:null,validationErrors:!1};function Xe(e,t,n){return 0===Tt(e,t).length&&(null===e.updatedProfilePhoto||"NewContact"===n)}function Ke(e){switch(e){case"DisplayNamePrefix":return"PersonaDisplayNamePrefixes";case"Generation":return"PersonaGenerations";case"GivenName":return"PersonaGivenNames";case"MiddleName":return"PersonaMiddleNames";case"Nickname":return"PersonaNicknames";case"Surname":return"PersonaSurnames";case"YomiFirstName":return"PersonaYomiFirstNames";case"YomiLastName":return"PersonaYomiLastNames";case"YomiName":return"PersonaYomiFirstNames";default:return Object(f.g)(e)}}function qe(e,t,n){var r=Object(x.a)(e,function(e){return n(e,t)});if(-1===r)return e.concat(t);var a=e.slice();return a.splice(r,1,t),a}function Je(e,t){return e.propertyUri===t.propertyUri&&e.index===t.index}function _e(e,t){return e.propertyUri===t.propertyUri&&(e.index===t.index||""===e.newValue)}function Ze(e,t){return Object(m.a)({},Ye,{propertyUri:e,newValue:t,index:-1})}function $e(e,t){var n=e,r=!0,a=!1,o=void 0;try{for(var i,c=Pe()(t);!(r=(i=c.next()).done);r=!0){n=qe(n,i.value,Je)}}catch(e){a=!0,o=e}finally{try{r||null==c.return||c.return()}finally{if(a)throw o}}return n}function Qe(e){switch(e){case"YomiFirstName":case"YomiLastName":return"YomiName";default:return e}}function et(e,t,n,r){var a=Ke(t);return a?Object(f.l)(e,{updatedNames:Object(f.l)(e.updatedNames,Object(xe.a)({},a,{oldValue:n,newValue:r}))}):e}var tt=function(e){return function(t,n){return St((t||[]).map(function(t,r){if(t.Value&&t.Value.Type){var a=$t(e,t.Attributions);return{propertyUri:n,index:r,oldValue:Object(f.k)(t.Value&&t.Value.Number),newValue:t.Value&&t.Value.Number||"",isWritable:a,attributions:Ue(t.Attributions,e)}}return console.error("Got phone entry without type (".concat(n,")")),null}))}};function nt(e){var t=tt(e.AttributionsArray);return t(e.AssistantPhoneNumbersArray,"PersonaAssistantPhoneNumbers").concat(t(e.BusinessPhoneNumbersArray,"PersonaBusinessPhoneNumbers")).concat(t(e.BusinessPhoneNumbers2Array,"PersonaBusinessPhoneNumbers2")).concat(t(e.CallbackPhonesArray,"PersonaCallbackPhones")).concat(t(e.CarPhonesArray,"PersonaCarPhones")).concat(t(e.HomeFaxesArray,"PersonaHomeFaxes")).concat(t(e.HomePhonesArray,"PersonaHomePhones")).concat(t(e.HomePhones2Array,"PersonaHomePhones2")).concat(t(e.MobilePhonesArray,"PersonaMobilePhones")).concat(t(e.OrganizationMainPhonesArray,"PersonaOrganizationMainPhones")).concat(t(e.OtherFaxesArray,"PersonaOtherFaxes")).concat(t(e.OtherTelephonesArray,"PersonaOtherTelephones")).concat(t(e.OtherPhones2Array,"PersonaOtherPhones2")).concat(t(e.PagersArray,"PersonaPagers")).concat(t(e.RadioPhonesArray,"PersonaRadioPhones")).concat(t(e.TelexNumbersArray,"PersonaTelexNumbers")).concat(t(e.TTYTDDPhoneNumbersArray,"PersonaTTYTDDPhoneNumbers")).concat(t(e.WorkFaxesArray,"PersonaWorkFaxes"))}function rt(e,t){return $e(nt(e),t.updatedPhones)}function at(e,t,n,r,a){var o=n(e,t).filter(function(e){return!0===e.isWritable}),i=r.filter(function(e){return!o.some(function(t){return t.propertyUri===e})});return a?i:i.filter(function(e){return!Object(ye.r)(e)})}function ot(e,t,n){var r=Ze(t,n||""),a=qe(e.updatedPhones,r,_e);return Object(f.l)(e,{updatedPhones:a})}function it(e,t){var n=qe(e.updatedPhones,t,Je);return Object(f.l)(e,{updatedPhones:n})}function ct(e,t){return $e(pt(e),t.updatedIms)}function st(e,t){var n=Ze("PersonaImAddresses",t||""),r=qe(e.updatedIms,n,_e);return Object(f.l)(e,{updatedIms:r})}function lt(e,t){var n=qe(e.updatedIms,t,Je);return Object(f.l)(e,{updatedIms:n})}function dt(e,t,n){var r=qe(e.updatedPostalAddresses,Ze(t,n||{Street:"",City:"",Country:"",PostalCode:"",State:""}),_e);return Object(f.l)(e,{updatedPostalAddresses:r})}function ut(e,t){var n=qe(e.updatedPostalAddresses,t,Je);return Object(f.l)(e,{updatedPostalAddresses:n})}function pt(e){return function(e,t){var n=e.AttributionsArray;return St((e.ImAddressesArray||[]).map(function(e,r){var a=$t(n,e.Attributions),o=e.Value?e.Value.replace(/^sip:/,""):e.Value;return{propertyUri:t,attributions:Ue(e.Attributions,n),index:r,oldValue:Object(f.k)(o),newValue:o||"",isWritable:a}}))}(e,"PersonaImAddresses")}function mt(e){return xt(e.Emails1Array,e.AttributionsArray,"PersonaEmails1").concat(xt(e.Emails2Array,e.AttributionsArray,"PersonaEmails2")).concat(xt(e.Emails3Array,e.AttributionsArray,"PersonaEmails3"))}function ht(e){var t,n=mt(e);return t=n,Object(je.a)(t,function(e,t){var n;return e.newValue===t.newValue&&e.isWritable===t.isWritable&&!!(n=t.attributions).push.apply(n,Object(Se.a)(Object(ke.a)(e.attributions,t.attributions)))})}function ft(e,t){return $e(mt(e),t.updatedEmails)}function gt(e,t,n){var r=Object(m.a)({},Ze(t,n||""),{oldDisplayNameValue:null,oldOriginalDisplayNameValue:null}),a=qe(e.updatedEmails,r,_e);return Object(f.l)(e,{updatedEmails:a})}function bt(e,t){var n=t;t.newValue&&Ae.validate(t.newValue.trim())&&(n=Object(m.a)({},t,{showErrorMessage:!1}));var r=qe(e.updatedEmails,n,Je);return Object(f.l)(e,{updatedEmails:r})}function yt(e){return"RecipientCache"!==e}function St(e){return Object(Ee.filterOutNull)(e).reduce(function(e,t){var n=t&&t.attributions.filter(yt);return(t&&!t.attributions.length||n&&n.length>0)&&e.push(Object(f.l)(t,{attributions:n})),e},[])}function xt(e,t,n){return St((e||[]).map(function(e,r){if(!e.Value)return null;var a="EX"!==e.Value.RoutingType&&e.Value.EmailAddress?e.Value.EmailAddress:e.Value.OriginalDisplayName;if(!a)return null;var o=$t(t||[],e.Attributions);return{propertyUri:n,index:r,oldValue:Object(f.k)(e.Value.EmailAddress),newValue:a,oldDisplayNameValue:Object(f.k)(e.Value.Name),oldOriginalDisplayNameValue:Object(f.k)(e.Value.OriginalDisplayName),attributions:Ue(e.Attributions,t),isWritable:o}}))}function vt(e,t){return $e(Ut(e),t.updatedPostalAddresses)}function Pt(e,t,n){return St((e||[]).map(function(e,r){if(e.Value&&e.Value.Type){var a=$t(t||[],e.Attributions);return{propertyUri:n,index:r,oldValue:e.Value,newValue:e.Value,editing:!1,attributions:Ue(e.Attributions,t),isWritable:a}}return null}))}function Et(e,t,n){return St((e||[]).map(function(e,r){if(e.Value){var a="string"==typeof e.Value?new Date(e.Value):e.Value,o=$t(t||[],e.Attributions);return{propertyUri:n,index:r,oldValue:a,newValue:a,attributions:Ue(e.Attributions,t),isWritable:o,isRemoved:!1}}return null}))}function Ct(e,t,n){return St((e||[]).map(function(e,r){return e.Value&&"string"==typeof e.Value?{propertyUri:n,index:r,oldValue:e.Value,newValue:e.Value,attributions:Ue(e.Attributions,t),isWritable:$t(t||[],e.Attributions)}:null}))}function At(e,t,n,r){var a=Et(t,n,r).concat(Et(e,n,r)).pop();return a?[a]:[]}function Ot(e){return At(e.WeddingAnniversariesLocalArray,e.WeddingAnniversariesArray,e.AttributionsArray,"PersonaWeddingAnniversaries").concat(At(e.BirthdaysLocalArray,e.BirthdaysArray,e.AttributionsArray,"PersonaBirthdays")).concat(Ct(e.PersonalHomePagesArray,e.AttributionsArray,"PersonaPersonalHomePages")).concat(Ct(e.SpouseNamesArray,e.AttributionsArray,"PersonaSpouseNames")).concat(Ct(e.ManagersArray,e.AttributionsArray,"PersonaManagers")).concat(Ct(e.AssistantNamesArray,e.AttributionsArray,"PersonaAssistantNames")).concat(Ct(e.BusinessHomePagesArray,e.AttributionsArray,"PersonaBusinessHomePages")).concat(Ct(e.SchoolsArray,e.AttributionsArray,"PersonaSchools")).concat(Ct(e.LocationsArray,e.AttributionsArray,"PersonaLocations")).concat(Ct(e.HobbiesArray,e.AttributionsArray,"PersonaHobbies"))}function Nt(e,t){return $e(Ot(e),t.updatedOtherContactProps).filter(function(e){return an(e)&&!e.isRemoved||!an(e)})}function wt(e,t,n){var r=e.updatedOtherContactProps,a=e.updatedOtherContactProps.filter(an),o=Object(we.default)(a,function(e){return!!e.isRemoved&&e.propertyUri===t});o&&-1!==o.index?r=e.updatedOtherContactProps.filter(function(e){return e!==o}):r=function(e,t,n){var r=Object(x.a)(e,function(e){return n(e,t)});if(-1===r)return e.concat(t);var a=e.slice();return a.splice(r,1),a.concat(t)}(r,Object(ye.w)(t)?Object(m.a)({},Ze(t,n?new Date(n):null),{isRemoved:!1}):Ze(t,n||""),_e);return Object(f.l)(e,{updatedOtherContactProps:r})}function kt(e,t){var n=qe(e.updatedOtherContactProps,t,Je);return Object(f.l)(e,{updatedOtherContactProps:n})}function jt(e,t){var n=Ze("PersonaBodies",t||""),r=qe(e.updatedPersonalNotes,n,_e);return Object(f.l)(e,{updatedPersonalNotes:r})}function Vt(e,t){var n=qe(e.updatedPersonalNotes,t,Je);return Object(f.l)(e,{updatedPersonalNotes:n})}function Dt(e){return e.BodiesArray?Object(Ee.filterOutNull)(e.BodiesArray).map(function(t,n){return{propertyUri:"PersonaBodies",index:n,oldValue:Object(f.k)(t.Value&&t.Value.Value),newValue:t.Value&&t.Value.Value||"",attributions:Ue(t.Attributions,e.AttributionsArray),isWritable:$t(e.AttributionsArray,t.Attributions)}}):[{propertyUri:"PersonaBodies",index:0,oldValue:"",newValue:"",attributions:[],isWritable:!0}]}function Lt(e,t){return $e(Dt(e),t.updatedPersonalNotes)}function Ut(e){return Pt(e.BusinessAddressesArray,e.AttributionsArray,"PersonaBusinessAddresses").concat(Pt(e.HomeAddressesArray,e.AttributionsArray,"PersonaHomeAddresses")).concat(Pt(e.OtherAddressesArray,e.AttributionsArray,"PersonaOtherAddresses"))}function Tt(e,t){var n=t?Object(m.a)({},e,{updatedEmails:rn(e.updatedEmails,t)}):e,r=function(e,t){if(!t)return Object(Ce.keys)(e.updatedNames).map(function(t){var n=e.updatedNames[t];return{propertyUri:t,oldValue:"",newValue:n&&n.newValue||""}});if(0===Object(Ce.keys)(e.updatedNames).length)return[];var n=(t.AttributionsArray||[]).filter(function(e){return e.IsWritable}).map(function(e){return e.Id}),r=[],a=!0,o=!1,i=void 0;try{for(var c,s=Pe()(ye.f);!(a=(c=s.next()).done);a=!0){var l=c.value,d=Ke(l),u=en(t,d),p=u.filter(function(e){return!e.Attributions||e.Attributions.some(function(e){return!!e&&n.indexOf(e)>=0})}),m=e.updatedNames[d],h=m?m.newValue||"":t[l]||"",f=[],g=!0,b=!1,y=void 0;try{for(var S,x=Pe()(p);!(g=(S=x.next()).done);g=!0){var v=S.value;r.push({propertyUri:d,oldValue:v.Value||"",newValue:h}),f.push.apply(f,Object(Se.a)(v.Attributions||[]))}}catch(e){b=!0,y=e}finally{try{g||null==x.return||x.return()}finally{if(b)throw y}}for(var P=Object(ke.a)(n,f).length,E=0;E<P;E++)r.push({propertyUri:d,oldValue:"",newValue:h})}}catch(e){o=!0,i=e}finally{try{a||null==s.return||s.return()}finally{if(o)throw i}}return r.filter(function(e){return e.newValue!==e.oldValue})}(n,t),a=function(e){return e.updatedPostalAddresses.map(function(e){var t=[e.oldValue&&e.oldValue.Street||"",e.oldValue&&e.oldValue.City||"",e.oldValue&&e.oldValue.State||"",e.oldValue&&e.oldValue.PostalCode||"",e.oldValue&&e.oldValue.Country||""].join(Bt),n=[e&&e.newValue&&e.newValue.Street||"",e&&e.newValue&&e.newValue.City||"",e&&e.newValue&&e.newValue.State||"",e&&e.newValue&&e.newValue.PostalCode||"",e&&e.newValue&&e.newValue.Country||""].join(Bt);return{propertyUri:e.propertyUri,oldValue:t,newValue:n}}).filter(function(e){return e.oldValue!==e.newValue})}(n),o=function(e,t){return Rt(e,t&&t.BirthdaysArray||[],"PersonaBirthdays",t&&t.BirthdaysLocalArray||[],"PersonaBirthdaysLocal").concat(Rt(e,t&&t.WeddingAnniversariesArray||[],"PersonaWeddingAnniversaries",t&&t.WeddingAnniversariesLocalArray||[],"PersonaWeddingAnniversariesLocal")).concat(e.updatedOtherContactProps.filter(function(e){return!an(e)}).map(function(e){var t="string"==typeof e.oldValue?e.oldValue:"",n="string"==typeof e.newValue?e.newValue:"";return{propertyUri:e.propertyUri,oldValue:t,newValue:n}}))}(n,t),i=function(e){return e.updatedPersonalNotes.map(function(e){return{propertyUri:e.propertyUri,oldValue:e.oldValue?e.oldValue:"",newValue:e.newValue||""}})}(n),c=function(e,t){return Wt(e,t||null,It,Ht,Gt)}(n,t),s=function(e,t){return Wt(e,t||null,Ft,Yt,zt)}(n,t);return[].concat(Object(Se.a)(r),Object(Se.a)(n.updatedEmails),Object(Se.a)(c),Object(Se.a)(s),Object(Se.a)(n.updatedIms),Object(Se.a)(n.updatedPhones),Object(Se.a)(n.updatedWorkDetails),Object(Se.a)(a),Object(Se.a)(o),Object(Se.a)(i)).map(function(e){return{propertyUri:e.propertyUri,oldValue:e.oldValue||"",newValue:e.newValue&&e.newValue.trim()||""}}).filter(function(e){return""!==e.oldValue||""!==e.newValue}).filter(function(e){return e.oldValue!==e.newValue})}var Bt="$#$";function Mt(e,t,n){return 0===e.length?[{propertyUri:t,oldValue:"",newValue:n}]:e.map(function(e){return{propertyUri:t,oldValue:e.Value||"",newValue:n}})}function Rt(e,t,n,r,a){var o=e.updatedOtherContactProps.filter(function(e){return e.propertyUri===n||e.propertyUri===a})[0];if(!o)return[];var i=o.newValue?"string"==typeof o.newValue?o.newValue:o.newValue.toISOString():"";return Mt(t,n,i).concat(Mt(r,a,i))}function Wt(e,t,n,r,a){return e.updatedEmails.map(function(e){var o=e.newValue||"",i=n(e);if(-1===e.index&&t)switch(e.propertyUri){case"PersonaEmails1":i=r(t.Emails1Array||[]);break;case"PersonaEmails2":i=r(t.Emails2Array||[]);break;case"PersonaEmails3":i=r(t.Emails3Array||[]);break;default:return Object(f.g)(e.propertyUri)}return{propertyUri:a(e.propertyUri),oldValue:i,newValue:o}})}function It(e){return e.oldDisplayNameValue||""}function Ft(e){return e.oldOriginalDisplayNameValue||""}function Ht(e){var t=Object(we.default)(e,function(e){return!!e.Value&&!!e.Value.Name});return t&&t.Value&&t.Value.Name?t.Value.Name:""}function Yt(e){var t=Object(we.default)(e,function(e){return!!e.Value&&!!e.Value.OriginalDisplayName});return t&&t.Value&&t.Value.OriginalDisplayName?t.Value.OriginalDisplayName:""}function Gt(e){switch(e){case"PersonaEmails1":return"PersonaEmails1DisplayNames";case"PersonaEmails2":return"PersonaEmails2DisplayNames";case"PersonaEmails3":return"PersonaEmails3DisplayNames";default:return Object(f.g)(e)}}function zt(e){switch(e){case"PersonaEmails1":return"PersonaEmails1OriginalDisplayNames";case"PersonaEmails2":return"PersonaEmails2OriginalDisplayNames";case"PersonaEmails3":return"PersonaEmails3OriginalDisplayNames";default:return Object(f.g)(e)}}function Xt(e,t,n){var r=Ze(t,n||""),a=qe(e.updatedWorkDetails,r,_e);return Object(f.l)(e,{updatedWorkDetails:a})}function Kt(e,t){var n=qe(e.updatedWorkDetails,t,Je);return Object(f.l)(e,{updatedWorkDetails:n})}function qt(e,t){return $e(Jt(e),t.updatedWorkDetails)}function Jt(e){return _t(e.CompanyNamesArray,e.AttributionsArray,"PersonaCompanyNames").concat(_t(e.TitlesArray,e.AttributionsArray,"PersonaTitles")).concat(_t(e.DepartmentsArray,e.AttributionsArray,"PersonaDepartments")).concat(_t(e.OfficeLocationsArray,e.AttributionsArray,"PersonaOfficeLocations")).concat(_t(e.YomiCompanyNamesArray,e.AttributionsArray,"PersonaYomiCompanyNames"))}function _t(e,t,n){return St((e||[]).map(function(e,r){return{propertyUri:n,index:r,oldValue:Object(f.k)(e.Value),newValue:e.Value||"",attributions:Ue(e.Attributions,t),isWritable:$t(t||[],e.Attributions)}}))}function Zt(e,t){var n={},r=["GivenName","Surname"];return(e.YomiFirstName||e.YomiLastName)&&r.push("YomiFirstName","YomiLastName"),ye.f.forEach(function(a){var o=Ke(a),i=e[a],c=t.updatedNames[o],s=c&&c.newValue,l=Ue(function(e,t){return e.filter(function(e){return e.Value===t}).reduce(function(e,t){return e.concat(t.Attributions||[])},[])}(en(e,a),i),e.AttributionsArray).filter(yt);void 0!==s?n=Object(m.a)({},n,Object(xe.a)({},a,{propertyUri:o,oldValue:i,newValue:s,attributions:l,isWritable:!0})):i?n=Object(m.a)({},n,Object(xe.a)({},a,{propertyUri:o,oldValue:i,newValue:i,attributions:l,isWritable:!0})):-1!==r.indexOf(a)&&(n=Object(m.a)({},n,Object(xe.a)({},a,{propertyUri:o,oldValue:null,newValue:"",isWritable:!0,attributions:l})))}),n}function $t(e,t){return!(!e||!t)&&t.some(function(t){return e.some(function(e){return e.Id===t&&!0===e.IsWritable})})}function Qt(e){return e?[{Value:e,Attributions:null}]:[]}function en(e,t){switch(t){case"DisplayNamePrefix":case"PersonaDisplayNamePrefixes":return e.DisplayNamePrefixesArray||Qt(e.DisplayNamePrefix);case"GivenName":case"PersonaGivenNames":return e.GivenNamesArray||Qt(e.GivenName);case"MiddleName":case"PersonaMiddleNames":return e.MiddleNamesArray||Qt(e.MiddleName);case"Surname":case"PersonaSurnames":return e.SurnamesArray||Qt(e.Surname);case"Generation":case"PersonaGenerations":return e.GenerationsArray||Qt(e.Generation);case"Nickname":case"PersonaNicknames":return e.NicknamesArray||Qt(e.Nickname);case"YomiFirstName":case"PersonaYomiFirstNames":return e.YomiFirstNamesArray||Qt(e.YomiFirstName);case"YomiLastName":case"PersonaYomiLastNames":return e.YomiLastNamesArray||Qt(e.YomiLastName);default:return Object(f.g)(t)}}function tn(e){var t=!0,n=!1,r=void 0;try{for(var a,o=Pe()(ye.f);!(t=(a=o.next()).done);t=!0){var i=a.value,c=e.updatedNames[Ke(i)];if(c&&c.newValue.length>Fe)return Ke(i)}}catch(e){n=!0,r=e}finally{try{t||null==o.return||o.return()}finally{if(n)throw r}}var s=function(e){return e.newValue.length>Fe},l=Object(we.default)(e.updatedEmails,function(e){return s(e)||!!e.showErrorMessage})||Object(we.default)(e.updatedIms,s)||Object(we.default)(e.updatedPhones,s)||Object(we.default)(e.updatedWorkDetails,s)||Object(we.default)(e.updatedPostalAddresses,function(e){return e.newValue.Street&&e.newValue.Street.length>Fe||e.newValue.City&&e.newValue.City.length>Fe||e.newValue.Country&&e.newValue.Country.length>Fe||e.newValue.PostalCode&&e.newValue.PostalCode.length>Fe||e.newValue.State&&e.newValue.State.length>Fe||!1})||Object(we.default)(e.updatedOtherContactProps,function(e){return!an(e)&&s(e)});return l?l.propertyUri:""}function nn(e){return e.some(function(e){return!e.isWritable})}function rn(e,t){var n=mt(t),r=[];return n.map(function(t){return n.map(function(n){t!==n&&t.newValue===n.newValue&&t.isWritable===n.isWritable&&e.map(function(e){return e.propertyUri===n.propertyUri&&e.index===n.index&&r.push(Object(m.a)({},t,{newValue:e.newValue}))})})}),r.push.apply(r,Object(Se.a)(e)),r}function an(e){return Object(ye.w)(e.propertyUri)}var on=n(46),cn=n(621),sn=n(44),ln=n(136),dn=n(55),un={editorState:"idle",originalContact:null,changeSet:He,mostRecentPropertyUri:"",errorState:null},pn={idle:[{action:U,nextState:"loading"},{action:T,nextState:"editing"}],loading:[{action:B,nextState:"editing"},{action:M,nextState:"loadErrorDialogOpen"}],editing:[{action:ae,nextState:"saving"},{action:oe,nextState:"editing"},{action:de,nextState:"discardDialogOpen"},{action:me,nextState:"idle"}],saving:[{action:pe,nextState:"idle"},{action:he,nextState:"failed"}],discardDialogOpen:[{action:ce,nextState:"idle"},{action:le,nextState:"editing"},{action:me,nextState:"idle"}],loadErrorDialogOpen:[{action:se,nextState:"loading"},{action:le,nextState:"idle"}],failed:[{action:ae,nextState:"idle"},{action:me,nextState:"idle"}]},mn=Object(on.a)().handleAction(T,function(e,t){var n=Object(Se.a)(t.payload.initialValues),r=t.payload.focusPropertyUri;r&&Object(ye.B)(r)&&-1===t.payload.initialValues.map(function(e){return e.propertyUri}).indexOf(r)&&(n=Object(ye.A)(r)?[].concat(Object(Se.a)(n),[{propertyUri:r,value:{Street:"",City:"",Country:"",PostalCode:"",State:""}}]):[].concat(Object(Se.a)(n),[{propertyUri:r,value:""}]));return t.payload.initialValues.reduce(Sn,ze)}).handleAction(R,function(e,t){var n=un.changeSet,r=t.payload.originalContact,a=Zt(r,n),o=!1;Object(Ce.keys)(a).forEach(function(e){var t=a&&a[e],r=t&&t.newValue||"";Object(ln.d)(r)||(o=!0),n=et(n,e,"",r)}),!1===o&&(n=et(n,"GivenName","",r.DisplayName||""));0===(n=vn(ht,bt,r,n)).updatedEmails.length&&r.EmailAddress&&r.EmailAddress.EmailAddress&&(n=vn(xn,bt,r,n));return n=vn(nt,it,r,n),n=vn(Jt,Kt,r,n),n=vn(Ut,ut,r,n),n=vn(Ot,kt,r,n),n=vn(Dt,Vt,r,n),n=vn(pt,lt,r,n)}).handleAction(B,function(e,t){var n=t.payload,r=n.focusPropertyUri,a=n.originalContact;if(!r||!Object(ye.B)(r)||!a)return e;if(Object(ye.v)(r)||(Object(ye.q)(r)?mt(a).some(function(e){return e.isWritable}):Object(ye.s)(r)?pt(a).some(function(e){return e.isWritable}):Object(ye.p)(r)||Object(ye.y)(r)?nt(a).some(function(e){return e.isWritable&&e.propertyUri===r}):Object(ye.x)(r)?Ot(a).some(function(e){return e.isWritable&&e.propertyUri===r}):Object(ye.z)(r)?Dt(a).some(function(e){return e.isWritable}):Object(ye.C)(r)?Jt(a).some(function(e){return e.isWritable&&e.propertyUri===r}):Object(ye.A)(r)?Ut(a).some(function(e){return e.isWritable&&e.propertyUri===r}):void 0))return e;var o=Object(ye.A)(r)?{propertyUri:r,value:{Street:"",City:"",Country:"",PostalCode:"",State:""}}:{propertyUri:r,value:""};return Sn(e,o)}).handleAction(W,function(e,t){return function(e,t){for(var n=0,r="YomiName"===t?["YomiFirstName","YomiLastName"]:[t];n<r.length;n++){var a=Ke(r[n]),o=e.updatedNames[a];if(o&&(o.oldValue||o.newValue));else{var i=Object(f.l)(e.updatedNames,Object(xe.a)({},a,{oldValue:null,newValue:""}));e=Object(f.l)(e,{updatedNames:i})}}return e}(e,t.payload.availableName)}).handleAction(I,function(e,t){var n=t.payload;return et(e,n.fieldType,n.oldValue,n.newValue)}).handleAction(F,function(e,t){return ot(e,t.payload.availablePhone)}).handleAction(H,function(e,t){return it(e,t.payload.phone)}).handleAction(G,function(e,t){return dt(e,t.payload.availablePostalAddress)}).handleAction(z,function(e,t){return ut(e,t.payload.postalAddress)}).handleAction(X,function(e,t){return wt(e,t.payload.availableOtherContactProp)}).handleAction(K,function(e,t){return kt(e,t.payload.otherContactProp)}).handleAction(q,function(e,t){return function(e,t){var n=Object(m.a)({},t,{isRemoved:!0,newValue:null}),r=qe(e.updatedOtherContactProps,n,Je);return Object(f.l)(e,{updatedOtherContactProps:r})}(e,t.payload.otherContactDateProp)}).handleAction(J,function(e){return st(e)}).handleAction(_,function(e,t){return lt(e,t.payload.im)}).handleAction(Z,function(e,t){return gt(e,t.payload.availableEmail)}).handleAction($,function(e,t){return function(e,t){var n=Object(m.a)({},t,{showErrorMessage:!(!t.newValue||Ae.validate(t.newValue.trim()))}),r=qe(e.updatedEmails,n,Je);return Object(f.l)(e,{updatedEmails:r})}(e,t.payload.email)}).handleAction(Q,function(e,t){return bt(e,t.payload.email)}).handleAction(ne,function(e,t){return Xt(e,t.payload.availableWorkDetail)}).handleAction(re,function(e,t){return Kt(e,t.payload.workDetail)}).handleAction(ee,function(e){return jt(e)}).handleAction(te,function(e,t){return Vt(e,t.payload.note)}).handleAction(ge,function(e,t){return function(e,t){return Object(f.l)(e,{updatedProfilePhoto:t})}(e,t.payload.dataUri)}).handleAction(pe,function(){return un.changeSet}).handleAction(me,function(){return un.changeSet}).handleAction(ae,function(e){return Object(m.a)({},e,{validationErrors:!1})}).handleAction(oe,function(e){return Object(m.a)({},e,{validationErrors:!0})}).done(He),hn=Object(on.a)().handleAction(T,function(e,t){return t.payload.focusPropertyUri||"PersonaGivenNames"}).handleAction(U,function(e,t){return t.payload.focusPropertyUri||"PersonaGivenNames"}).handleAction(W,function(e,t){return Ke(t.payload.availableName)}).handleAction(F,function(e,t){return t.payload.availablePhone}).handleAction(G,function(e,t){return t.payload.availablePostalAddress}).handleAction(Y,function(e,t){return t.payload.postalAddress.propertyUri}).handleAction(X,function(e,t){return t.payload.availableOtherContactProp}).handleAction(Z,function(e,t){return t.payload.availableEmail}).handleAction(J,function(e,t){return t.payload.availableIm}).handleAction(ne,function(e,t){return t.payload.availableWorkDetail}).handleAction(ee,function(){return"PersonaBodies"}).handleAction(pe,function(){return un.mostRecentPropertyUri}).handleAction(me,function(){return un.mostRecentPropertyUri}).done(un.mostRecentPropertyUri),fn=Object(on.a)().handleAction(T,function(){return un.originalContact}).handleAction(B,function(e,t){return t.payload.originalContact}).handleAction(pe,function(){return un.originalContact}).handleAction(me,function(){return un.originalContact}).done(un.originalContact),gn=Object(on.a)().handleAction(be,function(e,t){return null}).handleAction(ae,function(){return un.errorState}).handleAction(oe,function(e,t){return t.payload}).handleAction(he,function(e,t){return{message:t.payload.error,propertyUri:""}}).handleAction(pe,function(){return un.errorState}).handleAction(me,function(){return un.errorState}).done(un.errorState),bn=Object(dn.combineReducers)({editorState:Object(cn.a)(pn,un.editorState),originalContact:fn,changeSet:mn,mostRecentPropertyUri:hn,errorState:gn}),yn=Object(sn.a)("ContactEditorStore",bn,function(e){return{editorState:e.editorState,originalContact:e.originalContact,changeSet:e.changeSet,errorState:e.errorState,mostRecentPropertyUri:e.mostRecentPropertyUri,phones:rt(e.originalContact||{},e.changeSet),updatedValues:Tt(e.changeSet,e.originalContact||void 0)}}),Sn=function(e,t){if(Object(ye.u)(t)){if(Object(ye.v)(t.propertyUri))return Object(f.l)(e,{updatedNames:Object(f.l)(e.updatedNames,Object(xe.a)({},t.propertyUri,{oldValue:null,newValue:t.value}))});if(Object(ye.q)(t.propertyUri))return gt(e,t.propertyUri,t.value);if(Object(ye.s)(t.propertyUri))return st(e,t.value);if(Object(ye.p)(t.propertyUri)||Object(ye.y)(t.propertyUri))return ot(e,t.propertyUri,t.value);if(Object(ye.x)(t.propertyUri))return wt(e,t.propertyUri,t.value);if(Object(ye.z)(t.propertyUri))return jt(e,t.value);if(Object(ye.C)(t.propertyUri))return Xt(e,t.propertyUri,t.value)}else if(Object(ye.t)(t))return dt(e,t.propertyUri,t.value);return e};function xn(e){return[{propertyUri:"PersonaEmails1",index:-1,oldValue:null,newValue:e.EmailAddress&&e.EmailAddress.EmailAddress||"",oldDisplayNameValue:null,oldOriginalDisplayNameValue:null,attributions:[],isWritable:!0}]}function vn(e,t,n,r){return e(n).map(function(e){return r=t(r,Object(f.l)(e,{oldValue:"",isWritable:!0}))}),r}var Pn=n(31),En=n(506);function Cn(e,t){return e?t:void 0}var An=Object(En.b)(function(e,t,n){return Object(Pn.X)({row:[{display:"flex",flexDirection:"row",flexShrink:"0",selectors:{"& > div + div":{marginLeft:n},"& > div":Object(m.a)({},Cn(e,{marginLeft:n,marginTop:n}),{},Cn(t,{flex:1}))}},e&&{flexWrap:"wrap",marginTop:"-".concat(n),marginLeft:"-".concat(n)}]})}),On="24px";function Nn(e){var t=An(e.wrap,e.equalWidthChildren,On).row;return k.createElement("div",{className:"".concat(t," ").concat(e.className||"")},e.children)}var wn=Object(En.b)(function(e){return Object(Pn.X)({column:{display:"flex",flexDirection:"column"}})});function kn(e){var t=wn(On).column;return k.createElement("div",{className:"".concat(t," ").concat(e.className||"")},e.children)}var jn=Object(En.b)(function(e){var t=e.palette.neutralLighter;return Object(Pn.X)({persona:{minWidth:"100px",height:"100px",borderRadius:"50%",backgroundColor:t},nameblock:{marginTop:"4px"},section:{backgroundColor:t,height:"19px",minWidth:"133px",marginBottom:"17px",marginTop:"16px"},label:{backgroundColor:t,height:"12px",minWidth:"100px",marginBottom:"4px"},namefield:{backgroundColor:t,height:"19px",minWidth:"156px",marginBottom:"17px"},textfield:{backgroundColor:t,height:"19px",minWidth:"194px",marginBottom:"17px"},notes:{height:"56px",minWidth:"404px",borderWidth:"1px",borderColor:t,borderStyle:"solid",marginBottom:"56px"}})});function Vn(e){var t=jn(e.theme);return k.createElement("div",{className:e.styling},k.createElement(Nn,null,k.createElement(kn,null,k.createElement("div",{className:t.persona})),k.createElement(kn,null,k.createElement("div",{className:t.nameblock},k.createElement(Nn,null,k.createElement("div",{className:t.label})),k.createElement(Nn,null,k.createElement("div",{className:t.namefield})),k.createElement(Nn,null,k.createElement("div",{className:t.label})),k.createElement(Nn,null,k.createElement("div",{className:t.namefield}))))),k.createElement(Nn,null,k.createElement("div",{className:t.section})),k.createElement(Nn,null,k.createElement("div",{className:t.label})),k.createElement(Nn,null,k.createElement("div",{className:t.textfield})),k.createElement(Nn,null,k.createElement("div",{className:t.label})),k.createElement(Nn,null,k.createElement("div",{className:t.textfield})),k.createElement(Nn,null,k.createElement("div",{className:t.label})),k.createElement(Nn,null,k.createElement("div",{className:t.textfield})),k.createElement(Nn,null,k.createElement("div",{className:t.label})),k.createElement(Nn,null,k.createElement("div",{className:t.textfield})),k.createElement(Nn,null,k.createElement("div",{className:t.section})),k.createElement(Nn,null,k.createElement("div",{className:t.notes})))}var Dn=Object(En.b)(function(){var e={sectionTitle:Object(Pn.S)().fonts.large};return Object(Pn.X)(e,{sectionBlock:{border:0,padding:0,marginTop:"24px"},sectionTitle:{fontWeight:600,padding:0}})});function Ln(e){var t=Dn();return k.createElement("fieldset",{className:t.sectionBlock},k.createElement("legend",{role:"heading","aria-level":2,className:t.sectionTitle},e.header),e.children)}var Un=n(634),Tn=n(85),Bn=((Ve.declareString)("contactEditorStrings.attributionsAriaLabel")),Mn=((Ve.declareString)("contactEditorStrings.attributionsCaption")),Rn=Object(En.b)(function(e){return Object(Pn.X)({attributionInfoIcon:{selectors:{".ms-Button":{verticalAlign:"middle",width:"16px",height:"16px",boxSizing:"content-box"},".ms-Button-icon":{fontSize:"13px",color:e.palette.themePrimary}}},attributionHover:{visibility:"hidden",selectors:{"*:hover > * > * > &":{visibility:"visible"},"*:focus":{visibility:"visible"},".ms-Fabric.is-focusVisible &":{visibility:"visible"}}},attributionCallout:{selectors:{".ms-Callout-main":{padding:"14px",overflow:"visible !important"}}},calloutContent:{margin:"-24px",padding:"24px",fontSize:"12px"},attributionTitle:{fontWeight:"bold"}})}),Wn=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(l.a)(this,Object(d.a)(t).call(this,e))).iconButtonElement=null,n.onClickIcon=function(e){e&&n.props.showAlways&&e.preventDefault(),n.state.isCalloutVisible&&e&&0===e.screenX&&0===e.screenY?n.onHide():n.onShow()},n.onShow=function(){n.setState(function(e){return Object(f.l)(e,{isCalloutVisible:!0})})},n.onHide=function(){n.setState(function(e){return Object(f.l)(e,{isCalloutVisible:!1})})},n.state={isCalloutVisible:!1},n}return Object(u.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this,t=this.props.attributions.length>0,n=this.state.isCalloutVisible,r=Rn(this.props.theme),a=[r.attributionInfoIcon];return this.props.showAlways||this.state.isCalloutVisible||a.push(r.attributionHover),k.createElement("span",{className:a.join(" "),ref:function(t){return e.iconButtonElement=t}},t&&k.createElement(v.a,{iconProps:{iconName:"Info"},onMouseEnter:this.onShow,onMouseLeave:this.onHide,onMouseDown:this.onClickIcon,onClick:this.onClickIcon,tabIndex:-1,ariaLabel:Bn()}),n?this.iconButtonElement&&k.createElement(Un.a,{className:r.attributionCallout,target:this.iconButtonElement,onDismiss:this.onHide,gapSpace:8,directionalHint:Tn.a.rightTopEdge,isBeakVisible:!1},k.createElement("div",{className:r.calloutContent,onMouseEnter:this.onShow,onMouseLeave:this.onHide,role:"alert"},k.createElement("span",null,k.createElement("div",{className:r.attributionTitle},Mn())),this.props.attributions.map(function(e,t){return k.createElement("div",{key:t},e)}),this.props.children?k.createElement("p",null,this.props.children):null)):null)}}]),t}(k.Component),In=Object(S.a)(Wn),Fn=n(1167),Hn=Object(En.b)(function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"inactive",n=e.palette,r=n.neutralLighterAlt;return Object(Pn.X)({container:{position:"relative",display:"block",paddingTop:"13px",marginTop:"6px",marginBottom:"0px",width:"100%",backgroundColor:"disabled"===t?r:"inherit"},textField:{selectors:{"& .ms-TextField-fieldGroup, &.is-disabled .ms-TextField-fieldGroup":{backgroundColor:"transparent",zIndex:2},"input:disabled":Object(m.a)({backgroundColor:"transparent"},{"-webkit-text-fill-color":n.neutralTertiaryAlt,"-webkit-opacity":1}),"& .ms-TextField-field":{paddingLeft:0}}},label:{display:"flex",alignItems:"center",position:"absolute",zIndex:"inactive"===t?1:3,transition:"top 200ms ease-out, color 200ms, font-size 200ms ease-out",fontSize:"inactive"===t?"17px":"12px",top:"inactive"===t?"0px":"-10px",height:"inactive"===t?"32px":"16px",color:"inactive"===t?n.neutralSecondaryAlt:n.neutralSecondary}})}),Yn=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(l.a)(this,Object(d.a)(t).call(this,e))).textField=null,n.onFocus=function(){n.setState(function(e){return Object(f.l)(e,{isActive:!0})})},n.onBlur=function(){n.props.onBlur&&n.props.onBlur(),n.setState(function(e){return Object(f.l)(e,{isActive:!1})})},n.onRenderLabel=function(e){if(!e)return null;var t=n.getCSS();return k.createElement("div",{className:t.label},k.createElement("label",{htmlFor:e.id},e.label),n.props.onGetLabelAddon&&n.props.onGetLabelAddon(n.state.isActive))},n.getCSS=function(){var e=n.props.disabled||!n.props.isWritable?"disabled":n.props.value||n.state.isActive?"active":"inactive";return Hn(n.props.theme,e)},n.state={isActive:!1},n}return Object(u.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this,t=this.getCSS();return k.createElement("div",{className:Object(w.a)(t.container,this.props.className)},k.createElement(Fn.a,Object(r.a)({},this.props,{"data-log-name":this.props.dataLogName,componentRef:function(t){e.props.componentRef&&e.props.componentRef(t),e.textField=t},onRenderLabel:this.onRenderLabel,onFocus:this.onFocus,onBlur:this.onBlur,onKeyPress:function(t){return e.onKeyPress(t)},className:t.textField,underlined:!0,disabled:this.props.disabled||!this.props.isWritable,multiline:this.props.multiline||!1,autoAdjustHeight:this.props.multiline||!1})))}},{key:"onKeyPress",value:function(e){this.textField&&13===e.charCode&&this.props.onReturnPressed&&!this.props.multiline&&this.props.onReturnPressed(this.textField)}}]),t}(k.Component),Gn=Object(S.a)(Yn),zn=function(e){function t(){var e,n;Object(c.a)(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(n=Object(l.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(a)))).onGetLabelAddon=function(e){return n.props.value||e?k.createElement(In,{attributions:n.props.attributions,showAlways:e}):null},n}return Object(u.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return k.createElement(Gn,Object(r.a)({},this.props,{onGetLabelAddon:this.onGetLabelAddon}))}}]),t}(k.Component);function Xn(e){var t=0===e.emails.length?null:e.emails.map(function(t,n){var r="".concat(t.propertyUri,"-").concat(t.index);return k.createElement(zn,{componentRef:function(r){return e.textFieldRef(t.propertyUri,r,e.focusIndex+n/e.emails.length)},id:r,key:r,dataLogName:r,label:Me("Email"),value:t.newValue||"",isWritable:t.isWritable,onChanged:Object(f.b)(function(n){return e.onUpdateEmail(Object(f.l)(t,{newValue:n}))}),onReturnPressed:e.onReturnPressed,attributions:t.attributions,errorMessage:(t.showErrorMessage?e.strings.emailErrorMessage:"")||(t.newValue.length>Fe?e.strings.inputLengthErrorMessage:""),onBlur:function(){return e.onBlurEmail(t)}})});return k.createElement(kn,null,t)}function Kn(e){var t=0===e.ims.length?null:e.ims.map(function(t,n){var r="".concat(t.propertyUri,"-").concat(t.index);return k.createElement(zn,{componentRef:function(r){return e.textFieldRef(t.propertyUri,r,e.focusIndex+n/e.ims.length)},id:r,key:r,dataLogName:r,label:Me("IM"),value:t.newValue||"",isWritable:t.isWritable,errorMessage:t.newValue.length>Fe?e.strings.inputLengthErrorMessage:"",onChanged:Object(f.b)(function(n){return e.onUpdateIM(Object(f.l)(t,{newValue:n}))}),onReturnPressed:e.onReturnPressed,attributions:t.attributions})});return k.createElement(kn,null,t)}var qn=Object(En.b)(function(){return Object(Pn.X)({container:{flexGrow:1,marginTop:"-4px",flexDirection:"row",justifyContent:"space-between",flexWrap:"wrap"},nameFieldContainer:{flex:"1 1 200px"},nameFieldLeftSmallContainer:{flex:"0 0 60px",marginRight:"20px"},nameFieldRightSmallContainer:{flex:"0 0 60px",marginLeft:"20px"}})});function Jn(e){var t=qn();return k.createElement(kn,{className:t.container},ye.f.map(function(n,r){if(n in e.names){var a=e.names[n];if(!a||null===a.oldValue&&null===a.newValue)return null;var o=function(e,t){switch(e){case"DisplayNamePrefix":return t.nameFieldLeftSmallContainer;case"Generation":return t.nameFieldRightSmallContainer;default:return t.nameFieldContainer}}(n,t),i=a.oldValue;return k.createElement(zn,{componentRef:function(t){return e.textFieldRef(a.propertyUri,t,e.focusIndex+r/ye.f.length)},key:n,dataLogName:n,id:n,className:o,label:Me(n),value:a.newValue||"",isWritable:a.isWritable,errorMessage:a.newValue.length>Fe?e.strings.inputLengthErrorMessage:"",onChanged:Object(f.b)(function(t){return e.onUpdateName(n,i,t)}),onReturnPressed:e.onReturnPressed,attributions:a.attributions})}return null}))}var _n=n(188),Zn=n.n(_n),$n=n(1150),Qn=Object(En.b)(function(e){var t=e.palette;return Object(Pn.X)({deletableDatePicker:{border:"0px",margin:"8px 0px 8px 0px",padding:"0px"},container:{display:"flex",flexDirection:"row",alignItems:"flex-end",selectors:{"& .ms-Dropdown-container":{width:"100%"},"& .ms-Dropdown-label":{fontSize:"12px"},"& > div":{paddingRight:"12px"}}},monthPicker:{width:"160px"},datePicker:{width:"80px"},yearPicker:{width:"100px"},deleteButton:{selectors:{"&:hover":{backgroundColor:t.neutralLight},"&:hover .ms-Button-icon":{color:t.neutralPrimary}}},label:{display:"flex",fontSize:"12px",marginBottom:"4px",color:t.neutralSecondary,padding:0}})}),er=1604,tr=function(e){function t(e){var n;Object(c.a)(this,t),(n=Object(l.a)(this,Object(d.a)(t).call(this,e))).changeDayState=function(e){e&&n.props.otherContactProp.isWritable&&(n.setState(function(t){return Object(f.l)(t,{selectedDayItem:e})}),n.updateStore(n.getSelectedYear(),n.getSelectedMonth(),or(e.text)))},n.changeMonthState=function(e){e&&n.props.otherContactProp.isWritable&&(n.setState(function(t){return Object(f.l)(t,{selectedMonthItem:e})}),n.updateStore(n.getSelectedYear(),or(e.key.toString()),n.getSelectedDay()))},n.changeYearState=function(e){e&&n.props.otherContactProp.isWritable&&(n.setState(function(t){return Object(f.l)(t,{selectedYearItem:e})}),n.updateStore(or(e.text)||er,n.getSelectedMonth(),n.getSelectedDay()))};var r=e.otherContactProp.newValue?e.otherContactProp.newValue:e.otherContactProp.oldValue?e.otherContactProp.oldValue:rr(new Date(er,0,1));return n.state={selectedDayItem:{key:r.getUTCDate().toString(),text:""},selectedMonthItem:{key:r.getUTCMonth().toString(),text:""},selectedYearItem:{key:r.getUTCFullYear().toString(),text:""}},n}return Object(u.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this,t=this.state,n=t.selectedMonthItem,r=t.selectedDayItem,a=t.selectedYearItem,o=!this.props.otherContactProp.isWritable,i=Qn(this.props.theme),c={optionsContainerWrapper:{maxHeight:"280px",overflowY:"scroll",overflowX:"hidden"},optionsContainer:{marginRight:"16px"}};return k.createElement("fieldset",{className:i.deletableDatePicker},k.createElement("legend",{className:i.label},this.props.label," ",k.createElement(In,{attributions:this.props.attributions,showAlways:!1})),k.createElement("div",{className:i.container},k.createElement("div",{className:i.monthPicker},k.createElement($n.a,{allowFreeform:!0,componentRef:function(t){!o&&e.props.componentRef(t,e.props.focusIndex)},disabled:o,ariaLabel:Me("Month"),selectedKey:n&&n.key,onChanged:this.changeMonthState,options:this.getMonthOptions(),styles:c})),k.createElement("div",{className:i.datePicker},k.createElement($n.a,{allowFreeform:!0,componentRef:function(t){!o&&e.props.componentRef(t,e.props.focusIndex,!0)},disabled:o,ariaLabel:Me("Day"),selectedKey:r&&r.key,onChanged:this.changeDayState,options:this.getDayOptions(),styles:c})),k.createElement("div",{className:i.yearPicker},k.createElement($n.a,{allowFreeform:!0,componentRef:function(t){!o&&e.props.componentRef(t,e.props.focusIndex,!0)},disabled:o,ariaLabel:Me("Year"),selectedKey:a&&a.key,onChanged:this.changeYearState,options:this.getYearOptions(),styles:c})),this.props.onDeleted?k.createElement(v.a,{className:i.deleteButton,onClick:this.props.onDeleted,iconProps:{iconName:"Delete"},title:this.props.strings.removeDate,ariaLabel:this.props.strings.removeDate}):null))}},{key:"updateStore",value:function(e,t,n){this.props.onUpdate(Object(f.l)(this.props.otherContactProp,{newValue:rr(new Date(e,t,n,11,59))}))}},{key:"getSelectedYear",value:function(){return or(this.state.selectedYearItem.key.toString())||er}},{key:"getSelectedMonth",value:function(){return or(this.state.selectedMonthItem.key.toString())}},{key:"getSelectedDay",value:function(){return or(this.state.selectedDayItem.key.toString())}},{key:"getDayOptions",value:function(){return(e=this.getSelectedMonth(),t=this.getSelectedYear(),ar(1,function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:er;return new Date(t,e+1,0).getDate()}(e,t))).map(function(e){return{key:e,text:e}});var e,t}},{key:"getMonthOptions",value:function(){return(e=this.props.strings.monthNames,[e.january,e.february,e.march,e.april,e.may,e.june,e.july,e.august,e.september,e.october,e.november,e.december]).map(function(e,t){return{key:t.toString(),text:e}});var e}},{key:"getYearOptions",value:function(){return[{key:er.toString(),text:Me("Year")}].concat(ar(1900,(new Date).getUTCFullYear()).reverse().map(function(e){return{key:e,text:e}}))}}]),t}(k.Component),nr=Object(S.a)(tr);function rr(e){var t=6e4*e.getTimezoneOffset();return new Date(e.getTime()-t)}function ar(e,t){return Array.apply(null,new Array(t-e+1)).map(function(t,n){return(n+e).toString()})}function or(e){return Zn()(e,10)}function ir(e){if(0===e.otherContactProps.length)return null;var t=ye.g.map(function(t,n){return e.otherContactProps.filter(function(e){return e.propertyUri===t}).map(function(t){var r="".concat(t.propertyUri,"-").concat(t.index);return an(t)?k.createElement(nr,{componentRef:function(n,r,a){return e.focusTargetRef(a?void 0:t.propertyUri,n,r)},focusIndex:e.focusIndex+n/ye.g.length,onUpdate:e.onUpdateOtherContactProp,onDeleted:t.isWritable?function(){e.onRemoveOtherContactDateProp(t)}:void 0,strings:e.strings,otherContactProp:t,key:r,label:Me(t.propertyUri),attributions:t.attributions}):k.createElement(zn,{componentRef:function(r){return e.focusTargetRef(t.propertyUri,r,e.focusIndex+n/ye.g.length)},id:r,key:r,dataLogName:r,label:Me(t.propertyUri),value:t.newValue||"",isWritable:t.isWritable,errorMessage:t.newValue.length>Fe?e.strings.inputLengthErrorMessage:"",onChanged:Object(f.b)(function(n){e.onUpdateOtherContactProp(Object(f.l)(t,{newValue:n}))}),attributions:t.attributions,onReturnPressed:e.onReturnPressed})})});return k.createElement(Ln,{header:e.strings.otherPropertiesHeader},k.createElement(kn,null,t))}var cr=Object(En.b)(function(){return Object(Pn.X)({notesEditor:{width:"100%",marginTop:"12px",marginBottom:"40px"}})});function sr(e){var t=e.textFieldRef,n=e.strings,r=e.notes,a=e.onUpdatePersonalNote,o=e.focusIndex;return k.createElement(Ln,{header:n.privateNotes},r.map(function(e){return k.createElement(Fn.a,{disabled:!e.isWritable,className:cr().notesEditor,ariaLabel:lr(n.privateNotes,n.privateNotesSection,e),label:r.length>1?lr(n.privateNotes,n.privateNotesSection,e):void 0,componentRef:function(e){return t("PersonaBodies",e,o)},multiline:!0,autoAdjustHeight:!0,rows:4,value:e.newValue||"",resizable:!1,placeholder:n.privateNotesPlaceholder,key:e.index,"data-log-name":"PersonaBodies-".concat(e.index),onChanged:Object(f.b)(function(t){e.isWritable&&a(Object(f.l)(e,{newValue:t}))})})}))}function lr(e,t,n){return 0===n.attributions.length?e:t({p0:n.attributions.join(" - ")})}function dr(e){var t=0===e.phones.length?null:e.phones.map(function(t,n){var r="".concat(t.propertyUri,"-").concat(t.index);return k.createElement(zn,{componentRef:function(r){return e.textFieldRef(t.propertyUri,r,e.focusIndex+n/e.phones.length)},id:r,key:r,dataLogName:r,label:Re(t.propertyUri),value:t.newValue||"",isWritable:t.isWritable,errorMessage:t.newValue.length>Fe?e.strings.inputLengthErrorMessage:"",onChanged:Object(f.b)(function(n){return e.onUpdatePhone(Object(f.l)(t,{newValue:n}))}),onReturnPressed:e.onReturnPressed,attributions:t.attributions})});return k.createElement(kn,null,t)}var ur=Object(En.b)(function(e){return Object(Pn.X)({headerRow:Object(m.a)({},{justifyContent:"space-between",lineHeight:"14px;",marginTop:"6px"},{},Pn.e.small,{},!e&&{backgroundColor:Pn.f.neutralLighterAlt}),header:{color:Pn.f.neutralSecondary},addressFieldsContainer:{flexDirection:"row",justifyContent:"space-between",flexWrap:"wrap",display:"flex"},fullLineField:{flex:"0 0 100%"},halfLineField:{flex:"0 0 192px"}})});function pr(e){var t=["Street","City","State","PostalCode","Country"],n=ur(e.postalAddress.isWritable);return k.createElement("div",{className:n.addressFieldsContainer},t.map(function(r,a){var o="".concat(e.postalAddress.propertyUri,"-").concat(e.postalAddress.index,"-").concat(r);return k.createElement(Gn,{componentRef:function(n){return e.textFieldRef(0===a?e.postalAddress.propertyUri:void 0,n,e.focusIndex+a/(100*t.length))},id:o,key:o,dataLogName:o,label:Me(r),className:0===a?n.fullLineField:n.halfLineField,value:e.postalAddress.newValue&&e.postalAddress.newValue[r]||"",errorMessage:(e.postalAddress.newValue&&e.postalAddress.newValue[r]||"").length>Fe?e.strings.inputLengthErrorMessage:"",isWritable:e.postalAddress.isWritable,multiline:"Street"===r,onChanged:Object(f.b)(function(t){e.postalAddress.newValue&&e.onUpdatePostalAddress(Object(f.l)(e.postalAddress,{newValue:Object(f.l)(e.postalAddress.newValue,Object(xe.a)({},r,t))}))}),onReturnPressed:e.onReturnPressed})}))}function mr(e){var t=e.postalAddresses.map(function(t,n){return k.createElement(Ln,{key:n,header:(a=Me(t.propertyUri),o=t.attributions,k.createElement(Nn,null,a," ",k.createElement(In,{attributions:o,showAlways:!1})))},k.createElement(pr,Object(r.a)({postalAddress:t,focusIndex:e.focusIndex+n/e.postalAddresses.length},e)));var a,o});return k.createElement(kn,null,t)}var hr=n(890),fr=k.lazy(function(){return Promise.all([n.e(0),n.e(5)]).then(n.bind(null,1619)).then(function(e){return{default:e.StandaloneProfilePhotoPicker}})}),gr=function(e){function t(e){var n;return Object(c.a)(this,t),(n=Object(l.a)(this,Object(d.a)(t).call(this,e))).showPhotoPicker=function(){n.setState(function(e){return Object(f.l)(e,{isPhotoPickerVisible:!0})})},n.hidePhotoPicker=function(){n.setState(function(e){return Object(f.l)(e,{isPhotoPickerVisible:!1})})},n.state={isPhotoPickerVisible:!1},n}return Object(u.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this;return k.createElement(hr.a,{onClick:this.showPhotoPicker,title:this.props.title},k.createElement(k.Suspense,{fallback:k.createElement("div",null)},this.state.isPhotoPickerVisible&&k.createElement(fr,{personDisplayName:this.props.personDisplayName,personImageUrl:this.props.personImageUrl,strings:this.props.strings,onUpload:function(t,n,r){return e.onPhotoUploaded(t,n,r)},onDismiss:this.hidePhotoPicker})))}},{key:"onPhotoUploaded",value:function(e,t,n){t(),this.hidePhotoPicker(),this.props.onUpload&&this.props.onUpload(e)}}]),t}(k.Component),br=n(1066),yr=n(1006),Sr=n(1154),xr=n(1017),vr=n(1264),Pr=n(1189),Er=n(1263),Cr=n(1016),Ar=n(1623),Or=n(1015),Nr=Object(En.b)(function(e){return Object(Pn.X)({button:{margin:"10px 14px 0px 0px",padding:"0px",minWidth:"120px",maxWidth:"160px",color:e.palette.themePrimary,selectors:{"& .ms-Button-menuIcon, & .ms-Button-icon":{color:e.palette.themePrimary}}}})});var wr=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e,t,n,r=this.props,a=function(e,t){var n=Zt(e,t),r=ye.e.filter(function(e){return!n[e]});return Object(Oe.a)(r.map(Qe))}(r.originalContact,r.changeSet),o=(e=r.originalContact,t=r.changeSet,n=r.isEnterprise,at(e,t,ft,ye.b,n)),i=function(e,t,n){var r=at(e,t,rt,ye.j,n);return Object(Ne.a)(r,function(e){return We(e)})}(r.originalContact,r.changeSet,r.isEnterprise),c=function(e,t,n){return at(e,t,qt,ye.o,n)}(r.originalContact,r.changeSet,r.isEnterprise),s=function(e,t,n){return at(e,t,vt,ye.k,n)}(r.originalContact,r.changeSet,r.isEnterprise),l=function(e,t,n){return at(e,t,Nt,ye.h,n)}(r.originalContact,r.changeSet,r.isEnterprise),d=function(e,t,n){return at(e,t,ct,ye.c,n)}(r.originalContact,r.changeSet,r.isEnterprise),u=function(e,t,n){return at(e,t,Lt,ye.i,n)}(r.originalContact,r.changeSet,r.isEnterprise),p=Nr(r.theme),m=o.slice(0,1),h=Object(Ar.a)(ye.j,i.filter(ye.p)),f=Object(Ar.a)(ye.j,i.filter(ye.y));0===h.length&&(h=f,f=[]);var g=function(e){return{key:e,name:We(e),onClick:function(){r.onAddPhone(e)}}},b=r.disabled||o.length+d.length+a.length+h.length+f.length+c.length+l.length+s.length===0;return k.createElement(Or.a,{"data-log-name":"ContactEditorAdd",className:p.button,disabled:b,menuProps:{items:m.map(function(e){return{key:e,name:Me("Email"),onClick:function(){r.onAddEmail(e)}}}).concat(d.map(function(e){return{key:e,name:Me("IM"),onClick:function(){r.onAddIm(e)}}})).concat(kr(Me("AddNameSubmenu"),a.map(function(e){return{key:e,name:Me(e),onClick:function(){window.setTimeout(function(){return r.onAddName(e)},0)}}})),kr(Me("AddPhoneSubmenu"),h.map(g).concat(kr(Me("AddPhoneOtherSubmenu"),f.map(g),Me("AddPhoneSubmenu").concat(Me("AddPhoneOtherSubmenu"))))),kr(Me("AddWorkSubmenu"),c.map(function(e){return{key:e,name:Me(e),onClick:function(){r.onAddWorkDetail(e)}}})),kr(Me("AddAddressSubmenu"),s.map(function(e){return{key:e,name:Ie(e),onClick:function(){r.onAddPostalAddress(e)}}})),kr(Me("AddOtherSubmenu"),l.map(function(e){return{key:e,name:Me(e),onClick:function(){r.onAddOtherContactProp(e)}}}))).concat(u.map(function(e){return{key:e,name:Me("PersonaBodies"),onClick:function(){r.onAddPersonalNotes(e)}}}))},iconProps:{iconName:"Add"}},r.caption)}}]),t}(k.Component);function kr(e,t,n){return n=n||e,0===t.length?[]:{key:n,name:e,subMenuProps:{items:t}}}var jr=Object(j.b)(function(e,t){return{originalContact:yn.getSelectors(e).originalContact||{},changeSet:yn.getSelectors(e).changeSet}},function(e,t){return{onAddEmail:function(t){return e(Z({availableEmail:t}))},onAddIm:function(t){return e(J({availableIm:t}))},onAddName:function(t){return e(W({availableName:t}))},onAddOtherContactProp:function(t){return e(X({availableOtherContactProp:t}))},onAddPhone:function(t){return e(F({availablePhone:t}))},onAddPostalAddress:function(t){return e(G({availablePostalAddress:t}))},onAddWorkDetail:function(t){return e(ne({availableWorkDetail:t}))},onAddPersonalNotes:function(t){return e(ee({availableNotes:t}))}}})(Object(S.a)(wr)),Vr=Object(En.b)(function(e){var t=e.palette,n=t.neutralLighter;return Object(Pn.X)({button:{margin:"14px 14px 0px 0px",padding:"0px",minWidth:"80px",maxWidth:"100px",backgroundColor:t.neutralLighter,borderColor:t.neutralLighter,color:t.neutralPrimary,selectors:{"&.ms-Button--primary":{backgroundColor:t.themePrimary,color:t.white},"&.ms-Button--primary:hover":{backgroundColor:t.themeDarkAlt,color:t.white},"&.ms-Button--primary:active":{backgroundColor:t.themeDark,color:t.white},"&.is-disabled, &.ms-Button--primary.is-disabled":{backgroundColor:t.neutralLighter,color:t.neutralTertiary},"&.ms-Button--default:hover":{backgroundColor:t.neutralLight,color:t.black},"&.ms-Button--default:active":{backgroundColor:t.neutralTertiaryAlt,color:t.neutralDark}}},ghostedSaveBar:{display:"flex",flexDirection:"row"},ghostedButton:{margin:"14px 12px 0px 0px",height:"32px",maxWidth:"80px",minWidth:"80px",backgroundColor:n,borderColor:n},ghostedAddMoreButton:{display:"flex",flexDirection:"column",margin:"20px 0px 0px 0px",padding:"0px",minWidth:"120px",maxWidth:"120px",height:"22px",backgroundColor:n,borderColor:n},spinner:{width:"100%",margin:"auto"}})}),Dr=function(e){function t(){return Object(c.a)(this,t),Object(l.a)(this,Object(d.a)(t).apply(this,arguments))}return Object(u.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){return-1!==["saving","failed"].indexOf(this.props.editorState)?k.createElement(Pr.a,null,Lr(this.props)):k.createElement(Lr,this.props)}}]),t}(k.Component);function Lr(e){var t="loading"===e.editorState||"loadErrorDialogOpen"===e.editorState,n=Vr(e.theme),r="editing"===e.editorState;return k.createElement("div",{className:e.className},t?k.createElement("div",{className:n.ghostedSaveBar},k.createElement("span",{className:n.ghostedButton}),k.createElement("span",{className:n.ghostedButton}),k.createElement("span",{className:n.ghostedAddMoreButton})):k.createElement("div",null,k.createElement(Ur,e),k.createElement(Tr,e),k.createElement(jr,{disabled:!r,caption:e.strings.addMore,isEnterprise:e.isEnterprise})),"discardDialogOpen"===e.editorState?k.createElement(Mr,e):null,"loadErrorDialogOpen"===e.editorState?k.createElement(Rr,e):null)}function Ur(e){var t=Vr(e.theme),n=!e.hasChanges,r="failed"===e.editorState?e.onCancel:e.onSave;return k.createElement(br.a,{className:t.button,onClick:r,disabled:n,"data-log-name":"ContactEditorSave",onFocus:e.onSaveButtonFocus,theme:e.theme},function(e){switch(e.editorState){case"saving":case"discardDialogOpen":return k.createElement(Er.a,{className:Vr(e.theme).spinner,size:Cr.a.medium});case"failed":return e.strings.close;case"editing":return e.createMode?e.strings.create:e.strings.save;case"idle":case"loading":case"loadErrorDialogOpen":return"";default:return Object(f.g)(e.editorState)}}(e))}function Tr(e){var t=Vr(e.theme),n="saving"===e.editorState||"failed"===e.editorState;return k.createElement(yr.a,{className:t.button,onClick:e.onCancel,disabled:n,"data-log-name":"ContactEditorCancel",theme:e.theme},e.createMode?e.strings.discard:e.strings.cancel)}function Br(e){var t=e.onNotSaveInDialog,n=e.onCancelInDialog,r=e.strings,a=e.theme,o=Vr(a);return k.createElement(Sr.a,null,k.createElement(br.a,{onClick:t,text:r.discardDialogYes,"data-log-name":"EditContactSaveDialogNo",theme:a,className:o.button}),k.createElement(yr.a,{onClick:n,text:r.discardDialogCancel,"data-log-name":"EditContactSaveDialogCancel",theme:a,className:o.button}))}function Mr(e){var t=e.onCancelInDialog,n=e.strings;return k.createElement(Wr,{onCancel:t,title:n.discardDialogTitle,subText:n.discardDialogSubText,dialogType:xr.a.close,renderButtons:function(){return k.createElement(Br,e)}})}function Rr(e){var t=e.onCancelInDialog,n=e.strings,r=e.theme,a=Vr(r);return k.createElement(Wr,{onCancel:t,title:n.loadErrorDialogTitle,dialogType:xr.a.normal,renderButtons:function(){return k.createElement(Sr.a,null,k.createElement(br.a,{onClick:e.onCancelInDialog,text:n.errorDialogClose,theme:r,className:a.button}))}})}function Wr(e){return k.createElement(vr.a,{"data-log-name":"EditContactSaveDialog",hidden:!1,onDismiss:e.onCancel,dialogContentProps:{type:e.dialogType||xr.a.normal,title:e.title,subText:e.subText},modalProps:{isBlocking:!0}},e.renderButtons())}function Ir(e){if(0===e.workDetails.length)return null;var t=e.workDetails.map(function(t,n){var r="".concat(t.propertyUri,"-").concat(t.index);return k.createElement(zn,{componentRef:function(r){return e.textFieldRef(t.propertyUri,r,e.focusIndex+n/e.workDetails.length)},id:r,key:r,dataLogName:r,label:Me(t.propertyUri),value:t.newValue||"",isWritable:t.isWritable,errorMessage:t.newValue.length>Fe?e.strings.inputLengthErrorMessage:"",onChanged:Object(f.b)(function(n){return e.onUpdateWorkDetail(Object(f.l)(t,{newValue:n}))}),onReturnPressed:e.onReturnPressed,attributions:t.attributions})});return k.createElement(Ln,{header:e.strings.workDetailsHeader},k.createElement(kn,null,t))}var Fr="calc(100vh - ".concat(78,"px)"),Hr="calc(100vh - ".concat(179,"px)"),Yr=Object(En.b)(function(e){var t=e.palette,n={leftPaneTitle:e.fonts.xxLarge,leftPaneSubTitle:e.fonts.medium,leftPaneText:e.fonts.medium};return Object(Pn.X)(n,{editorRoot:{border:"1px solid transparent",width:"".concat(798,"px"),maxHeight:Fr,display:"flex",flexDirection:"row",overflow:"hidden",selectors:{"& h1, & h2, & h3":{marginTop:0,marginBottom:0}}},svg:{margin:"auto",height:"200px",width:"80%",display:"block"},primaryStroke:{stroke:t.themePrimary,fill:"none"},secondaryStroke:{stroke:t.themeTertiary,fill:"none"},leftPane:{boxSizing:"border-box",minWidth:"".concat(300,"px"),backgroundColor:t.neutralLighter,paddingLeft:"".concat(32,"px"),paddingRight:"".concat(32,"px"),paddingTop:"".concat(40,"px"),paddingBottom:"".concat(40,"px"),overflow:"auto",color:t.neutralPrimary,lineHeight:"18px"},leftPaneTitle:{paddingBottom:"40px",paddingTop:"10px",lineHeight:"1.2"},leftPaneSubTitle:{fontWeight:"600"},leftPaneText:{marginTop:"0px",whiteSpace:"pre-wrap"},rightPane:{minWidth:"".concat(500,"px"),display:"flex",flexDirection:"column"},rightBodyTopBorder:{selectors:{"div&":{borderTop:"1px solid ".concat(t.neutralLighter)}}},rightBody:{borderTop:"1px solid ".concat(t.white),maxHeight:Hr,padding:"0px",overflowY:"auto",marginTop:"".concat(39,"px")},rightBodyContent:{position:"relative",maxWidth:"".concat(404,"px"),paddingRight:"8px",paddingLeft:"".concat(48,"px"),paddingTop:"0px",paddingBottom:"0px",selectors:{"& .ms-Persona-initials":{color:"#FFFFFF"}}},rightFooter:{minHeight:"".concat(60,"px"),height:"".concat(60,"px"),padding:"0px ".concat(48,"px"),borderTop:"1px solid ".concat(t.neutralLighter),boxSizing:"border-box"},rightHeader:{paddingLeft:"".concat(48,"px"),maxWidth:"".concat(435,"px"),height:"10px",paddingTop:"0px",margin:"0px"},closeButtonOuter:{width:"".concat(31,"px"),textAlign:"center",position:"absolute",right:"1px",top:0},closeButton:{marginTop:"2px",color:t.neutralSecondary,selectors:{"&:hover .ms-Button--icon ":{color:t.themeDarker}}},errorBar:{margin:"0 auto 20px auto",maxWidth:"".concat(404,"px"),selectors:{"& .ms-MessageBar-icon":{margin:"8px 0 8px 8px"},"& .ms-MessageBar-text":{margin:"8px"}}},errorBarMessage:{color:t.black},editorOverlay:{zIndex:100,backgroundColor:t.white,opacity:.7},doughboy:{selectors:{"& .ms-Persona-coin .ms-Persona-initials":{fontSize:"32px",backgroundColor:t.neutralQuaternaryAlt}}}})}),Gr=n(1168),zr=n(477),Xr=n(1266);function Kr(e){var t=e.styles;return k.createElement("svg",{id:"Layer_1",className:t.svg,"data-name":"Layer 1",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 187.03 110.33","aria-hidden":"true"},k.createElement("line",{strokeLinecap:"round",strokeMiterlimit:"10",className:t.secondaryStroke,x1:"21.53",y1:"94.83",x2:"26.53",y2:"94.83"}),k.createElement("line",{strokeLinecap:"round",strokeMiterlimit:"10",className:t.secondaryStroke,x1:"132.53",y1:"94.83",x2:"149.53",y2:"94.83"}),k.createElement("line",{strokeLinecap:"round",strokeMiterlimit:"10",className:t.secondaryStroke,x1:"34.53",y1:"94.83",x2:"41.53",y2:"94.83"}),k.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",className:t.primaryStroke,d:"M104.75,71.56l.06.06a4.62,4.62,0,0,0,6.54,0h0",transform:"translate(-17.97 -15.67)"}),k.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",className:t.primaryStroke,d:"M100.16,83.1A9.51,9.51,0,0,0,108,87.3a9,9,0,0,0,7.89-4.2",transform:"translate(-17.97 -15.67)"}),k.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",className:t.primaryStroke,d:"M98.13,67.75A4,4,0,0,0,94.8,66a3.79,3.79,0,0,0-3.34,1.78",transform:"translate(-17.97 -15.67)"}),k.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",className:t.primaryStroke,d:"M124.46,67.75A4,4,0,0,0,121.13,66a3.79,3.79,0,0,0-3.34,1.78",transform:"translate(-17.97 -15.67)"}),k.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",className:t.primaryStroke,d:"M132,55V74.71a24,24,0,0,1-24,24h0a24,24,0,0,1-24-24V55.05",transform:"translate(-17.97 -15.67)"}),k.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",className:t.primaryStroke,d:"M84,64.62h-.51A5.41,5.41,0,0,0,78,70v.17a5.41,5.41,0,0,0,5.41,5.41H84",transform:"translate(-17.97 -15.67)"}),k.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",className:t.primaryStroke,d:"M132,64.62h.16A5.41,5.41,0,0,1,137.52,70v.17a5.41,5.41,0,0,1-5.41,5.41H132",transform:"translate(-17.97 -15.67)"}),k.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",className:t.primaryStroke,d:"M153,125.5v-5.33a19.56,19.56,0,0,0-19.56-19.56H124",transform:"translate(-17.97 -15.67)"}),k.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",className:t.primaryStroke,d:"M92,100.62H82.51A19.56,19.56,0,0,0,63,120.17v5.33",transform:"translate(-17.97 -15.67)"}),k.createElement("line",{strokeLinecap:"round",strokeMiterlimit:"6",className:t.primaryStroke,x1:"73.98",y1:"76.95",x2:"73.98",y2:"84.95"}),k.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",className:t.primaryStroke,d:"M91.94,101.06s-.36,15.56,15.56,15.56c16.45,0,16.45-15.56,16.45-15.56V92.62",transform:"translate(-17.97 -15.67)"}),k.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",className:t.primaryStroke,d:"M131.55,72.91",transform:"translate(-17.97 -15.67)"}),k.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",className:t.primaryStroke,d:"M91.57,98.06c-1.77-.83-3.27-4.3-4.89-5.37s-4.72-.18-6.19-1.48-1-4.55-2.31-6.05S73.7,83.65,72.65,82s.26-4.66-.55-6.47-3.88-2.74-4.43-4.66,1.54-4.38,1.27-6.36-3-3.73-3-5.75,2.69-3.81,3-5.75-1.81-4.48-1.27-6.36S71.29,43.76,72.1,42s-.5-4.81.55-6.47,4.27-1.69,5.54-3.19.84-4.75,2.31-6.05,4.55-.4,6.19-1.48,2.1-4.32,3.88-5.14,4.47.93,6.35.37,3.2-3.53,5.15-3.81,4,2.19,6,2.19,4.09-2.46,6-2.19,3.3,3.26,5.15,3.81,4.59-1.19,6.35-.37,2.25,4.07,3.88,5.14,4.72.18,6.19,1.48,1,4.55,2.31,6.05,4.48,1.52,5.54,3.19-.26,4.66.55,6.47,3.88,2.74,4.43,4.66S146.86,51,147.14,53s3,3.73,3,5.75-2.69,3.81-3,5.75,1.81,4.48,1.27,6.36-3.63,2.87-4.43,4.66.5,4.81-.55,6.47-4.27,1.69-5.54,3.19-.84,4.75-2.31,6.05-4.55.4-6.19,1.48-3.09,4.54-4.87,5.37",transform:"translate(-17.97 -15.67)"}),k.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",className:t.primaryStroke,d:"M84,55.23a2.29,2.29,0,0,0,1.65-.64c1.7-1.12,2.19-4.5,4-5.36s4.66,1,6.62.38,3.34-3.68,5.37-4,4.19,2.28,6.24,2.28,4.26-2.57,6.24-2.28,3.44,3.4,5.37,4,4.79-1.24,6.62-.38,2.35,4.25,4,5.36a3.51,3.51,0,0,0,1.23.47",transform:"translate(-17.97 -15.67)"}),k.createElement("line",{strokeLinecap:"round",strokeMiterlimit:"10",className:t.secondaryStroke,x1:"77.5",y1:"109.83",x2:"147.53",y2:"109.83"}),k.createElement("line",{strokeLinecap:"round",strokeMiterlimit:"10",className:t.secondaryStroke,x1:"30.5",y1:"109.83",x2:"60.53",y2:"109.83"}),k.createElement("line",{strokeLinecap:"round",strokeMiterlimit:"10",className:t.secondaryStroke,x1:"0.5",y1:"109.83",x2:"19.53",y2:"109.83"}),k.createElement("line",{strokeLinecap:"round",strokeMiterlimit:"10",className:t.secondaryStroke,x1:"156.5",y1:"109.83",x2:"186.53",y2:"109.83"}))}var qr={title:((Ve.declareString)("contactEditorStrings.infoTextNewContact.title")),description:((Ve.declareStringWithPlaceholders)("contactEditorStrings.infoTextNewContact.description"))},Jr={title:((Ve.declareString)("contactEditorStrings.infoTextAddContact.title")),description:((Ve.declareStringWithPlaceholders)("contactEditorStrings.infoTextAddContact.description"))},_r={title:((Ve.declareString)("contactEditorStrings.infoTextEditContact.title")),description:((Ve.declareStringWithPlaceholders)("contactEditorStrings.infoTextEditContact.description"))},Zr={title:((Ve.declareString)("contactEditorStrings.infoTextEditLinkedContact.title")),description:((Ve.declareStringWithPlaceholders)("contactEditorStrings.infoTextEditLinkedContact.description")),subTitle:((Ve.declareString)("contactEditorStrings.infoTextEditLinkedContact.subTitle")),subDescription:((Ve.declareStringWithPlaceholders)("contactEditorStrings.infoTextEditLinkedContact.subDescription"))};function $r(e){var t=e.styles,n=e.strings,r=e.editorMode,a=e.containsNonWritable,o=function(e,t){switch(e){case"NewContact":return qr;case"AddContact":return Jr;case"EditContact":return t?Zr:_r;default:return Object(f.g)(e),qr}}(r,e.isLinkedContact);return k.createElement("section",{className:t.leftPane,role:"region","aria-labelledby":"lpc-contact-editor-title"},k.createElement("h2",{className:t.leftPaneTitle,id:"lpc-contact-editor-title"},o.title()),k.createElement("p",{className:t.leftPaneText},k.createElement(Gr.a,{text:o.description,placeholders:{p0:k.createElement("strong",null,n.addMore)}})),k.createElement(Kr,{styles:t}),a&&o.subTitle&&k.createElement("h2",{className:t.leftPaneSubTitle},o.subTitle()),a&&o.subDescription&&k.createElement("p",{className:t.leftPaneText},k.createElement(Gr.a,{text:o.subDescription,placeholders:{p0:k.createElement(zr.a,{iconName:"Info"})}})),o.link&&o.linkLabel&&k.createElement(Xr.a,{href:o.link()},o.linkLabel()))}var Qr=Object(g.memoizeFunction)(function(e){return Object(m.a)({},e,{},{save:((Ve.declareString)("contactEditorStrings.save"))(),edit:((Ve.declareString)("contactEditorStrings.edit"))(),remove:((Ve.declareString)("contactEditorStrings.remove"))(),cancel:((Ve.declareString)("contactEditorStrings.cancel"))(),close:((Ve.declareString)("contactEditorStrings.close"))(),saving:((Ve.declareString)("contactEditorStrings.saving"))(),create:((Ve.declareString)("contactEditorStrings.create"))(),tryAgain:((Ve.declareString)("contactEditorStrings.tryAgain"))(),discard:((Ve.declareString)("contactEditorStrings.discard"))(),closeButtonAccessibilityTitle:((Ve.declareString)("contactEditorStrings.closeButtonAccessibilityTitle"))(),discardDialogTitle:((Ve.declareString)("contactEditorStrings.discardDialogTitle"))(),discardDialogSubText:((Ve.declareString)("contactEditorStrings.discardDialogSubText"))(),saveErrorDialogTitleEmailError:((Ve.declareString)("contactEditorStrings.saveErrorDialogTitleEmailError"))(),saveErrorDialogTitleError:((Ve.declareString)("contactEditorStrings.saveErrorDialogTitleError"))(),saveErrorDialogTextEmailError:((Ve.declareString)("contactEditorStrings.saveErrorDialogTextEmailError"))(),loadErrorDialogTitle:((Ve.declareString)("contactEditorStrings.loadErrorDialogTitle"))(),discardDialogYes:((Ve.declareString)("contactEditorStrings.discardDialogYes"))(),discardDialogCancel:((Ve.declareString)("contactEditorStrings.discardDialogCancel"))(),errorDialogCancel:((Ve.declareString)("contactEditorStrings.errorDialogCancel"))(),errorDialogClose:((Ve.declareString)("contactEditorStrings.errorDialogClose"))(),emailErrorMessage:((Ve.declareString)("contactEditorStrings.emailErrorMessage"))(),navigationWarning:((Ve.declareString)("contactEditorStrings.navigationWarning"))(),inputLengthErrorMessage:((Ve.declareString)("contactEditorStrings.inputLengthErrorMessage"))(),addToFavorites:((Ve.declareString)("contactEditorStrings.addToFavorites"))(),removeFromFavorites:((Ve.declareString)("contactEditorStrings.removeFromFavorites"))(),contactEditFormAriaLabel:((Ve.declareString)("contactEditorStrings.contactEditFormAriaLabel"))(),contactInformation:((Ve.declareString)("contactEditorStrings.contactInformation"))(),workDetailsHeader:((Ve.declareString)("contactEditorStrings.workDetailsHeader"))(),postalAddressesHeader:((Ve.declareString)("contactEditorStrings.postalAddressesHeader"))(),otherPropertiesHeader:((Ve.declareString)("contactEditorStrings.otherPropertiesHeader"))(),privateNotes:((Ve.declareString)("contactEditorStrings.privateNotes"))(),privateNotesSection:((Ve.declareStringWithPlaceholders)("contactEditorStrings.privateNotesSection")),privateNotesPlaceholder:((Ve.declareString)("contactEditorStrings.privateNotesPlaceholder"))(),addMore:((Ve.declareString)("contactEditorStrings.addMore"))(),dayNames:{monday:((Ve.declareString)("contactEditorStrings.contactEditorDayNamesStrings.monday"))(),tuesday:((Ve.declareString)("contactEditorStrings.contactEditorDayNamesStrings.tuesday"))(),wednesday:((Ve.declareString)("contactEditorStrings.contactEditorDayNamesStrings.wednesday"))(),thursday:((Ve.declareString)("contactEditorStrings.contactEditorDayNamesStrings.thursday"))(),friday:((Ve.declareString)("contactEditorStrings.contactEditorDayNamesStrings.friday"))(),saturday:((Ve.declareString)("contactEditorStrings.contactEditorDayNamesStrings.saturday"))(),sunday:((Ve.declareString)("contactEditorStrings.contactEditorDayNamesStrings.sunday"))()},dayShortNames:{monday:((Ve.declareString)("contactEditorStrings.contactEditorDayShortNamesStrings.monday"))(),tuesday:((Ve.declareString)("contactEditorStrings.contactEditorDayShortNamesStrings.tuesday"))(),wednesday:((Ve.declareString)("contactEditorStrings.contactEditorDayShortNamesStrings.wednesday"))(),thursday:((Ve.declareString)("contactEditorStrings.contactEditorDayShortNamesStrings.thursday"))(),friday:((Ve.declareString)("contactEditorStrings.contactEditorDayShortNamesStrings.friday"))(),saturday:((Ve.declareString)("contactEditorStrings.contactEditorDayShortNamesStrings.saturday"))(),sunday:((Ve.declareString)("contactEditorStrings.contactEditorDayShortNamesStrings.sunday"))()},contactEditorDatePickerLocale:((Ve.declareString)("contactEditorStrings.contactEditorDatePickerLocale"))(),removeDate:((Ve.declareString)("contactEditorStrings.removeDate"))(),addContactPhotoFor:((Ve.declareStringWithPlaceholders)("contactEditorStrings.addContactPhotoFor")),changeContactPhotoFor:((Ve.declareStringWithPlaceholders)("contactEditorStrings.changeContactPhotoFor")),addContactPhoto:((Ve.declareString)("contactEditorStrings.addContactPhoto"))(),changeContactPhoto:((Ve.declareString)("contactEditorStrings.changeContactPhoto"))()})});function ea(){return(ea=Object(p.a)(o.a.mark(function e(t,n){var r;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,n.saveChanges(n.originalContact&&n.originalContact.PersonaId&&n.originalContact.PersonaId.Id||null,n.originalContact,Tt(n.changeSet,n.originalContact||void 0).map(function(e){return"PersonaBodies"===e.propertyUri?Object(m.a)({},e,{newValue:e.newValue||" "}):e}),n.changeSet.updatedProfilePhoto);case 3:(r=e.sent).success?(n.onClose(r.owsPersona&&r.owsPersona.PersonaId&&r.owsPersona.PersonaId.Id||null),t(pe())):t(he({error:r.message})),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),t(he({error:na(e.t0)}));case 10:case"end":return e.stop()}},e,null,[[0,7]])}))).apply(this,arguments)}function ta(e,t,n){n||Xe(t.changeSet,t.originalContact,t.editorMode)||"failed"===t.editorState?(t.onClose(null),e(me())):e(de())}function na(e){return"string"==typeof e?e:e instanceof Error?e.message:"Error"}var ra=function(e){function t(){var e,n;Object(c.a)(this,t);for(var r=arguments.length,a=new Array(r),o=0;o<r;o++)a[o]=arguments[o];return(n=Object(l.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(a)))).focusTargets={},n.focusOrder=[],n.formContainer=null,n.focusRef=function(e,t,r){e&&t&&(n.focusTargets[e]=t),t&&n.focusOrder&&Object(x.a)(n.focusOrder,function(e){return e.element===t})<0&&(n.focusOrder.push({focusIndex:r,element:t}),n.focusOrder.sort(function(e,t){return e.focusIndex-t.focusIndex}))},n.focusNextElement=function(e){var t=Object(x.a)(n.focusOrder,function(t){return t.element===e});if(!(t<0))for(var r=document.activeElement,a=t+1;a<n.focusOrder.length;a++){var o=n.focusOrder[a].element;if(o.focus(),r!==document.activeElement)return void(o.select&&document.activeElement&&"TEXTAREA"!==document.activeElement.tagName&&o.select())}},n.handleExternalCancel=function(){n.props.onExternalCancel()},n.handleNavigation=function(e){if(!Xe(n.props.changeSet,n.props.originalContact,n.props.editorMode)){var t=n.props.strings.navigationWarning;return e.returnValue=t,t}return null},n}return Object(u.a)(t,e),Object(s.a)(t,[{key:"render",value:function(){var e=this;if("idle"===this.props.editorState)return null;var t=this.props.originalContact||{},n=Zt(t,this.props.changeSet),r=rt(t,this.props.changeSet),a=qt(t,this.props.changeSet),o=vt(t,this.props.changeSet),i=function(e,t){return $e(ht(e),t.updatedEmails)}(t,this.props.changeSet),c=Nt(t,this.props.changeSet),s=Lt(t,this.props.changeSet),l=ct(t,this.props.changeSet),d=nn(r)||nn(a)||nn(o)||nn(i)||nn(c)||nn(l)||nn(s),u=t.DisplayNameFirstLast||t.DisplayName||(t.GivenName&&t.Surname?"".concat(t.GivenName," ").concat(t.Surname):void 0),p=r.length>0||i.length>0||l.length>0,m="loading"===this.props.editorState||"loadErrorDialogOpen"===this.props.editorState,h=Yr(this.props.theme),f=(!i.length||i.some(function(e){return e.isWritable}))&&!t.ADObjectId;return this.focusOrder=[],k.createElement("main",{id:"lpc-contact-editor",className:h.editorRoot,"data-log-name":"ContactEditor"},k.createElement($r,{styles:h,strings:this.props.strings,editorMode:this.props.editorMode,containsNonWritable:d,isLinkedContact:aa(t)}),k.createElement("section",{className:h.rightPane,role:"region","aria-label":this.props.strings.contactEditFormAriaLabel},k.createElement("div",{className:Object(w.a)(h.rightBody,this.formContainer&&this.formContainer.scrollTop>0&&h.rightBodyTopBorder),onScroll:function(){e.formContainer&&0===e.formContainer.scrollTop===e.formContainer.classList.contains(h.rightBodyTopBorder)&&e.formContainer.classList.toggle(h.rightBodyTopBorder)},ref:function(t){e.formContainer=t}},this.props.errorState&&k.createElement(P.a,{messageBarType:E.a.error,className:h.errorBar},k.createElement("div",{role:"alert",className:h.errorBarMessage},this.props.errorState.message)),m?k.createElement(Vn,{theme:this.props.theme,styling:h.rightBodyContent}):k.createElement("div",{className:h.rightBodyContent},k.createElement(Nn,null,k.createElement(kn,null,k.createElement(O.a,{imageUrl:this.props.changeSet.updatedProfilePhoto||(this.props.profilePhotoUrl?this.props.profilePhotoUrl.uri:void 0),size:N.c.extraLarge,text:u,className:u?"":h.doughboy,hidePersonaDetails:!0}),f&&k.createElement(gr,{personDisplayName:u||"",personImageUrl:this.props.changeSet.updatedProfilePhoto||this.props.profilePhotoUrl&&this.props.profilePhotoUrl.uri||"",title:ia(this.props),strings:this.props.strings.profilePhotoPickerStrings,onUpload:this.props.onUpdateProfilePhoto})),k.createElement(Jn,{names:n,focusIndex:0,textFieldRef:this.focusRef,strings:this.props.strings,onUpdateName:this.props.onUpdateName,onReturnPressed:this.focusNextElement})),p?k.createElement(Ln,{header:this.props.strings.contactInformation},k.createElement(Xn,{emails:i,focusIndex:1,textFieldRef:this.focusRef,strings:this.props.strings,onBlurEmail:this.props.onBlurEmail,onUpdateEmail:this.props.onUpdateEmail,onReturnPressed:this.focusNextElement}),k.createElement(Kn,{ims:l,focusIndex:2,textFieldRef:this.focusRef,onUpdateIM:this.props.onUpdateIm,strings:this.props.strings,onReturnPressed:this.focusNextElement}),k.createElement(dr,{phones:r,focusIndex:3,textFieldRef:this.focusRef,strings:this.props.strings,onUpdatePhone:this.props.onUpdatePhone,onReturnPressed:this.focusNextElement})):null,k.createElement(Ir,{workDetails:a,focusIndex:4,strings:this.props.strings,textFieldRef:this.focusRef,onUpdateWorkDetail:this.props.onUpdateWorkDetail,onReturnPressed:this.focusNextElement}),k.createElement(mr,{postalAddresses:o,focusIndex:5,strings:this.props.strings,textFieldRef:this.focusRef,onAddressEditStarted:this.props.onPostalAddressEditStarted,onUpdatePostalAddress:this.props.onUpdatePostalAddress,onReturnPressed:this.focusNextElement}),k.createElement(ir,{otherContactProps:c,focusIndex:6,strings:this.props.strings,focusTargetRef:this.focusRef,onUpdateOtherContactProp:this.props.onUpdateOtherContactProp,onRemoveOtherContactDateProp:this.props.onRemoveOtherContactDateProp,onReturnPressed:this.focusNextElement}),k.createElement(sr,{notes:s,focusIndex:7,onUpdatePersonalNote:this.props.onUpdatePersonalNote,textFieldRef:this.focusRef,strings:this.props.strings}),k.createElement(oa,this.props))),k.createElement(Dr,{className:h.rightFooter,strings:this.props.strings,editorState:this.props.editorState,hasChanges:!Xe(this.props.changeSet,this.props.originalContact,this.props.editorMode),onSave:this.props.onSaveButtonClick,onCancel:this.props.onCancelButtonClick,onNotSaveInDialog:this.props.onNotSaveButtonInDialogClick,onCancelInDialog:this.props.onCancelButtonInDialogClick,onRetryLoadInDialog:this.props.onRetryLoadInDialogClick,createMode:"AddContact"===this.props.editorMode||"NewContact"===this.props.editorMode,theme:this.props.theme,onSaveButtonFocus:this.props.onResetErrorState,isEnterprise:this.props.isEnterprise}),k.createElement("div",{className:h.closeButtonOuter},k.createElement(v.a,{theme:this.props.theme,className:h.closeButton,ariaLabel:this.props.strings.closeButtonAccessibilityTitle,title:this.props.strings.closeButtonAccessibilityTitle,onClick:this.props.onCancelButtonClick,iconProps:{iconName:"Cancel"},"data-log-name":"ContactEditorClose"}))))}},{key:"componentDidMount",value:function(){this.updateComponentRef(void 0,this.props),window.addEventListener("beforeunload",this.handleNavigation),this.updateFocus()}},{key:"componentWillUnmount",value:function(){window.removeEventListener("beforeunload",this.handleNavigation),this.props.componentRef&&this.props.componentRef(null)}},{key:"componentDidUpdate",value:function(e){if(null!==this.props.errorState&&this.formContainer){this.props.strings.saveErrorDialogTitleError!==this.props.errorState.message||tn(this.props.changeSet)||this.props.onResetErrorState();var t=this.focusTargets[this.props.errorState.propertyUri];t&&(e.errorState&&e.errorState.propertyUri)!==this.props.errorState.propertyUri?t.focus():(e.errorState&&e.errorState.message)!==this.props.errorState.message&&(this.formContainer.scrollTop=0)}else e.focusPropertyUri===this.props.focusPropertyUri&&e.mostRecentPropertyUri===this.props.mostRecentPropertyUri&&e.editorState===this.props.editorState||this.updateFocus()}},{key:"componentWillReceiveProps",value:function(e){this.updateComponentRef(this.props,e)}},{key:"updateComponentRef",value:function(e,t){var n=this;(!e&&t.componentRef||e&&e.componentRef!==t.componentRef)&&(e&&e.componentRef&&e.componentRef(null),t.componentRef&&t.componentRef({cancel:function(){return n.handleExternalCancel()}}))}},{key:"updateFocus",value:function(){var e=this.props.mostRecentPropertyUri&&this.focusTargets[this.props.mostRecentPropertyUri]||this.focusTargets.PersonaGivenNames;e&&setTimeout(function(t){e.focus()},15)}}]),t}(k.Component);function aa(e){return!!e&&(e.AttributionsArray?e.AttributionsArray.filter(function(e){return!e.IsHidden&&"RecipientCache"!==e.DisplayName}):[""]).length>1}function oa(e){var t=e.editorState;if(-1===["saving","failed","discardDialogOpen"].indexOf(t))return null;var n=Yr(e.theme);return k.createElement(A.a,{"data-log-name":"ContactEditorOverlay",className:n.editorOverlay})}function ia(e){var t=e.changeSet.updatedNames.PersonaGivenNames&&e.changeSet.updatedNames.PersonaGivenNames.newValue||e.originalContact&&e.originalContact.GivenName,n=e.changeSet.updatedNames.PersonaSurnames&&e.changeSet.updatedNames.PersonaSurnames.newValue||e.originalContact&&e.originalContact.Surname,r=t||n,a=e.changeSet.updatedProfilePhoto||e.profilePhotoUrl&&e.profilePhotoUrl.uri;return r?(a?e.strings.changeContactPhotoFor:e.strings.addContactPhotoFor)({p0:t||"",p1:n||""}):a?e.strings.changeContactPhoto:e.strings.addContactPhoto}var ca=Object(j.b)(function(e,t){var n=yn.getSelectors(e);return{editorState:n.editorState,originalContact:n.originalContact,changeSet:n.changeSet,errorState:n.errorState,mostRecentPropertyUri:n.mostRecentPropertyUri,strings:Qr(t.contactEditorStrings)}},function(e,t){return{dispatch:e,onUpdateWorkDetail:function(t){return e(re({workDetail:t}))},onUpdateName:function(t,n,r){return e(I({fieldType:t,oldValue:n,newValue:r}))},onUpdatePhone:function(t){return e(H({phone:t}))},onPostalAddressEditStarted:function(t){return e(Y({postalAddress:t}))},onUpdatePostalAddress:function(t){return e(z({postalAddress:t}))},onUpdateOtherContactProp:function(t){return e(K({otherContactProp:t}))},onRemoveOtherContactDateProp:function(t){return e(q({otherContactDateProp:t}))},onUpdateIm:function(t){return e(_({im:t}))},onBlurEmail:function(t){return e($({email:t}))},onUpdateEmail:function(t){return e(Q({email:t}))},onUpdatePersonalNote:function(t){return e(te({note:t}))},onFavoriteStarClicked:function(t){return e(fe({newIsFavoriteValue:t}))},onUpdateProfilePhoto:function(t){return e(ge({dataUri:t}))},onResetErrorState:function(){return e(be())}}},function(e,t,n){var r=Object(m.a)({},n,{},e,{},t);return Object(m.a)({},r,{onSaveButtonClick:function(){return function(e,t){if("saving"!==t.editorState){var n=tn(t.changeSet);n?e(oe({message:t.strings.saveErrorDialogTitleError,propertyUri:n})):(e(ae()),function(e,t){ea.apply(this,arguments)}(e,t))}}(t.dispatch,r)},onCancelButtonClick:function(){return function(e,t){e(ie()),ta(e,t,!1)}(t.dispatch,r)},onNotSaveButtonInDialogClick:function(){return function(e,t){e(ce()),ta(e,t,!0)}(t.dispatch,r)},onCancelButtonInDialogClick:function(){return function(e,t){"loadErrorDialogOpen"===t.editorState&&ta(e,t,!0),e(le())}(t.dispatch,r)},onRetryLoadInDialogClick:function(){return function(e,t){e(se()),t.onRetryLoad()}(t.dispatch,r)},onExternalCancel:function(){return function(e,t){e(ue()),ta(e,t,!1)}(t.dispatch,r)}})})(Object(S.a)(ra)),sa=function(e){function t(){var e,n;Object(c.a)(this,t);for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];return(n=Object(l.a)(this,(e=Object(d.a)(t)).call.apply(e,[this].concat(a)))).getOriginalContact=Object(p.a)(o.a.mark(function e(){var t,r,a,c;return o.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=Object(b.b)(Object(i.a)(n)).reduxStore||Object(h.throwError)("redux store not found"),r=t.dispatch,a=void 0,c=void 0,e.prev=4,e.next=7,n.props.getOriginalContact();case 7:a=e.sent,e.next=13;break;case 10:e.prev=10,e.t0=e.catch(4),c=e.t0;case 13:e.t1=n.props.editorMode,e.next="AddContact"===e.t1?16:"NewContact"===e.t1?19:"EditContact"===e.t1?21:23;break;case 16:return a&&r(R({originalContact:a})),r(B({originalContact:null})),e.abrupt("break",24);case 19:return r(B({originalContact:null})),e.abrupt("break",24);case 21:return c?r(M({error:na(c)})):a?a.PersonaId&&a.PersonaId.Id?r(B({originalContact:a,focusPropertyUri:n.props.focusPropertyUri})):r(M({error:"GetOriginalContactReturnedEmptyPersona"})):r(M({error:"GetOriginalContactReturnedNull"})),e.abrupt("break",24);case 23:return e.abrupt("return",Object(f.g)(n.props.editorMode));case 24:case"end":return e.stop()}},e,null,[[4,10]])})),n}return Object(u.a)(t,e),Object(s.a)(t,[{key:"componentWillMount",value:function(){this.props.isOpen&&this.startEditing()}},{key:"componentWillReceiveProps",value:function(e){!this.props.isOpen&&e.isOpen&&this.startEditing()}},{key:"render",value:function(){var e=this.props.isOpen?k.createElement(ca,Object(r.a)({},this.props,{onRetryLoad:this.getOriginalContact})):null;return k.createElement(C.a,{isBlocking:!0,isOpen:this.props.isOpen,className:"lpc_nested_popup",titleAriaId:"lpc-contact-editor-title"},e)}},{key:"startEditing",value:function(){var e=Object(b.b)(this).reduxStore||Object(h.throwError)("redux store not found");"NewContact"===this.props.editorMode?e.dispatch(T({focusPropertyUri:this.props.focusPropertyUri||null,initialValues:this.props.initialValues||[]})):(e.dispatch(U({focusPropertyUri:this.props.focusPropertyUri||null})),this.getOriginalContact())}}]),t}(k.Component);sa.contextTypes=Object(m.a)({},y.b);var la=n(1074);n.d(t,"IContactEditor",function(){}),n.d(t,"ImageURISource",function(){}),n.d(t,"ContactEditor",function(){return sa}),n.d(t,"ContactEditorMode",function(){return ye.ContactEditorMode}),n.d(t,"ContactEditorProps",function(){}),n.d(t,"SaveChangeResponse",function(){return ye.SaveChangeResponse}),n.d(t,"SaveChangesFunction",function(){return ye.SaveChangesFunction}),n.d(t,"ContactEditorStore",function(){return yn}),n.d(t,"ContactEditorStrings",function(){return la.ContactEditorStrings}),n.d(t,"MonthNames",function(){return la.MonthNames}),n.d(t,"InitialValue",function(){return ye.InitialValue}),n.d(t,"UpdatedValues",function(){return ye.UpdatedValues})},827:function(e,t,n){"use strict";n.d(t,"a",function(){return l});var r=n(5),a=n(807),o=n(506),i=n(649),c=n(4),s=Object(o.b)(function(e){return Object(r.a)({},e,{disableGlobalClassNames:!0})}),l=Object(a.a)(function(e){return c.createElement(i.a,{settings:{theme:s(e.theme)}},e.children)})},856:function(e,t,n){"use strict";function r(e,t){var n=[];if(!t.global)throw new Error("regular expression must have the global flag set");var r=null;do{(r=t.exec(e))&&n.push(r)}while(r&&r[0]);return n}n.d(t,"a",function(){return r})},890:function(e,t,n){"use strict";var r=n(807),a=n(1161),o=n(4),i=n(827),c=n(108),s=n(31),l=n(506),d=Object(l.b)(function(e){var t=document.documentElement&&document.documentElement.getAttribute("dir"),n=e.palette;return Object(s.X)({root:{position:"absolute",width:"36px",height:"36px",transform:t===c.a.RightToLeft?"translate(50%, 100%)":"translate(-50%, 100%)",zIndex:1,boxSizing:"border-box",top:"-4px",padding:0,color:n.white,backgroundColor:n.neutralSecondary,borderRadius:"50%",border:"2px solid ".concat(n.white),backgroundClip:"padding-box"},icon:{color:n.white},rootHovered:{width:"40px",height:"40px",top:"-10px",backgroundColor:n.neutralPrimaryAlt}})});n.d(t,"a",function(){return u});var u=Object(r.a)(function(e){var t=e.children,n=e.onClick,r=e.title,c=e.theme,s=d(c);return o.createElement(i.a,null,o.createElement(a.a,{iconProps:{iconName:"Camera"},onClick:n,"data-log-name":"PhotoPickerButton",ariaLabel:r,title:r,styles:s}),t)})}}]);