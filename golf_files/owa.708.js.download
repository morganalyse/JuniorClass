self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.708.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[708],{14698:function(e,t,n){"use strict";n.r(t);var r=n(0),o=n(1173),i=n(839),c=n(735),a=n(860),u=n(63),s=n(727);function d(e,t){return Object(r.__awaiter)(this,void 0,void 0,function(){var n,o;return Object(r.__generator)(this,function(r){return 1===(n=t.tableQuery).listViewType?(o={Id:e,mailboxInfo:Object(i.c)(n)},[2,Object(a.i)(o,"LoadNudgedItem")]):[2,l(e,t)]})})}function l(e,t){return Object(r.__awaiter)(this,void 0,void 0,function(){var n,d;return Object(r.__generator)(this,function(r){return n=t.tableQuery,d=Object(i.c)(n),[2,c.E.importAndExecute(Object(s.i)(n),e,Object(o.g)(n),n.requestShapeName,d.requestOptions).then(function(t){if("Success"==t.ResponseClass){var n=t.Conversations;if(n&&n.length>0&&n[0].ConversationId.Id===e){var r={Id:e,mailboxInfo:d};return Object(a.h)(r,"LoadNudgedConversation"),n[0]}}return null}).catch(function(e){return u.d.warn("loadNudgedConversation throws an exception"+e.message),null})]})})}var f=n(246),b=n(463),v="https://outlook.office.com/FocusedInboxB2";function h(){return Object(r.__awaiter)(this,void 0,void 0,function(){var e,t;return Object(r.__generator)(this,function(n){switch(n.label){case 0:return[4,w()];case 1:return e=n.sent(),t=new Headers,e&&(t.authorization="Bearer "+e),[2,t]}})})}function w(){return Object(r.__awaiter)(this,void 0,void 0,function(){return Object(r.__generator)(this,function(e){return Object(f.a)()?[2,null]:[2,Object(b.getAccessTokenforResource)(v)]})})}var O=n(113),g="FocusedInboxB2/api/v1/Nudges/GetNudges";function j(e){return Object(r.__awaiter)(this,void 0,void 0,function(){var t,n;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return[4,h()];case 1:return t=r.sent(),[4,Object(O.b)(g,e,!0,t)];case 2:n=r.sent(),r.label=3;case 3:return r.trys.push([3,5,,6]),[4,n.json()];case 4:return[2,r.sent()];case 5:return r.sent(),[2,null];case 6:return[2]}})})}var m=n(3),p=n(736);function I(e){switch(e){case"Received":return 0;case"Sent":return 1;default:return u.d.warn("No nudge reason returned in GetNudge server response"),0}}var _=n(67),y=n(1647),T=n(1340),A=n(5656);function k(e){if(!Object(_.f)("tri-nudge")||Object(A.a)(16))return!1;if(e!==Object(p.a)("inbox")&&e!==Object(p.a)("sentitems"))return!1;var t=Object(s.B)();if("All"!=Object(s.I)(t))return!1;var n=Object(s.l)(t);if(0!=n&&-1!=n)return!1;var r=Object(s.p)(t.id);if(0!=r&&1!=r)return!1;var o=Object(y.a)(e),i={sortColumn:1,sortDirection:T.DESCENDING_SORT_DIR};return o.sortColumn==i.sortColumn&&o.sortDirection==i.sortDirection}var C=n(1496),N=n(2881),R=n(1159);function x(e,t){var n=t.rowKeys.indexOf(e);if(n>=0&&!s.b.getIsPinned(e,t)){var r=Object(N.a)(s.b.getLastDeliveryOrRenewTimeStamp(e,t),s.b.getLastDeliveryTimeStamp(e,t),t,n+1,!0);-1==r?Object(C.a)([e],t):R.a.updateRowPosition(--r,e,t)}}var S=n(153),D=n(51),E=n(734),K=n(2105),V=n(978),F=n(1510),U=n(753);var P=!1,M=Object(D.e)(K.a,"clone_onSelectFolderComplete",function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var t,n,o,i,c,a,u,d,l,f;return Object(r.__generator)(this,function(b){switch(b.label){case 0:return P||!k(e.selectedFolderId)?[2]:(t=Object(s.B)()).tableQuery.folderId!=e.selectedFolderId?[2]:(P=!0,[4,j(n=Object(E.a)())]);case 1:if(o=b.sent(),i=[],!o||!o.Nudges)return[3,5];c=o.Nudges,a=0,b.label=2;case 2:return a<c.length?[4,L(c[a],t)]:[3,5];case 3:(u=b.sent())&&(i.push(u),Object(S.m)("TnS_GetNudge",[n,u.itemId])),b.label=4;case 4:return a++,[3,2];case 5:return d=Object(m.a)("testOldNudge"),0!=decodeURIComponent(d||"").trim().length&&(i.push({rowKey:"testNudgeRowKey",itemId:"getTestNudgeRowDataForRowNotLoadedInTableViewItemId=",conversationId:"getTestNudgeRowDataForRowNotLoadedInTableViewConversationId=",tableViewId:t.id,reason:0,daysAgo:7}),l={ConversationId:{__type:"ItemId:#Exchange",Id:"getTestNudgeRowDataForRowNotLoadedInTableViewConversationId="},ConversationTopic:"This is a test Nudge Email that is older than the loaded rows",UniqueSenders:["Sayali Shah"],LastDeliveryTime:"2019-10-01T15:30:58-07:00",HasAttachments:!1,MessageCount:1,GlobalMessageCount:1,UnreadCount:1,GlobalUnreadCount:1,Size:1234,ItemClasses:["IPM.Note"],Importance:null,ItemIds:[{__type:"ItemId:#Exchange",ChangeKey:"CQAAAA==",Id:"getTestNudgeRowDataForRowNotLoadedInTableViewItemId="}],GlobalItemIds:[{__type:"ItemId:#Exchange",ChangeKey:"CQAAAA==",Id:"getTestNudgeRowDataForRowNotLoadedInTableViewItemId="}],LastModifiedTime:"2019-10-29T15:30:59-07:00",InstanceKey:"testNudgeRowKey",Preview:"Test nudge email for row that is not loaded",HasIrm:!1,IsLocked:!1,FamilyId:{__type:"ItemId:#Exchange",Id:"AAQkAGZjM2NmMGY1LTkzMzgtNGNhMy04ODg5LWQwMjJjMDc0YjJlMAAQAH9+ZbR0rbRFncY81mWHT1E="},LastDeliveryOrRenewTime:"2019-10-01T15:30:58-07:00",HasAttachmentPreviews:!1,LastSender:{Mailbox:{Name:"Sayali Shah",EmailAddress:"sayalis@microsoft.com",RoutingType:"SMTP"}}},t.rowKeys.indexOf("testNudgeRowKey")<0&&(f=Object(V.f)(t,0),R.a.addRow(f,l,t))),i.push.apply(i,Object(r.__spread)(function(e){var t=Object(m.a)("testNudge");if(0==decodeURIComponent(t||"").trim().length)return[];var n=[];if(e.rowKeys.length>0){var r=e.tableQuery.folderId===Object(p.a)("sentitems")?1:0,o={rowKey:e.rowKeys[0],itemId:s.b.getItemIds(e.rowKeys[0],e)[0],conversationId:s.b.getConversationId(e.rowKeys[0],e),tableViewId:e.id,reason:r,daysAgo:5};if(n.push(o),e.rowKeys.length>3){var i={rowKey:e.rowKeys[3],itemId:s.b.getItemIds(e.rowKeys[3],e)[0],conversationId:s.b.getConversationId(e.rowKeys[3],e),tableViewId:e.id,reason:r,daysAgo:0};n.push(i)}if(e.rowKeys.length>10&&1===Math.floor(2*Math.random())){var c={rowKey:e.rowKeys[10],itemId:s.b.getItemIds(e.rowKeys[10],e)[0],conversationId:s.b.getConversationId(e.rowKeys[10],e),tableViewId:e.id,reason:r,daysAgo:3};n.push(c)}}return n}(t))),Object(F.d)().nudgedRows.forEach(function(e){Object(F.i)(e.rowKey,e.tableViewId)||i.some(function(t){return t.rowKey===e.rowKey&&t.tableViewId===e.tableViewId})||x(e.rowKey,t)}),Object(F.g)(i,t),P=!1,[2]}})})});function L(e,t){return Object(r.__awaiter)(this,void 0,void 0,function(){var n,o,c,l,f,b,v,h,w;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return r.trys.push([0,4,,5]),e.FolderId.Id!=t.tableQuery.folderId?[2,null]:(n=e.ItemId.Id,o=e.ConversationId.Id,c=0===t.tableQuery.listViewType?o:n,l=void 0,0!==(f=Object(s.A)([c],t)).length?[3,2]:[4,d(c,t)]);case 1:return(b=r.sent())?(l=b.InstanceKey,v=Object(_.f)("tri-spotlight")&&0===e.NudgeReason.EmailAgeInDays,t.rowKeys.indexOf(l)<0&&!v&&(h=Object(V.f)(t,0),R.a.addRow(h,b,t)),[3,3]):(u.d.warn("Unable to load nudged row for list view type:"+t.tableQuery.listViewType),[2,null]);case 2:l=f[0],function(e,t){if(1===e.listViewType){var n=Object(U.b)().items.get(t);n&&n.NormalizedBody||Object(a.i)({Id:t,mailboxInfo:Object(i.c)(e)},"LoadNudgedItem")}else Object(U.b)().conversations.get(t)||Object(a.h)({Id:t,mailboxInfo:Object(i.c)(e)},"LoadNudgedConversation")}(t.tableQuery,c),r.label=3;case 3:return[2,{rowKey:l,itemId:n,conversationId:o,tableViewId:t.id,reason:I(e.NudgeReason.Reason),daysAgo:e.NudgeReason.EmailAgeInDays}];case 4:return w=r.sent(),u.d.warn("processNudgeResponse throws an exception"+w.message),[2,null];case 5:return[2]}})})}var G=n(122),z="FocusedInboxB2/api/v1/Nudges/UpdateNudge";function B(e,t){return Object(r.__awaiter)(this,void 0,void 0,function(){var n,o,i;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return[4,h()];case 1:return n=r.sent(),o={ItemId:{Id:e},NudgeAction:t},[4,Object(O.d)(z,o,Object(E.a)(),!1,n)];case 2:i=r.sent();try{Object(G.a)(i.status)||u.d.warn("updateNudgesOperation return http status "+i.status)}catch(e){return u.d.info("updateNudgesOperation return error "+e.message),[2,null]}return[2]}})})}var Q=n(1420),q=n(2719),W=n(2720),H=n(5005),J=n(5351),Y=n(6189),Z=Object(D.e)(Y.b,"clone_onNudgeInfoBarClicked",function(e){var t=e.response===Y.a.MarkComplete?"MarkedComplete":"Dismissed";ce(e.rowKey,e.itemId,t,"ReadingPane")}),$=Object(D.e)(J.a,"clone_onDismissNudgeClicked",function(e){Object(F.d)().nudgedRows.filter(function(t){return t.rowKey===e.rowKey&&t.tableViewId===e.tableViewId}).forEach(function(t){ce(e.rowKey,t.itemId,"Dismissed","ListView")})}),X=Object(D.e)(Q.a,"clone_deleteItemsStoreUpdate",function(e){e.itemContexts.map(function(e){return e.itemId}).forEach(function(e){var t=Object(F.b)(e);t&&Object(F.h)(t)})}),ee=Object(D.e)(C.a,"clone_removeRowsFromListViewStore",function(e){oe(e.rowKeys,e.tableView.id)}),te=Object(D.e)(W.a,"clone_markItemsAsPinnedStoreUpdate",function(e){ie(e.rowKeys,e.tableViewId,e.shouldMarkAsPinned),e.shouldMarkAsPinned&&oe(e.rowKeys,e.tableViewId)}),ne=Object(D.e)(q.a,"clone_markConversationsAsPinnedStoreUpdate",function(e){ie(e.rowKeys,e.tableViewId,e.shouldMarkAsPinned),e.shouldMarkAsPinned&&oe(e.rowKeys,e.tableViewId)}),re=Object(D.e)(H.a,"clone_onSendMessageSucceeded",function(e){if(1===e.operation||2===e.operation||3===e.operation){var t=Object(F.b)(e.referenceItemId.Id);t&&(Object(F.h)(t),x(t,Object(s.B)()))}});function oe(e,t){e.forEach(function(e){Object(F.e)(e,t)&&Object(F.h)(e)})}function ie(e,t,n){e.forEach(function(e){Object(F.d)().nudgedRows.filter(function(n){return n.rowKey===e&&n.tableViewId===t}).forEach(function(e){var t=n?"Pinned":"Unpinned";B(e.itemId,t),Object(S.m)("TnS_UpdateNudge",[t,e.itemId])})})}function ce(e,t,n,r){B(t,n),Object(F.h)(e),x(e,Object(s.B)()),Object(S.m)("TnS_UpdateNudge",[n,t,r])}var ae=n(4);function ue(e,t){if(!Object(F.i)(e,t.id)&&!s.b.getIsPinned(e,t)){var n=Object(V.f)(t,0);R.a.updateRowPosition(n,e,t)}}Object(ae.orchestrator)(F.g,function(e){e.nudgedRows.forEach(function(t){return ue(t.rowKey,e.tableView)})}),Object(ae.orchestrator)(V.i,function(e){var t=Object(F.d)().nudgedRows,n=e.tableView;t.filter(function(e){return e.tableViewId==n.id}).forEach(function(t){return ue(t.rowKey,e.tableView)})}),n.d(t,"getNudgesOrchestrator",function(){return M}),n.d(t,"removeNudgeOnInfoBarClickedOrchestrator",function(){return Z}),n.d(t,"removeNudgeOnDismissNudgeClickedOrchestrator",function(){return $}),n.d(t,"removeNudgeOnItemDeleteStoreUpdateOrchestrator",function(){return X}),n.d(t,"removeNudgeOnRowsDeleteStoreUpdateOrchestrator",function(){return ee}),n.d(t,"removeNudgeOnItemsPinnedStoreUpdateOrchestrator",function(){return te}),n.d(t,"removeNudgeOnConversationsPinnedStoreUpdateOrchestrator",function(){return ne}),n.d(t,"removeNudgeOnReplyOrReplyAllOrForwardOrchestrator",function(){return re})},154:function(e,t,n){"use strict";var r=n(0),o=n(163),i=n(138),c=n(180),a=n(298),u=n.n(a),s=n(46),d=n(334),l=n.n(d),f=n(50),b=500,v="OWA_GetAccessTokenForResource";function h(e){return Object(r.__awaiter)(this,void 0,void 0,function(){var t;return Object(r.__generator)(this,function(n){return t={isUserActivity:!1},[2,l()(u()({Resource:e}),t)]})})}function w(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,function(){return Object(r.__generator)(this,function(r){return t<1?(Object(f.g)(v,[e,t,n.toString()]),[2,Promise.reject()]):[2,h(e).catch(function(n){return Object(s.a)(b).then(function(){return w(e,t-1,n)})})]})})}var O,g=n(67),j=n(249),m=3,p=500;function I(e){var t=this,n=null,o=null,i=new Promise(function(e,i){return Object(r.__awaiter)(t,void 0,void 0,function(){return Object(r.__generator)(this,function(t){return n=e,o=i,[2]})})}),c={onFulfilled:n,onRejected:o,resource:e};return(null==O&&(O=new j.a(m,_,p)),O).add(c),i}function _(e){return Object(r.__awaiter)(this,void 0,void 0,function(){return Object(r.__generator)(this,function(t){return S(e.resource).then(function(t){e.onFulfilled(t)}).catch(function(t){e.onRejected(t)}),[2]})})}var y=n(166);n.d(t,"e",function(){return N}),n.d(t,"b",function(){return R}),n.d(t,"c",function(){return x}),n.d(t,"a",function(){return S}),n.d(t,"d",function(){return D});var T=1,A=12e4,k=3,C=null;function N(e){C=e}function R(e){return Object(r.__awaiter)(this,void 0,void 0,function(){var t;return Object(r.__generator)(this,function(n){switch(n.label){case 0:return null!=(t=D(E(),e))?[3,2]:[4,S(e)];case 1:t=n.sent(),n.label=2;case 2:return[2,null!=t?t.AccessToken:void 0]}})})}function x(e){var t=D(E(),e);if(t)return[t.AccessToken,void 0];if(Object(g.f)("auth-getAccessTokenQueueEnabled")){var n=Object(y.a)(e),r=void 0;return n?r=n:(r=I(e),Object(y.b)(e,r)),[void 0,r.then(function(t){return Object(y.c)(e),t.AccessToken})]}return[void 0,S(e).then(function(e){return e.AccessToken})]}function S(e){return Object(r.__awaiter)(this,void 0,void 0,function(){var t,n,o;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return Object(g.f)("auth-getAccessTokenQueueEnabled")?[4,w(e,k)]:[3,2];case 1:return n=r.sent(),[3,4];case 2:return[4,h(e)];case 3:n=r.sent(),r.label=4;case 4:return null!=(t=n)&&0==t.TokenResultCode&&null!=t.AccessTokenExpiry&&(t.ExpiresIn&&t.ExpiresIn>0&&(t.AccessTokenExpiry=Object(c.a)(Date.now(),t.ExpiresIn).toISOString()),(o=new Date(t.AccessTokenExpiry).getTime()-Date.now()-A)>0&&E().put(e,t,o,function(e,t){S(e).catch(function(){})})),[2,t]}})})}function D(e,t){var n=e.get(t),r=void 0;n&&n.AccessTokenExpiry&&(Object(i.a)(new Date(n.AccessTokenExpiry),-T)>new Date(Date.now())&&(r=n));return r}function E(){return null==C&&(C=new o.Cache),C}},163:function(e,t,n){"use strict";function r(){var e=Object.create(null),t=0,n=0,r=0,o=!1;function i(t){r--,delete e[t]}this.put=function(t,n,o,c){if(void 0!==o&&("number"!=typeof o||isNaN(o)||o<=0))throw new Error("Cache timeout must be a positive number");if(void 0!==c&&"function"!=typeof c)throw new Error("Cache timeout callback must be a function");var a=e[t];a?clearTimeout(a.timeout):r++;var u={value:n,expire:o+Date.now()};return isNaN(u.expire)||(u.timeout=setTimeout(function(){i(t),c&&c(t,n)}.bind(this),o)),e[t]=u,n},this.del=function(t){var n=!0,r=e[t];return r?(clearTimeout(r.timeout),!isNaN(r.expire)&&r.expire<Date.now()&&(n=!1)):n=!1,n&&i(t),n},this.clear=function(){for(var i in e)clearTimeout(e[i].timeout);r=0,e=Object.create(null),o&&(t=0,n=0)},this.get=function(i){var c=e[i];if(void 0!==c){if(isNaN(c.expire)||c.expire>=Date.now())return o&&t++,c.value;o&&n++,r--,delete e[i]}else o&&n++;return null},this.size=function(){return r},this.memsize=function(){var t,n=0;for(t in e)n++;return n},this.debug=function(e){o=e},this.hits=function(){return t},this.misses=function(){return n},this.keys=function(){return Object.keys(e)},this.exportJson=function(){var t={};for(var n in e){var r=e[n];t[n]={value:r.value,expire:r.expire||"NaN"}}return JSON.stringify(t)},this.importJson=function(t,n){var r=JSON.parse(t),o=Date.now(),i=n&&n.skipDuplicates;for(var c in r)if(r.hasOwnProperty(c)){if(i)if(e[c])continue;var a=r[c],u=a.expire-o;if(u<=0){this.del(c);continue}u=u>0?u:void 0,this.put(c,a.value,u)}return this.size()}}e.exports=new r,e.exports.Cache=r},166:function(e,t,n){"use strict";n.d(t,"a",function(){return c}),n.d(t,"c",function(){return a}),n.d(t,"b",function(){return u});var r=n(163),o=null;function i(){return null==o&&(o=new r.Cache),o}function c(e){return i().get(e)}function a(e){return i().del(e)}function u(e,t){i().put(e,t)}},298:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(0);t.default=function(e){return r.__assign({__type:"TokenRequest:#Exchange"},e)}},334:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(131),o=n(298);t.default=function(e,t){return void 0===e||e.__type||(e=o.default(e)),r.makeServiceRequest("GetAccessTokenforResource",e,t)}},463:function(e,t,n){"use strict";n.r(t);var r=n(163),o=n(154);function i(e){Object(o.e)(new r.Cache),Object(o.b)(e.location.origin)}var c=n(0),a=n(40),u=n(183),s=n.n(u),d=n(180),l=n(50),f="OWA_GetDelegationAccessToken",b={};function v(e){return Object(c.__awaiter)(this,void 0,void 0,function(){var t,n,r,o;return Object(c.__generator)(this,function(i){switch(i.label){case 0:t=e.client_id+e.scope,n=encodeURIComponent(t),r={},i.label=1;case 1:return i.trys.push([1,3,4,5]),[4,h(e,window)];case 2:return r=i.sent(),[3,5];case 3:return o=i.sent(),r.TokenResultCode=2,Object(l.g)(f+" Token fetch failure ",[o.toString(),e]),[3,5];case 4:return function(e,t){var n=t.document.getElementById(e);null!=n&&(n.removeEventListener("load",b[e]),t.document.body.removeChild(n),delete b[e])}(n,window),[7];case 5:return[2,r]}})})}function h(e,t){return Object(c.__awaiter)(this,void 0,void 0,function(){var n,r,o;return Object(c.__generator)(this,function(i){return n=encodeURIComponent(e.client_id+e.scope),r=function(e){var t={response_type:"token",prompt:"none",redirect_uri:e.redirect_uri,scope:e.scope,client_id:e.client_id};return e.authorization_uri+"?"+a.stringify(t)}(e),t.document.getElementById(n)?[2,{TokenResultCode:2}]:((o=t.document.createElement("iframe")).src=r.toString(),o.style.display="none",o.id=n,t.document.body.appendChild(o),[2,new Promise(function(r,i){b[n]=function(n){var c={};try{o.contentWindow&&o.contentWindow.location.host==t.location.host&&(c=function(e){var t=a.parse(e),n={};t.access_token?(n.AccessToken=t.access_token,n.AccessTokenExpiry=Object(d.a)(Date.now(),parseInt(t.expires_in)).toISOString(),n.TokenResultCode=0):"login_required"==t.error||"interaction_required"==t.error||"consent_required"==t.error?(n.TokenResultCode=3,Object(l.g)(f+" MSA Failure ",[t.error,e])):(n.TokenResultCode=2,Object(l.g)(f+" MSA Failure ",[t.error,e]));return n}(o.contentWindow.location.hash.substring(1)))}catch(t){Object(l.g)(f+" Hash param parsing failure ",[t.toString(),e]),c.TokenResultCode=2,i(c)}r(c)},o.addEventListener("load",b[n],!1)})])})})}var w,O=n(67),g=n(166),j=n(249),m=3,p=500;function I(e){var t=this,n=null,r=null,o=new Promise(function(e,o){return Object(c.__awaiter)(t,void 0,void 0,function(){return Object(c.__generator)(this,function(t){return n=e,r=o,[2]})})}),i={onFulfilled:n,onRejected:r,options:e};return(null==w&&(w=new j.a(m,_,p)),w).add(i),o}function _(e){return Object(c.__awaiter)(this,void 0,void 0,function(){return Object(c.__generator)(this,function(t){return v(e.options).then(function(t){e.onFulfilled(t)}).catch(function(t){e.onRejected(t)}),[2]})})}var y=null,T="OWA_GetDelegationAccessToken";function A(e){return Object(c.__awaiter)(this,void 0,void 0,function(){var t,n,r,o,i;return Object(c.__generator)(this,function(c){switch(c.label){case 0:t={scope:e,client_id:"",authorization_uri:"",redirect_uri:""},n=void 0,c.label=1;case 1:return c.trys.push([1,5,,6]),[4,s()()];case 2:return 0!=(r=c.sent()).ResultCode||null==r.ImplicitGrantAuthorizationUrl||""==r.ImplicitGrantAuthorizationUrl?(Object(l.g)(T+" ImplicitGrantAuthorizationUrl is empty or null "),[2,n]):(o=a.parse(r.ImplicitGrantAuthorizationUrl.split("?")[1]||"")).client_id&&o.redirect_uri?(t.client_id=o.client_id,t.authorization_uri=r.ImplicitGrantAuthorizationUrl.split("?")[0],t.redirect_uri=o.redirect_uri,[4,k(t)]):[3,4];case 3:n=c.sent(),c.label=4;case 4:return[2,n];case 5:return i=c.sent(),Object(l.g)(T+" GetAuthenticationUrl Operation failed ",[i.toString()]),[2,n];case 6:return[2]}})})}function k(e){return Object(c.__awaiter)(this,void 0,void 0,function(){var t,n,r,i;return Object(c.__generator)(this,function(c){switch(c.label){case 0:return t=e.client_id+e.scope,(n=Object(o.d)(N(),t))&&n.AccessToken?[2,n.AccessToken]:[3,1];case 1:return Object(O.f)("auth-getDelegationTokenQueueEnabled")?(r=Object(g.a)(t),i=void 0,r?i=r:(i=I(e),Object(g.b)(t,i)),[2,i.then(function(e){return C(t,e),Object(g.c)(t),e.AccessToken})]):[3,2];case 2:return[4,v(e)];case 3:return n=c.sent(),C(t,n),[2,0==n.TokenResultCode?n.AccessToken:void 0]}})})}function C(e,t){if(t&&0==t.TokenResultCode&&t.AccessTokenExpiry){var n=new Date(t.AccessTokenExpiry).getTime()-Date.now();n>0&&N().put(e,t,n)}}function N(){return null==y&&(y=new r.Cache),y}var R=n(121),x=n(340);var S=!1;function D(e){S||(!function(e){var t=Object(x.a)("/owa",e);Object(R.initializeServiceRequest)({baseUrl:t})}(e),S=!0)}function E(e,t,n,r){n?e.acquireTokenPopup(t,null,n,r):e.acquireToken(t,r)}var K=n(51),V=new K.c(function(){return Promise.all([n.e(563),n.e(109)]).then(n.bind(null,14939))}),F=new K.a(V,function(e){return e.createAdalAuthenticationContext});var U=function(e,t,n,r){return function(o,i){o||!i?r(o,null):(e.getCachedUser(),E(e,t,n,r))}},P="adalIdTokenFrame";function M(e,t,n,r){e.config.displayCall=function(o){!function(e){if(-1==e.indexOf("?"))throw new Error("Invalid Url in Adal Auth Context Display Call")}(o),window.detectUserCachedCallback=U(e,t,n,r),function(e,t){e._addAdalFrame(P).src="about:blank",e._loadFrame(t+"&prompt=none",P)}(e,o)},e.login()}function L(e,t,n,r,o){return Object(c.__awaiter)(this,void 0,void 0,function(){var i;return Object(c.__generator)(this,function(c){switch(c.label){case 0:return"https://login.microsoftonline.com/",[4,F.importAndExecute("https://login.microsoftonline.com/",e,t)];case 1:return i=c.sent(),i.getCachedUser()?E(i,n,r,o):M(i,n,r,o),[2]}})})}n.d(t,"registerTokenProvider",function(){return i}),n.d(t,"getAccessTokenforResource",function(){return o.b}),n.d(t,"getAccessTokenforResourceAsLazy",function(){return o.c}),n.d(t,"getDelegationToken",function(){return k}),n.d(t,"getDelegationTokenForOwa",function(){return A}),n.d(t,"bootstrap",function(){return D}),n.d(t,"getAccessTokenOnBehalfOfResource",function(){return L})},5656:function(e,t,n){"use strict";n.d(t,"a",function(){return i}),n.d(t,"b",function(){return c});var r=n(79),o=n(70);function i(e){return!!(e&Object(r.f)().ViewStateConfiguration.FocusedInboxBitFlags)}var c=Object(o.action)("setBit")(function(e,t){i(t)!==e&&(e?Object(r.f)().ViewStateConfiguration.FocusedInboxBitFlags|=t:Object(r.f)().ViewStateConfiguration.FocusedInboxBitFlags&=~t)})}},0,[3,4,9,13,421,0,1,2,576,189,6,377,23,575,185,17,359,10,622,442,5,353,7,8,12,130,11,43,126,36,68,356,563,109,604,368,341,351,374,538,745]]);
//# sourceMappingURL=owa.708.js.map
self.scriptsLoaded['owa.708.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.708.js'] = (new Date()).getTime();