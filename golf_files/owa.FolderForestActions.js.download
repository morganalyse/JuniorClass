self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.FolderForestActions.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[254],{11143:function(e){e.exports={c:"PBb",a:"QBb",b:"RBb"}},14700:function(e,r,t){"use strict";t.r(r);var o=t(0),a=t(3146),n=t(2135),c=t(3145),i=t(1771),s=t(2576),d=t(2134),l=t(2577),u=t(153),b=t(763),f=t(729),v=t(1352),F=t(863),O=t(3054),j=t(2979);function h(e){return!0===j.a.prefetchedFolderIds.get(e)}var p=t(67),m=t(50),y=t(2182),g=t(727),I=t(736),P=t(7),w=Object(m.c)("selectPersona",i.a.selectPersona)(function(e){var r;if(Object(y.a)("üèÉ‚Äç SelectPersonaToPersonaHeaderRender"),e!==Object(F.c)().id){var t=Object(p.f)("tri-favorites-roaming"),o=void 0;if(t){var a=Object(b.getStore)().outlookFavorites.get(e);o=a?Object(b.convertFavoritePersonaDataToFavoritePersonaNode)(a):void 0}else o=Object(b.getStore)().favoritesPersonaNodes.get(e);if(!o)return Object(d.a)("ResetInbox"),Promise.resolve();var n=!1;Object(v.isFavoritingInProgress)(o.personaId)||Object(v.isFavoritingInProgress)(o.mainEmailAddress)||f.p.folderTable.has(o.searchFolderId)||(n=!0,o.searchFolderId=void 0,o.isSearchFolderPopulated=!1);var c=!o.isSearchFolderPopulated,i=o.searchFolderId&&h(o.searchFolderId),j=Object(u.o)();if(j&&j.addCustomData({isSearchFallback:c,searchFolderNotFound:n,isPrefetchedFuf:!!i}),r=Object(l.a)(o,"FavoritesPersonaNode"),t||v.lazyOnFavoritePersonaSelected.importAndExecute(o.id),o.searchFolderId&&(Object(O.b)(o.searchFolderId),Object(g.L)(Object(I.a)("inbox")))){var m=f.p.folderTable.get(o.searchFolderId).TotalCount;Object(u.m)("TnS_PauseSelectPersona",[m-f.p.folderTable.get(o.searchFolderId).pausedTotalCount,Object(P.m)(g.O.inboxPausedDateTime),g.O.inboxPausedLength?g.O.inboxPausedLength:-1],{isCore:!0}),f.p.folderTable.get(o.searchFolderId).pausedTotalCount=m}}return Object(s.a)(),r}),T=Object(m.c)("selectPrivateDistributionList",i.a.selectPrivateDistributionList)(function(e){var r;if(e!=Object(F.c)().id){var t=Object(b.getStore)().outlookFavorites.get(e);if(!t)return Object(d.a)("ResetInbox"),Promise.resolve();var o=Object(b.convertFavoritePdlDataToFavoritePdlNode)(t),a=!1;Object(v.isFavoritingInProgress)(o.data.favoriteId)||f.p.folderTable.has(o.data.searchFolderId)||(a=!0,o.data.searchFolderId=void 0,o.data.isSearchFolderPopulated=!1);var n=!o.data.isSearchFolderPopulated,c=o.data.searchFolderId&&h(o.data.searchFolderId),i=Object(u.o)();i&&i.addCustomData({isSearchFallback:n,searchFolderNotFound:a,isPrefetchedFuf:!!c}),r=Object(l.a)(o,"FavoritesPrivateDistributionList"),o.data.searchFolderId&&Object(O.b)(o.data.searchFolderId)}return Object(s.a)(),r}),_=t(4),S=Object(_.action)("SELECT_PREVIOUS_NODE_INTERNAL",function(e){return{actionSource:e}}),k=t(1038),E=(Object(_.orchestrator)(S,function(e){return Object(o.__awaiter)(void 0,void 0,void 0,function(){var r,t,i,s;return Object(o.__generator)(this,function(o){switch(r=e.actionSource,t=k.v,i=t.previousNode,(s=i||Object(F.c)()).type){case 1:w(s.id);break;case 5:T(s.id);break;case 0:case 6:Object(n.a)(s.id,s.treeType,r,s.type);break;case 4:Object(a.a)(s.id);break;case 2:Object(c.a)(s.id,s.treeType);break;default:throw new Error("exitSearchOrchestrator: Unknown node type")}return[2]})})}),t(11143)),N=t(5),x=t(770),U=t(860),M=t(193),D=t(2575),q=t.n(D),C=t(746),R=t.n(C),L=t(2574),z=t.n(L);var A=t(1264),V=t(70),B=t(857),H=Object(V.action)("deleteFolder")(function(e,r,t,a){return Object(o.__awaiter)(this,void 0,void 0,function(){var n,c;return Object(o.__generator)(this,function(o){switch(o.label){case 0:return n=e.folderTable.get(r),A.b(),Object(f.db)(e,n),c=Object(f.t)(n.FolderId.Id),Object(B.raiseAction)(U.e.DeleteFolderAction)(c),t?Object(f.q)(e,c):Object(f.Z)(e,n,a),[4,(i=r,s=t,q()({Header:Object(M.getJsonRequestHeader)(),Body:z()({DeleteType:s?"SoftDelete":"MoveToDeletedItems",FolderIds:[R()({Id:i})]})}).then(function(e){return e.Body.ResponseMessages.Items[0]}))];case 1:return o.sent(),[2]}var i,s})})}),Q=t(4943),J=t(2243),K=Object(V.action)("deleteFolderInFolderForest")(Object(V.select)({favoritesFolderNodesV1:function(){return b.favoritesStore.favoritesFolderNodes},favoritesFolderNodesV2:function(){return b.favoritesStore.outlookFavorites},folders:function(){return f.p}})(function(e,r,t,a,c){var i=this,s=c.favoritesFolderNodesV1,d=c.favoritesFolderNodesV2,l=c.folders,u=Object(f.t)(e),b=l.folderTable.get(e),O=a?Object(N.a)(E.c):Object(N.a)(E.a);Object(x.b)(Object(N.a)(E.b),Object(N.b)(O,b.DisplayName)).then(function(c){return Object(o.__awaiter)(i,void 0,void 0,function(){return Object(o.__generator)(this,function(i){return c===x.a.ok?(u.forEach(function(e){!function(e,r,t,a){Object(o.__awaiter)(this,void 0,void 0,function(){return Object(o.__generator)(this,function(o){switch(o.label){case 0:return Object(p.f)("tri-favorites-roaming")?t.has(e)?[4,v.lazyRemoveFavoriteFolder.import()]:[3,2]:[3,3];case 1:o.sent()(e,a),o.label=2;case 2:return[3,5];case 3:return r.has(e)?[4,v.lazyRemoveFavoriteFolder.import()]:[3,5];case 4:o.sent()(e,a),o.label=5;case 5:return[2]}})})}(e,s,d,r),e==Object(F.b)()&&Object(n.a)(Object(I.a)("inbox"),"primaryFolderTree","ResetInbox")}),Object(f.M)(e,f.l)?[2,J.c.importAndExecute(t,e,f.j,!0)]:[2,H(l,e,a,t)]):[2]})})}),Q.c.importAndExecute(e)}));var $=t(1600),G=Object(V.action)("toggleFavoriteFolder")(function(e,r){return Object(o.__awaiter)(this,void 0,void 0,function(){var t,a;return Object(o.__generator)(this,function(o){switch(o.label){case 0:return t=Object($.f)(e),a=t||e.FolderId.Id,Object(b.isFolderInFavorites)(a)?(a==Object(F.b)()&&Object(n.a)(Object(I.a)("inbox"),"primaryFolderTree","ResetInbox"),[4,v.lazyRemoveFavoriteFolder.import()]):[3,2];case 1:return o.sent()(a,r),[3,4];case 2:return[4,v.lazyAddFavoriteFolder.import()];case 3:o.sent()(a,r),o.label=4;case 4:return[2]}})})}),Z=t(1251),W=Object(V.action)("selectFolderNode")(function(e,r){var t=e||Object(F.c)();switch(t.type){case 1:Z.f.importAndExecute(t.id);break;case 5:Z.h.importAndExecute(t.id);break;case 0:Object(Z.o)(t.id,t.treeType,r);break;case 4:Object(Z.m)(t.id);break;case 2:Object(Z.q)(t.id,t.treeType);break;default:throw new Error("selectFolderNode: Unknown node type")}}),X=t(3839),Y=t(3838),ee=t(41),re=t(63),te=Object(V.action)("initializeFrequentlyUsedFolders")(function(){var e=Object(ee.a)().UserOptions,r=!1,t=Object(j.b)();t.isInitialized||(e.FrequentlyUsedFolders&&e.FrequentlyUsedFolders.forEach(function(e){try{var o=JSON.parse(e);t.frequentlyUsedFolders.push(o)}catch(e){re.d.warn("Unable to parse frequently used folders"),r=!0}}),t.isInitialized=!0,r&&Object(Y.a)())}),oe=t(1173),ae=t(1950),ne=t(905),ce=t(1334),ie=t(3003),se=t(221),de=t.n(se),le=t(2245),ue=t(1647),be=t(978),fe=t(3142),ve=t(214);function Fe(e){if("UserCategory"!=e.filterType)throw new Error("getQueryTypeForFilteredFolder should only be called for 'UserCategory' viewfilter type");var r=Object(ve.h)(e.filterValue,Object(ve.l)());return r?Object(oe.b)(r):null}var Oe=Object(V.action)("prefetchFrequentlyUsedFolders")(function(){te(),setTimeout(je,1e4)});function je(){var e=Object(j.b)(),r=Math.min(5,e.frequentlyUsedFolders.length),t=[];de()(function(){for(var a=0;a<r;a++){var n=e.frequentlyUsedFolders[a].FolderId,c=null;if(me(n)){var i=pe(n);if(!i||"UserCategory"!=i.filterType)continue;c=Fe(i)}else c=Object(oe.c)(n,Object(g.w)(n),he(n),-1,null,null,Object(ue.a)(n));if(c){var s=Object(ce.c)(c),d=Object(ne.a)();if(d&&d.id!=s.id&&Object(le.a)()&&-1==Object(le.b)(s)){var l=Object(ae.a)(s,!0,ie.a);t.push(l),Object(X.a)(n)}}}!function(e){var r=Object(j.b)();Object(u.m)("prefetchFrequentlyUsedFolders_count",{total:e,personaTotal:r.frequentlyUsedFolders.slice(0,e).filter(function(e){return Object(b.isFolderPersonaFavoriteSearchFolder)(e.FolderId)}).length,allPrefetched:r.prefetchedFolderIds.size,personaPrefetched:Object(o.__spread)(r.prefetchedFolderIds.keys()).filter(function(e){return Object(b.isFolderPersonaFavoriteSearchFolder)(e)}).length})}(r),Promise.all(t).then(function(){!function(){var e,r,t=0,a=0,n=0,c=0,i=0,s=0,d=Object(I.a)("inbox"),l=g.O.tableViews.values();try{for(var b=Object(o.__values)(l),f=b.next();!f.done;f=b.next()){var v=f.value,F=v.tableQuery,O=F.folderId;if(0!=F.type)return;s++,Object(be.l)(F)&&i++;for(var j=0,h=0;h<v.rowKeys.length;h++){var p=v.rowKeys[h],m=g.b.getIsPinned(p,v);if(!m)break;j++}O===d&&"All"===F.viewFilter&&(a+=j),t+=j,j>=20?n++:j>=10&&c++}}catch(r){e={error:r}}finally{try{f&&!f.done&&(r=b.return)&&r.call(b)}finally{if(e)throw e.error}}Object(u.m)("TnS_PinnedRowsCount",{total:t,inbox:a,tfc:s,pfc:i,ftwenty:n,ften:c})}()})})}function he(e){return Object(b.isFolderPersonaFavoriteSearchFolder)(e)?"persona":Object(b.isFolderPrivateDLFavoriteSearchFolder)(e)?"privatedistributionlist":"mail"}function pe(e){var r=e.split(fe.a);return 2==r.length?{filterType:r[0],filterValue:r[1]}:null}function me(e){return["SystemCategory","Hashtag","UserCategory"].reduce(function(r,t){return r||e.slice(0,t.length)==t},!1)}t.d(r,"deleteFolderInFolderForest",function(){return K}),t.d(r,"selectPersona",function(){return w}),t.d(r,"selectPrivateDistributionList",function(){return T}),t.d(r,"toggleFavoriteFolder",function(){return G}),t.d(r,"selectFolderNode",function(){return W}),t.d(r,"selectPreviousNodeInternal",function(){return S}),t.d(r,"prefetchFrequentlyUsedFolders",function(){return Oe})},2182:function(e,r,t){"use strict";t.d(r,"a",function(){return a}),t.d(r,"b",function(){return n});var o="undefined"!=typeof window&&window.hasOwnProperty("Performance")&&Performance.prototype.getEntriesByName;function a(e){var r;r=e+" - start",o&&performance&&performance.mark&&performance.mark(r)}function n(e){if(o){try{performance&&performance.measure&&performance.measure(e,e+" - start")}catch(e){return}var r=performance&&performance.getEntriesByName(e);return performance&&performance.clearMarks&&performance.clearMarks(e+" - start"),r&&r.length>0?r.slice(-1)[0]:void 0}}},3729:function(e,r,t){"use strict";t.d(r,"b",function(){return a});var o=t(4),a=Object(o.createStore)("mruFolderCache",{mruFolders:[],isInitialized:!1}),n=a();r.a=n},4682:function(e,r,t){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var o=t(131);r.default=function(e){return o.makeServiceRequest("GetFolderMruConfiguration",{},e)}},4943:function(e,r,t){"use strict";var o=t(51),a=t(4682),n=t.n(a);var c=t(3729),i=t(736),s=t(70),d=Object(s.action)("getMoveToMruList")(function(){n()().then(function(e){return e}).then(function(e){return function(e){if(null==e.FolderMruEntries||0==e.FolderMruEntries.length)c.a.mruFolders.push(Object(i.a)("inbox")),c.a.mruFolders.push(Object(i.a)("deleteditems")),c.a.mruFolders.push(Object(i.a)("archive"));else for(var r=0;r<e.FolderMruEntries.length;r++){var t=e.FolderMruEntries[r].EwsFolderIdEntry;c.a.mruFolders.push(t)}c.a.isInitialized=!0}(e)})});t.d(r,"b",function(){return u}),t.d(r,"c",function(){return b}),t.d(r,"a",function(){return d});var l=new o.c(function(){return t.e(364).then(t.bind(null,14853))}),u=new o.a(l,function(e){return e.addFolderIdToMoveToMruList}),b=new o.a(l,function(e){return e.removeFolderIdFromMoveToMruList})}},0,[3,4,9,13,421,600,20,15,36,334,0,1,2,576,189,6,377,23,575,185,17,359,10,622,442,5,353,7,8,12,130,11,43,126,68,356,604,368,365,237,341,351,364,374,538,745]]);
//# sourceMappingURL=owa.FolderForestActions.js.map
self.scriptsLoaded['owa.FolderForestActions.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.FolderForestActions.js'] = (new Date()).getTime();