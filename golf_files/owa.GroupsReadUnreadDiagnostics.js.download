self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.GroupsReadUnreadDiagnostics.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[285],{1178:function(e,t,n){"use strict";n.d(t,"a",function(){return r}),n.d(t,"b",function(){return c});var o=n(15),i=n(191),r={root:"ms-Check",circle:"ms-Check-circle",check:"ms-Check-check",checkHost:"ms-Check-checkHost"},c=function(e){var t,n,c,a,s,u=e.height,l=void 0===u?e.checkBoxHeight||"18px":u,d=e.checked,p=e.className,f=e.theme,h=f.palette,b=f.semanticColors,m=f.fonts,g=Object(i.a)(),v=Object(o.getGlobalClassNames)(r,f),k={fontSize:l,position:"absolute",left:0,top:0,width:l,height:l,textAlign:"center",verticalAlign:"middle"};return{root:[v.root,m.medium,{lineHeight:"1",width:l,height:l,verticalAlign:"top",position:"relative",userSelect:"none",selectors:(t={":before":{content:'""',position:"absolute",top:"1px",right:"1px",bottom:"1px",left:"1px",borderRadius:"50%",opacity:1,background:b.bodyBackground}},t["."+v.checkHost+":hover &, ."+v.checkHost+":focus &, &:hover, &:focus"]={opacity:1},t)},d&&["is-checked",{selectors:{":before":{background:h.themePrimary,opacity:1,selectors:(n={},n[o.HighContrastSelector]={background:"Window"},n)}}}],p],circle:[v.circle,k,{color:h.neutralSecondary,selectors:(c={},c[o.HighContrastSelector]={color:"WindowText"},c)},d&&{color:h.white}],check:[v.check,k,{opacity:0,color:h.neutralSecondary,fontSize:o.IconFontSizes.medium,left:g?"-0.5px":".5px",selectors:(a={":hover":{opacity:1}},a[o.HighContrastSelector]={MsHighContrastAdjust:"none"},a)},d&&{opacity:1,color:h.white,fontWeight:900,selectors:(s={},s[o.HighContrastSelector]={border:"none",color:"WindowText"},s)}],checkHost:v.checkHost}}},1217:function(e,t,n){"use strict";var o=n(696),i=n(0),r=n(1),c=n(314),a=n(158),s=n(658),u=Object(c.a)(),l=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._link=r.createRef(),t._onClick=function(e){var n=t.props,o=n.onClick;n.disabled?e.preventDefault():o&&o(e)},t}return i.__extends(t,e),t.prototype.render=function(){var e=this,t=this.props,n=t.disabled,o=t.children,c=t.className,a=t.href,l=t.theme,d=t.styles,p=t.keytipProps,f=u(d,{className:c,isButton:!a,isDisabled:n,theme:l}),h=this._getRootType(this.props);return r.createElement(s.a,{keytipProps:p,ariaDescribedBy:this.props["aria-describedby"],disabled:n},function(t){return r.createElement(h,i.__assign({},t,e._adjustPropsForRootType(h,e.props),{className:f.root,onClick:e._onClick,ref:e._link,"aria-disabled":n}),o)})},t.prototype.focus=function(){var e=this._link.current;e&&e.focus&&e.focus()},t.prototype._adjustPropsForRootType=function(e,t){t.children,t.as;var n=t.disabled,o=t.target,r=t.href,c=(t.theme,t.getStyles,t.styles,t.componentRef,i.__rest(t,["children","as","disabled","target","href","theme","getStyles","styles","componentRef"]));return"string"==typeof e?"a"===e?i.__assign({target:o,href:n?void 0:r},c):"button"===e?i.__assign({type:"button",disabled:n},c):i.__assign({},c,{disabled:n}):i.__assign({target:o,href:r,disabled:n},c)},t.prototype._getRootType=function(e){return e.as?e.as:e.href?"a":"button"},t}(a.a),d=n(15),p={root:"ms-Link"};n.d(t,"a",function(){return f});var f=Object(o.a)(l,function(e){var t,n,o,i=e.className,r=e.isButton,c=e.isDisabled,a=e.theme,s=a.semanticColors,u=s.link,l=s.linkHovered,f=s.disabledText,h=s.focusBorder,b=Object(d.getGlobalClassNames)(p,a);return{root:[b.root,a.fonts.medium,{color:u,outline:"none",fontSize:"inherit",fontWeight:"inherit",selectors:(t={".ms-Fabric--isFocusVisible &:focus":{boxShadow:"0 0 0 1px "+h+" inset",selectors:(n={},n[d.HighContrastSelector]={outline:"1px solid WindowText"},n)}},t[d.HighContrastSelector]={borderBottom:"none"},t)},r&&{background:"none",backgroundColor:"transparent",border:"none",cursor:"pointer",display:"inline",margin:0,overflow:"inherit",padding:0,textAlign:"left",textOverflow:"inherit",userSelect:"text",borderBottom:"1px solid transparent",selectors:(o={},o[d.HighContrastSelectorBlack]={color:"#FFFF00"},o[d.HighContrastSelectorWhite]={color:"#00009F"},o)},!r&&{textDecoration:"none"},c&&["is-disabled",{color:f,cursor:"default"},{selectors:{"&:link, &:visited":{pointerEvents:"none"}}}],!c&&{selectors:{"&:active, &:hover, &:active:hover":{color:l,textDecoration:"underline"},"&:focus":{color:u}}},b.root,i]}},void 0,{scope:"Link"})},13100:function(e,t,n){var o=n(13101),i=n(45);"string"==typeof o&&(o=[[e.i,o]]);for(var r=0;r<o.length;r++)i.loadStyles(o[r][1],!1);o.locals&&(e.exports=o.locals)},13101:function(e,t,n){(t=e.exports=n(44)(!1)).push([e.i,"._3n-f8Ap1Kc2GX9G5WkichB{font-weight:600;font-size:12px}html[dir=ltr] ._3n-f8Ap1Kc2GX9G5WkichB{padding:15px 0 10px 10px}html[dir=rtl] ._3n-f8Ap1Kc2GX9G5WkichB{padding:15px 10px 10px 0}html[dir=ltr] ._3FcKFiEljg6x-owcifZQA5{padding-left:15px}html[dir=rtl] ._3FcKFiEljg6x-owcifZQA5{padding-right:15px}",""]),t.locals={groupSectionHeader:"_3n-f8Ap1Kc2GX9G5WkichB",detailsList:"_3FcKFiEljg6x-owcifZQA5"}},1604:function(e,t,n){"use strict";var o=n(51),i=n(0),r=n(4),c=function(e,t,n){var o=null;return{init:function(c){var a;if(null!==o)throw new Error("Diagnostics store "+e+" was initialized multiple times");return o=Object(r.createStore)(e,t),n(o()),Object(i.__assign)(Object(i.__assign)({},c),((a={})[e]=o,a))},getIfInitialized:function(){return o?o():null}}};n.d(t,"b",function(){return s}),n.d(t,"f",function(){return u}),n.d(t,"g",function(){return l}),n.d(t,"e",function(){return d}),n.d(t,"h",function(){return p}),n.d(t,"a",function(){return f}),n.d(t,"c",function(){return h}),n.d(t,"d",function(){return c});var a=new o.c(function(){return Promise.all([n.e(0),n.e(1),n.e(2),n.e(4),n.e(210)]).then(n.bind(null,14671))}),s=Object(o.d)(a,function(e){return e.DiagnosticsPanel}),u=new o.a(a,function(e){return e.registerDiagnostics}),l=new o.b(a,function(e){return e.setSelectedPivot}),d=new o.b(a,function(e){return e.getDiagnosticsLogState}),p=new o.b(a,function(e){return e.initializeDefaultDiagnostics}),f=Object(o.d)(a,function(e){return e.DiagnosticsHost}),h=(Object(o.d)(a,function(e){return e.DiagnosticsInspector}),Object(o.d)(a,function(e){return e.TwoColumnInspector}))},2341:function(e,t,n){"use strict";var o=n(1),i=n(696),r=n(161),c=n(405),a=n(498),s=n(314),u=Object(s.a)(),l=n(1178);n.d(t,"a",function(){return d}),n.d(t,"b",function(){return p});var d=Object(i.a)(function(e){var t=e.checked,n=void 0!==t&&t,i=e.className,r=e.theme,s=e.styles,l=e.useFastIcons,d=void 0===l||l,p=u(s,{theme:r,className:i,checked:n}),f=d?c.a:a.a;return o.createElement("div",{className:p.root},o.createElement(f,{iconName:"CircleRing",className:p.circle}),o.createElement(f,{iconName:"StatusCircleCheckmark",className:p.check}))},l.b,void 0,{scope:"Check"},!0),p=Object(r.b)(function(e,t,n){return o.createElement(d,{theme:e,checked:t,className:n,useFastIcons:!0})})},9727:function(e,t,n){"use strict";n.r(t);var o=n(4),i=Object(o.action)("addDiagnosticsData",function(e,t,n){return{groupId:e,actionType:t,customData:n}}),r=n(20),c=Object(o.createStore)("groupsReadUnreadDiagnosticsStore",{diagnosticsMap:new r.ObservableMap})(),a=(Object(o.mutator)(i,function(e){var t=e.groupId,n=e.actionType,o=e.customData,i={group:t,actionType:n,timestamp:new Date(Date.now()).toLocaleTimeString(),customData:o};if(c.diagnosticsMap.has(t)){var r=c.diagnosticsMap.get(t);r.push(i),r.length>20&&r.splice(0,1)}else c.diagnosticsMap.set(t,[i])}),n(0)),s=Object(o.action)("addMarkAsReadDiagnostics",function(e,t,n,o,i){return{tableQuery:e,isActingOnAllItemsInTable:t,isReadValueToSet:n,actionSource:o,itemsToUpdate:i}}),u=Object(o.action)("addUnreadCountNotificationDiagnostics",function(e,t){return{groupId:e,notification:t}}),l=Object(o.action)("addUnreadCountSubscriptionDiagnostics",function(e,t,n){return{groupId:e,subscription:t,isUnsubscribe:n}}),d=n(22),p=n(1),f=n.n(p),h=n(4190),b=n(1407),m=n(2169),g=n(13100),v=[{key:"timestamp",minWidth:80,name:"Time",fieldName:"timestamp",isResizable:!0},{key:"actionType",minWidth:150,name:"Action",fieldName:"actionType",isResizable:!0},{key:"customData",minWidth:650,name:"Details",fieldName:"customData",isResizable:!0}],k=function(e,t,n){return p.createElement("span",null,e[n.key])},y=Object(d.a)(function(){if(0==c.diagnosticsMap.size)return null;var e=Object(a.__spread)(c.diagnosticsMap.keys()).sort(function(e,t){return e.localeCompare(t)}),t=[];return e.forEach(function(e){t.push(p.createElement("div",{className:g.groupSectionHeader},e)),t.push(p.createElement(h.a,{className:g.detailsList,items:c.diagnosticsMap.get(e),columns:v,layoutMode:b.e.fixedColumns,selectionMode:m.c.none,constrainMode:b.d.unconstrained,onRenderItemColumn:k}))}),p.createElement("div",{className:"allowTextSelection"},t)}),_=n(1604),w=!1,j={name:"Groups read/unread",datapoints:[],type:"Custom"},x=function(){return f.a.createElement(y)};function C(){return Object(a.__awaiter)(this,void 0,void 0,function(){return Object(a.__generator)(this,function(e){switch(e.label){case 0:return w?[3,2]:(w=!0,[4,_.e.import().then(function(e){_.f.importAndExecute(j,e(),x)})]);case 1:e.sent(),e.label=2;case 2:return[2]}})})}var O=n(858),S=n(727);Object(o.orchestrator)(s,function(e){return Object(a.__awaiter)(void 0,void 0,void 0,function(){var t,n,o,r,c,s,u;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return t=e.tableQuery,n=e.isActingOnAllItemsInTable,o=e.isReadValueToSet,r=e.actionSource,c=e.itemsToUpdate,Object(O.e)(t)?(s=function(e,t){return e?t?"MarkAllAsRead":"MarkAllAsUnread":t?"MarkAsRead":"MarkAsUnread"}(n,o),u="ListViewType: "+Object(S.x)(t.listViewType)+", ActionSource: "+r,c&&(u+=", Count: "+c.length),[4,C()]):[3,2];case 1:a.sent(),i(t.folderId,s,u),a.label=2;case 2:return[2]}})})}),Object(o.orchestrator)(u,function(e){return Object(a.__awaiter)(void 0,void 0,void 0,function(){var t,n,o,r;return Object(a.__generator)(this,function(c){switch(c.label){case 0:return t=e.groupId,n=e.notification,o=n.EventType?n.EventType:"Unknown",r="UnreadCount: "+n.UnreadCount+", EventType: "+o+", NotificationId: "+n.NotificationId+", BrokerSubscriptionId: "+n.BrokerSubscriptionId,[4,C()];case 1:return c.sent(),i(t,"UnreadCountNotification",r),[2]}})})}),Object(o.orchestrator)(l,function(e){return Object(a.__awaiter)(void 0,void 0,void 0,function(){var t,n,o,r,c;return Object(a.__generator)(this,function(a){switch(a.label){case 0:return t=e.groupId,n=e.subscription,o=e.isUnsubscribe,r=o?"Unsubscribe":"Subscribe",c="ChannelId: "+n.subscriptionParameters.ChannelId,[4,C()];case 1:return a.sent(),i(t,r,c),[2]}})})}),n.d(t,"addMarkAsReadDiagnostics",function(){return s}),n.d(t,"addUnreadCountNotificationDiagnostics",function(){return u}),n.d(t,"addUnreadCountSubscriptionDiagnostics",function(){return l})}},0,[0,1,2,576,189,4,210]]);
//# sourceMappingURL=owa.GroupsReadUnreadDiagnostics.js.map
self.scriptsLoaded['owa.GroupsReadUnreadDiagnostics.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.GroupsReadUnreadDiagnostics.js'] = (new Date()).getTime();