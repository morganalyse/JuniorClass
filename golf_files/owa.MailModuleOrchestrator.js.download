self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailModuleOrchestrator.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[349],{1035:function(e,n,t){"use strict";t.d(n,"c",function(){return o}),t.d(n,"a",function(){return a}),t.d(n,"b",function(){return i});var r=t(41),a="HTML",i="Text",c="Html";function o(){return Object(r.a)().UserOptions.ComposeMarkup==c?"HTML":"Text"}},1079:function(e,n,t){"use strict";t.d(n,"a",function(){return o});var r=t(0),a=t(814),i=t(809),c=t(63);function o(){var e,n,t=Object(i.a)();try{for(var o=Object(r.__values)(t.tabs),u=o.next();!u.done;u=o.next()){var s=u.value;if(s.isActive&&s.type!=a.a.FloatingChat)return s}}catch(n){e={error:n}}finally{try{u&&!u.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}return c.d.error("There is no active tab. Something went very wrong."),null}},1143:function(e,n,t){"use strict";var r=t(1154);t(804),t(52),t(827);t(821),t(852);t.d(n,"a",function(){return r.a})},1154:function(e,n,t){"use strict";t.d(n,"a",function(){return a});var r=t(804);function a(){return(location?location.pathname:"").split("/").indexOf(r.c)>=0}},1166:function(e,n,t){"use strict";var r=t(814),a=t(1500),i=t(1079),c=t(1933),o=t(2025),u=t(50),s=t(1222);n.a=Object(u.c)("activateTab",a.a.TabViewActivateTab)(function(e,n){switch(Object(c.a)(e,!0),e.type){case r.a.FloatingChat:return void Object(o.a)(e);case r.a.Primary:case r.a.OverflowMenu:case r.a.SecondaryReadingPane:case r.a.Compose:if(!e.isActive){var t,a=Object(i.a)();if(a)a.isActive=!1,(t=Object(s.a)(a.type))&&t.onDeactivate&&t.onDeactivate(a);if(e)e.isActive=!0,e.blink=!1,(t=Object(s.a)(e.type))&&t.onActivate&&t.onActivate(e)}return}})},1211:function(e,n,t){"use strict";t.d(n,"a",function(){return u});var r=t(0),a=t(960),i=t(809),c=t(885),o=t(162);function u(e,n,t){var u,l;void 0===n&&(n=0);var b=function(e){switch(e){case 0:return s;case 1:return f;case 2:return d;default:return Object(o.a)(e)}}(n),v=Object(c.b)();try{for(var O=Object(r.__values)(Object(i.a)().tabs),m=O.next();!m.done;m=O.next()){var p=m.value;if(p.type==a.a.Compose&&!p.isShown){var w=v.viewStates.get(p.data);if(w&&w.isInlineCompose&&b(w,e)&&(0==w.asyncSendState||t&&6==w.asyncSendState))return w}}}catch(e){u={error:e}}finally{try{m&&!m.done&&(l=O.return)&&l.call(O)}finally{if(u)throw u.error}}return null}function s(e,n){return e.conversationId===n}function f(e,n){return e.referenceItemId.Id===n}function d(e,n){return!1}},1222:function(e,n,t){"use strict";t.d(n,"b",function(){return i}),t.d(n,"a",function(){return c});var r=t(814),a={};function i(e,n){a[r.a[e]]=n}function c(e){return a[r.a[e]]}},1245:function(e,n,t){"use strict";t.d(n,"b",function(){return a}),t.d(n,"a",function(){return i});var r=t(2024);function a(e){return e.isDirty||e.toRecipientWell&&e.toRecipientWell.isDirty||e.ccRecipientWell&&e.ccRecipientWell.isDirty||e.bccRecipientWell&&e.bccRecipientWell.isDirty}function i(e){return Object(r.a)(e.toRecipientWell)+Object(r.a)(e.ccRecipientWell)+Object(r.a)(e.bccRecipientWell)}},1325:function(e,n,t){"use strict";var r=t(4),a=Object(r.actionCreator)("ADD_CHAT_TAB",function(e){return{chatConversationId:e}});n.a=a},1358:function(e,n,t){"use strict";t.d(n,"a",function(){return a});var r=t(0);function a(e){var n,t,a=[];if(e&&e.recipients)try{for(var i=Object(r.__values)(e.recipients),c=i.next();!c.done;c=i.next()){var o=c.value,u=o.persona.EmailAddress;u&&u.ItemId&&"PrivateDL"==u.MailboxType?a.push({Name:u.Name,RoutingType:u.RoutingType,MailboxType:u.MailboxType,ItemId:{Id:u.ItemId.Id,ChangeKey:null},EmailAddressIndex:u.EmailAddressIndex,RelevanceScore:u.RelevanceScore||0}):a.push(o.persona.EmailAddress)}}catch(e){n={error:e}}finally{try{c&&!c.done&&(t=i.return)&&t.call(i)}finally{if(n)throw n.error}}return a}},1453:function(e,n,t){"use strict";var r=t(743),a=t.n(r),i=t(70);function c(e){e&&(e.isDirty=!1)}n.a=Object(i.action)("updateComposeItemId")(function(e,n,t,r){e&&(e.itemId?e.itemId.ChangeKey=t:e.itemId=a()({Id:n,ChangeKey:t}),r&&(e.lastSaveTimeStamp=r,e.isDirty=!1,c(e.toRecipientWell),c(e.ccRecipientWell),c(e.bccRecipientWell)))})},1454:function(e,n,t){"use strict";t.d(n,"a",function(){return i});var r=t(0),a=t(1804);function i(e){return Object(r.__awaiter)(this,void 0,void 0,function(){var n;return Object(r.__generator)(this,function(t){switch(t.label){case 0:return[4,a.c.import()];case 1:return n=t.sent(),e&&n(e.referenceItemId&&e.referenceItemId.Id),[2]}})})}},14731:function(e,n,t){"use strict";t.r(n);var r=t(4),a=Object(r.action)("closeImmersiveReadingPane",function(e){return{source:e}}),i=t(1060),c=t(1061),o=t(70),u=t(727),s=t(801),f=Object(o.action)("onReadingPanePositionOptionSaved")(function(){Object(i.a)(!0),Object(c.a)(!Object(s.b)()),u.O.rowInfoForVLV.clear()}),d=t(866),l=t(960),b=Object(o.action)("onReplyOrReplyAllOrForwardMessage")(function(){var e=Object(l.c)();!Object(s.b)()||e&&e.type!=l.a.Primary||(Object(d.z)(!0),Object(d.y)(!1))}),v=t(991),O=t(885),m=t(1143),p=Object(o.action)("mailModuleOrchestrator.onSelectingFolder")(function(){null===O.a.primaryComposeId||Object(m.a)()?Object(s.b)()&&a():v.x.importAndExecute(null)}),w=Object(o.action)("onSelectMessageAd")(function(){Object(d.z)(!0),Object(d.y)(!Object(s.b)())}),j=t(1396),y=t(884);function g(e){if(Object(s.b)())switch(e){case y.c.MailList:a();break;case y.c.ReadingPane:case y.c.ConversationAttachmentWell:}Object(j.a)()}y.G.eventManager.on(y.f.CloseEvent,g);var h=t(2676),C=(Object(r.orchestrator)(h.b,function(e){Object(d.y)(!0),Object(d.z)(!Object(s.b)())}),t(0)),S=t(2568),A=t(905),I=t(1800),_=t(2381),T=t(1243),R=t(153);Object(r.orchestrator)(a,function(e){if(!Object(s.b)())throw new Error("closeImmersiveReadingPane should only be called with reading pane off");var n=Object(A.a)(),t=Object(_.b)(n.tableQuery);if("messageSuggestion"!==t){if("mail"===t){var r=e.source||"Unknown";Object(R.m)("Search_ReadingPaneClosed",[r])}var a=Object(T.a)();if(Object(d.y)(!0),Object(d.z)(!1),a&&1==n.selectedRowKeys.size){var i=Object(C.__spread)(n.selectedRowKeys.keys())[0];I.i.importAndExecute(i,n)}}else Object(S.a)("CommandBar")});var P=t(51),M=Object(P.e)(d.w,"CLONE_CLIENT_READING_PANE_POSITION_CHANGE",function(e){return Object(C.__awaiter)(void 0,void 0,void 0,function(){var e,n,t,r;return Object(C.__generator)(this,function(a){return e=Object(A.a)(),n=Object(s.b)(),t=!n||Object(T.a)()&&1==e.selectedRowKeys.size,r=!n||!t,Object(d.z)(t),Object(d.y)(r),u.O.rowInfoForVLV.clear(),[2]})})});t.d(n,"closeImmersiveReadingPane",function(){return a}),t.d(n,"onReadingPanePositionOptionSaved",function(){return f}),t.d(n,"onReplyOrReplyAllOrForwardMessage",function(){return b}),t.d(n,"onSelectingFolder",function(){return p}),t.d(n,"onSelectMessageAd",function(){return w}),t.d(n,"onSxSPreviewPaneClose",function(){return g}),t.d(n,"onClientReadingPanePositionChangeOrchestrator",function(){return M})},1499:function(e,n,t){"use strict";t.d(n,"a",function(){return a});var r=t(4),a=Object(r.action)("messageBeingSent")},1500:function(e,n,t){"use strict";n.a={TabViewAddTab:{name:"TabViewAddTab",customData:function(e,n,t,r){return[e,n,t]}},TabViewCloseTab:{name:"TabViewCloseTab",customData:function(e,n){return[e.type,e.isShown,e.isActive,n,e.startTime?(new Date).getTime()-e.startTime:0]}},TabViewActivateTab:{name:"TabViewActivateTab",customData:function(e,n){return[e.type,n]},options:{isVerbose:!0}}}},1501:function(e,n,t){"use strict";var r=t(4),a=Object(r.createStore)("MRUAttachmentStore",{attachments:[]});n.a=a},1502:function(e,n,t){"use strict";var r=t(4);n.a=Object(r.action)("onInlineComposeSendStateChange",function(e,n){return{viewState:e,isSendPending:n}})},1800:function(e,n,t){"use strict";t.d(n,"a",function(){return i}),t.d(n,"k",function(){return c}),t.d(n,"l",function(){return o}),t.d(n,"d",function(){return u}),t.d(n,"c",function(){return s}),t.d(n,"g",function(){return f}),t.d(n,"e",function(){return d}),t.d(n,"b",function(){return l}),t.d(n,"j",function(){return b}),t.d(n,"i",function(){return v}),t.d(n,"h",function(){return O}),t.d(n,"f",function(){return m});var r=t(51),a=new r.c(function(){return Promise.all([t.e(36),t.e(68),t.e(356)]).then(t.bind(null,4401))}),i=new r.a(a,function(e){return e.clearAutoMarkAsReadTimer}),c=new r.a(a,function(e){return e.setAutoMarkAsReadTimer}),o=new r.a(a,function(e){return e.toggleRowReadState}),u=new r.b(a,function(e){return e.markItemsAsReadBasedOnNodeIds}),s=new r.a(a,function(e){return e.markItemAsReadFromReadingPane}),f=new r.a(a,function(e){return e.onKeyboardMarkAsRead}),d=new r.a(a,function(e){return e.markReadOnTableViewChange}),l=new r.a(a,function(e){return e.markAsReadInTable}),b=new r.a(a,function(e){return e.onSingleSelectionChanged}),v=new r.a(a,function(e){return e.onReadingPaneClosed}),O=new r.a(a,function(e){return e.onNavigateAwayViaUpDown}),m=new r.a(a,function(e){return e.onItemPartDeselected})},1804:function(e,n,t){"use strict";t.d(n,"c",function(){return c}),t.d(n,"b",function(){return o});var r=t(51),a=t(1501);t.d(n,"a",function(){return a.a});var i=new r.c(function(){return t.e(129).then(t.bind(null,3226))}),c=new r.b(i,function(e){return e.getAttachmentSuggestionsAction}),o=new r.b(i,function(e){return e.createCloudFileFromAttachmentData})},1933:function(e,n,t){"use strict";var r=t(1166),a=t(70),i=t(809);n.a=Object(a.action)("setTabIsShown")(function(e,n){if(e.isShown!=n&&(e.isShown=n,e.blink=n,e.isActive&&!n)){var t=Object(i.a)(),a=t.tabs.indexOf(e),c=t.tabs.filter(function(n){return n.id==e.parentTabId&&n.isShown})[0]||function(e,n){n<0&&(n=0);for(var t=n;t<e.length;t++)if(e[t].isShown)return e[t];for(t=n-1;t>=0;t--)if(e[t].isShown)return e[t];return null}(t.tabs,a);c&&Object(r.a)(c)}})},1988:function(e,n,t){"use strict";var r=t(0),a=t(1166),i=t(1500),c=t(1079),o=t(814),u=t(50),s=t(809),f=1;n.a=Object(u.c)("addTab",i.a.TabViewAddTab)(function(e,n,t,i){var u=Object(c.a)(),d=Object(s.a)(),l={id:o.a[e]+(f++).toString(),isShown:n,isActive:!1,startTime:(new Date).getTime(),parentTabId:u?u.id:null,blink:n,data:i},b=null;switch(e){case o.a.Primary:b=Object(r.__assign)(Object(r.__assign)({},l),{type:o.a.Primary});break;case o.a.OverflowMenu:b=Object(r.__assign)(Object(r.__assign)({},l),{type:o.a.OverflowMenu,data:i});break;case o.a.SecondaryReadingPane:b=Object(r.__assign)(Object(r.__assign)({},l),{type:o.a.SecondaryReadingPane,data:i});break;case o.a.Compose:b=Object(r.__assign)(Object(r.__assign)({},l),{type:o.a.Compose,data:i});break;case o.a.FloatingChat:b=Object(r.__assign)(Object(r.__assign)({},l),{type:o.a.FloatingChat,data:i,isChatActive:!1})}d.tabs.push(b),t&&Object(a.a)(d.tabs[d.tabs.length-1])})},2024:function(e,n,t){"use strict";function r(e){return e&&e.recipients?e.recipients.length:0}t.d(n,"a",function(){return r})},2025:function(e,n,t){"use strict";var r=t(70);n.a=Object(r.action)("toggleChatTab")(function(e){e.isChatActive=!e.isChatActive,e.isActive=e.isChatActive,e.blink=!1})},2676:function(e,n,t){"use strict";t.d(n,"d",function(){return a}),t.d(n,"c",function(){return i}),t.d(n,"b",function(){return c}),t.d(n,"a",function(){return o});var r=t(4),a=Object(r.action)("ON_COMPOSE_OPENED"),i=Object(r.action)("ON_COMPOSE_CLOSED"),c=Object(r.action)("ON_CLOSE_FULL_COMPOSE"),o=Object(r.action)("NEW_MESSAGE_V3",function(e,n,t,r,a){return{actionSource:e,groupId:n,toEmailAddressWrappers:t,subject:r,body:a}})},804:function(e,n,t){"use strict";t.d(n,"c",function(){return i}),t.d(n,"b",function(){return c}),t.d(n,"h",function(){return o}),t.d(n,"g",function(){return u}),t.d(n,"f",function(){return s}),t.d(n,"d",function(){return f}),t.d(n,"e",function(){return d}),t.d(n,"a",function(){return l});var r=t(0),a=t(900),i="deeplink",c="compose",o="reply",u="replyall",s="read",f="group",d="/"+Object(r.__spread)(["mail"],Object(a.a)().split("/").slice(1)).join("/")+i+"/",l="/"+Object(r.__spread)(["calendar"],Object(a.a)().split("/").slice(1)).join("/")+i+"/"},809:function(e,n,t){"use strict";t.d(n,"a",function(){return c}),t.d(n,"b",function(){return o});var r=t(814),a=t(4),i={tabs:[{id:"primaryTab",type:r.a.Primary,isShown:!0,isActive:!0,blink:!1}],tabBarWidth:0,isOverflowMenuShown:!1},c=Object(a.createStore)("tab",i),o=(c(),c().tabs[0])},814:function(e,n,t){"use strict";var r;t.d(n,"a",function(){return r}),function(e){e[e.Primary=0]="Primary",e[e.OverflowMenu=1]="OverflowMenu",e[e.SecondaryReadingPane=2]="SecondaryReadingPane",e[e.Compose=3]="Compose",e[e.FloatingChat=4]="FloatingChat"}(r||(r={}))},821:function(e,n,t){"use strict";var r=t(804),a=t(52),i=t(827),c=t(40);function o(e,n){if(n){var t=n.displayName?n.displayName+"<"+n.smtpAddress+">":n.smtpAddress;return e?"&"+e+"="+t:t}return""}function u(e,n){return n?"&"+e+"="+n:""}function s(e){if(!e.to||!e.to.smtpAddress)return"";var n=c.parse(Object(a.a)().search.substr(1));return n.mailtouri=function(e){if(!e.to||!e.to.smtpAddress)return"";var n="mailto:"+o(null,e.to),t="";return t+=o("cc",e.cc),t+=o("bcc",e.bcc),t+=u("subject",e.subject),(t+=u("body",e.body))?n+"?"+t.slice(1):n}(e),Object(i.a)(r.e,r.b,"?"+c.stringify(n))}t.d(n,"a",function(){return s})},827:function(e,n,t){"use strict";t.d(n,"a",function(){return a});var r=t(252);function a(e,n,t){var a={pathname:e+n,search:t};return r.format(a)}},852:function(e,n,t){"use strict";t.d(n,"a",function(){return c});var r=t(804),a=t(52),i=t(827);function c(e){return e?Object(i.a)(r.e,r.f+"/"+encodeURIComponent(e),Object(a.a)().search):""}},885:function(e,n,t){"use strict";var r=t(20),a=t(4),i={viewStates:new r.ObservableMap,primaryComposeId:null,complianceConfigurations:new r.ObservableMap,messageClassifications:new r.ObservableMap,newMessageCreationInProgress:!1},c=Object(a.createStore)("compose",i),o=c();t.d(n,"a",function(){return o}),t.d(n,"b",function(){return c})},960:function(e,n,t){"use strict";var r=t(1222),a=t(814),i=t(0),c=t(809);function o(e){var n,t,r=Object(c.a)();try{for(var o=Object(i.__values)(r.tabs),u=o.next();!u.done;u=o.next()){var s=u.value;if(s.type!==a.a.Primary&&s.data==e)return s}}catch(e){n={error:e}}finally{try{u&&!u.done&&(t=o.return)&&t.call(o)}finally{if(n)throw n.error}}return null}var u=t(1079),s=t(51),f=t(1166),d=t(1988),l=t(1325),b=t(4);Object(b.mutator)(l.a,function(e){var n,t;try{for(var r=Object(i.__values)(Object(c.a)().tabs),o=r.next();!o.done;o=r.next()){var u=o.value;if(u.type==a.a.FloatingChat&&u.data==e.chatConversationId)return void Object(f.a)(u,!0)}}catch(e){n={error:e}}finally{try{o&&!o.done&&(t=r.return)&&t.call(r)}finally{if(n)throw n.error}}Object(d.a)(a.a.FloatingChat,!0,!0,e.chatConversationId)});t(866);t.d(n,"e",function(){return O}),t.d(n,"f",function(){return m}),t.d(n,"g",function(){return p}),t.d(n,"h",function(){return w}),t.d(n,"a",function(){return a.a}),t.d(n,"b",function(){return o}),t.d(n,"c",function(){return u.a}),t.d(n,"d",function(){return c.a}),t.d(n,"i",function(){return c.b}),t.d(n,"j",function(){return r.b});var v=new s.c(function(){return Promise.all([t.e(45),t.e(63),t.e(68),t.e(473)]).then(t.bind(null,14944))}),O=new s.a(v,function(e){return e.activateTab}),m=new s.a(v,function(e){return e.addTab}),p=new s.a(v,function(e){return e.closeTab}),w=new s.a(v,function(e){return e.setTabIsShown})},991:function(e,n,t){"use strict";var r=t(1499),a=t(51),i=t(1035),c=t(1245),o=(t(1453),t(1358)),u=t(1211),s=t(885),f=t(960),d=t(63);function l(e,n,t){var r,a=Object(s.b)();if(e){switch(e.type){case f.a.SecondaryReadingPane:e.data.listViewType==t&&(r=Object(u.a)(n,t));break;case f.a.Compose:r=a.viewStates.get(e.data);break;case f.a.Primary:r=n?Object(u.a)(n,t,!0):null;break;default:r=null}return r}return d.d.error("There is no active tab. Something went very wrong."),null}var b=t(1454),v=t(4),O=Object(v.action)("onComposeAddinsInitialized",function(e,n){return{hostItemIndex:e,itemId:n}}),m=t(1502);function p(){var e=Object(f.c)(),n=Object(s.b)(),t=e?function(e,n){switch(e.type){case f.a.Primary:return n.primaryComposeId;case f.a.Compose:return e.data;default:return null}}(e,n):n.primaryComposeId,r=t?n.viewStates.get(t):null;return r&&!r.isInlineCompose?r:null}t.d(n,"u",function(){return j}),t.d(n,"m",function(){return y}),t.d(n,"h",function(){return g}),t.d(n,"k",function(){return h}),t.d(n,"o",function(){return C}),t.d(n,"r",function(){return S}),t.d(n,"y",function(){return A}),t.d(n,"x",function(){return I}),t.d(n,"p",function(){return _}),t.d(n,"s",function(){return T}),t.d(n,"w",function(){return R}),t.d(n,"t",function(){return P}),t.d(n,"q",function(){return M}),t.d(n,"j",function(){return k}),t.d(n,"n",function(){return x}),t.d(n,"l",function(){return D}),t.d(n,"v",function(){return E}),t.d(n,"i",function(){return F}),t.d(n,"d",function(){return i.c}),t.d(n,"a",function(){return i.b}),t.d(n,"g",function(){return c.b}),t.d(n,"f",function(){return o.a}),t.d(n,"c",function(){return u.a}),t.d(n,"b",function(){return l}),t.d(n,"z",function(){return b.a}),t.d(n,"B",function(){return O}),t.d(n,"C",function(){return m.a}),t.d(n,"e",function(){return p}),t.d(n,"A",function(){return r.a});var w=new a.c(function(){return Promise.all([t.e(3),t.e(4),t.e(5),t.e(6),t.e(329)]).then(t.bind(null,14161))}),j=new a.a(w,function(e){return e.replyToMessage}),y=new a.a(w,function(e){return e.forwardMessage}),g=new a.a(w,function(e){return e.closeCompose}),h=new a.a(w,function(e){return e.discardCompose}),C=new a.a(w,function(e){return e.loadDraftToCompose}),S=new a.a(w,function(e){return e.openCompose}),A=new a.a(w,function(e){return e.trySendMessage}),I=new a.a(w,function(e){return e.trySaveAndCloseCompose}),_=new a.a(w,function(e){return e.moveComposeToTab}),T=new a.a(w,function(e){return e.recreateComposeFromViewState}),R=new a.a(w,function(e){return e.tryCreateResendDraft}),P=new a.a(w,function(e){return e.replyToApprovalMessage}),M=new a.a(w,function(e){return e.onEditDraftButtonClicked}),k=(new a.b(w,function(e){return e.createComposeViewState}),new a.b(w,function(e){return e.createReply})),x=new a.b(w,function(e){return e.getToCcRecipientsForReply}),D=new a.b(w,function(e){return e.findComposePlugins}),E=new a.b(w,function(e){return e.replyToMessageAndCreateViewState}),F=(new a.b(w,function(e){return e.infoBarAddHandler}),new a.b(w,function(e){return e.infoBarRemoveHandler}),new a.b(w,function(e){return e.getNextComposeId}),new a.b(w,function(e){return e.createAttachments}));new a.b(w,function(e){return e.findComposeFromRecipientWell})}},0,[0,1,2,576,189,6,377,23,575,185,3,4,5,329,11,43,126,36,68,356,365,341,374]]);
//# sourceMappingURL=owa.MailModuleOrchestrator.js.map
self.scriptsLoaded['owa.MailModuleOrchestrator.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailModuleOrchestrator.js'] = (new Date()).getTime();