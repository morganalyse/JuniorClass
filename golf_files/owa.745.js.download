self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.745.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[745],{14732:function(e,t,r){"use strict";r.r(t);var n=r(0),a=r(727),i=r(1220),o=r(744),c=r(833),s=r(4),d=Object(s.mutatorAction)("removeSingleItemFromConversation",function(e,t){var r,i,c=o.a.tableViews.get(t),s=Object(a.A)([e.itemConversationId.Id],c);try{for(var d=Object(n.__values)(s),u=d.next();!u.done;u=d.next()){l(u.value,e,t)}}catch(e){r={error:e}}finally{try{u&&!u.done&&(i=d.return)&&i.call(d)}finally{if(r)throw r.error}}});function l(e,t,r){var n=Object(i.a)(t.itemConversationId.Id),a=Object(c.a)(e,r),o=a.itemIds.indexOf(t.itemId);o>=0&&(a.itemIds.splice(o,1),t.isRead||a.unreadCount--),(o=n.globalItemIds.indexOf(t.itemId))>=0&&(n.globalItemIds.splice(o,1),t.isRead||n.globalUnreadCount--),(o=a.draftItemIds.indexOf(t.itemId))>=0&&a.draftItemIds.splice(o,1)}var u=r(1951),f=r(930),b=r(1420),v=r(51),O=r(3056),m=Object(v.e)(b.a,"clone_deleteItemsStoreUpdate",function(e){var t,r,a=e.itemContexts[0],i=Object(u.a)(a&&a.mailboxInfo,e.parentFolderId,!0);try{for(var o=Object(n.__values)(i),c=o.next();!c.done;c=o.next()){var s=c.value;1==s.tableQuery.listViewType?I(e.itemContexts,s):0==s.tableQuery.listViewType&&y(e.itemContexts,s)}}catch(e){t={error:e}}finally{try{c&&!c.done&&(r=o.return)&&r.call(o)}finally{if(t)throw t.error}}});function I(e,t){var r=e.map(function(e){return e.itemId}),n=Object(a.A)(r,t),i=n.filter(function(e){return t.rowKeys.indexOf(e)>=0});0!=i.length&&(Object(O.a)(i,t),j(t,n))}function y(e,t){var r,i,o,s;try{for(var l=Object(n.__values)(e),u=l.next();!u.done;u=l.next()){var f=u.value,b=Object(a.A)([f.itemConversationId.Id],t);try{for(var v=(o=void 0,Object(n.__values)(b)),m=v.next();!m.done;m=v.next()){var I=m.value,y=Object(c.a)(I,t.id);y&&(1==y.itemIds.length&&y.itemIds[0]==f.itemId?(Object(O.a)([I],t),j(t,[I])):d(f,t.id))}}catch(e){o={error:e}}finally{try{m&&!m.done&&(s=v.return)&&s.call(v)}finally{if(o)throw o.error}}}}catch(e){r={error:e}}finally{try{u&&!u.done&&(i=l.return)&&i.call(l)}finally{if(r)throw r.error}}}function j(e,t){0!==e.tableQuery.type&&2!==e.tableQuery.type||f.a.add(t,e.serverFolderId,3)}var w=r(4224),p=r(6202),h=r(867),x=r(5358),S=Object(v.e)(h.f,"clone_mailListItemExpansionOrchestrator",function(e){var t=Object(o.b)().expandedConversationViewState,r=t.selectedNodeIds;r&&-1!=r.indexOf(e.nodeId)||h.q(t.expandedRowKey,e.nodeId,t.allNodeIds,e.tableViewId),Object(w.b)(e.contextMenuAnchor,x.a.All,p.a.MailListItemPart)}),V=r(1931),g=r(2881),R=r(1496),C=r(1173),T=r(978),A=r(1159),_=r(1510),F=r(1078),M=r(70);var L=Object(M.select)({tableViews:function(){return a.O.tableViews}})(function(e,t,r,n,i){var o=i.tableViews.get(t);0===o.tableQuery.type&&(f.a.add(e,o.serverFolderId,1),function(e,t){var r=e[e.length-1];if(t.selectedRowKeys.has(r)){var n=t.rowKeys.indexOf(r);n<t.rowKeys.length-1?Object(h.r)(t,t.rowKeys[n+1],!1,F.a.RowRemoval):Object(h.j)(t,F.a.Reset)}}(e,o)),Object(a.y)(e,t).forEach(function(e){i.tableViews.forEach(function(i){i.tableQuery.folderId==o.tableQuery.folderId&&Object(a.A)([e],i).forEach(function(e){(n(e,i.id,r),0===i.tableQuery.type)&&(Object(C.o)(i,2),function(e,t,r,n,a){var i,o=Object(V.a)(n,r);if(o<0)throw new Error("Row being pinned / unpinnned must exist in the list");var c=a?0:o+1;return o<(i=!a&&Object(_.e)(n,r.id)?Object(T.f)(r,c):Object(g.a)(e,t,r,c,!a))&&i--,-1==i?(Object(R.a)([n],r),!1):(A.a.updateRowPosition(i,n,r),!0)}(a.b.getLastDeliveryOrRenewTimeStamp(e,i),a.b.getLastDeliveryTimeStamp(e,i),i,e,r)||i.id!=t||f.a.add([e],o.serverFolderId,3))})})})}),U=r(2719),k=r(907),P=Object(v.e)(U.a,"clone_markConversationsAsPinnedStoreUpdate",function(e){var t=e.rowKeys,r=e.tableViewId,n=e.shouldMarkAsPinned;L(t,r,n,Q)});function Q(e,t,r){var n=Object(c.a)(e,t);if(n)if(r){var a=Object(k.d)();a&&(n.lastDeliveryOrRenewTimeStamp=a)}else n.lastDeliveryOrRenewTimeStamp=n.lastDeliveryTimeStamp}var E=r(3006),D=r(2213),K=Object(v.e)(D.a,"clone_markConversationAsReadStoreUpdate",function(e){var t=e.conversationIds,r=e.tableViewId,n=e.isReadValue,i=e.isExplicit,o=a.O.tableViews.get(r),c=Object(a.A)(t,o);Object(E.a)(c,n,o,!0),Object(a.Q)(o,n,i)?(f.a.add(c,o.serverFolderId,3),Object(R.a)(c,o)):f.a.add(c,o.serverFolderId,2)}),N=r(2720),q=r(735),B=Object(v.e)(N.a,"clone_markItemsAsPinnedStoreUpdate",function(e){var t=e.rowKeys,r=e.tableViewId,n=e.shouldMarkAsPinned;L(t,r,n,z)});function z(e,t,r){var n=Object(a.G)(e,t);if(n){var i=q.I.items.get(n.clientId.Id);if(r){var o=Object(k.d)();o&&(i.ReceivedOrRenewTime=o)}else i.ReceivedOrRenewTime=i.DateTimeReceived}}var G=r(3007),$=r(2214),H=Object(v.e)($.a,"clone_markItemsAsReadStoreUpdateOrchestrator",function(e){var t=e.itemIds,r=e.isReadValue,n=e.isExplicit,i=e.tableViewId,o=a.O.tableViews.get(i);if(o){Object(G.a)(o,t,r);var c=[],s=Object(a.Q)(o,r,n);1==o.tableQuery.listViewType?c=Object(a.A)(t,o):t.forEach(function(e){var t=q.I.items.get(e).ConversationId.Id,r=Object(a.A)([t],o);r.forEach(function(e){var t=Object(a.F)(e,i);s&&0!=t.unreadCount||r.push(e)})}),0!=c.length&&(s?(f.a.add(c,o.serverFolderId,3),Object(R.a)(c,o)):f.a.add(c,o.serverFolderId,2))}}),J=r(2794),W=r(905),X=r(1263),Y=r(1334),Z=r(2672),ee=r(1307),te=r(729),re=Object(v.e)(Z.a,"clone_onListViewTypeOptionSavedOrchestrator",function(e){return Object(n.__awaiter)(void 0,void 0,void 0,function(){var t,r,a,i,o;return Object(n.__generator)(this,function(n){if(t=e.newListViewType,r=Object(W.a)().tableQuery,a=Object(ee.a)(),i=a&&a.treeType,1===r.type||i===te.c||i===te.l)return[2];switch(o=2===r.type?Object(J.a)(r.folderId,t):Object(C.c)(r.folderId,t,r.scenarioType,r.focusedViewFilter,r.viewFilter,r.categoryName,r.sortBy,r.inboxClassificationFilter),Object(Y.d)(o),t){case 0:X.q.itemReadingPaneViewState=null;break;case 1:X.q.conversationReadingPaneViewState=null}return[2]})})});r.d(t,"deleteItemsStoreUpdateOrchestrator",function(){return m}),r.d(t,"mailListItemExpansionOrchestrators",function(){return S}),r.d(t,"markConversationsAsPinnedStoreUpdateOrchestrator",function(){return P}),r.d(t,"markConversationsAsReadStoreUpdateOrchestrator",function(){return K}),r.d(t,"markItemsAsPinnedStoreUpdateOrchestrator",function(){return B}),r.d(t,"markItemsAsReadStoreUpdateOrchestrator",function(){return H}),r.d(t,"onListViewTypeOptionSavedOrchestrator",function(){return re})},2794:function(e,t,r){"use strict";var n=r(727),a=r(735);function i(e,t){var r;switch(t){case 0:r=a.a;break;case 1:r=Object(a.p)()}return{categoryName:null,folderId:e,focusedViewFilter:-1,listViewType:t,viewFilter:"All",sortBy:n.c.getDefaultSortBy(),requestShapeName:r,type:2,shouldTryToUseSessionDataResponse:!1,scenarioType:"group",inboxClassificationFilter:0}}var o=r(41);function c(){var e=Object(o.a)().UserOptions.GlobalListViewTypeReact;return null==e?0:e}r.d(t,"a",function(){return i}),r.d(t,"b",function(){return c})},4224:function(e,t,r){"use strict";r.d(t,"b",function(){return i}),r.d(t,"a",function(){return o});var n=r(744),a=r(70),i=Object(a.action)("showMailItemContextMenu")(Object(a.select)({listViewStore:function(){return n.a}})(function(e,t,r,n){n.listViewStore.itemContextMenuState={anchor:e,menuType:t,menuSource:r}})),o=Object(a.action)("hideMailItemContextMenu")(Object(a.select)({listViewStore:function(){return n.a}})(function(e){e.listViewStore.itemContextMenuState=null}))},5358:function(e,t,r){"use strict";var n;!function(e){e[e.All=0]="All",e[e.MoveTo=1]="MoveTo",e[e.Categorize=2]="Categorize"}(n||(n={})),t.a=n},6202:function(e,t,r){"use strict";var n;!function(e){e[e.MailListItem=0]="MailListItem",e[e.MailListItemPart=1]="MailListItemPart"}(n||(n={})),t.a=n}},0,[3,4,9,13,421,0,1,2,576,189,6,377,23,575,185,17,359,10,622,442,5,353,7,8,12,130,11,43,126,36,68,356,604,368,341,351,374,538]]);
//# sourceMappingURL=owa.745.js.map
self.scriptsLoaded['owa.745.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.745.js'] = (new Date()).getTime();