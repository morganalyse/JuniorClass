self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailFunctionalBoot.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[339],{11825:function(e){e.exports={a:"IIb"}},11826:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=t(131);n.default=function(e,n){return r.makeServiceRequest("ConnectedAccountsNotification",e,n)}},14673:function(e,n,t){"use strict";t.r(n);var r=t(0),a=t(51),o=new a.c(function(){return t.e(312).then(t.bind(null,14745))}),c=new a.b(o,function(e){return e.addLandmarkKeyboardNavigation}),i=function(){return Object(r.__awaiter)(this,void 0,void 0,function(){return Object(r.__generator)(this,function(e){switch(e.label){case 0:return[4,c.import()];case 1:return e.sent()(),[2]}})})},u=t(736),s=t(2793),l=t(727);function d(e){return Object(l.L)(Object(u.a)("inbox"))}var f=t(763);function b(e){var n=Object(u.a)("inbox");return Object(l.L)(n)&&!Object(f.isPersonaInFavorites)(null,e.SenderSmtpEmailAddress)}var h=t(794),p=t(5),v=t(11825);var C=t(8551),O=t(41),g=t(34),m=t(67),j=t(153);function w(e){return Object(r.__awaiter)(this,void 0,void 0,function(){var n,t,a,o,c,i;return Object(r.__generator)(this,function(r){switch(r.label){case 0:if(n=new j.a("RegisterServiceWorker"),!(t=e.navigator&&e.navigator.serviceWorker))return[3,7];if(a=function(){var e,n=Object(g.a)().browser;Object(m.f)("fwk-prefetch-code-off")?e="Error_PrefetchDisabled":"Chrome"==n||"Edge Anaheim"==n?Object(m.f)("fwk-prefetch-code-off-chromium")&&!Object(g.k)([77])&&(e="Error_ChromeMinVersion"):"Edge"==n?Object(m.f)("auth-ServiceWorkerEdge")?Object(g.k)([17,17134])||(e="EdgeMinVersion"):e="EdgeFlightOff":"Safari"==n?Object(m.f)("auth-ServiceWorkerSafari")?Object(g.k)([11,1])||(e="SafariMinVersion"):e="SafariFlightOff":"Firefox"!=n&&(e="UnsupportedBrowser:"+n);return e}())return[3,5];c=Object(O.a)(),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,Object(C.a)(e,"mail",c.SessionSettings.UserLanguage,c.UserOptions.IsDarkModeTheme)];case 2:return r.sent(),[3,4];case 3:return i=r.sent(),o=i,[3,4];case 4:return[3,6];case 5:t.getRegistrations&&t.getRegistrations().then(function(e){for(var n=0;n<e.length;++n)e[n].unregister()}),r.label=6;case 6:return[3,8];case 7:a="SWNotAvailable",r.label=8;case 8:return n.addCustomData([a||"success"]),o?n.endWithError("ClientError",o):a?n.endWithError("ServerError"):n.end(),[2]}})})}var I=t(8610),S=t(2278),k=new a.c(function(){return t.e(262).then(t.bind(null,14734))}),E=new a.a(k,function(e){return e.loadGetStarted}),y=t(990),P=t(2498),R=new a.c(function(){return t.e(119).then(t.bind(null,14961))}),U=new a.a(R,function(e){return e.loadSenders}),A=new a.c(function(){return t.e(996).then(t.bind(null,14962))}),W=new a.a(A,function(e){return e.initializeCloudCacheMailboxService}),N=t(8793),x=t(2019),F=t(1422),_=t(193),L=t(1707),M=t.n(L),T=t(746),V=t.n(T),H=t(1706),B=t.n(H),D=t(741),q=t.n(D),G=t(1059),J=t.n(G);var z=function(e){var n=[q()({FieldURI:"UnreadCount"}),q()({FieldURI:"TotalCount"})];return e&&n.push(q()({FieldURI:"PermissionSet"})),n},K=t(729),Q=t(1262),$=t(4),Y=t(63),X=(Object($.orchestrator)(x.a,function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var n,t,a,o;return Object(r.__generator)(this,function(r){return n=e.folderId,t=Object(K.B)().get(n),a=t&&t.treeType===K.l,o=Object(Q.b)(n).requestOptions,function(e,n,t){return M()({Header:Object(_.getJsonRequestHeader)(),Body:B()({FolderShape:J()({BaseShape:"IdOnly",AdditionalProperties:z(n)}),FolderIds:[V()({Id:e})]})},t).then(function(e){return e.Body.ResponseMessages.Items[0]})}(n,a,o).then(function(e){var t=e&&e.Folders[0];t&&(Object(F.a)(t.UnreadCount,t.TotalCount,n,!1),a&&K.Y.import().then(function(e){e(n,t.PermissionSet.Permissions)}))}).catch(function(e){Y.d.warn("GetFolderDataOrchestrator: "+e)}),[2]})})}),t(1015)),Z=t.n(X),ee=t(1014),ne=t.n(ee);function te(){var e=Z()({FolderShape:J()({BaseShape:"IdOnly",AdditionalProperties:[q()({FieldURI:"TotalCount"}),q()({FieldURI:"UnreadCount"})]}),Paging:null,ParentFolderIds:[V()({Id:Object(u.a)("msgfolderroot")})],ReturnParentFolder:!0,ShapeName:null,Traversal:"Deep"});return ne()({Header:Object(_.getJsonRequestHeader)(),Body:e}).then(function(e){return e.Body.ResponseMessages.Items[0]})}var re=t(944),ae=t(1576),oe=t(2243);function ce(e){switch(e.EventType){case"Reload":case"QueryResultChanged":!function(){Object(r.__awaiter)(this,void 0,void 0,function(){var e;return Object(r.__generator)(this,function(n){switch(n.label){case 0:return[4,te()];case 1:return"Success"==(e=n.sent()).ResponseClass?e.RootFolder.Folders.forEach(function(e){Object(F.a)(e.UnreadCount,e.TotalCount,e.FolderId.Id,!1)}):Y.d.warn("UpdateFolderCountsAction failed"),[2]}})})}();break;case"RowAdded":case"RowModified":var n=e;Object(F.a)(n.unreadCount,n.itemCount,n.folderId,!1),"RowAdded"===e.EventType&&oe.e.importAndExecute(n.folderId,n.parentFolderId,n.displayName),ae.f.import().then(function(n){n(e)});break;default:return}}var ie=new a.c(function(){return t.e(294).then(t.bind(null,14963))}),ue=new a.a(ie,function(e){return e.postIRISService}),se=new a.a(ie,function(e){return e.getExperienceTypeForUser}),le=t(9711),de=t(8648),fe=t(8652),be=t(11826),he=t.n(be),pe=t(246),ve=t(1447),Ce=t(1539),Oe=t(3366),ge=t(2707),me=t(1797);function je(){le.a.import(),Object(m.f)("fwk-devTools")&&N.b.importAndExecute(),Object(I.a)(),i(),w(window),Object(m.f)("fwk-mailtoProtocolHandler")&&window&&window.navigator&&window.navigator.registerProtocolHandler&&window.navigator.registerProtocolHandler("mailto",""+Object(h.m)()+Object(h.k)()+"deeplink/compose?mailtouri=%s",Object(p.a)(v.a)),Object(s.g)(b),Object(s.f)(d),he()({isOWALogon:!0}),Object(m.f)("fwk-skypeBusinessV2")&&ve.c.import().then(function(e){return e()}),Oe.a.importAndExecute(),re.g.importAndExecute({subscriptionId:"HierarchyNotification",requiresExplicitSubscribe:!0,subscriptionParameters:{NotificationType:"HierarchyNotification"}},ce),Object(pe.a)()&&U.importAndExecute(),2===Object(O.a)().SessionSettings.WebSessionType&&W.importAndExecute(),Object(m.f)("auth-realtimeEmail")&&se.importAndExecute().then(function(e){e&&ue.importAndExecute(e.toString())}),Object(fe.b)(),0!=Object(P.i)(!1)&&de.b.import(),E.importAndExecute(),ae.i.importAndExecute(),ae.h.importAndExecute(),S.c.importAndExecute(),Object(ge.j)()&&ge.d.importAndExecute(),ge.e.importAndExecute(),Object(me.d)(window)&&me.i.importAndExecute(window),Ce.c.import().then(function(e){return e()}),Object(m.f)("rp-linkedInViewProfile")&&y.b.importAndExecute()}var we=t(839),Ie=t(1263),Se=t(735),ke=t(860);Object($.orchestrator)(s.c,function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var n,t,a,o,c,i;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return n=e.notification,0!==Object(l.B)().tableQuery.listViewType?[3,3]:(t=Object(Se.s)().conversations.get(n.conversationId),a={Id:n.conversationId,mailboxInfo:Object(we.a)()},t?[3,2]:[4,Object(ke.h)(a,"LoadLikedConversation")]);case 1:r.sent(),r.label=2;case 2:return Ee(a,n.subject),[3,6];case 3:return o=Object(Se.s)().items.get(n.itemId),c={Id:n.itemId,mailboxInfo:Object(we.a)()},o&&o.NormalizedBody?(Ee(c,n.subject),[3,6]):[3,4];case 4:return i={Id:n.itemId,mailboxInfo:Object(we.a)()},[4,Object(ke.i)(i,"LoadLikedItem")];case 5:r.sent(),Ee(i,n.subject),r.label=6;case 6:return[2]}})})});function Ee(e,n){Ie.k.importAndExecute(e,n,[],!0,null)}var ye=t(7657),Pe=t(79);Object($.orchestrator)(s.d,function(e){var n=e.notification,t=1===Object(Pe.f)().UserOptions.GlobalListViewTypeReact?n.ItemId:n.ConversationId;Object(ye.a)("inbox",t)});t.d(n,"setupMailModulePostRender",function(){return je})},2582:function(e,n,t){"use strict";t.d(n,"b",function(){return o}),t.d(n,"e",function(){return c}),t.d(n,"c",function(){return i}),t.d(n,"g",function(){return u}),t.d(n,"d",function(){return s}),t.d(n,"f",function(){return l}),t.d(n,"a",function(){return d});var r=t(51),a=new r.c(function(){return Promise.all([t.e(6),t.e(570),t.e(147)]).then(t.bind(null,4410))}),o=new r.a(a,function(e){return e.loadCLPUserLabels}),c=new r.b(a,function(e){return e.showJustificationModal}),i=new r.a(a,function(e){return e.loadItemCLPInfo}),u=new r.b(a,function(e){return e.updateItemCLPInfo}),s=new r.b(a,function(e){return e.logReadCLPLabel}),l=new r.b(a,function(e){return e.triggerCLPAutoLabeling}),d=Object(r.d)(a,function(e){return e.CLPSubjectHeaderLabel})},3366:function(e,n,t){"use strict";t.d(n,"a",function(){return o});var r=t(51),a=new r.c(function(){return t.e(505).then(t.bind(null,4942))}),o=new r.a(a,function(e){return e.loadWorkloadScenarioSettings})},4507:function(e,n,t){"use strict";t.d(n,"a",function(){return a});var r=t(1251);function a(e){e?Object(r.p)(e,"Route"):Object(r.l)("Route")}},4509:function(e,n,t){"use strict";t.d(n,"a",function(){return o});var r=t(51),a=new r.c(function(){return t.e(363).then(t.bind(null,6727))}),o=new r.a(a,function(e){return e.loadSignatureInUserOptions})},5169:function(e,n,t){"use strict";t.d(n,"a",function(){return i});var r=t(867),a=t(727),o=t(905),c=t(1078);function i(e){var n=Object(o.a)(),t=Object(a.A)([e],n)[0];n.rowKeys.includes(t)&&Object(r.r)(n,t,!0,c.a.RouteHandler)}},7657:function(e,n,t){"use strict";t.d(n,"a",function(){return o});var r=t(4507),a=t(5169);function o(e,n){Object(r.a)(e),Object(a.a)(n)}},8551:function(e,n,t){"use strict";var r=t(794);var a,o=t(54),c=t(3),i=t(63);!function(e){e[e.Normal=0]="Normal",e[e.CacheCorrupt=1]="CacheCorrupt",e[e.TooManyInstallError=2]="TooManyInstallError"}(a||(a={}));var u,s=a;!function(e){e[e.Install=0]="Install",e[e.UnInstall=1]="UnInstall"}(u||(u={}));var l,d=u;!function(e){e[e.CacheProgress=0]="CacheProgress",e[e.Error=1]="Error"}(l||(l={}));var f,b=l;!function(e){e[e.Checking=0]="Checking",e[e.Downloading=1]="Downloading",e[e.Progress=2]="Progress",e[e.Error=3]="Error",e[e.Cached=4]="Cached",e[e.NoUpdate=5]="NoUpdate",e[e.Obsolete=6]="Obsolete",e[e.UpdateReady=7]="UpdateReady",e[e.Idle=8]="Idle",e[e.UnCached=9]="UnCached",e[e.CleanupError=10]="CleanupError",e[e.CleanupSuceeded=11]="CleanupSuceeded"}(f||(f={}));var h,p=f;!function(e){e[e.CacheInstalled=0]="CacheInstalled",e[e.CacheFailed=1]="CacheFailed",e[e.CacheCleared=2]="CacheCleared"}(h||(h={}));var v=h,C=t(153),O="SWCache";function g(e,n,t,r,a,o,c){var i={};i.ev=n,i.cv=t,i.e=r,i.rc=e.resourcesCached,i.ccs=e.cacheCleanupStatus,i.ncc=e.numberOfCachesCleaned,i.r=a,i.st=o,i.stk=c,i.ch=e.cacheHealth,i.app=e.appName,e.resourcesCached=0,e.cacheCleanupStatus=0,e.numberOfCachesCleaned=0,Object(C.m)(O,i)}var m=t(11);function j(e,n){return e+"_"+n}var w="SWCacheErrorCount";function I(e,n,t){var r=j(n.appName,w);0==t?Object(m.c)(e,r):Object(m.d)(e,r,""+t)}function S(e,n){var t=parseInt(Object(m.a)(e,j(n.appName,w)));return isNaN(t)?0:t}var k="CacheVersion",E="AttemptedCacheVersion";function y(e,n,t,r){switch(t){case v.CacheInstalled:Object(m.d)(e,j(n.appName,k),r),I(e,n,0);break;case v.CacheFailed:Object(m.d)(e,j(n.appName,E),r),I(e,n,S(e,n)+1);break;case v.CacheCleared:Object(m.d)(e,j(n.appName,k),null),Object(m.d)(e,j(n.appName,E),null),I(e,n,0)}}function P(e,n,t){if(null!=t.cacheMessage&&(t.targetClient==n.appName||"global"==t.targetClient)){var r=t.cacheMessage;switch(r.cacheEvent){case p.Checking:i.d.info("[SW Client] Checking");break;case p.Downloading:i.d.info("[SW Client] Downloading");break;case p.Progress:!function(e,n){i.d.info("[SW Client] Progress"),e.resourcesCached++}(n);break;case p.Error:!function(e,n,t){i.d.warn("[SW Client] Error: "+t.error),y(e,n,v.CacheFailed,t.cacheVersion),g(n,"ER",t.cacheVersion,t.error,t.resource,t.status,t.stack)}(e,n,r);break;case p.Cached:!function(e,n,t){i.d.info("[SW Client] Cached"),y(e,n,v.CacheInstalled,t.cacheVersion),g(n,"C",t.cacheVersion)}(e,n,r);break;case p.NoUpdate:!function(e,n,t){i.d.info("[SW Client] NoUpdate"),y(e,n,v.CacheInstalled,t.cacheVersion),g(n,"NU",t.cacheVersion)}(e,n,r);break;case p.Obsolete:!function(e,n,t){i.d.info("[SW Client] Obsolete"),y(e,n,v.CacheCleared,null),g(n,"OB"),n.cacheHealth>s.Normal&&(n.cacheHealth=s.Normal,N())}(e,n);break;case p.UpdateReady:!function(e,n,t){i.d.info("[SW Client] UpdateReady"),y(e,n,v.CacheInstalled,t.cacheVersion),g(n,"UR",t.cacheVersion)}(e,n,r);break;case p.Idle:i.d.info("[SW Client] Idle");break;case p.UnCached:i.d.info("[SW Client] Uncached");break;case p.CleanupError:!function(e,n){i.d.warn("[SW Client] Cleanup Error"),e.cacheCleanupStatus=1}(n);break;case p.CleanupSuceeded:!function(e,n){var t=null!=n.cachesCleaned?n.cachesCleaned.join(","):null;i.d.info("[SW Client] Cleanup Suceeded, "+t),e.cacheCleanupStatus=2,e.numberOfCachesCleaned=null!=n.cachesCleaned?n.cachesCleaned.length:0}(n,r)}}}var R=t(67),U=15,A=null,W=null;function N(){var e=(null!=A.serviceWorkerPath?A.serviceWorkerPath+"/"+A.appName+"cache.manifest":"/"+A.appName+"cache.manifest")+"?manifestVersion=2",n=d.Install;A.cacheHealth>s.Normal&&(n=d.UnInstall);var t={source:A.appName,action:n,bootResourcesOnly:!0,language:A.userLanguage,darkMode:void 0!==A.darkMode&&A.darkMode,manifestUrl:e,proxyFetchAlways:Object(R.f)("fwk-sw-proxyFetchAlways")};A.serviceWorkerRegistration.active.postMessage(t)}function x(e){if(null!=e.data){var n=e.data;n.messageType==b.CacheProgress?P(W,A,n):n.messageType==b.Error&&function(e){null!=e.error&&i.d.error({message:"[SW Client] ServiceWorker Unhandled Exception",error:e.error})}(n)}}var F=t(34),_="sw.js",L="activated",M=null,T=null,V=null,H=null,B=null,D=null,q=!1;function G(e,n,t,a){T=(V=e).navigator.serviceWorker;var i,u,s,l=Object(o.a)(V.location);i=l,u=V.location,s=i,null!=i&&(s=Object(r.q)("/"+i,u.pathname)),B=n,D=t,q=a;var d,f,b,h=null!=(H=s)?H+"/"+_:"/"+_,p=null!=l?{scope:"/"+l+"/"}:null,v=[];return["branch","ring","version"].some(function(n){return!!Object(c.d)(n,e.location)&&(v.push(n+"="+Object(c.a)(n,e.location)),!0)}),Object(R.f)("fwk-sw-proxyFetchAlways")&&(d=Object(F.a)(),f=d.browser,b=d.browserVersion,("Chrome"==f||"Edge Anaheim"==f)&&b&&b.length>0)&&v.push("fa=1"),v.length>0&&(h=h+"?"+v.join("&")),T.register(h,p).then(function(){T.ready.then(J)})}function J(e){i.d.info("[SW Client] ready fired, state: "+e.active.state),M=e,T.oncontrollerchange=Q,z()}function z(){M.active.state==L?$():M.active.onstatechange=K}function K(e){M.active.state==L&&(M.active.onstatechange=null,$())}function Q(){null!=M.active&&z()}function $(){var e,n;e={serviceWorkerContainer:T,serviceWorkerRegistration:M,serviceWorkerPath:H,appName:B,userLanguage:D,darkMode:q},n=V,null==A&&((A=e).serviceWorkerContainer.onmessage=x,S(window,A)>U&&(A.cacheHealth=s.TooManyInstallError)),W=n,N()}t.d(n,"a",function(){return G})},8652:function(e,n,t){"use strict";var r=t(51),a=t(2216),o=t(67),c=t(2723),i=t(727);function u(e,n,t,r){if(1!=e.length)return null;var a=e[0];return{uniqueSenders:i.b.getUniqueSenders(a,n),lastSenderSmtpAddress:i.b.getLastSenderSMTP(a,n),folderId:r}}t.d(n,"b",function(){return l}),t.d(n,"a",function(){return u});var s=new r.c(function(){return Promise.all([t.e(14),t.e(487)]).then(t.bind(null,14687))});function l(){Object(o.f)("tri-triagePattern")&&(Object(r.f)(a.c,s,function(e){return e.triagePatternsOrchestrator}),Object(r.f)(c.a,s,function(e){return e.triagePatternsOrchestratorForSearch}))}}},0,[3,4,9,13,421,600,20,15,36,334,629,486,0,1,2,576,189,601,350,23,503,151,297,457,6,377,575,185,630,42,70,493,17,359,10,622,442,5,353,7,8,12,130,30,55,659,685,11,43,126,68,356,570,147,72,464,604,368,456,365,118,121,237,252,254,294,312,341,345,351,363,364,374,505,538,745]]);
//# sourceMappingURL=owa.MailFunctionalBoot.js.map
self.scriptsLoaded['owa.MailFunctionalBoot.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailFunctionalBoot.js'] = (new Date()).getTime();