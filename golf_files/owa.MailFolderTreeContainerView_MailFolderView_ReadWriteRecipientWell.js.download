self.scriptsLoaded = self.scriptsLoaded || {}; self.scriptProcessStart = self.scriptProcessStart || {}; self.scriptProcessStart['owa.MailFolderTreeContainerView~MailFolderView~ReadWriteRecipientWell.js'] = (new Date()).getTime();(window.$wj=window.$wj||[]).push([[47],{1009:function(e,t,n){"use strict";var r=n(70);t.a=Object(r.action)("updateCurrentRenderedQueryString")(function(e,t){e.currentRenderedQueryString=t})},1039:function(e,t,n){"use strict";var r=n(0),i=n(914),a=n(936),c=n(1109),s=n(4),o=Object(s.action)("resolvePendingPersonaOnRecipient",function(e,t,n){return{recipient:e,nextPersona:t,searchedString:n}});Object(s.mutator)(o,function(e){var t=e.recipient,n=e.nextPersona,r=e.searchedString;Object(i.a)(t.persona.EmailAddress)===r&&(t.isPendingResolution=!1,n&&(t.persona=n,t.isValid=!0,t.displayText=Object(c.a)(n.EmailAddress)))});var u=o,d=Object(s.action)("addRecipientsToRecipientWell",function(e,t){return{newRecipients:e,recipientWell:t}});t.a=d;Object(s.mutator)(d,function(e){var t,n=e.recipientWell;(t=n.recipients).splice.apply(t,Object(r.__spread)([n.recipients.length,0],e.newRecipients)),n.isDirty=!0}),Object(s.orchestrator)(d,function(e){e.newRecipients.forEach(function(e){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var t,n;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return e.isPendingResolution?(t=Object(i.a)(e.persona.EmailAddress),[4,a.b.import().then(function(e){return e(t)})]):[2];case 1:return n=r.sent(),u(e,n,t),[2]}})})})})},1086:function(e,t,n){"use strict";n.d(t,"a",function(){return s});var r=/^"?(.*?)"?\s*\(([^\(]*?)\)$/,i=/^"?(.*?)"?\s*<([^<]*?)>$/,a=/^"?(.*?)"?\s*\[([^\[]*?)\]$/,c=/^"?(.*?)"?\s*{([^\{]*?)}$/;function s(e){if("string"!=typeof e)return e;var t=e.trim(),n=t.match(r)||t.match(i)||t.match(a)||t.match(c);return n?n[1].length?{displayName:n[1],address:n[2]}:{address:n[2]}:{address:t}}},1109:function(e,t,n){"use strict";var r=n(1215),i=n(914),a=n(246);var c=function(e,t){var n=t||e.Name;if(!n)return!0;var i,c,s=Object(r.a)(n),o=-1!==n.indexOf("@")&&n!=e.EmailAddress,u=!Object(a.a)()&&("ExternalMailbox"===e.MailboxType||"LinkedIn"===e.MailboxType),d=!("OneOff"!==e.MailboxType&&"Unknown"!==e.MailboxType||(i=n,c=e.EmailAddress,i==c||i&&c&&i.toLowerCase()==c.toLowerCase()));return e.EmailAddress&&(s||o||u&&!o||d)};t.a=function(e,t){var n=t||e.Name,a=!n||Object(r.a)(n);return c(e,t)?a?Object(i.a)(e):n+" <"+Object(i.a)(e)+">":n}},1114:function(e,t,n){"use strict";function r(e){return void 0!==e.recipients&&void 0!==e.findResultSet}n.d(t,"a",function(){return r})},1121:function(e,t,n){"use strict";n.d(t,"a",function(){return a}),n.d(t,"c",function(){return c}),n.d(t,"b",function(){return s}),n.d(t,"d",function(){return o});var r=n(51),i=new r.c(function(){return Promise.all([n.e(6),n.e(617),n.e(419)]).then(n.bind(null,2972))}),a=Object(r.d)(i,function(e){return e.FeedbackFooter}),c=new r.a(i,function(e){return e.removePendingRequestCorrelationId}),s=new r.a(i,function(e){return e.addPendingRequestCorrelationId}),o=new r.b(i,function(e){return e.showFeedbackDialog})},1122:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(803);function i(e){var t,n="";e&&(Object(r.a)()?(t=e).Groups&&t.Instrumentation&&(n=t.Instrumentation.TraceId):"Success"==(t=e).ResponseClass&&t.ResultSet&&(n=t.TransactionId));return n}},1125:function(e,t,n){"use strict";var r=n(0),i=n(1086),a=n(1309);var c=n(1224);function s(e){var t,n,s=Object(i.a)(e),o=Object(a.a)(s.address,s.displayName);if(null===o)return Object(r.__assign)(Object(r.__assign)({},c.a),{isValid:!1,isPendingResolution:!0,displayText:e,persona:{EmailAddress:(t=e,{MailboxType:"OneOff",RoutingType:"SMTP",EmailAddress:t,Name:n||t})}});var u=Object(c.b)(o);return Object(r.__assign)(Object(r.__assign)({},u),{isPendingResolution:!0,persona:{EmailAddress:o}})}n.d(t,"a",function(){return s})},1130:function(e,t,n){"use strict";var r=n(70);t.a=Object(r.action)("setCommonWellItemSelectedState")(function(e,t){e.isSelected=t})},1131:function(e,t,n){"use strict";function r(e){var t=[];return e&&(t=e.map(function(e){return e.persona})),t}n.d(t,"a",function(){return r})},1195:function(e,t,n){"use strict";n.d(t,"a",function(){return o}),n.d(t,"d",function(){return u}),n.d(t,"c",function(){return d}),n.d(t,"b",function(){return f});var r=n(0),i=n(5),a=n(947),c=n(153),s=n(1569);function o(e,t,n,r){return l(f(e),t,n,r,function(t,n){Object(c.m)("RecipientCacheHitIndex",[Math.ceil(n/50),!Object(i.g)(e),t.sessionAdd])})}function u(e,t,n,i){return Object(r.__awaiter)(this,void 0,void 0,function(){return Object(r.__generator)(this,function(r){switch(r.label){case 0:return[4,s.b.import().then(function(r){return r(e,t,function(e){return b(n,e,i)})})];case 1:return[2,r.sent()]}})})}function d(e,t,n,r){return l(e,t,n,r)}function l(e,t,n,r,i){for(var c=[],s=0;c.length<t&&a.a.recipientCache&&s<a.a.recipientCache.length;){var o=a.a.recipientCache[s];if(e(o))b(n,o.EmailAddress,r)||(c.push(o),i&&i(o,s));s++}return c}function b(e,t,n){var r=!1;return e&&function(e,t){for(var n=0;n<t.length;n++)if(e.EmailAddress==t[n].EmailAddress.EmailAddress)return!0;return!1}(t,e)&&(r=!0),n&&n.indexOf(t.MailboxType)>=0&&(r=!0),r}var f=function(e){return function(t){var n=t.EmailAddress;if(n.EmailAddress&&0==n.EmailAddress.toLowerCase().indexOf(e))return!0;if(n.Name){if(0==n.Name.toLowerCase().indexOf(e))return!0;for(var r=n.Name.toLowerCase().split(" "),i=0;i<r.length;i++)if(0==r[i].indexOf(e))return!0}return!1}}},1215:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=["\t","\n","\v","\f","\r"," ",""," "," "," "," "," "," "," "," "," "," "," "," "," ","\u2028","\u2029"," "," ","　","؜","​","‌","‍","‎","‏","\u2028","\u2029","‪","‫","‬","‭","‮"," ","⁠","⁦","⁧","⁨","⁩"],i=null,a=function(e){return null===i&&(i=new Set,r.forEach(function(e){return i.add(e)})),e.split("").every(function(e){return i.has(e)})}},1223:function(e,t,n){"use strict";n.d(t,"b",function(){return i});var r=n(4),i=Object(r.createStore)("substratepeoplesuggestions",{sessionMaskedRecipients:[]}),a=i();t.a=a},1224:function(e,t,n){"use strict";n.d(t,"a",function(){return c}),n.d(t,"b",function(){return s});var r=n(0),i=n(1177),a=n(1109),c={isContextMenuOpen:!1,isSelected:!1,isExpanding:!1,isEditing:!1,isFadedOut:!1,expansionStatus:i.a.None,members:[]};function s(e,t){return Object(r.__assign)(Object(r.__assign)({},c),{isValid:!0,displayText:Object(a.a)(e,t)})}},1248:function(e,t,n){"use strict";var r=n(70);t.a=Object(r.action)("updateIsEditing")(function(e,t){e.isEditing=t})},1278:function(e,t,n){"use strict";var r=n(70);t.a=Object(r.action)("setForceResolveState")(function(e,t){e.inForceResolve=t})},1309:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(0),i=n(886);function a(e,t){if(Object(i.c)(e))return{MailboxType:"OneOff",RoutingType:"SMTP",EmailAddress:e,Name:t||e};if(Object(i.b)(e)){var n=Object(r.__read)(e.split(":",2),2),a=n[0],c=n[1];return{MailboxType:"OneOff",RoutingType:a.toUpperCase(),EmailAddress:c,Name:t||c}}return null}},1346:function(e,t,n){"use strict";var r=n(4),i=Object(r.action)("onRecipientsChanged",function(e,t){return{recipientWellRecipients:e,recipientData:t}});t.a=i},1359:function(e,t,n){"use strict";var r=n(0),i=n(70),a=n(1701);t.a=Object(i.action)("processSubstrateSuggestionsResponse")(function(e,t,n,i,c){var s,o;if(!t||!t.Groups)throw new Error("Response groups should not be null");var u=[];i=i||20,i=n?i-e.length:i;var d=t.Instrumentation&&t.Instrumentation.TraceId;try{for(var l=Object(r.__values)(t.Groups),b=l.next();!b.done;b=l.next()){var f=b.value;if("People"===f.Type){f.Suggestions.forEach(function(e){if(u.length<i){var t=Object(a.a)(e,d,c);t&&u.push(t)}});break}}}catch(e){s={error:e}}finally{try{b&&!b.done&&(o=l.return)&&o.call(l)}finally{if(s)throw s.error}}n?e.push.apply(e,Object(r.__spread)(u)):e.splice.apply(e,Object(r.__spread)([0,e.length],u))})},1360:function(e,t,n){"use strict";var r=n(4),i=Object(r.action)("removePersonaFromWell",function(e,t,n){return void 0===n&&(n=!1),{targetRecipientWell:e,personaToRemove:t,shouldRemoveAllOccurrences:n}});t.a=i},1377:function(e,t,n){"use strict";n.d(t,"a",function(){return i});var r=n(947);function i(){return null===r.a.recipientCache||0==r.a.recipientCache.length}},1379:function(e,t,n){"use strict";t.a={SearchPeopleIndex:{name:"SearchPeopleIndex"},AddRecipientFromFindControl:{name:"AddRecipientFromFindControl",customData:function(e,t){return{index:(e>23?23:e).toString(),source:t.toString()}}},SearchCacheFirst:{name:"SearchCacheFirst"}}},1384:function(e,t,n){"use strict";var r=n(5),i=n(889),a=n(966),c=n(7),s=n(106),o=n(63),u=n(70),d=n(734),l=Object(u.action)("localCacheTransactionCompleted")(function(e,t,n,u,l,b){if(void 0===b&&(b=Object(c.Nb)()),e&&e.hasSessionStarted){var f={TransactionRequestTime:Object(c.pb)(b),TransactionRequestDuration:Object(c.w)(Object(c.Nb)(),b),QueryString:Object(r.g)(t)?"":t,QueryStringLength:Object(s.b)(t)?0:t.length,FeatureData:null!=u?u:void 0,personaTypeList:l,ImpressionId:Object(d.a)(),Cvid:e.conversationId},p=JSON.stringify(f),O=JSON.stringify(n),j=Object(a.a)(e,"","LocalCacheTransactionCompleted",O,0,p);Object(i.a)(e,j,!1),o.d.info(Object(r.b)("{0} LocalCacheTransactionCompleted. Session id: {1}",e.entityScenarioName,e.clientSessionId))}}),b=n(1394);function f(e){if(e.findResultSet&&e.findResultSet.length>0){var t=[];e.findResultSet.forEach(function(e){t.push(b.a[e.PersonaTypeString])}),l(e.findPeopleFeedbackManager,e.queryString,(n=e.findResultSet,r=[],n&&n.forEach(function(e,t){r[t]=e.EmailAddress.EmailAddress}),r),null,t)}var n,r}n.d(t,"a",function(){return f})},1394:function(e,t,n){"use strict";t.a={Unknown:0,Person:1,DistributionList:2,ModernGroup:5,ImplicitGroup:10,ExplicitGroup:11,LinkedIn:12}},1480:function(e,t,n){"use strict";var r=n(0),i=n(1874),a=n(1278),c=n(1248),s=n(70),o=n(153);t.a=Object(s.action)("resolveAllUnresolvedRecipients")(function(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,function(){var s,u,d;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return Object(a.a)(e,!0),e.queryString=e.queryString.trim(),e.recipients&&e.queryString?(n&&n(),[4,Object(i.a)(e,!1,!0,!0)]):[3,2];case 1:return r.sent(),[3,3];case 2:for(s=-1,u=0;u<t.length;u++)if(t[u].persona&&t[u].persona.EmailAddress&&!t[u].persona.EmailAddress.EmailAddress&&"PrivateDL"!=(d=t[u].persona).EmailAddress.MailboxType&&Object(o.m)("EmptyEmailAddress",[d.EmailAddress.MailboxType,d.EmailAddress.RoutingType]),!t[u].isValid){s=u;break}-1!=s?Object(c.a)(t[s],!0):Object(a.a)(e,!1),r.label=3;case 3:return[2]}})})})},1569:function(e,t,n){"use strict";n.d(t,"b",function(){return a}),n.d(t,"a",function(){return c});var r=n(51),i=new r.c(function(){return Promise.all([n.e(30),n.e(55),n.e(561),n.e(100)]).then(n.bind(null,2546))}),a=new r.b(i,function(e){return e.searchCacheTrie}),c=new r.a(i,function(e){return e.initializeSuggestionTrie})},1651:function(e,t,n){"use strict";var r=n(4),i=Object(r.createStore)("recipientcommon",{fallbackToFindPeople:!1})();t.a=i},1701:function(e,t,n){"use strict";var r=n(5),i=n(1223);function a(e,t,n){var a=e.EmailAddresses,u=e.DisplayName,d=e.Text,l=e.PDLItemId,b=e.ADObjectId,f=e.PersonaId,p=e.FeatureData,O=e.Id,j=e.ReferenceId,m=e.ImAddress,g=e.JobTitle,h=e.PeopleSubtype,v=a?a[0]:null;if(!n&&function(e){return Object(i.b)().sessionMaskedRecipients[e]}(v))return null;var S={EmailAddress:v,Name:Object(r.g)(u)?d:u,MailboxType:o(h),RoutingType:c(h),ItemId:l?{Id:l,__type:"ItemId:#Exchange"}:null};return{DisplayName:u,ADObjectId:b,FeatureData:p,Id:O,ImAddress:m,EmailAddress:S,EmailAddresses:[S],PersonaTypeString:s(h),PersonaId:{Id:f},Title:g,ReferenceId:j,TransactionId:t}}function c(e){return"PersonalDistributionList"==e?"MAPIPDL":"SMTP"}function s(e){switch(e){case"PublicDistributionList":case"PersonalDistributionList":return"DistributionList";case"UnifiedGroup":return"ModernGroup";case"OrganizationUser":case"PersonalContact":case"ImplicitContact":case"OrganizationContact":return"Person";case"LinkedIn":return"LinkedIn";case"ImplicitGroup":return"ImplicitGroup";default:return"Unknown"}}function o(e){switch(e){case"PublicDistributionList":return"PublicDL";case"PersonalDistributionList":return"PrivateDL";case"UnifiedGroup":return"GroupMailbox";case"ImplicitGroup":return"RecommendedGroup";case"OrganizationUser":return"InternalMailbox";case"LinkedIn":return"LinkedIn";case"PersonalContact":case"OrganizationContact":case"ImplicitContact":case"Guest":case"Unknown":return"ExternalMailbox";default:return e}}n.d(t,"a",function(){return a})},1749:function(e,t,n){"use strict";var r=n(0),i=n(1346),a=n(1750),c=n(1130),s=n(70);function o(e,t,n){e[0].isSelected&&n.recipients.length>0&&Object(c.a)(n.recipients[Math.max(0,t-1)],!0)}t.a=Object(s.action)("removeReadWriteRecipients")(function(e,t,n){var c,s;void 0===n&&(n=!0);var u=!1;try{for(var d=Object(r.__values)(t),l=d.next();!l.done;l=d.next()){var b=l.value,f=-1;if((f="number"==typeof b?b:e.recipients.indexOf(b))>=0){if(e.recipients[f].blockWellItemRemoval)return;Object(a.a)(f,e,o),u=!0}}}catch(e){c={error:e}}finally{try{l&&!l.done&&(s=d.return)&&s.call(d)}finally{if(c)throw c.error}}n&&u&&Object(i.a)(e)})},1750:function(e,t,n){"use strict";var r=n(0),i=n(4),a=Object(i.action)("removeRecipientFromRecipientWell",function(e,t,n,r){return{recipientIndex:e,recipientWellRecipients:t,onRecipientDeletedCallback:n,deletedRecipient:t.recipients[e],newRecipients:r}});Object(i.mutator)(a,function(e){var t;e.recipientWellRecipients.isDirty=!0,(t=e.recipientWellRecipients.recipients).splice.apply(t,Object(r.__spread)([e.recipientIndex,1],e.newRecipients||[]))}),Object(i.orchestrator)(a,function(e){e.onRecipientDeletedCallback([e.deletedRecipient],e.recipientIndex,e.recipientWellRecipients)}),t.a=a},1777:function(e,t,n){"use strict";function r(e,t){return null!=e&&null!=t&&(e==t||e.EmailAddress&&t.EmailAddress&&null!=e.EmailAddress.EmailAddress&&null!=t.EmailAddress.EmailAddress&&e.EmailAddress.EmailAddress.toLowerCase()==t.EmailAddress.EmailAddress.toLowerCase()||e.ADObjectId&&t.ADObjectId&&e.ADObjectId==t.ADObjectId||e.PersonaId&&t.PersonaId&&e.PersonaId==t.PersonaId)}n.d(t,"a",function(){return r})},1825:function(e,t,n){"use strict";function r(e){return e?e.EmailAddress&&e.EmailAddress.EmailAddress||e.PersonaId&&e.PersonaId.Id:null}n.d(t,"a",function(){return r})},1826:function(e,t,n){"use strict";var r=n(5),i=n(889),a=n(966),c=n(7),s=n(106),o=n(63),u=n(70);t.a=Object(u.action)("transactionFailed")(function(e,t,n,u,d,l){if(void 0===l&&(l=null),e&&e.hasSessionStarted){var b={TransactionRequestTime:Object(c.pb)(u),TransactionRequestDuration:Object(c.w)(Object(c.Nb)(),u),QueryString:Object(r.g)(t)?"":t,QueryStringLength:Object(s.b)(t)?0:t.length,ImpressionId:n};l&&Object.keys(l).forEach(function(e){b[e]=l[e]}),d&&(b.Context=d);var f=JSON.stringify(b),p=Object(a.a)(e,n,"TransactionFailed",null,0,f);Object(i.a)(e,p,!1),o.d.info(Object(r.b)("{0} TransactionComplete. Session id: {1}",e.entityScenarioName,e.clientSessionId))}})},1827:function(e,t,n){"use strict";var r=n(4),i=Object(r.action)("removeRecipientsFromRecipientWells",function(e,t){return{emailAddresses:e,recipientWells:t}});t.a=i},1874:function(e,t,n){"use strict";var r=n(0),i=n(1039),a=n(943),c=n(70),s=Object(c.action)("setDirectorySearchType")(function(e,t){e.directorySearchType=t}),o=n(942),u=n(769),d=n(1125);t.a=Object(c.action)("resolveQueryStringToRecipient")(function(e,t,n,c){return Object(r.__awaiter)(this,void 0,void 0,function(){var l;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return s(e,n?u.a.Manual:u.a.None),(l=e.queryString.trim())?t||e.inForceResolve?(e.queryString="",Object(o.a)(e,!1),Object(i.a)([Object(d.a)(l)],e),[3,3]):[3,1]:[3,4];case 1:return Object(o.a)(e,!0),[4,Object(a.a)(e,e.queryString,n,c)];case 2:r.sent(),r.label=3;case 3:return[3,5];case 4:Object(o.a)(e,!1),r.label=5;case 5:return[2]}})})})},1875:function(e,t,n){"use strict";var r=n(0),i=n(70),a=(t.a=Object(i.action)("processFindPeopleResult")(function(e,t,n,i){if("Success"!=t.ResponseClass||!t.ResultSet)throw new Error("Response resultSet should not be null");i=i||20,i=n?i-e.length:i,i=t.ResultSet.length>i?i:t.ResultSet.length;for(var c=t.TransactionId,s=[],o=0;o<i;o++){var u=t.ResultSet[o];u.EmailAddress?s.push({EmailAddress:(d=u.EmailAddress,d.RoutingType&&"EX"===d.RoutingType.toUpperCase()?Object(r.__assign)(Object(r.__assign)({},d),{EmailAddress:d.OriginalDisplayName}):d),PersonaId:u.PersonaId,ADObjectId:u.ADObjectId,PersonaTypeString:u.PersonaTypeString,DisplayName:u.DisplayName,TransactionId:c}):"ImplicitGroup"==u.PersonaTypeString&&s.push({EmailAddress:a(u),PersonaId:u.PersonaId,ADObjectId:u.ADObjectId,Members:u.Members,PersonaTypeString:u.PersonaTypeString,DisplayName:u.DisplayName,TransactionId:c})}var d;n?e.push.apply(e,Object(r.__spread)(s)):e.splice.apply(e,Object(r.__spread)([0,e.length],s))}),function(e){return{EmailAddress:e.FeedbackId,OriginalDisplayName:e.FeedbackId,Name:e.DisplayName,MailboxType:"GroupMailbox",RoutingType:"SMTP"}})},803:function(e,t,n){"use strict";n.d(t,"a",function(){return c});var r=n(41),i=n(67),a=n(1651);function c(){var e=Object(r.a)(),t=e&&e.SessionSettings&&e.SessionSettings.IsExplicitLogon,n=Object(i.f)("rp-3SPeopleSuggestions")||Object(i.f)("rp-linkedInPeopleSuggestions");return!a.a.fallbackToFindPeople&&n&&!t&&e.SessionSettings.IsSubstrateSearchServiceAvailable}},889:function(e,t,n){"use strict";var r=n(5),i=n(70),a=n(1330),c=n.n(a),s=n(1331),o=n.n(s),u=n(193),d=n(63);function l(e){var t=o()({EntityFeedbackEntries:e});return c()({Header:Object(u.getJsonRequestHeader)(),Body:t}).then(function(e){!function(e){if(e&&e.Body){var t=e.Body;d.d.info(Object(r.b)("addEntityFeedback Error count: {0}",t.ErrorCount)),d.d.info(Object(r.b)("addEntityFeedback error details: {0}",t.ErrorDetails))}}(e)})}t.a=Object(i.action)("attemptToSubmitAddEntityFeedback")(function(e,t,n){e&&t&&(e.entityFeedbackEntries.push(t),(n||e.entityFeedbackEntries.length>=e.maxActionBatchSize)&&(l(e.entityFeedbackEntries),d.d.info(Object(r.b)("{0} Submitted {1} entities.",e.entityScenarioName,e.entityFeedbackEntries.length)),e.entityFeedbackEntries=[]))})},914:function(e,t,n){"use strict";function r(e){if("SMTP"===e.RoutingType||void 0===e.RoutingType)return e.EmailAddress;var t="MAPIPDL"===e.RoutingType&&e.ItemId&&e.ItemId.Id||e.EmailAddress;return e.RoutingType+":"+t}n.d(t,"a",function(){return r})},915:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var r=n(0),i=n(1224);function a(e){var t=Object(i.b)(e.EmailAddress,e.DisplayName);return Object(r.__assign)(Object(r.__assign)({},t),{isPendingResolution:!1,persona:e})}},936:function(e,t,n){"use strict";n.d(t,"b",function(){return a}),n.d(t,"a",function(){return c});var r=n(51),i=new r.c(function(){return Promise.all([n.e(72),n.e(426)]).then(n.bind(null,2700))}),a=new r.b(i,function(e){return e.searchSuggestionsForSinglePersona}),c=new r.b(i,function(e){return e.searchSuggestions})},938:function(e,t,n){"use strict";var r=n(7),i=n(803);n.d(t,"c",function(){return u}),n.d(t,"b",function(){return d}),n.d(t,"d",function(){return l}),n.d(t,"a",function(){return b});var a="Cache",c="Mailbox",s="Directory",o=" Fallback";function u(e){e.peopleFeedbackState={live:null,cache:null,directory:null}}function d(e,t,n,a){if(Object(i.a)()&&e.peopleFeedbackState){var o={CorrelationId:"",TimeStamp:"",QueryString:"",SuggestionSource:"",RawResponse:""};o.TimeStamp=Object(r.zb)(t),o.QueryString=e.queryString,o.SuggestionSource=a?s:c,o.RawResponse="pending",n&&(o.CorrelationId=n),a?e.peopleFeedbackState.directory=o:e.peopleFeedbackState.live=o}}function l(e,t,n){if(Object(i.a)()&&e.peopleFeedbackState){var r=n?JSON.stringify(n):"no response";e&&e.peopleFeedbackState&&(t&&e.peopleFeedbackState.directory?e.peopleFeedbackState.directory.RawResponse=r:!t&&e.peopleFeedbackState.live&&(e.peopleFeedbackState.live.RawResponse=r))}}function b(e,t,n,c){if(Object(i.a)()&&e.peopleFeedbackState){var s={CorrelationId:"",TimeStamp:"",QueryString:"",SuggestionSource:"",RawResponse:""};s.QueryString=e.queryString,s.TimeStamp=Object(r.zb)(t),s.SuggestionSource=c?a+o:a,s.RawResponse=n?JSON.stringify(n):"no response",e.peopleFeedbackState.cache=s}}},942:function(e,t,n){"use strict";var r=n(70);t.a=Object(r.action)("setIsSearching")(function(e,t){e.isSearching!=t&&(e.isSearching=t)})},943:function(e,t,n){"use strict";var r=n(0),i=n(936),a=n(70),c=n(1039),s=n(1114),o=n(915),u=Object(a.action)("postProcessSuggestionsResult")(function(e,t,n){1==e.findResultSet.length&&n&&Object(s.a)(e)?Object(c.a)(e.findResultSet.map(o.a),e):e.findResultType=t}),d=n(1359),l=n(803);function b(e,t){Object(l.a)()?function(e,t){var n,i;try{for(var a=Object(r.__values)(t.Groups),c=a.next();!c.done;c=a.next()){var s=c.value;if("People"===s.Type){var o=s.Suggestions.filter(function(t){return null==e[t.EmailAddresses?t.EmailAddresses[0]:""]});s.Suggestions=o;break}}}catch(e){n={error:e}}finally{try{c&&!c.done&&(i=a.return)&&i.call(a)}finally{if(n)throw n.error}}}(e,t):function(e,t){var n=t.ResultSet.filter(function(t){return null==e[t.EmailAddress?t.EmailAddress.EmailAddress:""]});t.ResultSet=n}(e,t)}var f=n(1875),p=Object(a.action)("processResponseResults")(function(e,t,n,r,i){if(n){var a=new Map;e.forEach(function(e){a[e.EmailAddress.EmailAddress]=e}),b(a,t)}Object(l.a)()?Object(d.a)(e,t,n,r,i):Object(f.a)(e,t,n,r)}),O=n(938),j=n(942),m=n(1009),g=n(1122),h=n(7),v=n(734),S=n(769),y=n(5),R=n(889),E=n(966),A=n(106),I=n(63),T=Object(a.action)("transactionCompleted")(function(e,t,n,r,i,a,c,s){if(void 0===s&&(s=null),e&&e.hasSessionStarted){var o={TransactionRequestTime:Object(h.pb)(i),TransactionRequestDuration:Object(h.w)(Object(h.Nb)(),i),QueryString:Object(y.g)(t)?"":t,QueryStringLength:Object(A.b)(t)?0:t.length,PersonaTypeList:c,ImpressionId:r,Cvid:e.conversationId};s&&Object.keys(s).forEach(function(e){o[e]=s[e]}),a&&(o.Context=a);var u=JSON.stringify(o),d=JSON.stringify(n),l=Object(E.a)(e,r,"TransactionCompleted",d,0,u);Object(R.a)(e,l,!1),I.d.info(Object(y.b)("{0} TransactionComplete. Session id: {1}",e.entityScenarioName,e.clientSessionId))}}),_=n(1394);function P(e,t,n){var r=[];e.findResultSet&&e.findResultSet.length>0&&e.findResultSet.forEach(function(e){r.push(_.a[e.PersonaTypeString])});var i,a;T(e.findPeopleFeedbackManager,e.queryString,(i=e.findResultSet,a=[],i&&i.forEach(function(e,t){a[t]=e.Id||e.EmailAddress.EmailAddress||e.EmailAddress.Name}),a),n,t,{Action:"Type Down"},r)}var w=Object(a.action)("autoSearchDirectory")(function(e,t,n){return Object(r.__awaiter)(this,void 0,void 0,function(){var a,c,s;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return a=Object(h.Nb)(),c=Object(v.a)(),Object(O.b)(e,a,c,!0),[4,i.a.import().then(function(n){return n(t,!0,c,e.findPeopleFeedbackManager)})];case 1:return s=r.sent(),Object(j.a)(e,!1),e.queryString.trim()==t&&(20,Object(m.a)(e,t),p(e.findResultSet,s,!1,20,!0),Object(O.d)(e,!0,s),P(e,a,Object(g.a)(s)),e.directorySearchType=S.a.Auto,0==e.findResultSet.length&&(e.findResultSet=[]),u(e,S.b.SearchDirectory,n)),[2]}})})}),C=n(4),F=Object(C.action)("addPendingRequest",function(e){return{correlationId:e}}),k=Object(C.action)("removePendingRequest",function(e){return{correlationId:e}}),x=n(947),D=n(1825),N=Object(a.action)("addToCache")(function(e){e&&0!=e.length&&null!==x.a.recipientCache&&e.forEach(function(e){if("LinkedIn"!=e.PersonaTypeString){var t=Object(D.a)(e);if(t&&!x.a.allKeys[t]){var n=Object(r.__assign)(Object(r.__assign)({},e),{sessionAdd:!0});x.a.recipientCache.push(n),x.a.allKeys[t]=!0}}})}),M=n(1826);function L(e,t,n){Object(M.a)(e.findPeopleFeedbackManager,e.queryString,n,t,{Action:"Type Down"})}var q=Object(a.action)("backfillCache")(function(e,t){return Object(r.__awaiter)(this,void 0,void 0,function(){var n,a,c,s,o,u;return Object(r.__generator)(this,function(r){switch(r.label){case 0:n=Object(v.a)(),F(n),a=Object(h.Nb)(),Object(O.b)(e,a,n,!1),c="",r.label=1;case 1:return r.trys.push([1,3,4,5]),[4,i.a.import().then(function(e){return e(t,!1,n)})];case 2:return s=r.sent(),c=Object(g.a)(s),o=function(e){if(Object(l.a)()){var t=[];return Object(d.a)(t,e,!1),t}return e.ResultSet}(s),N(o),function(e){if(Object(l.a)()){var t=e;return!t||!t.Groups}var t=e;return"Success"!=t.ResponseClass||0==t.ResultSet.length}(s)||e.queryString!=t||(u=e.findResultSet.length>0,Object(O.d)(e,!1,s),p(e.findResultSet,s,u,5),P(e,a,c)),[3,5];case 3:return r.sent(),L(e,a,c),[3,5];case 4:return k(n),[7];case 5:return[2]}})})});var W=n(1379),G=n(1360),Q=n(1777),U=n(1749),J=(Object(C.orchestrator)(G.a,function(e){var t=e.targetRecipientWell,n=e.personaToRemove,r=e.shouldRemoveAllOccurrences,i=t.recipients.filter(function(e){return Object(Q.a)(e.persona,n)});if(i&&i.length>0){for(var a=r?i.length-1:0,c=[],s=0;s<=a;s++)i[s]&&!i[s].blockWellItemRemoval&&c.push(i[s]);c.length>0&&Object(U.a)(t,c)}}),n(1827)),z=(Object(C.orchestrator)(J.a,function(e){var t=e.recipientWells;t&&0!==t.length&&e.emailAddresses.forEach(function(e){var n={EmailAddress:e};t.filter(function(e){return!!e}).forEach(function(e){return Object(G.a)(e,n,!0)})})}),n(1346)),V=n(1480);Object(C.orchestrator)(c.a,function(e){e.newRecipients.forEach(function(e){e.isValid&&N([e.persona])})}),Object(C.orchestrator)(c.a,function(e){var t=e.recipientWell;t&&Object(s.a)(t)&&t.inForceResolve&&Object(V.a)(t,t.recipients)}),Object(C.orchestrator)(c.a,function(e){var t=e.recipientWell,n=e.newRecipients;Object(z.a)(t,n.map(function(e){return{isValid:e.isValid,newPersona:e.persona,newEmailAddress:e.persona.EmailAddress.EmailAddress}}))});var $=n(67),B=n(1121);Object(C.orchestrator)(F,function(e){H.pendingFindPeopleRequests++,Object($.f)("rp-findPeopleSuggestionFeedback")&&B.b.importAndExecute(e.correlationId)}),Object(C.orchestrator)(k,function(e){H.pendingFindPeopleRequests--,Object($.f)("rp-findPeopleSuggestionFeedback")&&B.c.importAndExecute(e.correlationId)});var H=Object(C.createStore)("readwriterecipientwell",{pendingFindPeopleRequests:0})(),K=n(153),X=Object(a.action)("setFindResultSet")(function(e,t){e.findResultSet=t});var Y=n(1384),Z=Object(a.action)("processCacheResult")(function(e,t,n,i){return Object(r.__awaiter)(this,void 0,void 0,function(){var a;return Object(r.__generator)(this,function(c){return n&&(a=new Map,e.findResultSet.forEach(function(e){a[e.EmailAddress.EmailAddress]=e}),t=function(e,t){return t.filter(function(t){return null==e[t.EmailAddress?t.EmailAddress.EmailAddress:""]})}(a,t),(t=Object(r.__spread)(e.findResultSet,t)).splice(5)),Object(j.a)(e,!1),X(e,t),Object(Y.a)(e),u(e,S.b.Cache,i),[2]})})}),ee=n(1195);function te(e,t){return Object(r.__awaiter)(this,void 0,void 0,function(){var n,i,a;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return Object($.f)("rp-peopleSuggestionsTrie")?[4,Object(ee.d)(e,5,t)]:[3,2];case 1:return i=r.sent(),[3,3];case 2:i=Object(ee.a)(e,5,t),r.label=3;case 3:return 0==(n=i).length?[2,[]]:(a=n.map(function(e){return{EmailAddress:e.EmailAddress,PersonaId:e.PersonaId,ADObjectId:e.ADObjectId,PersonaTypeString:e.PersonaTypeString}}),[2,Promise.resolve(a)])}})})}var ne=n(1131),re=function(e,t,n,i,a){return Object(r.__awaiter)(void 0,void 0,void 0,function(){var c,s;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return c=Object(h.Nb)(),[4,te(e,Object(ne.a)(t))];case 1:return s=r.sent(),Object(O.a)(n,c,s),Z(n,s,i,a),[2]}})})},ie=Object(a.action)("findPeopleCacheFirst")(function(e,t,n,i,a){return Object(r.__awaiter)(this,void 0,void 0,function(){var c,s,o;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return c=S.b.Cache,s=new K.a(W.a.SearchCacheFirst.name),e.directorySearchType=S.a.None,Object(j.a)(e,!0),[4,re(t,n,e,i,a)];case 1:if(r.sent(),Object(m.a)(e,t),!(e.findResultSet.length<5))return[3,7];r.label=2;case 2:return r.trys.push([2,6,,7]),e.findResultSet.length>0&&H.pendingFindPeopleRequests<3?(q(e,t),c=S.b.MixedCacheLive,[3,5]):[3,3];case 3:return 0!=e.findResultSet.length?[3,5]:[4,q(e,t)];case 4:r.sent(),c=S.b.FindPeople,r.label=5;case 5:return[3,7];case 6:return o=r.sent(),s.endWithError("ServerError",o),[3,7];case 7:return e.findResultSet.length>0?(u(e,c,a),[3,10]):[3,8];case 8:return[4,w(e,t,a)];case 9:r.sent(),c=S.b.SearchDirectory,r.label=10;case 10:return Object(j.a)(e,!1),s.addCustomData([c,t==e.queryString]),s.end(),[2]}})})}),ae=5;var ce=n(1377),se=Object(a.action)("searchCacheFallback")(function(e,t,n,i,a,c){return Object(r.__awaiter)(this,void 0,void 0,function(){var s,o;return Object(r.__generator)(this,function(r){switch(r.label){case 0:return e.queryString.trim()!=t.trim()?[3,2]:(s=Object(h.Nb)(),[4,te(t,Object(ne.a)(n))]);case 1:o=r.sent(),Object(O.a)(e,s,o,!0),Object(m.a)(e,t),e.directorySearchType=S.a.None,o.length>0?Z(e,o,i,a):c&&(c.isCacheEmpty=!0),r.label=2;case 2:return[2]}})})});t.a=Object(a.action)("findReadWriteRecipient")(Object(a.select)({store:function(){return H}})(function(e,t,n,a,c,o,d,b){return Object(r.__awaiter)(this,void 0,void 0,function(){var f,y,R,E,A,I,T,_,C,x,D,N,M,q,G,Q,U,J;return Object(r.__generator)(this,function(z){switch(z.label){case 0:return n||Object(O.c)(e),f=function(e,t){return Object(s.a)(e)?e.recipients:t||[]}(e,c),y=!1,o&&o.length>0&&(R=function(e,t){var n=[];if(t){var r=0;for(e=e.toLowerCase();n.length<ae&&r<t.length;){var i=t[r].persona.EmailAddress;(i.EmailAddress&&0==i.EmailAddress.toLowerCase().indexOf(e)||i.Name&&0==i.Name.toLowerCase().indexOf(e))&&n.push({EmailAddress:i}),r++}}return n}(t,o))&&R.length>0&&(e.findResultSet=R,y=!0),!d&&!Object($.f)("rp-peopleSuggestionsCacheFirst")||n?[3,2]:[4,ie(e,t,f,y,a)];case 1:return z.sent(),[2];case 2:return E=!1,b.store.pendingFindPeopleRequests<3?(J=new K.a(W.a.SearchPeopleIndex.name),Object(j.a)(e,!0),A=e.currentRenderedQueryString,I=e.directorySearchType,Object($.f)("rp-optimizeAutoSearchDirectory")&&""!=A&&!n&&I==S.a.Auto&&A.length<t.length&&0==t.indexOf(e.currentRenderedQueryString)?[4,w(e,t,a)]:[3,4]):[3,14];case 3:return z.sent(),E=!0,J.addCustomData([!1,!0,!0,!1,!0,Object(l.a)()]),J.end(),[3,13];case 4:T={isTimedOut:!1,isCacheEmpty:!1},_=n||Object(ce.a)()?null:setTimeout(function(e,t,n,i,a,c){return function(){return Object(r.__awaiter)(void 0,void 0,void 0,function(){return Object(r.__generator)(this,function(r){switch(r.label){case 0:return c.isTimedOut=!0,[4,se(e,n,t,i,a,c)];case 1:return r.sent(),[2]}})})}}(e,f,t,y,a,T),1e3),C=Object(h.Nb)(),x="",D=Object(v.a)(),z.label=5;case 5:return z.trys.push([5,11,,13]),F(D),N=[],f.forEach(function(e){N.push(e.persona.EmailAddress.EmailAddress)}),Object(O.b)(e,C,D,n),[4,i.a.import().then(function(r){return r(t,n,D,e.findPeopleFeedbackManager,N)})];case 6:return M=z.sent(),k(D),clearTimeout(_),q=e.queryString==t,Object(O.d)(e,n,M),T.isTimedOut&&!T.isCacheEmpty||!q?[3,10]:(Object(m.a)(e,t),e.directorySearchType=n?S.a.Manual:S.a.None,G=n?20:5,p(e.findResultSet,M,y,G,n),x=Object(g.a)(M),P(e,C,x),e.findResultSet.length>0?(Object(j.a)(e,!1),Q=n?S.b.SearchDirectory:S.b.FindPeople,u(e,Q,a),[3,10]):[3,7]);case 7:return[4,se(e,t,f,y,a)];case 8:return z.sent(),0!==e.findResultSet.length?[3,10]:(E=!0,[4,w(e,t,a)]);case 9:z.sent(),z.label=10;case 10:return J.addCustomData([T.isTimedOut,q,n,T.isCacheEmpty,E,Object(l.a)()]),J.end(),[3,13];case 11:return U=z.sent(),k(D),J.endWithError("ServerError",U),L(e,C,x),[4,se(e,t,f,y,a)];case 12:return z.sent(),[3,13];case 13:return[3,16];case 14:return J=new K.a("FindPeopleThresholdHit"),[4,se(e,t,f,y,a)];case 15:z.sent(),J.end(),z.label=16;case 16:return Object(j.a)(e,!1),[2]}})})}))},947:function(e,t,n){"use strict";var r=n(4),i=Object(r.createStore)("recipientcache",{recipientCache:null,allKeys:{},usedFindPeopleFallback:!1})();t.a=i},966:function(e,t,n){"use strict";var r=n(5),i=n(70),a=Object(i.action)("increaseEntrySequenceNumber")(function(e){e&&e.entrySequenceNumber++}),c=n(106),s=n(63),o=n(7);function u(e,t,n,i,u,d,l,b){if(void 0===b&&(b=Object(o.Nb)()),!e)return s.d.warn("Attempting to create entity feedback entry with invalid feedbackManager"),null;if(Object(c.b)(e.clientSessionId))return s.d.warn(Object(r.b)("{0} - Attempting to create entity feedback entry with empty client session id",e.entityScenarioName)),null;var f={ClientEventTimeUtc:Object(o.rb)(b),ClientEventTimeLocal:Object(o.pb)(b),ClientSessionId:e.clientSessionId,ClientVersion:e.clientVersion,ClientId:e.clientId,EntityType:e.entityType,EntrySequenceNumber:e.entrySequenceNumber,TransactionId:t,EventType:n,TargetEntityList:i,EntityAddSource:u,JsonPropertyBag:d,ScenarioName:l||e.entityScenarioName};return a(e),f}n.d(t,"a",function(){return u})}}]);
//# sourceMappingURL=owa.MailFolderTreeContainerView~MailFolderView~ReadWriteRecipientWell.js.map
self.scriptsLoaded['owa.MailFolderTreeContainerView~MailFolderView~ReadWriteRecipientWell.js'] = 1; self.scriptProcessEnd = self.scriptProcessEnd || {}; self.scriptProcessEnd['owa.MailFolderTreeContainerView~MailFolderView~ReadWriteRecipientWell.js'] = (new Date()).getTime();